"use strict";(self["webpackChunkgl_starter"]=self["webpackChunkgl_starter"]||[]).push([[6683],{62642:function(e,t,s){s.r(t),s.d(t,{Back:function(){return r.eJ},Bounce:function(){return r.sm},CSSPlugin:function(){return i._Z},Circ:function(){return r.zO},Cubic:function(){return r.Ll},Elastic:function(){return r.tQ},Expo:function(){return r.Au},Linear:function(){return r.bJ},Power0:function(){return r.qD},Power1:function(){return r.EA},Power2:function(){return r.Lp},Power3:function(){return r.Aq},Power4:function(){return r.Yp},Quad:function(){return r.lD},Quart:function(){return r.CQ},Quint:function(){return r.gU},Sine:function(){return r.Yv},SteppedEase:function(){return r.NB},Strong:function(){return r.cK},TimelineLite:function(){return r.Vq},TimelineMax:function(){return r.b_},TweenLite:function(){return r.iC},TweenMax:function(){return a},default:function(){return n},gsap:function(){return n}});var r=s(25317),i=s(9975),n=r.p8.registerPlugin(i._Z)||r.p8,a=n.core.Tween},22632:function(e,t,s){s.d(t,{V:function(){return n},q:function(){return i}});var r=s(63887);const i={rectangle:"brush.png",radial:"radial-brush.png",brush01:"brush-01-2.png",brush02:"brush-02-2.png",brush03:"brush-03-2.png",brush04:"brush-04-2.png",brush05:"brush-05-2.png",brush06:"brush-06-2.png",brush07:"brush-07-2.png",brush08:"brush-08-2.png",brush09:"brush-09-2.png",brush10:"brush-10-2.png"},n=[{brush:"radial",size:20,distPerPoint:.007,color:16742530,useBackground:!0,useRandAngle:!1,noiseStep:.65,channel:r.vec3.fromValues(0,1,0),isIntro:!0,minAlpha:.3,alphaDecreaseSpeed:-.02},{brush:"brush02",size:40,distPerPoint:.005,color:16754674,useRandAngle:!1},{brush:"brush04",size:35,distPerPoint:.005,color:955468,useRandAngle:!1},{brush:"brush10",size:50,distPerPoint:.005,color:8679108,useRandAngle:!1},{brush:"brush02",size:35,distPerPoint:.005,color:2700436,useRandAngle:!1,noiseStep:.65}]},6683:function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var r=s(63887),i=s(94292),n=s(2246),a=s(88271),h=s(21370),o=s(46009),u=s(97703),l=s(62642),c=s(22632),d=s(46816);const p=1.3,f=1.25,g=.1;class w{constructor(e){this.renderer=e,this.isPainting=!1,this.isLoaderBrush=!0,this.baseSize=0,this.viewport=[0,0],this.aspect=1,this.isMobile=!1,this.drawInitialBrush=!1,this.distPerPoint=.025,this.minAlpha=.4,this.alphaDecreaseSpeed=-1,this.alphaIncreaseSpeed=1,this.alphaDecreaseLength=.25,this.direction=r.vec2.create(),this.startCoord=r.vec2.create(),this.coord=r.vec2.create(),this.lerpCoord=r.vec2.create(),this.prevCoord=r.vec2.create(),this.velocity=r.vec2.create(),this.angle=0,this.mouseLerp=.2,this.angleLerp=1,this.prevTime=0,this.currentBrushParams={totalPoints:0,hasModifiedAlpha:!1,brushAlphaStartPos:0,hasIncreasingSize:!1,hasDecreasingSize:!1,alpha:1,size:7,increaseScale:0,decreaseScale:0},this.maxDist=6,this.canDraw=!1,this.isInTransition=!1,this.justStarted=!1,this.clearColor=!1,this.debugNoAutoSkip=!1,this.onResize=()=>{this.viewport[0]=window.innerWidth,this.viewport[1]=window.innerHeight,this.aspect=window.innerWidth/window.innerHeight,this.flow.setViewport(this.aspect,this.viewport),this.isMobile=window.innerWidth<768,this.flow.clearBrushs()},this.onChangeState=e=>{var t,s;"intro"===(null===(t=this.currentState)||void 0===t?void 0:t.landing_page)&&"SKIP"===(null===(s=e.event)||void 0===s?void 0:s.type)&&(this.updateBrushConfig(c.V[1]),this.clearColor=!1),this.currentState=e.value,this.currentArchivesStep=e.context.step},this.onCursorDown=()=>{this.isInTransition||u["default"].state.machine.context.archiveTransition||(this.canDraw=!0,this.justStarted=!0)},this.onCursorUp=()=>{this.canDraw=!1,!this.debugNoAutoSkip&&this.currentBrushParams.totalPoints*this.distPerPoint>=g&&(this.isInTransition=!0,this.goNext()),this.resetMouse()},this.updateBrushConfig=({brush:e,size:t,color:s,lerp:i=.04,alpha:n=1,useBackground:a=!1,useRandAngle:h=!1,noiseStep:o=.65,accumulations:u=1,drawInitialBrush:c=!0,distPerPoint:d=.03,channel:p=r.vec3.fromValues(1,0,0),isIntro:f=!1,minAlpha:g=.4,alphaDecreaseSpeed:w=-.009,alphaIncreaseSpeed:m=.006,alphaDecreaseLength:v=.25})=>{f?(this.flow.setAlphaBackground(+a),this.flow.setBrushTexture(e),this.currentBrushParams.size=t,this.flow.setAccumulation(u),this.flow.setNoiseStep(o),this.flow.setUseRandomAngle(h),this.flow.setChannelToUse(p),this.flow.setIsIntro(f),this.drawInitialBrush=c,this.mouseLerp=i,this.distPerPoint=d,this.isInTransition=!1,this.minAlpha=g,this.alphaDecreaseSpeed=w,this.alphaIncreaseSpeed=m,this.alphaDecreaseLength=v):l["default"].to(this.flow,{alpha:0,duration:.5,onComplete:()=>{this.flow.clearBrushs(),this.flow.alpha=n,this.flow.setAlphaBackground(+a),this.flow.setBrushColor(s),this.flow.setBrushTexture(e),this.currentBrushParams.size=t,this.flow.setAccumulation(u),this.flow.setNoiseStep(this.currentBrushParams.hasModifiedAlpha?1:o),this.flow.setUseRandomAngle(h),this.flow.setChannelToUse(p),this.flow.setIsIntro(f),this.drawInitialBrush=c,this.mouseLerp=i,this.distPerPoint=d,this.minAlpha=g,this.alphaDecreaseSpeed=w,this.alphaIncreaseSpeed=m,this.alphaDecreaseLength=v,this.isInTransition=!1}})},this.goNext=async()=>{if("loader"===this.currentState.landing_page)this.clearColor=!0,u["default"].state.send("NEXT"),await(0,n.Z)(500),this.updateBrushConfig(c.V[0]);else if("intro"===this.currentState.landing_page)this.updateBrushConfig(c.V[1]),await(0,n.Z)(500),u["default"].state.send("PAINTING_DONE"),this.clearColor=!1;else if("running"===this.currentState.archives)switch(this.currentArchivesStep){case 0:u["default"].state.send("NEXT"),await(0,n.Z)(1500),this.updateBrushConfig(c.V[2]);break;case 1:u["default"].state.send("NEXT"),await(0,n.Z)(1500),this.updateBrushConfig(c.V[3]);break;case 2:u["default"].state.send("NEXT"),await(0,n.Z)(1500),this.updateBrushConfig(c.V[4]);break;case 3:u["default"].state.send("SKIP"),await(0,n.Z)(1500),await l["default"].to(this.flow,{alpha:0,duration:.5});break}},this.updateMouse=e=>{const t=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,s=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,r=t/this.viewport[0]*2-1,i=-s/this.viewport[1]*2+1,n=h.Z.dt/1e3,a=(r-this.prevCoord[0])/n,o=(i-this.prevCoord[1])/n;this.canDraw&&(this.coord.set([r,i]),this.velocity.set([a,o]),this.angle=Math.atan2(o,a),this.justStarted&&(this.flow.velocity.set(this.velocity),this.lerpCoord.set(this.coord),this.prevCoord.set(this.coord),this.flow.angle=this.angle,this.justStarted=!1)),this.prevTime=h.Z.dt},this.updateAlpha=(e=!1)=>{const t=Math.max(this.minAlpha,Math.min(this.currentBrushParams.alpha+(e?this.alphaDecreaseSpeed:this.alphaIncreaseSpeed),1));return this.currentBrushParams.alpha=t,this.currentBrushParams.alpha},this.getBrushProgress=e=>e*this.distPerPoint/(this.isMobile?f:p*this.aspect),this.brushes=[],this.currentBrush=-1,this.cfg=i.Z.get(e.gl).config().depthMask(!1).enableDepthTest(!1).enableBlend(!0).blendFuncSeparate(e.gl.SRC_ALPHA,e.gl.ONE_MINUS_SRC_ALPHA,e.gl.ONE,e.gl.ONE_MINUS_SRC_ALPHA)}createDebug(){const e=o.Z.folder("Brushes");e.add(this,"debugNoAutoSkip"),e.add(this,"distPerPoint",{min:.001,max:.2,step:1e-4}),e.add(this,"mouseLerp",{min:0,max:1,step:.01}),e.add(this,"angleLerp",{min:0,max:1,step:.01}),e.add(this,"minAlpha",{min:0,max:.5,step:.01}),e.add(this,"alphaIncreaseSpeed",{min:0,max:.1,step:.001}),e.add(this,"alphaDecreaseSpeed",{min:-.1,max:0,step:.001}),e.add(this,"alphaDecreaseLength",{min:0,max:.5,step:.001})}resetMouse(){this.prevTime=0,this.coord.set([-2,-2]),this.lerpCoord.set([-2,-2]),this.prevCoord.set([-2,-2]),this.velocity.set([0,0]),this.angle=0,this.currentBrushParams=Object.assign(Object.assign({},this.currentBrushParams),{totalPoints:0,hasModifiedAlpha:Math.random()>.2,hasIncreasingSize:Math.random()>.4,increaseScale:2*Math.random()+1,hasDecreasingSize:Math.random()>.4,decreaseScale:2*Math.random()+1,alpha:1,brushAlphaStartPos:.6*Math.random()+.2}),this.flow.velocity.set([0,0])}async load(){if(!this.flow){const e=(await Promise.all([s.e(9400),s.e(6478),s.e(1236),s.e(2046)]).then(s.bind(s,42046))).FlowMap;this.flow=new e(this.renderer)}return this.flow.load()}unload(){}async start(){this.changeStateSubscription=u["default"].state.subscribe(this.onChangeState),this.onResize(),this.renderer.postprocess.enabled=!1,this.flow.start(),this.renderer.ilayer.addEventListener("mousedown",this.onCursorDown),this.renderer.ilayer.addEventListener("touchstart",this.onCursorDown),this.renderer.ilayer.addEventListener("mouseup",this.onCursorUp),this.renderer.ilayer.addEventListener("touchend",this.onCursorUp),window.addEventListener("mousemove",this.updateMouse),window.addEventListener("touchmove",this.updateMouse),window.addEventListener("resize",this.onResize)}stop(){this.changeStateSubscription.unsubscribe(),this.renderer.postprocess.enabled=!0,this.flow.stop(),this.renderer.ilayer.removeEventListener("mousedown",this.onCursorDown),this.renderer.ilayer.removeEventListener("touchstart",this.onCursorDown),this.renderer.ilayer.removeEventListener("mouseup",this.onCursorUp),this.renderer.ilayer.removeEventListener("touchend",this.onCursorUp),window.removeEventListener("mousemove",this.updateMouse),window.removeEventListener("touchmove",this.updateMouse),window.removeEventListener("resize",this.onResize)}preRender(){if(!this.justStarted){let e=h.Z.dt/1e3*(this.mouseLerp/.008);e=Math.max(this.mouseLerp,e),r.vec2.lerp(this.lerpCoord,this.lerpCoord,this.coord,e),r.vec2.lerp(this.flow.velocity,this.flow.velocity,this.velocity,e);const t=r.vec2.distance(this.prevCoord,this.lerpCoord)*(this.aspect<1?1:this.aspect);if(r.vec2.sub(this.direction,this.prevCoord,this.lerpCoord),t>this.distPerPoint&&this.canDraw){const{hasModifiedAlpha:e,hasIncreasingSize:s,increaseScale:i,hasDecreasingSize:n,decreaseScale:h,brushAlphaStartPos:o}=this.currentBrushParams;this.flow.angle=(0,a.t)(this.flow.angle,this.angle,this.angleLerp);const u=Math.floor(t/this.distPerPoint),l=[];for(let t=1;t<u+1;t++){const c=this.getBrushProgress(this.currentBrushParams.totalPoints+t);let p=c/.2;p=Math.min(1,Math.max(0,p));let f=!1,g=(c-.8)/.2;g=Math.min(1,Math.max(0,g));let w=!1,m=!1;c>o&&e?(this.currentBrushParams.alpha=this.minAlpha,this.currentBrushParams.hasModifiedAlpha=!1):c>o-this.alphaDecreaseLength&&e&&(m=!0);const v=r.vec2.lerp(r.vec2.create(),this.prevCoord,this.lerpCoord,t/u),P=Math.random()*Math.PI*2;let b=this.currentBrushParams.size;s&&p<1&&(f=!0,b=(0,a.Z)(this.currentBrushParams.size*i,this.currentBrushParams.size,p)),n&&g>0&&(f=!1,w=!0,b=(0,a.Z)(this.currentBrushParams.size,this.currentBrushParams.size*h,g));let S=(0,d.FG)(this.updateAlpha(m));S=f?(0,a.Z)(0,S,p):w?(0,a.Z)(S,0,g):S,l.push({coord:v,randAngle:P,alpha:S,size:b})}this.currentBrushParams.totalPoints+=l.length,this.flow.points=l,this.prevCoord.set(this.lerpCoord),this.getBrushProgress(this.currentBrushParams.totalPoints)>1&&this.onCursorUp()}else this.flow.points=[]}this.flow.preRender()}rttPass(){this.flow.rttPass()}render(){this.clearColor&&(this.renderer.gl.clearColor(234/255,228/255,203/255,0),this.renderer.gl.clear(this.renderer.gl.COLOR_BUFFER_BIT)),this.cfg.apply(),this.flow.render()}}},46816:function(e,t,s){function r(e){return e*e}s.d(t,{FG:function(){return r}});Math.PI,Math.PI}}]);
//# sourceMappingURL=6683.29883f38.js.map