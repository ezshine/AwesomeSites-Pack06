(self["webpackChunkgl_starter"]=self["webpackChunkgl_starter"]||[]).push([[6381],{24771:function(t,e,r){var n=Object.defineProperty,o=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,u=(t,e,r)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,l=(t,e)=>{for(var r in e||(e={}))a.call(e,r)&&u(t,r,e[r]);if(s)for(var r of s(e))c.call(e,r)&&u(t,r,e[r]);return t},h=(t,e)=>o(t,i(e)),f=t=>n(t,"__esModule",{value:!0}),d=(t,e)=>{for(var r in f(t),e)n(t,r,{get:e[r],enumerable:!0})};d(e,{Atom:()=>cn,PointerProxy:()=>yn,Ticker:()=>vn,getPointerParts:()=>_r,isPointer:()=>wr,isPrism:()=>Sr,iterateAndCountTicks:()=>dn,iterateOver:()=>gn,pointer:()=>mr,pointerToPrism:()=>hn,prism:()=>rn,val:()=>fn});var p=Array.isArray,v=p,g="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,y=g,_="object"==typeof self&&self&&self.Object===Object&&self,b=y||_||Function("return this")(),m=b,w=m.Symbol,j=w,P=Object.prototype,O=P.hasOwnProperty,S=P.toString,T=j?j.toStringTag:void 0;function k(t){var e=O.call(t,T),r=t[T];try{t[T]=void 0;var n=!0}catch(i){}var o=S.call(t);return n&&(e?t[T]=r:delete t[T]),o}var A=k,D=Object.prototype,x=D.toString;function C(t){return x.call(t)}var I=C,F="[object Null]",E="[object Undefined]",B=j?j.toStringTag:void 0;function V(t){return null==t?void 0===t?E:F:B&&B in Object(t)?A(t):I(t)}var M=V;function z(t){return null!=t&&"object"==typeof t}var N=z,R="[object Symbol]";function U(t){return"symbol"==typeof t||N(t)&&M(t)==R}var L=U,q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$=/^\w*$/;function H(t,e){if(v(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!L(t))||($.test(t)||!q.test(t)||null!=e&&t in Object(e))}var G=H;function W(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var K=W,J="[object AsyncFunction]",X="[object Function]",Y="[object GeneratorFunction]",Q="[object Proxy]";function Z(t){if(!K(t))return!1;var e=M(t);return e==X||e==Y||e==J||e==Q}var tt=Z,et=m["__core-js_shared__"],rt=et,nt=function(){var t=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ot(t){return!!nt&&nt in t}var it=ot,st=Function.prototype,at=st.toString;function ct(t){if(null!=t){try{return at.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var ut=ct,lt=/[\\^$.*+?()[\]{}|]/g,ht=/^\[object .+?Constructor\]$/,ft=Function.prototype,dt=Object.prototype,pt=ft.toString,vt=dt.hasOwnProperty,gt=RegExp("^"+pt.call(vt).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yt(t){if(!K(t)||it(t))return!1;var e=tt(t)?gt:ht;return e.test(ut(t))}var _t=yt;function bt(t,e){return null==t?void 0:t[e]}var mt=bt;function wt(t,e){var r=mt(t,e);return _t(r)?r:void 0}var jt=wt,Pt=jt(Object,"create"),Ot=Pt;function St(){this.__data__=Ot?Ot(null):{},this.size=0}var Tt=St;function kt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var At=kt,Dt="__lodash_hash_undefined__",xt=Object.prototype,Ct=xt.hasOwnProperty;function It(t){var e=this.__data__;if(Ot){var r=e[t];return r===Dt?void 0:r}return Ct.call(e,t)?e[t]:void 0}var Ft=It,Et=Object.prototype,Bt=Et.hasOwnProperty;function Vt(t){var e=this.__data__;return Ot?void 0!==e[t]:Bt.call(e,t)}var Mt=Vt,zt="__lodash_hash_undefined__";function Nt(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ot&&void 0===e?zt:e,this}var Rt=Nt;function Ut(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}Ut.prototype.clear=Tt,Ut.prototype["delete"]=At,Ut.prototype.get=Ft,Ut.prototype.has=Mt,Ut.prototype.set=Rt;var Lt=Ut;function qt(){this.__data__=[],this.size=0}var $t=qt;function Ht(t,e){return t===e||t!==t&&e!==e}var Gt=Ht;function Wt(t,e){var r=t.length;while(r--)if(Gt(t[r][0],e))return r;return-1}var Kt=Wt,Jt=Array.prototype,Xt=Jt.splice;function Yt(t){var e=this.__data__,r=Kt(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Xt.call(e,r,1),--this.size,!0}var Qt=Yt;function Zt(t){var e=this.__data__,r=Kt(e,t);return r<0?void 0:e[r][1]}var te=Zt;function ee(t){return Kt(this.__data__,t)>-1}var re=ee;function ne(t,e){var r=this.__data__,n=Kt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var oe=ne;function ie(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}ie.prototype.clear=$t,ie.prototype["delete"]=Qt,ie.prototype.get=te,ie.prototype.has=re,ie.prototype.set=oe;var se=ie,ae=jt(m,"Map"),ce=ae;function ue(){this.size=0,this.__data__={hash:new Lt,map:new(ce||se),string:new Lt}}var le=ue;function he(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}var fe=he;function de(t,e){var r=t.__data__;return fe(e)?r["string"==typeof e?"string":"hash"]:r.map}var pe=de;function ve(t){var e=pe(this,t)["delete"](t);return this.size-=e?1:0,e}var ge=ve;function ye(t){return pe(this,t).get(t)}var _e=ye;function be(t){return pe(this,t).has(t)}var me=be;function we(t,e){var r=pe(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var je=we;function Pe(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}Pe.prototype.clear=le,Pe.prototype["delete"]=ge,Pe.prototype.get=_e,Pe.prototype.has=me,Pe.prototype.set=je;var Oe=Pe,Se="Expected a function";function Te(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Se);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(Te.Cache||Oe),r}Te.Cache=Oe;var ke=Te,Ae=500;function De(t){var e=ke(t,(function(t){return r.size===Ae&&r.clear(),t})),r=e.cache;return e}var xe=De,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ie=/\\(\\)?/g,Fe=xe((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ce,(function(t,r,n,o){e.push(n?o.replace(Ie,"$1"):r||t)})),e})),Ee=Fe;function Be(t,e){var r=-1,n=null==t?0:t.length,o=Array(n);while(++r<n)o[r]=e(t[r],r,t);return o}var Ve=Be,Me=1/0,ze=j?j.prototype:void 0,Ne=ze?ze.toString:void 0;function Re(t){if("string"==typeof t)return t;if(v(t))return Ve(t,Re)+"";if(L(t))return Ne?Ne.call(t):"";var e=t+"";return"0"==e&&1/t==-Me?"-0":e}var Ue=Re;function Le(t){return null==t?"":Ue(t)}var qe=Le;function $e(t,e){return v(t)?t:G(t,e)?[t]:Ee(qe(t))}var He=$e,Ge=1/0;function We(t){if("string"==typeof t||L(t))return t;var e=t+"";return"0"==e&&1/t==-Ge?"-0":e}var Ke=We;function Je(t,e){e=He(e,t);var r=0,n=e.length;while(null!=t&&r<n)t=t[Ke(e[r++])];return r&&r==n?t:void 0}var Xe=Je;function Ye(t,e,r){var n=null==t?void 0:Xe(t,e);return void 0===n?r:n}var Qe=Ye;function Ze(t,e){return function(r){return t(e(r))}}var tr=Ze,er=tr(Object.getPrototypeOf,Object),rr=er,nr="[object Object]",or=Function.prototype,ir=Object.prototype,sr=or.toString,ar=ir.hasOwnProperty,cr=sr.call(Object);function ur(t){if(!N(t)||M(t)!=nr)return!1;var e=rr(t);if(null===e)return!0;var r=ar.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&sr.call(r)==cr}var lr=ur;function hr(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var fr=hr,dr=new WeakMap,pr=new WeakMap,vr=Symbol("pointerMeta"),gr={get(t,e){if(e===vr)return dr.get(t);let r=pr.get(t);r||(r=new Map,pr.set(t,r));const n=r.get(e);if(void 0!==n)return n;const o=dr.get(t),i=br({root:o.root,path:[...o.path,e]});return r.set(e,i),i}},yr=t=>{const e=t[vr];return e},_r=t=>{const{root:e,path:r}=yr(t);return{root:e,path:r}};function br(t){var e;const r={root:t.root,path:null!=(e=t.path)?e:[]},n={};return dr.set(n,r),new Proxy(n,gr)}var mr=br,wr=t=>t&&!!yr(t);function jr(t,e,r){return 0===e.length?r(t):Pr(t,e,r)}var Pr=(t,e,r)=>{if(0===e.length)return r(t);if(Array.isArray(t)){let[n,...o]=e;n=parseInt(String(n),10),isNaN(n)&&(n=0);const i=t[n],s=Pr(i,o,r);if(i===s)return t;const a=[...t];return a.splice(n,1,s),a}if("object"===typeof t&&null!==t){const[n,...o]=e,i=t[n],s=Pr(i,o,r);if(i===s)return t;const a=h(l({},t),{[n]:s});return a}{const[t,...n]=e;return{[t]:Pr(void 0,n,r)}}},Or=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const t=this._head;if(t)return this._head=t.next,t.data}push(t){const e={next:this._head,data:t};this._head=e}};function Sr(t){return!(!t||!t.isPrism||!0!==t.isPrism)}function Tr(){const t=()=>{},e=new Or,r=t,n=t=>{e.push(t)},o=t=>{const r=e.peek();if(r!==t)throw new Error("Popped collector is not on top of the stack");e.pop()},i=()=>{e.push(r)},s=()=>{e.peek()!==r||e.pop()},a=t=>{const n=e.peek();n&&n(t),e.push(r)},c=t=>{e.pop()};return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:i,stopIgnoringDependencies:s,reportResolutionStart:a,reportResolutionEnd:c,pushCollector:n,popCollector:o}}function kr(){const t="__dataverse_discoveryMechanism_sharedStack",e="undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:{};if(e){const r=e[t];if(r&&"object"===typeof r&&"Dataverse_discoveryMechanism"===r.type)return r;{const r=Tr();return e[t]=r,r}}return Tr()}var{startIgnoringDependencies:Ar,stopIgnoringDependencies:Dr,reportResolutionEnd:xr,reportResolutionStart:Cr,pushCollector:Ir,popCollector:Fr}=kr(),Er=()=>{},Br=class{constructor(t,e){this._fn=t,this._prismInstance=e,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new zr(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=t=>{this._possiblyStaleDeps.add(t),this._markAsStale()};for(const r of this._dependencies)r._addDependent(this._reactToDependencyGoingStale);Ar(),this.getValue(),Dr()}get hasDependents(){return this._dependents.size>0}removeDependent(t){this._dependents.delete(t)}addDependent(t){this._dependents.add(t)}destroy(){for(const t of this._dependencies)t._removeDependent(this._reactToDependencyGoingStale);Nr(this._scope)}getValue(){if(!this._isFresh){const t=this._recalculate();this._lastValue=t,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let t;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let t=!1;Ar();for(const e of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(e)!==e.getValue()){t=!0;break}if(Dr(),this._possiblyStaleDeps.clear(),!t)return this._lastValue}const e=new Set;this._cacheOfDendencyValues.clear();const r=t=>{e.add(t),this._addDependency(t)};Ir(r),Ur.push(this._scope);try{t=this._fn()}catch(n){console.error(n)}finally{const t=Ur.pop();t!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}Fr(r);for(const o of this._dependencies)e.has(o)||this._removeDependency(o);this._dependencies=e,Ar();for(const o of e)this._cacheOfDendencyValues.set(o,o.getValue());return Dr(),t}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const t of this._dependents)t(this._prismInstance)}}_addDependency(t){this._dependencies.has(t)||(this._dependencies.add(t),t._addDependent(this._reactToDependencyGoingStale))}_removeDependency(t){this._dependencies.has(t)&&(this._dependencies.delete(t),t._removeDependent(this._reactToDependencyGoingStale))}},Vr={},Mr=class{constructor(t){this._fn=t,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(t,e,r=!1){const n=()=>{t.onThisOrNextTick(i)};let o=Vr;const i=()=>{const t=this.getValue();t!==o&&(o=t,e(t))};this._addDependent(n),r&&(o=this.getValue(),e(o));const s=()=>{this._removeDependent(n),t.offThisOrNextTick(i),t.offNextTick(i)};return s}onStale(t){const e=()=>{this._removeDependent(r)},r=()=>t();return this._addDependent(r),e}keepHot(){return this.onStale((()=>{}))}_addDependent(t){this._state.hot||this._goHot(),this._state.handle.addDependent(t)}_goHot(){const t=new Br(this._fn,this);this._state={hot:!0,handle:t}}_removeDependent(t){const e=this._state;if(!e.hot)return;const r=e.handle;r.removeDependent(t),r.hasDependents||(this._state={hot:!1,handle:void 0},r.destroy())}getValue(){Cr(this);const t=this._state;let e;return e=t.hot?t.handle.getValue():tn(this._fn),xr(this),e}},zr=class{constructor(t){this._hotHandle=t,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(t,e){let r=this._refs.get(t);if(void 0!==r)return r;{const r={current:e};return this._refs.set(t,r),r}}effect(t,e,r){let n=this.effects.get(t);void 0===n&&(n={cleanup:Er,deps:void 0},this.effects.set(t,n)),$r(n.deps,r)&&(n.cleanup(),Ar(),n.cleanup=Rr(e,Er).value,Dr(),n.deps=r)}memo(t,e,r){let n=this.memos.get(t);return void 0===n&&(n={cachedValue:null,deps:void 0},this.memos.set(t,n)),$r(n.deps,r)&&(Ar(),n.cachedValue=Rr(e,void 0).value,Dr(),n.deps=r),n.cachedValue}state(t,e){const{value:r,setValue:n}=this.memo("state/"+t,(()=>{const t={current:e},r=e=>{t.current=e,this._hotHandle.forceStale()};return{value:t,setValue:r}}),[]);return[r.current,n]}sub(t){return this.subs[t]||(this.subs[t]=new zr(this._hotHandle)),this.subs[t]}cleanupEffects(){for(const t of this.effects.values())Rr(t.cleanup,void 0);this.effects.clear()}source(t,e){const r="$$source/blah";return this.effect(r,(()=>{const e=t((()=>{this._hotHandle.forceStale()}));return e}),[t]),e()}};function Nr(t){for(const e of Object.values(t.subs))Nr(e);t.cleanupEffects()}function Rr(t,e){try{return{value:t(),ok:!0}}catch(r){return setTimeout((function(){throw r})),{value:e,ok:!1}}}var Ur=new Or;function Lr(t,e){const r=Ur.peek();if(!r)throw new Error("prism.ref() is called outside of a prism() call.");return r.ref(t,e)}function qr(t,e,r){const n=Ur.peek();if(!n)throw new Error("prism.effect() is called outside of a prism() call.");return n.effect(t,e,r)}function $r(t,e){if(void 0===t||void 0===e)return!0;const r=t.length;if(r!==e.length)return!0;for(let n=0;n<r;n++)if(t[n]!==e[n])return!0;return!1}function Hr(t,e,r){const n=Ur.peek();if(!n)throw new Error("prism.memo() is called outside of a prism() call.");return n.memo(t,e,r)}function Gr(t,e){const r=Ur.peek();if(!r)throw new Error("prism.state() is called outside of a prism() call.");return r.state(t,e)}function Wr(){const t=Ur.peek();if(!t)throw new Error("The parent function is called outside of a prism() call.")}function Kr(t,e){const r=Ur.peek();if(!r)throw new Error("prism.scope() is called outside of a prism() call.");const n=r.sub(t);Ur.push(n);const o=Rr(e,void 0).value;return Ur.pop(),o}function Jr(t,e,r){return Hr(t,(()=>Qr(e)),r).getValue()}function Xr(){return!!Ur.peek()}function Yr(t,e){const r=Ur.peek();if(!r)throw new Error("prism.source() is called outside of a prism() call.");return r.source(t,e)}var Qr=t=>new Mr(t),Zr=class{effect(t,e,r){console.warn("prism.effect() does not run in cold prisms")}memo(t,e,r){return e()}state(t,e){return[e,()=>{}]}ref(t,e){return{current:e}}sub(t){return new Zr}source(t,e){return e()}};function tn(t){const e=new Zr;let r;Ur.push(e);try{r=t()}catch(n){console.error(n)}finally{const t=Ur.pop();t!==e&&console.warn("The Prism hook stack has slipped. This is a bug.")}return r}Qr.ref=Lr,Qr.effect=qr,Qr.memo=Hr,Qr.ensurePrism=Wr,Qr.state=Gr,Qr.scope=Kr,Qr.sub=Jr,Qr.inPrism=Xr,Qr.source=Yr;var en,rn=Qr;(function(t){t[t["Dict"]=0]="Dict",t[t["Array"]=1]="Array",t[t["Other"]=2]="Other"})(en||(en={}));var nn=t=>Array.isArray(t)?1:lr(t)?0:2,on=(t,e,r=nn(t))=>0===r&&"string"===typeof e||1===r&&sn(e)?t[e]:void 0,sn=t=>{const e="number"===typeof t?t:parseInt(t,10);return!isNaN(e)&&e>=0&&e<1/0&&(0|e)===e},an=class{constructor(t,e){this._parent=t,this._path=e,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(t){this.identityChangeListeners.add(t)}removeIdentityChangeListener(t){this.identityChangeListeners.delete(t),this._checkForGC()}removeChild(t){this.children.delete(t),this._checkForGC()}getChild(t){return this.children.get(t)}getOrCreateChild(t){let e=this.children.get(t);return e||(e=e=new an(this,this._path.concat([t])),this.children.set(t,e)),e}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(fr(this._path))}},cn=class{constructor(t){this.$$isPointerToPrismProvider=!0,this.pointer=mr({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(t,e)=>{const{path:r}=_r(t),n=this._getOrCreateScopeForPath(r);n.identityChangeListeners.add(e);const o=()=>{n.identityChangeListeners.delete(e)};return o},this._currentState=t,this._rootScope=new an(void 0,[])}set(t){const e=this._currentState;this._currentState=t,this._checkUpdates(this._rootScope,e,t)}get(){return this._currentState}getByPointer(t){const e=wr(t)?t:t(this.pointer),r=_r(e).path;return this._getIn(r)}_getIn(t){return 0===t.length?this.get():Qe(this.get(),t)}reduce(t){this.set(t(this.get()))}reduceByPointer(t,e){const r=wr(t)?t:t(this.pointer),n=_r(r).path,o=jr(this.get(),n,e);this.set(o)}setByPointer(t,e){this.reduceByPointer(t,(()=>e))}_checkUpdates(t,e,r){if(e===r)return;for(const i of t.identityChangeListeners)i(r);if(0===t.children.size)return;const n=nn(e),o=nn(r);if(2!==n||n!==o)for(const[i,s]of t.children){const t=on(e,i,n),a=on(r,i,o);this._checkUpdates(s,t,a)}}_getOrCreateScopeForPath(t){let e=this._rootScope;for(const r of t)e=e.getOrCreateChild(r);return e}pointerToPrism(t){const{path:e}=_r(t),r=e=>this._onPointerValueChange(t,e),n=()=>this._getIn(e);return rn((()=>rn.source(r,n)))}},un=new WeakMap;function ln(t){return"object"===typeof t&&null!==t&&!0===t["$$isPointerToPrismProvider"]}var hn=t=>{const e=yr(t);let r=un.get(e);if(!r){const n=e.root;if(!ln(n))throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");r=n.pointerToPrism(t),un.set(e,r)}return r},fn=t=>wr(t)?hn(t).getValue():Sr(t)?t.getValue():t;function*dn(t){let e;if(wr(t))e=hn(t);else{if(!Sr(t))throw new Error("Only pointers and prisms are supported");e=t}let r=0;const n=e.onStale((()=>{r++}));try{while(1){const t=r;r=0,yield{value:e.getValue(),ticks:t}}}finally{n()}}var pn=180,vn=class{constructor(t){this._conf=t,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(t){this._scheduledForThisOrNextTick.add(t),this._dormant&&this._goActive()}onNextTick(t){this._scheduledForNextTick.add(t),this._dormant&&this._goActive()}offThisOrNextTick(t){this._scheduledForThisOrNextTick.delete(t)}offNextTick(t){this._scheduledForNextTick.delete(t)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var t,e;this._dormant&&(this._dormant=!1,null==(e=null==(t=this._conf)?void 0:t.onActive)||e.call(t))}_goDormant(){var t,e;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,null==(e=null==(t=this._conf)?void 0:t.onDormant)||e.call(t))}tick(t=performance.now()){if(this.__ticks++,!this._dormant&&0===this._scheduledForNextTick.size&&0===this._scheduledForThisOrNextTick.size&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=pn))this._goDormant();else{this._ticking=!0,this._timeAtCurrentTick=t;for(const t of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(t);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}}_tick(t){const e=this.time;if(t>10&&console.warn("_tick() recursing for 10 times"),t>100)throw new Error("Maximum recursion limit for _tick()");const r=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const n of r)n(e);if(this._scheduledForThisOrNextTick.size>0)return this._tick(t+1)}};function*gn(t){let e;if(wr(t))e=hn(t);else{if(!Sr(t))throw new Error("Only pointers and prisms are supported");e=t}const r=new vn,n=e.onChange(r,(t=>{}));try{while(1)r.tick(),yield e.getValue()}finally{n()}}var yn=class{constructor(t){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new cn(t),this.pointer=mr({root:this,path:[]})}setPointer(t){this._currentPointerBox.set(t)}pointerToPrism(t){const{path:e}=yr(t);return rn((()=>{const t=this._currentPointerBox.prism.getValue(),r=e.reduce(((t,e)=>t[e]),t);return fn(r)}))}}},46381:function(t,e,r){"use strict";t=r.nmd(t);var n=Object.create,o=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,l=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,d=(t,e,r)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,p=(t,e)=>{for(var r in e||(e={}))h.call(e,r)&&d(t,r,e[r]);if(u)for(var r of u(e))f.call(e,r)&&d(t,r,e[r]);return t},v=(t,e)=>i(t,a(e)),g=(t,e)=>function(){return e||(0,t[c(t)[0]])((e={exports:{}}).exports,e),e.exports},y=(t,e)=>{for(var r in e)o(t,r,{get:e[r],enumerable:!0})},_=(t,e,r,n)=>{if(e&&"object"===typeof e||"function"===typeof e)for(let i of c(e))h.call(t,i)||i===r||o(t,i,{get:()=>e[i],enumerable:!(n=s(e,i))||n.enumerable});return t},b=(t,e,r)=>(r=null!=t?n(l(t)):{},_(!e&&t&&t.__esModule?r:o(r,"default",{value:t,enumerable:!0}),t)),m=t=>_(o({},"__esModule",{value:!0}),t),w=(t,e,r)=>(d(t,"symbol"!==typeof e?e+"":e,r),r),j=g({"../node_modules/timing-function/lib/UnitBezier.js"(t,e){e.exports=function(){function t(t,e,r,n){this.set(t,e,r,n)}return t.prototype.set=function(t,e,r,n){this._cx=3*t,this._bx=3*(r-t)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*e,this._by=3*(n-e)-this._cy,this._ay=1-this._cy-this._by},t.epsilon=1e-6,t.prototype._sampleCurveX=function(t){return((this._ax*t+this._bx)*t+this._cx)*t},t.prototype._sampleCurveY=function(t){return((this._ay*t+this._by)*t+this._cy)*t},t.prototype._sampleCurveDerivativeX=function(t){return(3*this._ax*t+2*this._bx)*t+this._cx},t.prototype._solveCurveX=function(t,e){var r,n,o,i,s,a;o=void 0,i=void 0,s=void 0,a=void 0,r=void 0,n=void 0,s=t,n=0;while(n<8){if(a=this._sampleCurveX(s)-t,Math.abs(a)<e)return s;if(r=this._sampleCurveDerivativeX(s),Math.abs(r)<e)break;s-=a/r,n++}if(o=0,i=1,s=t,s<o)return o;if(s>i)return i;while(o<i){if(a=this._sampleCurveX(s),Math.abs(a-t)<e)return s;t>a?o=s:i=s,s=.5*(i-o)+o}return s},t.prototype.solve=function(t,e){return this._sampleCurveY(this._solveCurveX(t,e))},t.prototype.solveSimple=function(t){return this._sampleCurveY(this._solveCurveX(t,1e-6))},t}()}}),P=g({"../node_modules/levenshtein-edit-distance/index.js"(t,e){var r,n;function o(t,e,o){var i,s,a,c,u,l,h,f;if(t===e)return 0;if(i=t.length,s=e.length,0===i)return s;if(0===s)return i;o&&(t=t.toLowerCase(),e=e.toLowerCase()),h=0;while(h<i)n[h]=t.charCodeAt(h),r[h]=++h;f=0;while(f<s){a=e.charCodeAt(f),c=u=f++,h=-1;while(++h<i)l=a===n[h]?u:u+1,u=r[h],r[h]=c=u>c?l>c?c+1:l:l>u?u+1:l}return c}r=[],n=[],e.exports=o}}),O=g({"../node_modules/propose/propose.js"(t,e){var r=P();function n(){var t,e,n,o,i,s=0,a=arguments[0],c=arguments[1],u=c.length,l=arguments[2];l&&(o=l.threshold,i=l.ignoreCase),void 0===o&&(o=0);for(var h=0;h<u;++h)e=i?r(a,c[h],!0):r(a,c[h]),t=e>a.length?1-e/c[h].length:1-e/a.length,t>s&&(s=t,n=c[h]);return s>=o?n:null}e.exports=n}}),S=g({"../node_modules/fast-deep-equal/index.js"(t,e){e.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,o,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(o=n;0!==o--;)if(!t(e[o],r[o]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(o=n;0!==o--;)if(!Object.prototype.hasOwnProperty.call(r,i[o]))return!1;for(o=n;0!==o--;){var s=i[o];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}}}),T={};y(T,{createRafDriver:()=>Hf,getProject:()=>iv,notify:()=>Rf,onChange:()=>cv,types:()=>id,val:()=>uv}),t.exports=m(T);var k={};y(k,{createRafDriver:()=>Hf,getProject:()=>iv,notify:()=>Rf,onChange:()=>cv,types:()=>id,val:()=>uv});var A=r(24771),D=class{constructor(){w(this,"atom",new A.Atom({projects:{}}))}add(t,e){this.atom.setByPointer((e=>e.projects[t]),e)}get(t){return this.atom.get().projects[t]}has(t){return!!this.get(t)}},x=new D,C=x,I=new WeakMap;function F(t){return I.get(t)}function E(t,e){I.set(t,e)}var B=[],V=Array.isArray,M=V,z="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,N=z,R="object"==typeof self&&self&&self.Object===Object&&self,U=N||R||Function("return this")(),L=U,q=L.Symbol,$=q,H=Object.prototype,G=H.hasOwnProperty,W=H.toString,K=$?$.toStringTag:void 0;function J(t){var e=G.call(t,K),r=t[K];try{t[K]=void 0;var n=!0}catch(i){}var o=W.call(t);return n&&(e?t[K]=r:delete t[K]),o}var X=J,Y=Object.prototype,Q=Y.toString;function Z(t){return Q.call(t)}var tt=Z,et="[object Null]",rt="[object Undefined]",nt=$?$.toStringTag:void 0;function ot(t){return null==t?void 0===t?rt:et:nt&&nt in Object(t)?X(t):tt(t)}var it=ot;function st(t){return null!=t&&"object"==typeof t}var at=st,ct="[object Symbol]";function ut(t){return"symbol"==typeof t||at(t)&&it(t)==ct}var lt=ut,ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ft=/^\w*$/;function dt(t,e){if(M(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!lt(t))||(ft.test(t)||!ht.test(t)||null!=e&&t in Object(e))}var pt=dt;function vt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var gt=vt,yt="[object AsyncFunction]",_t="[object Function]",bt="[object GeneratorFunction]",mt="[object Proxy]";function wt(t){if(!gt(t))return!1;var e=it(t);return e==_t||e==bt||e==yt||e==mt}var jt=wt,Pt=L["__core-js_shared__"],Ot=Pt,St=function(){var t=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Tt(t){return!!St&&St in t}var kt=Tt,At=Function.prototype,Dt=At.toString;function xt(t){if(null!=t){try{return Dt.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Ct=xt,It=/[\\^$.*+?()[\]{}|]/g,Ft=/^\[object .+?Constructor\]$/,Et=Function.prototype,Bt=Object.prototype,Vt=Et.toString,Mt=Bt.hasOwnProperty,zt=RegExp("^"+Vt.call(Mt).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Nt(t){if(!gt(t)||kt(t))return!1;var e=jt(t)?zt:Ft;return e.test(Ct(t))}var Rt=Nt;function Ut(t,e){return null==t?void 0:t[e]}var Lt=Ut;function qt(t,e){var r=Lt(t,e);return Rt(r)?r:void 0}var $t=qt,Ht=$t(Object,"create"),Gt=Ht;function Wt(){this.__data__=Gt?Gt(null):{},this.size=0}var Kt=Wt;function Jt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Xt=Jt,Yt="__lodash_hash_undefined__",Qt=Object.prototype,Zt=Qt.hasOwnProperty;function te(t){var e=this.__data__;if(Gt){var r=e[t];return r===Yt?void 0:r}return Zt.call(e,t)?e[t]:void 0}var ee=te,re=Object.prototype,ne=re.hasOwnProperty;function oe(t){var e=this.__data__;return Gt?void 0!==e[t]:ne.call(e,t)}var ie=oe,se="__lodash_hash_undefined__";function ae(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Gt&&void 0===e?se:e,this}var ce=ae;function ue(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}ue.prototype.clear=Kt,ue.prototype["delete"]=Xt,ue.prototype.get=ee,ue.prototype.has=ie,ue.prototype.set=ce;var le=ue;function he(){this.__data__=[],this.size=0}var fe=he;function de(t,e){return t===e||t!==t&&e!==e}var pe=de;function ve(t,e){var r=t.length;while(r--)if(pe(t[r][0],e))return r;return-1}var ge=ve,ye=Array.prototype,_e=ye.splice;function be(t){var e=this.__data__,r=ge(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():_e.call(e,r,1),--this.size,!0}var me=be;function we(t){var e=this.__data__,r=ge(e,t);return r<0?void 0:e[r][1]}var je=we;function Pe(t){return ge(this.__data__,t)>-1}var Oe=Pe;function Se(t,e){var r=this.__data__,n=ge(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var Te=Se;function ke(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}ke.prototype.clear=fe,ke.prototype["delete"]=me,ke.prototype.get=je,ke.prototype.has=Oe,ke.prototype.set=Te;var Ae=ke,De=$t(L,"Map"),xe=De;function Ce(){this.size=0,this.__data__={hash:new le,map:new(xe||Ae),string:new le}}var Ie=Ce;function Fe(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}var Ee=Fe;function Be(t,e){var r=t.__data__;return Ee(e)?r["string"==typeof e?"string":"hash"]:r.map}var Ve=Be;function Me(t){var e=Ve(this,t)["delete"](t);return this.size-=e?1:0,e}var ze=Me;function Ne(t){return Ve(this,t).get(t)}var Re=Ne;function Ue(t){return Ve(this,t).has(t)}var Le=Ue;function qe(t,e){var r=Ve(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var $e=qe;function He(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}He.prototype.clear=Ie,He.prototype["delete"]=ze,He.prototype.get=Re,He.prototype.has=Le,He.prototype.set=$e;var Ge=He,We="Expected a function";function Ke(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(We);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(Ke.Cache||Ge),r}Ke.Cache=Ge;var Je=Ke,Xe=500;function Ye(t){var e=Je(t,(function(t){return r.size===Xe&&r.clear(),t})),r=e.cache;return e}var Qe=Ye,Ze=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tr=/\\(\\)?/g,er=Qe((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ze,(function(t,r,n,o){e.push(n?o.replace(tr,"$1"):r||t)})),e})),rr=er;function nr(t,e){var r=-1,n=null==t?0:t.length,o=Array(n);while(++r<n)o[r]=e(t[r],r,t);return o}var or=nr,ir=1/0,sr=$?$.prototype:void 0,ar=sr?sr.toString:void 0;function cr(t){if("string"==typeof t)return t;if(M(t))return or(t,cr)+"";if(lt(t))return ar?ar.call(t):"";var e=t+"";return"0"==e&&1/t==-ir?"-0":e}var ur=cr;function lr(t){return null==t?"":ur(t)}var hr=lr;function fr(t,e){return M(t)?t:pt(t,e)?[t]:rr(hr(t))}var dr=fr,pr=1/0;function vr(t){if("string"==typeof t||lt(t))return t;var e=t+"";return"0"==e&&1/t==-pr?"-0":e}var gr=vr;function yr(t,e){e=dr(e,t);var r=0,n=e.length;while(null!=t&&r<n)t=t[gr(e[r++])];return r&&r==n?t:void 0}var _r=yr;function br(t,e,r){var n=null==t?void 0:_r(t,e);return void 0===n?r:n}var mr=br;function wr(t,e){return 0===e.length?t:mr(t,e)}var jr=class{constructor(){w(this,"_values",{})}get(t,e){if(this.has(t))return this._values[t];{const r=e();return this._values[t]=r,r}}has(t){return this._values.hasOwnProperty(t)}},Pr=r(24771),Or=function(){try{var t=$t(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),Sr=Or;function Tr(t,e,r){"__proto__"==e&&Sr?Sr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var kr=Tr,Ar=Object.prototype,Dr=Ar.hasOwnProperty;function xr(t,e,r){var n=t[e];Dr.call(t,e)&&pe(n,r)&&(void 0!==r||e in t)||kr(t,e,r)}var Cr=xr,Ir=9007199254740991,Fr=/^(?:0|[1-9]\d*)$/;function Er(t,e){var r=typeof t;return e=null==e?Ir:e,!!e&&("number"==r||"symbol"!=r&&Fr.test(t))&&t>-1&&t%1==0&&t<e}var Br=Er;function Vr(t,e,r,n){if(!gt(t))return t;e=dr(e,t);var o=-1,i=e.length,s=i-1,a=t;while(null!=a&&++o<i){var c=gr(e[o]),u=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=s){var l=a[c];u=n?n(l,c,a):void 0,void 0===u&&(u=gt(l)?l:Br(e[o+1])?[]:{})}Cr(a,c,u),a=a[c]}return t}var Mr=Vr;function zr(t,e,r){return null==t?t:Mr(t,e,r)}var Nr=zr,Rr=new WeakMap;function Ur(t){return Lr(t)}function Lr(t){if(Rr.has(t))return Rr.get(t);const e="compound"===t.type?$r(t):"enum"===t.type?qr(t):t.default;return Rr.set(t,e),e}function qr(t){const e={$case:t.defaultCase};for(const[r,n]of Object.entries(t.cases))e[r]=Lr(n);return e}function $r(t){const e={};for(const[r,n]of Object.entries(t.props))e[r]=Lr(n);return e}var Hr=r(24771),Gr=b(j());function Wr(t,e,r){return(0,Hr.prism)((()=>{const n=(0,Hr.val)(e),o=Hr.prism.memo("driver",(()=>n?"BasicKeyframedTrack"===n.type?Kr(t,n,r):(t.logger.error("Track type not yet supported."),(0,Hr.prism)((()=>{}))):(0,Hr.prism)((()=>{}))),[n]);return o.getValue()}))}function Kr(t,e,r){return(0,Hr.prism)((()=>{let n=Hr.prism.ref("state",{started:!1}),o=n.current;const i=r.getValue();return(!o.started||i<o.validFrom||o.validTo<=i)&&(n.current=o=Xr(t,r,e)),o.der.getValue()}))}var Jr=(0,Hr.prism)((()=>{}));function Xr(t,e,r){const n=e.getValue();if(0===r.keyframes.length)return{started:!0,validFrom:-1/0,validTo:1/0,der:Jr};let o=0;while(1){const t=r.keyframes[o];if(!t)return Yr.error;const i=o===r.keyframes.length-1;if(n<t.position)return 0===o?Yr.beforeFirstKeyframe(t):Yr.error;if(t.position===n)return i?Yr.lastKeyframe(t):Yr.between(t,r.keyframes[o+1],e);if(o===r.keyframes.length-1)return Yr.lastKeyframe(t);{const i=o+1;if(r.keyframes[i].position<=n){o=i;continue}return Yr.between(t,r.keyframes[o+1],e)}}}var Yr={beforeFirstKeyframe(t){return{started:!0,validFrom:-1/0,validTo:t.position,der:(0,Hr.prism)((()=>({left:t.value,progression:0})))}},lastKeyframe(t){return{started:!0,validFrom:t.position,validTo:1/0,der:(0,Hr.prism)((()=>({left:t.value,progression:0})))}},between(t,e,r){if(!t.connectedRight)return{started:!0,validFrom:t.position,validTo:e.position,der:(0,Hr.prism)((()=>({left:t.value,progression:0})))};const n=r=>(r-t.position)/(e.position-t.position);if(!t.type||"bezier"===t.type){const o=new Gr.default(t.handles[2],t.handles[3],e.handles[0],e.handles[1]),i=(0,Hr.prism)((()=>{const i=n(r.getValue()),s=o.solveSimple(i);return{left:t.value,right:e.value,progression:s}}));return{started:!0,validFrom:t.position,validTo:e.position,der:i}}const o=(0,Hr.prism)((()=>{const o=n(r.getValue()),i=Math.floor(o);return{left:t.value,right:e.value,progression:i}}));return{started:!0,validFrom:t.position,validTo:e.position,der:o}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:Jr}};function Qr(t,e,r){const n=r,o=n.get(t);if(o&&o.override===e)return o.merged;const i=p({},t);for(const s of Object.keys(e)){const n=e[s],o=t[s];i[s]="object"===typeof n&&"object"===typeof o?Qr(o,n,r):void 0===n?o:n}return r.set(t,{override:e,merged:i}),i}function Zr(t,e){let r=t;for(const n of e)r=r[n];return r}var tn=r(24771),en=(t,e)=>{const r=tn.prism.memo(t,(()=>new tn.Atom(e)),[]);return r.set(e),r},rn=r(24771),nn=r(24771),on=/\s/;function sn(t){var e=t.length;while(e--&&on.test(t.charAt(e)));return e}var an=sn,cn=/^\s+/;function un(t){return t?t.slice(0,an(t)+1).replace(cn,""):t}var ln=un,hn=NaN,fn=/^[-+]0x[0-9a-f]+$/i,dn=/^0b[01]+$/i,pn=/^0o[0-7]+$/i,vn=parseInt;function gn(t){if("number"==typeof t)return t;if(lt(t))return hn;if(gt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=gt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=ln(t);var r=dn.test(t);return r||pn.test(t)?vn(t.slice(2),r?2:8):fn.test(t)?hn:+t}var yn=gn,_n=1/0,bn=17976931348623157e292;function mn(t){if(!t)return 0===t?t:0;if(t=yn(t),t===_n||t===-_n){var e=t<0?-1:1;return e*bn}return t===t?t:0}var wn=mn;function jn(t){var e=wn(t),r=e%1;return e===e?r?e-r:e:0}var Pn=jn;function On(t){return t}var Sn=On,Tn=$t(L,"WeakMap"),kn=Tn,An=Object.create,Dn=function(){function t(){}return function(e){if(!gt(e))return{};if(An)return An(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),xn=Dn;function Cn(t,e){var r=-1,n=t.length;e||(e=Array(n));while(++r<n)e[r]=t[r];return e}var In=Cn;function Fn(t,e){var r=-1,n=null==t?0:t.length;while(++r<n)if(!1===e(t[r],r,t))break;return t}var En=Fn;function Bn(t,e,r,n){var o=!r;r||(r={});var i=-1,s=e.length;while(++i<s){var a=e[i],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),o?kr(r,a,c):Cr(r,a,c)}return r}var Vn=Bn,Mn=9007199254740991;function zn(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Mn}var Nn=zn;function Rn(t){return null!=t&&Nn(t.length)&&!jt(t)}var Un=Rn,Ln=Object.prototype;function qn(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||Ln;return t===r}var $n=qn;function Hn(t,e){var r=-1,n=Array(t);while(++r<t)n[r]=e(r);return n}var Gn=Hn,Wn="[object Arguments]";function Kn(t){return at(t)&&it(t)==Wn}var Jn=Kn,Xn=Object.prototype,Yn=Xn.hasOwnProperty,Qn=Xn.propertyIsEnumerable,Zn=Jn(function(){return arguments}())?Jn:function(t){return at(t)&&Yn.call(t,"callee")&&!Qn.call(t,"callee")},to=Zn;function eo(){return!1}var ro=eo,no=e&&!e.nodeType&&e,oo=no&&t&&!t.nodeType&&t,io=oo&&oo.exports===no,so=io?L.Buffer:void 0,ao=so?so.isBuffer:void 0,co=ao||ro,uo=co,lo="[object Arguments]",ho="[object Array]",fo="[object Boolean]",po="[object Date]",vo="[object Error]",go="[object Function]",yo="[object Map]",_o="[object Number]",bo="[object Object]",mo="[object RegExp]",wo="[object Set]",jo="[object String]",Po="[object WeakMap]",Oo="[object ArrayBuffer]",So="[object DataView]",To="[object Float32Array]",ko="[object Float64Array]",Ao="[object Int8Array]",Do="[object Int16Array]",xo="[object Int32Array]",Co="[object Uint8Array]",Io="[object Uint8ClampedArray]",Fo="[object Uint16Array]",Eo="[object Uint32Array]",Bo={};function Vo(t){return at(t)&&Nn(t.length)&&!!Bo[it(t)]}Bo[To]=Bo[ko]=Bo[Ao]=Bo[Do]=Bo[xo]=Bo[Co]=Bo[Io]=Bo[Fo]=Bo[Eo]=!0,Bo[lo]=Bo[ho]=Bo[Oo]=Bo[fo]=Bo[So]=Bo[po]=Bo[vo]=Bo[go]=Bo[yo]=Bo[_o]=Bo[bo]=Bo[mo]=Bo[wo]=Bo[jo]=Bo[Po]=!1;var Mo=Vo;function zo(t){return function(e){return t(e)}}var No=zo,Ro=e&&!e.nodeType&&e,Uo=Ro&&t&&!t.nodeType&&t,Lo=Uo&&Uo.exports===Ro,qo=Lo&&N.process,$o=function(){try{var t=Uo&&Uo.require&&Uo.require("util").types;return t||qo&&qo.binding&&qo.binding("util")}catch(e){}}(),Ho=$o,Go=Ho&&Ho.isTypedArray,Wo=Go?No(Go):Mo,Ko=Wo,Jo=Object.prototype,Xo=Jo.hasOwnProperty;function Yo(t,e){var r=M(t),n=!r&&to(t),o=!r&&!n&&uo(t),i=!r&&!n&&!o&&Ko(t),s=r||n||o||i,a=s?Gn(t.length,String):[],c=a.length;for(var u in t)!e&&!Xo.call(t,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Br(u,c))||a.push(u);return a}var Qo=Yo;function Zo(t,e){return function(r){return t(e(r))}}var ti=Zo,ei=ti(Object.keys,Object),ri=ei,ni=Object.prototype,oi=ni.hasOwnProperty;function ii(t){if(!$n(t))return ri(t);var e=[];for(var r in Object(t))oi.call(t,r)&&"constructor"!=r&&e.push(r);return e}var si=ii;function ai(t){return Un(t)?Qo(t):si(t)}var ci=ai;function ui(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}var li=ui,hi=Object.prototype,fi=hi.hasOwnProperty;function di(t){if(!gt(t))return li(t);var e=$n(t),r=[];for(var n in t)("constructor"!=n||!e&&fi.call(t,n))&&r.push(n);return r}var pi=di;function vi(t){return Un(t)?Qo(t,!0):pi(t)}var gi=vi;function yi(t,e){var r=-1,n=e.length,o=t.length;while(++r<n)t[o+r]=e[r];return t}var _i=yi,bi=ti(Object.getPrototypeOf,Object),mi=bi,wi="[object Object]",ji=Function.prototype,Pi=Object.prototype,Oi=ji.toString,Si=Pi.hasOwnProperty,Ti=Oi.call(Object);function ki(t){if(!at(t)||it(t)!=wi)return!1;var e=mi(t);if(null===e)return!0;var r=Si.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Oi.call(r)==Ti}var Ai=ki;function Di(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),r=r>o?o:r,r<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;var i=Array(o);while(++n<o)i[n]=t[n+e];return i}var xi=Di;function Ci(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:xi(t,e,r)}var Ii=Ci,Fi="\\ud800-\\udfff",Ei="\\u0300-\\u036f",Bi="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",Mi=Ei+Bi+Vi,zi="\\ufe0e\\ufe0f",Ni="\\u200d",Ri=RegExp("["+Ni+Fi+Mi+zi+"]");function Ui(t){return Ri.test(t)}var Li=Ui;function qi(t){return t.split("")}var $i=qi,Hi="\\ud800-\\udfff",Gi="\\u0300-\\u036f",Wi="\\ufe20-\\ufe2f",Ki="\\u20d0-\\u20ff",Ji=Gi+Wi+Ki,Xi="\\ufe0e\\ufe0f",Yi="["+Hi+"]",Qi="["+Ji+"]",Zi="\\ud83c[\\udffb-\\udfff]",ts="(?:"+Qi+"|"+Zi+")",es="[^"+Hi+"]",rs="(?:\\ud83c[\\udde6-\\uddff]){2}",ns="[\\ud800-\\udbff][\\udc00-\\udfff]",os="\\u200d",is=ts+"?",ss="["+Xi+"]?",as="(?:"+os+"(?:"+[es,rs,ns].join("|")+")"+ss+is+")*",cs=ss+is+as,us="(?:"+[es+Qi+"?",Qi,rs,ns,Yi].join("|")+")",ls=RegExp(Zi+"(?="+Zi+")|"+us+cs,"g");function hs(t){return t.match(ls)||[]}var fs=hs;function ds(t){return Li(t)?fs(t):$i(t)}var ps=ds;function vs(t,e,r){return t===t&&(void 0!==r&&(t=t<=r?t:r),void 0!==e&&(t=t>=e?t:e)),t}var gs=vs;function ys(t,e,r){return void 0===r&&(r=e,e=void 0),void 0!==r&&(r=yn(r),r=r===r?r:0),void 0!==e&&(e=yn(e),e=e===e?e:0),gs(yn(t),e,r)}var _s=ys;function bs(){this.__data__=new Ae,this.size=0}var ms=bs;function ws(t){var e=this.__data__,r=e["delete"](t);return this.size=e.size,r}var js=ws;function Ps(t){return this.__data__.get(t)}var Os=Ps;function Ss(t){return this.__data__.has(t)}var Ts=Ss,ks=200;function As(t,e){var r=this.__data__;if(r instanceof Ae){var n=r.__data__;if(!xe||n.length<ks-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ge(n)}return r.set(t,e),this.size=r.size,this}var Ds=As;function xs(t){var e=this.__data__=new Ae(t);this.size=e.size}xs.prototype.clear=ms,xs.prototype["delete"]=js,xs.prototype.get=Os,xs.prototype.has=Ts,xs.prototype.set=Ds;var Cs=xs;function Is(t,e){return t&&Vn(e,ci(e),t)}var Fs=Is;function Es(t,e){return t&&Vn(e,gi(e),t)}var Bs=Es,Vs=e&&!e.nodeType&&e,Ms=Vs&&t&&!t.nodeType&&t,zs=Ms&&Ms.exports===Vs,Ns=zs?L.Buffer:void 0,Rs=Ns?Ns.allocUnsafe:void 0;function Us(t,e){if(e)return t.slice();var r=t.length,n=Rs?Rs(r):new t.constructor(r);return t.copy(n),n}var Ls=Us;function qs(t,e){var r=-1,n=null==t?0:t.length,o=0,i=[];while(++r<n){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i}var $s=qs;function Hs(){return[]}var Gs=Hs,Ws=Object.prototype,Ks=Ws.propertyIsEnumerable,Js=Object.getOwnPropertySymbols,Xs=Js?function(t){return null==t?[]:(t=Object(t),$s(Js(t),(function(e){return Ks.call(t,e)})))}:Gs,Ys=Xs;function Qs(t,e){return Vn(t,Ys(t),e)}var Zs=Qs,ta=Object.getOwnPropertySymbols,ea=ta?function(t){var e=[];while(t)_i(e,Ys(t)),t=mi(t);return e}:Gs,ra=ea;function na(t,e){return Vn(t,ra(t),e)}var oa=na;function ia(t,e,r){var n=e(t);return M(t)?n:_i(n,r(t))}var sa=ia;function aa(t){return sa(t,ci,Ys)}var ca=aa;function ua(t){return sa(t,gi,ra)}var la=ua,ha=$t(L,"DataView"),fa=ha,da=$t(L,"Promise"),pa=da,va=$t(L,"Set"),ga=va,ya="[object Map]",_a="[object Object]",ba="[object Promise]",ma="[object Set]",wa="[object WeakMap]",ja="[object DataView]",Pa=Ct(fa),Oa=Ct(xe),Sa=Ct(pa),Ta=Ct(ga),ka=Ct(kn),Aa=it;(fa&&Aa(new fa(new ArrayBuffer(1)))!=ja||xe&&Aa(new xe)!=ya||pa&&Aa(pa.resolve())!=ba||ga&&Aa(new ga)!=ma||kn&&Aa(new kn)!=wa)&&(Aa=function(t){var e=it(t),r=e==_a?t.constructor:void 0,n=r?Ct(r):"";if(n)switch(n){case Pa:return ja;case Oa:return ya;case Sa:return ba;case Ta:return ma;case ka:return wa}return e});var Da=Aa,xa=Object.prototype,Ca=xa.hasOwnProperty;function Ia(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Ca.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var Fa=Ia,Ea=L.Uint8Array,Ba=Ea;function Va(t){var e=new t.constructor(t.byteLength);return new Ba(e).set(new Ba(t)),e}var Ma=Va;function za(t,e){var r=e?Ma(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Na=za,Ra=/\w*$/;function Ua(t){var e=new t.constructor(t.source,Ra.exec(t));return e.lastIndex=t.lastIndex,e}var La=Ua,qa=$?$.prototype:void 0,$a=qa?qa.valueOf:void 0;function Ha(t){return $a?Object($a.call(t)):{}}var Ga=Ha;function Wa(t,e){var r=e?Ma(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Ka=Wa,Ja="[object Boolean]",Xa="[object Date]",Ya="[object Map]",Qa="[object Number]",Za="[object RegExp]",tc="[object Set]",ec="[object String]",rc="[object Symbol]",nc="[object ArrayBuffer]",oc="[object DataView]",ic="[object Float32Array]",sc="[object Float64Array]",ac="[object Int8Array]",cc="[object Int16Array]",uc="[object Int32Array]",lc="[object Uint8Array]",hc="[object Uint8ClampedArray]",fc="[object Uint16Array]",dc="[object Uint32Array]";function pc(t,e,r){var n=t.constructor;switch(e){case nc:return Ma(t);case Ja:case Xa:return new n(+t);case oc:return Na(t,r);case ic:case sc:case ac:case cc:case uc:case lc:case hc:case fc:case dc:return Ka(t,r);case Ya:return new n;case Qa:case ec:return new n(t);case Za:return La(t);case tc:return new n;case rc:return Ga(t)}}var vc=pc;function gc(t){return"function"!=typeof t.constructor||$n(t)?{}:xn(mi(t))}var yc=gc,_c="[object Map]";function bc(t){return at(t)&&Da(t)==_c}var mc=bc,wc=Ho&&Ho.isMap,jc=wc?No(wc):mc,Pc=jc,Oc="[object Set]";function Sc(t){return at(t)&&Da(t)==Oc}var Tc=Sc,kc=Ho&&Ho.isSet,Ac=kc?No(kc):Tc,Dc=Ac,xc=1,Cc=2,Ic=4,Fc="[object Arguments]",Ec="[object Array]",Bc="[object Boolean]",Vc="[object Date]",Mc="[object Error]",zc="[object Function]",Nc="[object GeneratorFunction]",Rc="[object Map]",Uc="[object Number]",Lc="[object Object]",qc="[object RegExp]",$c="[object Set]",Hc="[object String]",Gc="[object Symbol]",Wc="[object WeakMap]",Kc="[object ArrayBuffer]",Jc="[object DataView]",Xc="[object Float32Array]",Yc="[object Float64Array]",Qc="[object Int8Array]",Zc="[object Int16Array]",tu="[object Int32Array]",eu="[object Uint8Array]",ru="[object Uint8ClampedArray]",nu="[object Uint16Array]",ou="[object Uint32Array]",iu={};function su(t,e,r,n,o,i){var s,a=e&xc,c=e&Cc,u=e&Ic;if(r&&(s=o?r(t,n,o,i):r(t)),void 0!==s)return s;if(!gt(t))return t;var l=M(t);if(l){if(s=Fa(t),!a)return In(t,s)}else{var h=Da(t),f=h==zc||h==Nc;if(uo(t))return Ls(t,a);if(h==Lc||h==Fc||f&&!o){if(s=c||f?{}:yc(t),!a)return c?oa(t,Bs(s,t)):Zs(t,Fs(s,t))}else{if(!iu[h])return o?t:{};s=vc(t,h,a)}}i||(i=new Cs);var d=i.get(t);if(d)return d;i.set(t,s),Dc(t)?t.forEach((function(n){s.add(su(n,e,r,n,t,i))})):Pc(t)&&t.forEach((function(n,o){s.set(o,su(n,e,r,o,t,i))}));var p=u?c?la:ca:c?gi:ci,v=l?void 0:p(t);return En(v||t,(function(n,o){v&&(o=n,n=t[o]),Cr(s,o,su(n,e,r,o,t,i))})),s}iu[Fc]=iu[Ec]=iu[Kc]=iu[Jc]=iu[Bc]=iu[Vc]=iu[Xc]=iu[Yc]=iu[Qc]=iu[Zc]=iu[tu]=iu[Rc]=iu[Uc]=iu[Lc]=iu[qc]=iu[$c]=iu[Hc]=iu[Gc]=iu[eu]=iu[ru]=iu[nu]=iu[ou]=!0,iu[Mc]=iu[zc]=iu[Wc]=!1;var au=su,cu=1,uu=4;function lu(t){return au(t,cu|uu)}var hu=lu,fu="__lodash_hash_undefined__";function du(t){return this.__data__.set(t,fu),this}var pu=du;function vu(t){return this.__data__.has(t)}var gu=vu;function yu(t){var e=-1,r=null==t?0:t.length;this.__data__=new Ge;while(++e<r)this.add(t[e])}yu.prototype.add=yu.prototype.push=pu,yu.prototype.has=gu;var _u=yu;function bu(t,e){var r=-1,n=null==t?0:t.length;while(++r<n)if(e(t[r],r,t))return!0;return!1}var mu=bu;function wu(t,e){return t.has(e)}var ju=wu,Pu=1,Ou=2;function Su(t,e,r,n,o,i){var s=r&Pu,a=t.length,c=e.length;if(a!=c&&!(s&&c>a))return!1;var u=i.get(t),l=i.get(e);if(u&&l)return u==e&&l==t;var h=-1,f=!0,d=r&Ou?new _u:void 0;i.set(t,e),i.set(e,t);while(++h<a){var p=t[h],v=e[h];if(n)var g=s?n(v,p,h,e,t,i):n(p,v,h,t,e,i);if(void 0!==g){if(g)continue;f=!1;break}if(d){if(!mu(e,(function(t,e){if(!ju(d,e)&&(p===t||o(p,t,r,n,i)))return d.push(e)}))){f=!1;break}}else if(p!==v&&!o(p,v,r,n,i)){f=!1;break}}return i["delete"](t),i["delete"](e),f}var Tu=Su;function ku(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}var Au=ku;function Du(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var xu=Du,Cu=1,Iu=2,Fu="[object Boolean]",Eu="[object Date]",Bu="[object Error]",Vu="[object Map]",Mu="[object Number]",zu="[object RegExp]",Nu="[object Set]",Ru="[object String]",Uu="[object Symbol]",Lu="[object ArrayBuffer]",qu="[object DataView]",$u=$?$.prototype:void 0,Hu=$u?$u.valueOf:void 0;function Gu(t,e,r,n,o,i,s){switch(r){case qu:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Lu:return!(t.byteLength!=e.byteLength||!i(new Ba(t),new Ba(e)));case Fu:case Eu:case Mu:return pe(+t,+e);case Bu:return t.name==e.name&&t.message==e.message;case zu:case Ru:return t==e+"";case Vu:var a=Au;case Nu:var c=n&Cu;if(a||(a=xu),t.size!=e.size&&!c)return!1;var u=s.get(t);if(u)return u==e;n|=Iu,s.set(t,e);var l=Tu(a(t),a(e),n,o,i,s);return s["delete"](t),l;case Uu:if(Hu)return Hu.call(t)==Hu.call(e)}return!1}var Wu=Gu,Ku=1,Ju=Object.prototype,Xu=Ju.hasOwnProperty;function Yu(t,e,r,n,o,i){var s=r&Ku,a=ca(t),c=a.length,u=ca(e),l=u.length;if(c!=l&&!s)return!1;var h=c;while(h--){var f=a[h];if(!(s?f in e:Xu.call(e,f)))return!1}var d=i.get(t),p=i.get(e);if(d&&p)return d==e&&p==t;var v=!0;i.set(t,e),i.set(e,t);var g=s;while(++h<c){f=a[h];var y=t[f],_=e[f];if(n)var b=s?n(_,y,f,e,t,i):n(y,_,f,t,e,i);if(!(void 0===b?y===_||o(y,_,r,n,i):b)){v=!1;break}g||(g="constructor"==f)}if(v&&!g){var m=t.constructor,w=e.constructor;m==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof w&&w instanceof w||(v=!1)}return i["delete"](t),i["delete"](e),v}var Qu=Yu,Zu=1,tl="[object Arguments]",el="[object Array]",rl="[object Object]",nl=Object.prototype,ol=nl.hasOwnProperty;function il(t,e,r,n,o,i){var s=M(t),a=M(e),c=s?el:Da(t),u=a?el:Da(e);c=c==tl?rl:c,u=u==tl?rl:u;var l=c==rl,h=u==rl,f=c==u;if(f&&uo(t)){if(!uo(e))return!1;s=!0,l=!1}if(f&&!l)return i||(i=new Cs),s||Ko(t)?Tu(t,e,r,n,o,i):Wu(t,e,c,r,n,o,i);if(!(r&Zu)){var d=l&&ol.call(t,"__wrapped__"),p=h&&ol.call(e,"__wrapped__");if(d||p){var v=d?t.value():t,g=p?e.value():e;return i||(i=new Cs),o(v,g,r,n,i)}}return!!f&&(i||(i=new Cs),Qu(t,e,r,n,o,i))}var sl=il;function al(t,e,r,n,o){return t===e||(null==t||null==e||!at(t)&&!at(e)?t!==t&&e!==e:sl(t,e,r,n,al,o))}var cl=al,ul=1,ll=2;function hl(t,e,r,n){var o=r.length,i=o,s=!n;if(null==t)return!i;t=Object(t);while(o--){var a=r[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}while(++o<i){a=r[o];var c=a[0],u=t[c],l=a[1];if(s&&a[2]){if(void 0===u&&!(c in t))return!1}else{var h=new Cs;if(n)var f=n(u,l,c,t,e,h);if(!(void 0===f?cl(l,u,ul|ll,n,h):f))return!1}}return!0}var fl=hl;function dl(t){return t===t&&!gt(t)}var pl=dl;function vl(t){var e=ci(t),r=e.length;while(r--){var n=e[r],o=t[n];e[r]=[n,o,pl(o)]}return e}var gl=vl;function yl(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}var _l=yl;function bl(t){var e=gl(t);return 1==e.length&&e[0][2]?_l(e[0][0],e[0][1]):function(r){return r===t||fl(r,t,e)}}var ml=bl;function wl(t,e){return null!=t&&e in Object(t)}var jl=wl;function Pl(t,e,r){e=dr(e,t);var n=-1,o=e.length,i=!1;while(++n<o){var s=gr(e[n]);if(!(i=null!=t&&r(t,s)))break;t=t[s]}return i||++n!=o?i:(o=null==t?0:t.length,!!o&&Nn(o)&&Br(s,o)&&(M(t)||to(t)))}var Ol=Pl;function Sl(t,e){return null!=t&&Ol(t,e,jl)}var Tl=Sl,kl=1,Al=2;function Dl(t,e){return pt(t)&&pl(e)?_l(gr(t),e):function(r){var n=mr(r,t);return void 0===n&&n===e?Tl(r,t):cl(e,n,kl|Al)}}var xl=Dl;function Cl(t){return function(e){return null==e?void 0:e[t]}}var Il=Cl;function Fl(t){return function(e){return _r(e,t)}}var El=Fl;function Bl(t){return pt(t)?Il(gr(t)):El(t)}var Vl=Bl;function Ml(t){return"function"==typeof t?t:null==t?Sn:"object"==typeof t?M(t)?xl(t[0],t[1]):ml(t):Vl(t)}var zl=Ml;function Nl(t){return function(e,r,n){var o=-1,i=Object(e),s=n(e),a=s.length;while(a--){var c=s[t?a:++o];if(!1===r(i[c],c,i))break}return e}}var Rl=Nl,Ul=Rl(),Ll=Ul;function ql(t,e){return t&&Ll(t,e,ci)}var $l=ql,Hl=function(){return L.Date.now()},Gl=Hl,Wl="Expected a function",Kl=Math.max,Jl=Math.min;function Xl(t,e,r){var n,o,i,s,a,c,u=0,l=!1,h=!1,f=!0;if("function"!=typeof t)throw new TypeError(Wl);function d(e){var r=n,i=o;return n=o=void 0,u=e,s=t.apply(i,r),s}function p(t){return u=t,a=setTimeout(y,e),l?d(t):s}function v(t){var r=t-c,n=t-u,o=e-r;return h?Jl(o,i-n):o}function g(t){var r=t-c,n=t-u;return void 0===c||r>=e||r<0||h&&n>=i}function y(){var t=Gl();if(g(t))return _(t);a=setTimeout(y,v(t))}function _(t){return a=void 0,f&&n?d(t):(n=o=void 0,s)}function b(){void 0!==a&&clearTimeout(a),u=0,n=c=o=a=void 0}function m(){return void 0===a?s:_(Gl())}function w(){var t=Gl(),r=g(t);if(n=arguments,o=this,c=t,r){if(void 0===a)return p(c);if(h)return clearTimeout(a),a=setTimeout(y,e),d(c)}return void 0===a&&(a=setTimeout(y,e)),s}return e=yn(e)||0,gt(r)&&(l=!!r.leading,h="maxWait"in r,i=h?Kl(yn(r.maxWait)||0,e):i,f="trailing"in r?!!r.trailing:f),w.cancel=b,w.flush=m,w}var Yl=Xl;function Ql(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Zl=Ql;function th(t,e){return e.length<2?t:_r(t,xi(e,0,-1))}var eh=th;function rh(t){return"number"==typeof t&&t==Pn(t)}var nh=rh;function oh(t,e){var r={};return e=zl(e,3),$l(t,(function(t,n,o){kr(r,n,e(t,n,o))})),r}var ih=oh;function sh(t,e){return e=dr(e,t),t=eh(t,e),null==t||delete t[gr(Zl(e))]}var ah=sh,ch=9007199254740991,uh=Math.floor;function lh(t,e){var r="";if(!t||e<1||e>ch)return r;do{e%2&&(r+=t),e=uh(e/2),e&&(t+=t)}while(e);return r}var hh=lh,fh=Il("length"),dh=fh,ph="\\ud800-\\udfff",vh="\\u0300-\\u036f",gh="\\ufe20-\\ufe2f",yh="\\u20d0-\\u20ff",_h=vh+gh+yh,bh="\\ufe0e\\ufe0f",mh="["+ph+"]",wh="["+_h+"]",jh="\\ud83c[\\udffb-\\udfff]",Ph="(?:"+wh+"|"+jh+")",Oh="[^"+ph+"]",Sh="(?:\\ud83c[\\udde6-\\uddff]){2}",Th="[\\ud800-\\udbff][\\udc00-\\udfff]",kh="\\u200d",Ah=Ph+"?",Dh="["+bh+"]?",xh="(?:"+kh+"(?:"+[Oh,Sh,Th].join("|")+")"+Dh+Ah+")*",Ch=Dh+Ah+xh,Ih="(?:"+[Oh+wh+"?",wh,Sh,Th,mh].join("|")+")",Fh=RegExp(jh+"(?="+jh+")|"+Ih+Ch,"g");function Eh(t){var e=Fh.lastIndex=0;while(Fh.test(t))++e;return e}var Bh=Eh;function Vh(t){return Li(t)?Bh(t):dh(t)}var Mh=Vh,zh=Math.ceil;function Nh(t,e){e=void 0===e?" ":ur(e);var r=e.length;if(r<2)return r?hh(e,t):e;var n=hh(e,zh(t/Mh(e)));return Li(e)?Ii(ps(n),0,t).join(""):n.slice(0,t)}var Rh=Nh;function Uh(t,e,r){t=hr(t),e=Pn(e);var n=e?Mh(t):0;return e&&n<e?Rh(e-n,r)+t:t}var Lh=Uh;function qh(t,e){return null==t||ah(t,e)}var $h=qh,Hh=5e3,Gh=class{constructor(t){w(this,"_cache",new jr),w(this,"_keepHotUntapDebounce"),E(this,t)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return F(this).propsP}get sheet(){return F(this).sheet.publicApi}get project(){return F(this).sheet.project.publicApi}get address(){return p({},F(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",(()=>{const t=F(this),e=(0,nn.prism)((()=>(0,nn.val)(t.getValues().getValue())));return e}))}onValuesChange(t,e){return cv(this._valuesPrism(),t,e)}get value(){const t=this._valuesPrism();if(null!=Hh){if(!t.isHot){null!=this._keepHotUntapDebounce&&this._keepHotUntapDebounce.flush();const e=t.keepHot();this._keepHotUntapDebounce=Yl((()=>{e(),this._keepHotUntapDebounce=void 0}),Hh)}this._keepHotUntapDebounce&&this._keepHotUntapDebounce()}return t.getValue()}set initialValue(t){F(this).setInitialValue(t)}};function Wh(t){const e=new WeakMap;return r=>(e.has(r)||e.set(r,t(r)),e.get(r))}function Kh(t){return"compound"===t.type||"enum"===t.type}function Jh(t,e){if(!t)return;const[r,...n]=e;if(void 0===r)return t;if(!Kh(t))return;const o="enum"===t.type?t.cases[r]:t.props[r];return Jh(o,n)}function Xh(t){return!Kh(t)}var Yh=Wh((t=>{if("enum"===t.type)throw new Error("Not implemented yet for enums");for(const e in t.props){const r=t.props[e];if(!Kh(r))return!0;if(Yh(r))return!0}return!1})),Qh=class{constructor(t,e,r){this.sheet=t,this.template=e,this.nativeObject=r,w(this,"$$isPointerToPrismProvider",!0),w(this,"address"),w(this,"publicApi"),w(this,"_initialValue",new rn.Atom({})),w(this,"_cache",new jr),w(this,"_logger"),w(this,"_internalUtilCtx"),this._logger=t._logger.named("SheetObject",e.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=v(p({},e.address),{sheetInstanceId:t.address.sheetInstanceId}),this.publicApi=new Gh(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",(()=>(0,rn.prism)((()=>{const t=(0,rn.val)(this.template.getDefaultValues()),e=(0,rn.val)(this._initialValue.pointer),r=rn.prism.memo("withInitialCache",(()=>new WeakMap),[]),n=Qr(t,e,r),o=(0,rn.val)(this.template.getStaticValues()),i=rn.prism.memo("withStatics",(()=>new WeakMap),[]),s=Qr(n,o,i);let a,c=s;{const t=rn.prism.memo("seq",(()=>this.getSequencedValues()),[]),e=rn.prism.memo("withSeqsCache",(()=>new WeakMap),[]);a=(0,rn.val)((0,rn.val)(t));const r=Qr(c,a,e);c=r}const u=en("finalAtom",c);return u.pointer}))))}getValueByPointer(t){const e=(0,rn.val)(this.getValues()),{path:r}=(0,rn.getPointerParts)(t);return(0,rn.val)(Zr(e,r))}pointerToPrism(t){const{path:e}=(0,rn.getPointerParts)(t);return(0,rn.prism)((()=>{const t=(0,rn.val)(this.getValues());return(0,rn.val)(Zr(t,e))}))}getSequencedValues(){return(0,rn.prism)((()=>{const t=rn.prism.memo("tracksToProcess",(()=>this.template.getArrayOfValidSequenceTracks()),[]),e=(0,rn.val)(t),r=new rn.Atom({}),n=(0,rn.val)(this.template.configPointer);return rn.prism.effect("processTracks",(()=>{const t=[];for(const{trackId:o,pathToProp:i}of e){const e=this._trackIdToPrism(o),s=Jh(n,i),a=s.deserializeAndSanitize,c=s.interpolate,u=()=>{const t=e.getValue();if(!t)return r.setByPointer((t=>Zr(t,i)),void 0);const n=a(t.left),o=void 0===n?s.default:n;if(void 0===t.right)return r.setByPointer((t=>Zr(t,i)),o);const u=a(t.right),l=void 0===u?s.default:u;return r.setByPointer((t=>Zr(t,i)),c(o,l,t.progression))},l=e.onStale(u);u(),t.push(l)}return()=>{for(const e of t)e()}}),[n,...e]),r.pointer}))}_trackIdToPrism(t){const e=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[t],r=this.sheet.getSequence().positionPrism;return Wr(this._internalUtilCtx,e,r)}get propsP(){return this._cache.get("propsP",(()=>(0,rn.pointer)({root:this,path:[]})))}validateValue(t,e){}setInitialValue(t){this.validateValue(this.propsP,t),this._initialValue.set(t)}};function Zh(t){return function(e,r){return t(e,r())}}var tf={_hmm:ef(524),_todo:ef(522),_error:ef(521),errorDev:ef(529),errorPublic:ef(545),_kapow:ef(268),_warn:ef(265),warnDev:ef(273),warnPublic:ef(289),_debug:ef(137),debugDev:ef(145),_trace:ef(73),traceDev:ef(81)};function ef(t){return Object.freeze({audience:rf(t,8)?"internal":rf(t,16)?"dev":"public",category:rf(t,4)?"troubleshooting":rf(t,2)?"todo":"general",level:rf(t,512)?512:rf(t,256)?256:rf(t,128)?128:64})}function rf(t,e){return(t&e)===e}function nf(t,e){return(32===(32&e)||(16===(16&e)?t.dev:8===(8&e)&&t.internal))&&t.min<=e}var of={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(t,e,r){return this.create({names:[...t.names,{name:e,key:r}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(t){if(t.length<5)return t;const e=t.replace(this.collapseOnRE,"");return this.cssMemo.has(e)||this.cssMemo.set(e,this.css(t)),e},css(t){var e,r,n,o;const i=this.cssMemo.get(t);if(i)return i;let s="color:".concat(null!=(r=null==(e=this.color)?void 0:e.call(this,t))?r:"hsl(".concat((t.charCodeAt(0)+t.charCodeAt(t.length-1))%360,", 100%, 60%)"));return(null==(n=this.bold)?void 0:n.test(t))&&(s+=";font-weight:600"),(null==(o=this.italic)?void 0:o.test(t))&&(s+=";font-style:italic"),this.cssMemo.set(t,s),s}}};function sf(t=console,e={}){const r=v(p({},of),{includes:p({},of.includes)}),n={styled:uf.bind(r,t),noStyle:hf.bind(r,t)},o=cf.bind(r);function i(){return r.loggingConsoleStyle&&r.loggerConsoleStyle?n.styled:n.noStyle}return r.create=i(),{configureLogger(t){var e;"console"===t?(r.loggerConsoleStyle=of.loggerConsoleStyle,r.create=i()):"console"===t.type?(r.loggerConsoleStyle=null!=(e=t.style)?e:of.loggerConsoleStyle,r.create=i()):"keyed"===t.type?(r.creatExt=e=>t.keyed(e.names),r.create=o):"named"===t.type&&(r.creatExt=af.bind(null,t.named),r.create=o)},configureLogging(t){var e,n,o,s,a;r.includes.dev=null!=(e=t.dev)?e:of.includes.dev,r.includes.internal=null!=(n=t.internal)?n:of.includes.internal,r.includes.min=null!=(o=t.min)?o:of.includes.min,r.include=null!=(s=t.include)?s:of.include,r.loggingConsoleStyle=null!=(a=t.consoleStyle)?a:of.loggingConsoleStyle,r.create=i()},getLogger(){return r.create({names:[]})}}}function af(t,e){const r=[];for(let{name:n,key:o}of e.names)r.push(null==o?n:"".concat(n," (").concat(o,")"));return t(r)}function cf(t){const e=p(p({},this.includes),this.include(t)),r=this.filtered,n=this.named.bind(this,t),o=this.creatExt(t),i=nf(e,524),s=nf(e,522),a=nf(e,521),c=nf(e,529),u=nf(e,545),l=nf(e,265),h=nf(e,268),f=nf(e,273),d=nf(e,289),v=nf(e,137),g=nf(e,145),y=nf(e,73),_=nf(e,81),b=i?o.error.bind(o,tf._hmm):r.bind(t,524),m=s?o.error.bind(o,tf._todo):r.bind(t,522),w=a?o.error.bind(o,tf._error):r.bind(t,521),j=c?o.error.bind(o,tf.errorDev):r.bind(t,529),P=u?o.error.bind(o,tf.errorPublic):r.bind(t,545),O=h?o.warn.bind(o,tf._kapow):r.bind(t,268),S=l?o.warn.bind(o,tf._warn):r.bind(t,265),T=f?o.warn.bind(o,tf.warnDev):r.bind(t,273),k=d?o.warn.bind(o,tf.warnPublic):r.bind(t,273),A=v?o.debug.bind(o,tf._debug):r.bind(t,137),D=g?o.debug.bind(o,tf.debugDev):r.bind(t,145),x=y?o.trace.bind(o,tf._trace):r.bind(t,73),C=_?o.trace.bind(o,tf.traceDev):r.bind(t,81),I={_hmm:b,_todo:m,_error:w,errorDev:j,errorPublic:P,_kapow:O,_warn:S,warnDev:T,warnPublic:k,_debug:A,debugDev:D,_trace:x,traceDev:C,lazy:{_hmm:i?Zh(b):b,_todo:s?Zh(m):m,_error:a?Zh(w):w,errorDev:c?Zh(j):j,errorPublic:u?Zh(P):P,_kapow:h?Zh(O):O,_warn:l?Zh(S):S,warnDev:f?Zh(T):T,warnPublic:d?Zh(k):k,_debug:v?Zh(A):A,debugDev:g?Zh(D):D,_trace:y?Zh(x):x,traceDev:_?Zh(C):C},named:n,utilFor:{internal(){return{debug:I._debug,error:I._error,warn:I._warn,trace:I._trace,named(t,e){return I.named(t,e).utilFor.internal()}}},dev(){return{debug:I.debugDev,error:I.errorDev,warn:I.warnDev,trace:I.traceDev,named(t,e){return I.named(t,e).utilFor.dev()}}},public(){return{error:I.errorPublic,warn:I.warnPublic,debug(t,e){I._warn('(public "debug" filtered out) '.concat(t),e)},trace(t,e){I._warn('(public "trace" filtered out) '.concat(t),e)},named(t,e){return I.named(t,e).utilFor.public()}}}}};return I}function uf(t,e){const r=p(p({},this.includes),this.include(e)),n=[];let o="";for(let c=0;c<e.names.length;c++){const{name:t,key:r}=e.names[c];if(o+=" %c".concat(t),n.push(this.style.css(t)),null!=r){const t="%c#".concat(r);o+=t,n.push(this.style.css(t))}}const i=this.filtered,s=this.named.bind(this,e),a=[o,...n];return ff(i,e,r,t,a,lf(a),s)}function lf(t){const e=t.slice(0);for(let r=1;r<e.length;r++)e[r]+=";background-color:#e0005a;padding:2px;color:white";return e}function hf(t,e){const r=p(p({},this.includes),this.include(e));let n="";for(let a=0;a<e.names.length;a++){const{name:t,key:r}=e.names[a];n+=" ".concat(t),null!=r&&(n+="#".concat(r))}const o=this.filtered,i=this.named.bind(this,e),s=[n];return ff(o,e,r,t,s,s,i)}function ff(t,e,r,n,o,i,s){const a=nf(r,524),c=nf(r,522),u=nf(r,521),l=nf(r,529),h=nf(r,545),f=nf(r,265),d=nf(r,268),p=nf(r,273),v=nf(r,289),g=nf(r,137),y=nf(r,145),_=nf(r,73),b=nf(r,81),m=a?n.error.bind(n,...o):t.bind(e,524),w=c?n.error.bind(n,...o):t.bind(e,522),j=u?n.error.bind(n,...o):t.bind(e,521),P=l?n.error.bind(n,...o):t.bind(e,529),O=h?n.error.bind(n,...o):t.bind(e,545),S=d?n.warn.bind(n,...i):t.bind(e,268),T=f?n.warn.bind(n,...o):t.bind(e,265),k=p?n.warn.bind(n,...o):t.bind(e,273),A=v?n.warn.bind(n,...o):t.bind(e,273),D=g?n.info.bind(n,...o):t.bind(e,137),x=y?n.info.bind(n,...o):t.bind(e,145),C=_?n.debug.bind(n,...o):t.bind(e,73),I=b?n.debug.bind(n,...o):t.bind(e,81),F={_hmm:m,_todo:w,_error:j,errorDev:P,errorPublic:O,_kapow:S,_warn:T,warnDev:k,warnPublic:A,_debug:D,debugDev:x,_trace:C,traceDev:I,lazy:{_hmm:a?Zh(m):m,_todo:c?Zh(w):w,_error:u?Zh(j):j,errorDev:l?Zh(P):P,errorPublic:h?Zh(O):O,_kapow:d?Zh(S):S,_warn:f?Zh(T):T,warnDev:p?Zh(k):k,warnPublic:v?Zh(A):A,_debug:g?Zh(D):D,debugDev:y?Zh(x):x,_trace:_?Zh(C):C,traceDev:b?Zh(I):I},named:s,utilFor:{internal(){return{debug:F._debug,error:F._error,warn:F._warn,trace:F._trace,named(t,e){return F.named(t,e).utilFor.internal()}}},dev(){return{debug:F.debugDev,error:F.errorDev,warn:F.warnDev,trace:F.traceDev,named(t,e){return F.named(t,e).utilFor.dev()}}},public(){return{error:F.errorPublic,warn:F.warnPublic,debug(t,e){F._warn('(public "debug" filtered out) '.concat(t),e)},trace(t,e){F._warn('(public "trace" filtered out) '.concat(t),e)},named(t,e){return F.named(t,e).utilFor.public()}}}}};return F}var df=sf(console,{_debug:function(){},_error:function(){}});df.configureLogging({dev:!0,min:64});var pf=df.getLogger().named("Theatre.js (default logger)").utilFor.dev(),vf=new WeakMap;function gf(t){const e=vf.get(t);if(e)return e;const r=new Map;return vf.set(t,r),yf([],t,r),r}function yf(t,e,r){for(const[n,o]of Object.entries(e.props))if(!Kh(o)){const e=[...t,n];r.set(JSON.stringify(e),r.size),_f(e,o,r)}for(const[n,o]of Object.entries(e.props))if(Kh(o)){const e=[...t,n];r.set(JSON.stringify(e),r.size),_f(e,o,r)}}function _f(t,e,r){if("compound"===e.type)yf(t,e,r);else{if("enum"===e.type)throw new Error("Enums aren't supported yet");r.set(JSON.stringify(t),r.size)}}function bf(t){return"object"===typeof t&&null!==t&&0===Object.keys(t).length}var mf=class{constructor(t,e,r,n,o){this.sheetTemplate=t,w(this,"address"),w(this,"type","Theatre_SheetObjectTemplate"),w(this,"_config"),w(this,"_temp_actions_atom"),w(this,"_cache",new jr),w(this,"project"),w(this,"pointerToSheetState"),w(this,"pointerToStaticOverrides"),this.address=v(p({},t.address),{objectKey:e}),this._config=new Pr.Atom(n),this._temp_actions_atom=new Pr.Atom(o),this.project=t.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(t,e,r){return this._config.set(r),new Qh(t,this,e)}reconfigure(t){this._config.set(t)}_temp_setActions(t){this._temp_actions_atom.set(t)}getDefaultValues(){return this._cache.get("getDefaultValues()",(()=>(0,Pr.prism)((()=>{const t=(0,Pr.val)(this.configPointer);return Ur(t)}))))}getStaticValues(){return this._cache.get("getStaticValues",(()=>(0,Pr.prism)((()=>{var t;const e=null!=(t=(0,Pr.val)(this.pointerToStaticOverrides))?t:{},r=(0,Pr.val)(this.configPointer),n=r.deserializeAndSanitize(e)||{};return n}))))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",(()=>(0,Pr.prism)((()=>{const t=this.project.pointers.historic.sheetsById[this.address.sheetId],e=(0,Pr.val)(t.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!e)return B;const r=[];if(!e)return B;const n=(0,Pr.val)(this.configPointer),o=Object.entries(e);for(const[s,a]of o){const t=wf(s);if(!t)continue;const e=Jh(n,t),o=e&&Xh(e);o&&r.push({pathToProp:t,trackId:a})}const i=gf(n);return r.sort(((t,e)=>{const r=t.pathToProp,n=e.pathToProp,o=i.get(JSON.stringify(r)),s=i.get(JSON.stringify(n));return o>s?1:-1})),0===r.length?B:r}))))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",(()=>(0,Pr.prism)((()=>{const t=(0,Pr.val)(this.getArrayOfValidSequenceTracks());let e={};for(const{pathToProp:r,trackId:n}of t)Nr(e,r,n);return e}))))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",(()=>(0,Pr.prism)((()=>{const t=(0,Pr.val)(this.getStaticValues()),e=(0,Pr.val)(this.getArrayOfValidSequenceTracks()),r=hu(t);for(const{pathToProp:n}of e){$h(r,n);let t=n.slice(0,-1);while(t.length>0){const e=wr(r,t);if(!bf(e))break;$h(r,t),t=t.slice(0,-1)}}return bf(r)?void 0:r}))))}getDefaultsAtPointer(t){const{path:e}=(0,Pr.getPointerParts)(t),r=this.getDefaultValues().getValue(),n=wr(r,e);return n}};function wf(t){try{const e=JSON.parse(t);return e}catch(e){return void pf.warn("property ".concat(JSON.stringify(t)," cannot be parsed. Skipping."))}}var jf=r(24771),Pf=Wh((t=>JSON.stringify(t)));b(O());var Of=class extends Error{},Sf=class extends Of{},Tf=r(24771),kf=r(24771),Af=r(24771),Df=r(24771);function xf(){let t,e;const r=new Promise(((r,o)=>{t=t=>{r(t),n.status="resolved"},e=t=>{o(t),n.status="rejected"}})),n={resolve:t,reject:e,promise:r,status:"pending"};return n}var Cf=()=>{},If=Cf,Ff=r(24771),Ef=class{constructor(){w(this,"_stopPlayCallback",If),w(this,"_state",new Ff.Atom({position:0,playing:!1})),w(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=If}gotoPosition(t){this._updatePositionInState(t)}_updatePositionInState(t){this._state.setByPointer((t=>t.position),t)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(t){this._state.setByPointer((t=>t.playing),t)}play(t,e,r,n,o){this.playing&&this.pause(),this.playing=!0;const i=e[1]-e[0];{const t=this.getCurrentPosition();t<e[0]||t>e[1]?"normal"===n||"alternate"===n?this._updatePositionInState(e[0]):"reverse"!==n&&"alternateReverse"!==n||this._updatePositionInState(e[1]):"normal"===n||"alternate"===n?t===e[1]&&this._updatePositionInState(e[0]):t===e[0]&&this._updatePositionInState(e[1])}const s=xf(),a=o.time,c=i*t;let u=this.getCurrentPosition()-e[0];"reverse"!==n&&"alternateReverse"!==n||(u=e[1]-this.getCurrentPosition());const l=o=>{const l=Math.max(o-a,0),f=l/1e3,d=Math.min(f*r+u,c);if(d!==c){const t=Math.floor(d/i);let r=d/i%1*i;if("normal"!==n)if("reverse"===n)r=i-r;else{const e=t%2===0;"alternate"===n?e||(r=i-r):e&&(r=i-r)}this._updatePositionInState(r+e[0]),h()}else{if("normal"===n)this._updatePositionInState(e[1]);else if("reverse"===n)this._updatePositionInState(e[0]);else{const r=(t-1)%2===0;"alternate"===n?r?this._updatePositionInState(e[1]):this._updatePositionInState(e[0]):r?this._updatePositionInState(e[0]):this._updatePositionInState(e[1])}this.playing=!1,s.resolve(!0)}};this._stopPlayCallback=()=>{o.offThisOrNextTick(l),o.offNextTick(l),this.playing&&s.resolve(!1)};const h=()=>o.onNextTick(l);return o.onThisOrNextTick(l),s.promise}playDynamicRange(t,e){this.playing&&this.pause(),this.playing=!0;const r=xf(),n=t.keepHot();r.promise.then(n,n);let o=e.time;const i=e=>{const r=Math.max(e-o,0);o=e;const n=r/1e3,i=this.getCurrentPosition(),a=t.getValue();if(i<a[0]||i>a[1])this.gotoPosition(a[0]);else{let t=i+n;t>a[1]&&(t=a[0]+(t-a[1])),this.gotoPosition(t)}s()};this._stopPlayCallback=()=>{e.offThisOrNextTick(i),e.offNextTick(i),r.resolve(!1)};const s=()=>e.onNextTick(i);return e.onThisOrNextTick(i),r.promise}},Bf=r(24771),Vf="__TheatreJS_StudioBundle",Mf="__TheatreJS_CoreBundle",zf="__TheatreJS_Notifications",Nf=t=>(...e)=>{var r;switch(t){case"success":pf.debug(e.slice(0,2).join("\n"));break;case"info":pf.debug(e.slice(0,2).join("\n"));break;case"warning":pf.warn(e.slice(0,2).join("\n"));break;case"error":}return"undefined"!==typeof window?null==(r=window[zf])?void 0:r.notify[t](...e):void 0},Rf={warning:Nf("warning"),success:Nf("success"),info:Nf("info"),error:Nf("error")};"undefined"!==typeof window&&(window.addEventListener("error",(t=>{Rf.error("An error occurred","<pre>".concat(t.message,"</pre>\n\nSee **console** for details."))})),window.addEventListener("unhandledrejection",(t=>{Rf.error("An error occurred","<pre>".concat(t.reason,"</pre>\n\nSee **console** for details."))})));var Uf,Lf=class{constructor(t,e,r){this._decodedBuffer=t,this._audioContext=e,this._nodeDestination=r,w(this,"_mainGain"),w(this,"_state",new Bf.Atom({position:0,playing:!1})),w(this,"statePointer"),w(this,"_stopPlayCallback",If),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(t,e){const r=xf();let n;this._playing&&this.pause(),this._playing=!0;const o=()=>{null==n||n(),n=this._loopInRange(t.getValue(),e).stop},i=t.onStale(o);return o(),this._stopPlayCallback=()=>{null==n||n(),i(),r.resolve(!1)},r.promise}_loopInRange(t,e){const r=1;let n=this.getCurrentPosition();const o=t[1]-t[0];(n<t[0]||n>t[1]||n===t[1])&&this._updatePositionInState(t[0]),n=this.getCurrentPosition();const i=this._audioContext.createBufferSource();i.buffer=this._decodedBuffer,i.connect(this._mainGain),i.playbackRate.value=r,i.loop=!0,i.loopStart=t[0],i.loopEnd=t[1];const s=e.time;let a=n-t[0];i.start(0,n);const c=e=>{const n=Math.max(e-s,0),i=n/1e3,c=i*r+a;let l=c/o%1*o;this._updatePositionInState(l+t[0]),u()},u=()=>e.onNextTick(c);e.onThisOrNextTick(c);const l=()=>{i.stop(),i.disconnect(),e.offThisOrNextTick(c),e.offNextTick(c)};return{stop:l}}get _playing(){return this._state.get().playing}set _playing(t){this._state.setByPointer((t=>t.playing),t)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=If}gotoPosition(t){this._updatePositionInState(t)}_updatePositionInState(t){this._state.reduce((e=>v(p({},e),{position:t})))}getCurrentPosition(){return this._state.get().position}play(t,e,r,n,o){this._playing&&this.pause(),this._playing=!0;let i=this.getCurrentPosition();const s=e[1]-e[0];if("normal"!==n)throw new Sf('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(n,"' given."));(i<e[0]||i>e[1]||i===e[1])&&this._updatePositionInState(e[0]),i=this.getCurrentPosition();const a=xf(),c=this._audioContext.createBufferSource();c.buffer=this._decodedBuffer,c.connect(this._mainGain),c.playbackRate.value=r,t>1e3&&(Rf.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(t,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),t=1e3),t>1&&(c.loop=!0,c.loopStart=e[0],c.loopEnd=e[1]);const u=o.time;let l=i-e[0];const h=s*t;c.start(0,i,h-l);const f=t=>{const n=Math.max(t-u,0),o=n/1e3,i=Math.min(o*r+l,h);if(i!==h){let t=i/s%1*s;this._updatePositionInState(t+e[0]),p()}else this._updatePositionInState(e[1]),this._playing=!1,d(),a.resolve(!0)},d=()=>{c.stop(),c.disconnect()};this._stopPlayCallback=()=>{d(),o.offThisOrNextTick(f),o.offNextTick(f),this._playing&&a.resolve(!1)};const p=()=>o.onNextTick(f);return o.onThisOrNextTick(f),a.promise}},qf=r(24771),$f=0;function Hf(t){var e;const r=t=>{n.tick(t)},n=new qf.Ticker({onActive(){var e;null==(e=null==t?void 0:t.start)||e.call(t)},onDormant(){var e;null==(e=null==t?void 0:t.stop)||e.call(t)}}),o={tick:r,id:$f++,name:null!=(e=null==t?void 0:t.name)?e:"CustomRafDriver-".concat($f),type:"Theatre_RafDriver_PublicAPI"},i={type:"Theatre_RafDriver_PrivateAPI",publicApi:o,ticker:n,start:null==t?void 0:t.start,stop:null==t?void 0:t.stop};return E(o,i),o}function Gf(){let t=null;const e=()=>{if("undefined"!==typeof window){const e=r=>{n.tick(r),t=window.requestAnimationFrame(e)};t=window.requestAnimationFrame(e)}else n.tick(0),setTimeout((()=>n.tick(1)),0)},r=()=>{"undefined"!==typeof window&&null!==t&&window.cancelAnimationFrame(t)},n=Hf({name:"DefaultCoreRafDriver",start:e,stop:r});return n}function Wf(){return Uf||Jf(Gf()),Uf}function Kf(){return Wf().ticker}function Jf(t){if(Uf)throw new Error("`setCoreRafDriver()` is already called.");const e=F(t);Uf=e}var Xf=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(t){E(this,t)}play(t){const e=F(this);if(e._project.isReady()){const r=(null==t?void 0:t.rafDriver)?F(t.rafDriver).ticker:Kf();return e.play(null!=t?t:{},r)}{0;const t=xf();return t.resolve(!0),t.promise}}pause(){F(this).pause()}get position(){return F(this).position}set position(t){F(this).position=t}__experimental_getKeyframes(t){return F(this).getKeyframesOfSimpleProp(t)}async attachAudio(t){const{audioContext:e,destinationNode:r,decodedBuffer:n,gainNode:o}=await Yf(t),i=new Lf(n,e,o);return F(this).replacePlaybackController(i),{audioContext:e,destinationNode:r,decodedBuffer:n,gainNode:o}}get pointer(){return F(this).pointer}};async function Yf(t){function e(){if(t.audioContext)return Promise.resolve(t.audioContext);const e=new AudioContext;return"running"===e.state||"undefined"===typeof window?Promise.resolve(e):new Promise((t=>{const r=()=>{e.resume().catch((t=>{console.error(t)}))},n=["mousedown","keydown","touchstart"],o={capture:!0,passive:!1};n.forEach((t=>{window.addEventListener(t,r,o)})),e.addEventListener("statechange",(()=>{"running"===e.state&&(n.forEach((t=>{window.removeEventListener(t,r,o)})),t(e))}))}))}async function r(){if(t.source instanceof AudioBuffer)return t.source;const e=xf();if("string"!==typeof t.source)throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let r,o;try{r=await fetch(t.source)}catch(a){throw console.error(a),new Error("Could not fetch '".concat(t.source,"'. Network error logged above."))}try{o=await r.arrayBuffer()}catch(a){throw console.error(a),new Error("Could not read '".concat(t.source,"' as an arrayBuffer."))}const i=await n;let s;i.decodeAudioData(o,e.resolve,e.reject);try{s=await e.promise}catch(a){throw console.error(a),new Error("Could not decode ".concat(t.source," as an audio file."))}return s}const n=e(),o=r(),[i,s]=await Promise.all([n,o]),a=t.destinationNode||i.destination,c=i.createGain();return c.connect(a),{audioContext:i,decodedBuffer:s,gainNode:c,destinationNode:a}}Zf("Theatre_Project"),Zf("Theatre_Sheet"),Zf("Theatre_SheetTemplate");var Qf=Zf("Theatre_SheetObject");Zf("Theatre_SheetObjectTemplate"),Zf("Theatre_Project_PublicAPI"),Zf("Theatre_Sheet_PublicAPI"),Zf("Theatre_SheetObject_PublicAPI");function Zf(t){return e=>"object"===typeof e&&!!e&&e.type===t}var td=class{constructor(t,e,r,n,o){this._project=t,this._sheet=e,this._lengthD=r,this._subUnitsPerUnitD=n,w(this,"address"),w(this,"publicApi"),w(this,"_playbackControllerBox"),w(this,"_prismOfStatePointer"),w(this,"_positionD"),w(this,"_positionFormatterD"),w(this,"_playableRangeD"),w(this,"pointer",(0,Af.pointer)({root:this,path:[]})),w(this,"$$isPointerToPrismProvider",!0),w(this,"_logger"),w(this,"closestGridPosition",(t=>{const e=this.subUnitsPerUnit,r=1/e;return parseFloat((Math.round(t/r)*r).toFixed(3))})),this._logger=t._logger.named("Sheet",e.address.sheetId).named("Instance",e.address.sheetInstanceId),this.address=v(p({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new Xf(this),this._playbackControllerBox=new kf.Atom(null!=o?o:new Ef),this._prismOfStatePointer=(0,Df.prism)((()=>this._playbackControllerBox.prism.getValue().statePointer)),this._positionD=(0,Df.prism)((()=>{const t=this._prismOfStatePointer.getValue();return(0,Df.val)(t.position)})),this._positionFormatterD=(0,Df.prism)((()=>{const t=(0,Df.val)(this._subUnitsPerUnitD);return new ed(t)}))}pointerToPrism(t){const{path:e}=(0,Tf.getPointerParts)(t);if(0===e.length)return(0,Df.prism)((()=>({length:(0,Df.val)(this.pointer.length),playing:(0,Df.val)(this.pointer.playing),position:(0,Df.val)(this.pointer.position)})));if(e.length>1)return(0,Df.prism)((()=>{}));const[r]=e;return"length"===r?this._lengthD:"position"===r?this._positionD:"playing"===r?(0,Df.prism)((()=>(0,Df.val)(this._prismOfStatePointer.getValue().playing))):(0,Df.prism)((()=>{}))}getKeyframesOfSimpleProp(t){const{path:e,root:r}=(0,Tf.getPointerParts)(t);if(!Qf(r))throw new Sf("Argument prop must be a pointer to a SheetObject property");const n=(0,Df.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[r.address.objectKey]);if(!n)return[];const{trackData:o,trackIdByPropPath:i}=n,s=Pf(e),a=i[s];if(!a)return[];const c=o[a];return c?c.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(t){let e=t;this.pause(),e>this.length&&(e=this.length);const r=this.length;this._playbackControllerBox.get().gotoPosition(e>r?r:e)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,Df.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,Df.prism)((()=>[0,(0,Df.val)(this._lengthD)]))}playDynamicRange(t,e){return this._playbackControllerBox.get().playDynamicRange(t,e)}async play(t,e){const r=this.length,n=t&&t.range?t.range:[0,r];const o=t&&"number"===typeof t.iterationCount?t.iterationCount:1;const i=t&&"undefined"!==typeof t.rate?t.rate:1;const s=t&&t.direction?t.direction:"normal";return await this._play(o,[n[0],n[1]],i,s,e)}_play(t,e,r,n,o){return this._playbackControllerBox.get().play(t,e,r,n,o)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(t){this.pause();const e=this._playbackControllerBox.get();this._playbackControllerBox.set(t);const r=e.getCurrentPosition();e.destroy(),t.gotoPosition(r)}},ed=class{constructor(t){this._fps=t}formatSubUnitForGrid(t){const e=t%1,r=1/this._fps,n=Math.round(e/r);return n+"f"}formatFullUnitForGrid(t){let e=t,r="";if(e>=od){const t=Math.floor(e/od);r+=t+"h",e%=od}if(e>=nd){const t=Math.floor(e/nd);r+=t+"m",e%=nd}if(e>=rd){const t=Math.floor(e/rd);r+=t+"s",e%=rd}const n=1/this._fps;if(e>=n){const t=Math.floor(e/n);r+=t+"f",e%=n}return 0===r.length?"0s":r}formatForPlayhead(t){let e=t,r="";if(e>=od){const t=Math.floor(e/od);r+=Lh(t.toString(),2,"0")+"h",e%=od}if(e>=nd){const t=Math.floor(e/nd);r+=Lh(t.toString(),2,"0")+"m",e%=nd}else r.length>0&&(r+="00m");if(e>=rd){const t=Math.floor(e/rd);r+=Lh(t.toString(),2,"0")+"s",e%=rd}else r+="00s";const n=1/this._fps;if(e>=n){const t=Math.round(e/n);r+=Lh(t.toString(),2,"0")+"f",e%=n}else if(e/n>.98){const t=1;r+=Lh(t.toString(),2,"0")+"f",e%=n}else r+="00f";return 0===r.length?"00s00f":r}formatBasic(t){return t.toFixed(2)+"s"}},rd=1,nd=60*rd,od=60*nd,id={};function sd(t,e){return t.length<=e?t:t.substr(0,e-3)+"..."}y(id,{boolean:()=>Fd,compound:()=>wd,file:()=>jd,image:()=>Od,number:()=>Td,rgba:()=>xd,string:()=>Vd,stringLiteral:()=>zd});var ad=t=>"string"===typeof t?'string("'.concat(sd(t,10),'")'):"number"===typeof t?"number(".concat(sd(String(t),10),")"):null===t?"null":void 0===t?"undefined":"boolean"===typeof t?String(t):Array.isArray(t)?"array":"object"===typeof t?"object":"unknown",cd=ad;function ud(t,{removeAlphaIfOpaque:e=!1}={}){const r=(255*t.a|256).toString(16).slice(1),n=(255*t.r|256).toString(16).slice(1)+(255*t.g|256).toString(16).slice(1)+(255*t.b|256).toString(16).slice(1)+(e&&"ff"===r?"":r);return"#".concat(n)}function ld(t){return v(p({},t),{toString(){return ud(this,{removeAlphaIfOpaque:!0})}})}function hd(t){return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,_s(e,0,1)])))}function fd(t){function e(t){return t>=.0031308?1.055*t**(1/2.4)-.055:12.92*t}return hd({r:e(t.r),g:e(t.g),b:e(t.b),a:t.a})}function dd(t){function e(t){return t>=.04045?((t+.055)/1.055)**2.4:t/12.92}return{r:e(t.r),g:e(t.g),b:e(t.b),a:t.a}}function pd(t){let e=.4122214708*t.r+.5363325363*t.g+.0514459929*t.b,r=.2119034982*t.r+.6806995451*t.g+.1073969566*t.b,n=.0883024619*t.r+.2817188376*t.g+.6299787005*t.b,o=Math.cbrt(e),i=Math.cbrt(r),s=Math.cbrt(n);return{L:.2104542553*o+.793617785*i-.0040720468*s,a:1.9779984951*o-2.428592205*i+.4505937099*s,b:.0259040371*o+.7827717662*i-.808675766*s,alpha:t.a}}function vd(t){let e=t.L+.3963377774*t.a+.2158037573*t.b,r=t.L-.1055613458*t.a-.0638541728*t.b,n=t.L-.0894841775*t.a-1.291485548*t.b,o=e*e*e,i=r*r*r,s=n*n*n;return{r:4.0767416621*o-3.3077115913*i+.2309699292*s,g:-1.2684380046*o+2.6097574011*i-.3413193965*s,b:-.0041960863*o-.7034186147*i+1.707614701*s,a:t.alpha}}var gd=Symbol("TheatrePropType_Basic");function yd(t){return"object"===typeof t&&!!t&&"TheatrePropType"===t[gd]}function _d(t){if("number"===typeof t)return Td(t);if("boolean"===typeof t)return Fd(t);if("string"===typeof t)return Vd(t);if("object"===typeof t&&t){if(yd(t))return t;if(Ai(t))return wd(t);throw new Sf("This value is not a valid prop type: ".concat(cd(t)))}throw new Sf("This value is not a valid prop type: ".concat(cd(t)))}function bd(t){const e={};for(const r of Object.keys(t)){0;const n=t[r];yd(n)?e[r]=n:e[r]=_d(n)}return e}var md=(t,e)=>{0},wd=(t,e={})=>{md("t.compound(props, opts)",e);const r=bd(t),n=new WeakMap,o={type:"compound",props:r,valueType:null,[gd]:"TheatrePropType",label:e.label,default:ih(r,(t=>t.default)),deserializeAndSanitize:t=>{if("object"!==typeof t||!t)return;if(n.has(t))return n.get(t);const e={};let o=!1;for(const[n,i]of Object.entries(r))if(Object.prototype.hasOwnProperty.call(t,n)){const r=i.deserializeAndSanitize(t[n]);null!=r&&(o=!0,e[n]=r)}return n.set(t,e),o?e:void 0}};return o},jd=(t,e={})=>{const r=(t,r,n)=>{var o;const i=null!=(o=e.interpolate)?o:Bd;return{type:"file",id:i(t.id,r.id,n)}};return{type:"file",default:{type:"file",id:t},valueType:null,[gd]:"TheatrePropType",label:e.label,interpolate:r,deserializeAndSanitize:Pd}},Pd=t=>{if(!t)return;let e=!0;return"string"===typeof t.id||[null,void 0].includes(t.id)||(e=!1),"file"!==t.type&&(e=!1),e?t:void 0},Od=(t,e={})=>{const r=(t,r,n)=>{var o;const i=null!=(o=e.interpolate)?o:Bd;return{type:"image",id:i(t.id,r.id,n)}};return{type:"image",default:{type:"image",id:t},valueType:null,[gd]:"TheatrePropType",label:e.label,interpolate:r,deserializeAndSanitize:Sd}},Sd=t=>{if(!t)return;let e=!0;return"string"===typeof t.id||[null,void 0].includes(t.id)||(e=!1),"image"!==t.type&&(e=!1),e?t:void 0},Td=(t,e={})=>{var r;return v(p({type:"number",valueType:0,default:t,[gd]:"TheatrePropType"},e||{}),{label:e.label,nudgeFn:null!=(r=e.nudgeFn)?r:Nd,nudgeMultiplier:"number"===typeof e.nudgeMultiplier?e.nudgeMultiplier:void 0,interpolate:Dd,deserializeAndSanitize:kd(e.range)})},kd=t=>t?e=>{if("number"===typeof e&&isFinite(e))return _s(e,t[0],t[1])}:Ad,Ad=t=>"number"===typeof t&&isFinite(t)?t:void 0,Dd=(t,e,r)=>t+r*(e-t),xd=(t={r:0,g:0,b:0,a:1},e={})=>{const r={};for(const n of["r","g","b","a"])r[n]=Math.min(Math.max(t[n],0),1);return{type:"rgba",valueType:null,default:ld(r),[gd]:"TheatrePropType",label:e.label,interpolate:Id,deserializeAndSanitize:Cd}},Cd=t=>{if(!t)return;let e=!0;for(const n of["r","g","b","a"])Object.prototype.hasOwnProperty.call(t,n)&&"number"===typeof t[n]||(e=!1);if(!e)return;const r={};for(const n of["r","g","b","a"])r[n]=Math.min(Math.max(t[n],0),1);return ld(r)},Id=(t,e,r)=>{const n=pd(dd(t)),o=pd(dd(e)),i={L:(1-r)*n.L+r*o.L,a:(1-r)*n.a+r*o.a,b:(1-r)*n.b+r*o.b,alpha:(1-r)*n.alpha+r*o.alpha},s=fd(vd(i));return ld(s)},Fd=(t,e={})=>{var r;return{type:"boolean",default:t,valueType:null,[gd]:"TheatrePropType",label:e.label,interpolate:null!=(r=e.interpolate)?r:Bd,deserializeAndSanitize:Ed}},Ed=t=>"boolean"===typeof t?t:void 0;function Bd(t){return t}var Vd=(t,e={})=>{var r;return{type:"string",default:t,valueType:null,[gd]:"TheatrePropType",label:e.label,interpolate:null!=(r=e.interpolate)?r:Bd,deserializeAndSanitize:Md}};function Md(t){return"string"===typeof t?t:void 0}function zd(t,e,r={}){var n,o;return{type:"stringLiteral",default:t,valuesAndLabels:p({},e),[gd]:"TheatrePropType",valueType:null,as:null!=(n=r.as)?n:"menu",label:r.label,interpolate:null!=(o=r.interpolate)?o:Bd,deserializeAndSanitize(t){if("string"===typeof t)return Object.prototype.hasOwnProperty.call(e,t)?t:void 0}}}var Nd=({config:t,deltaX:e,deltaFraction:r,magnitude:n})=>{var o;const{range:i}=t;return t.nudgeMultiplier||!i||i.includes(1/0)||i.includes(-1/0)?e*n*(null!=(o=t.nudgeMultiplier)?o:1):r*(i[1]-i[0])*n},Rd=t=>t.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ");function Ud(t,e){const r=Rd(t);return r}b(S());var Ld,qd,$d=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(t){E(this,t)}object(t,e,r){const n=F(this),o=Ud(t,"sheet.object"),i=n.getObject(o),s=null,a=null==r?void 0:r.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(i)return a&&i.template._temp_setActions(a),i.publicApi;{const t=wd(e),r=n.createObject(o,s,t,a);return r.publicApi}}get sequence(){return F(this).getSequence().publicApi}get project(){return F(this).project.publicApi}get address(){return p({},F(this).address)}detachObject(t){const e=F(this),r=Ud(t,'sheet.deleteObject("'.concat(t,'")')),n=e.getObject(r);if(!n)return Rf.warning("Couldn't delete object \"".concat(r,'"'),'There is no object with key "'.concat(r,'".\n\nTo fix this, make sure you are calling `sheet.deleteObject("').concat(r,'")` with the correct key.')),void console.warn('Object key "'.concat(r,'" does not exist.'));e.deleteObject(r)}},Hd=r(24771),Gd=class{constructor(t,e){this.template=t,this.instanceId=e,w(this,"_objects",new Hd.Atom({})),w(this,"_sequence"),w(this,"address"),w(this,"publicApi"),w(this,"project"),w(this,"objectsP",this._objects.pointer),w(this,"type","Theatre_Sheet"),w(this,"_logger"),this._logger=t.project._logger.named("Sheet",e),this._logger._trace("creating sheet"),this.project=t.project,this.address=v(p({},t.address),{sheetInstanceId:this.instanceId}),this.publicApi=new $d(this)}createObject(t,e,r,n={}){const o=this.template.getObjectTemplate(t,e,r,n),i=o.createInstance(this,e,r);return this._objects.setByPointer((e=>e[t]),i),i}getObject(t){return this._objects.get()[t]}deleteObject(t){this._objects.reduce((e=>{const r=p({},e);return delete r[t],r}))}getSequence(){if(!this._sequence){const t=(0,Hd.prism)((()=>{const t=(0,Hd.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return Wd(t)})),e=(0,Hd.prism)((()=>{const t=(0,Hd.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return Kd(t)}));this._sequence=new td(this.template.project,this,t,e)}return this._sequence}},Wd=t=>"number"===typeof t&&isFinite(t)&&t>0?t:10,Kd=t=>"number"===typeof t&&nh(t)&&t>=1&&t<=1e3?t:30,Jd=class{constructor(t,e){this.project=t,w(this,"type","Theatre_SheetTemplate"),w(this,"address"),w(this,"_instances",new jf.Atom({})),w(this,"instancesP",this._instances.pointer),w(this,"_objectTemplates",new jf.Atom({})),w(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=v(p({},t.address),{sheetId:e})}getInstance(t){let e=this._instances.get()[t];return e||(e=new Gd(this,t),this._instances.setByPointer((e=>e[t]),e)),e}getObjectTemplate(t,e,r,n){let o=this._objectTemplates.get()[t];return o||(o=new mf(this,t,e,r,n),this._objectTemplates.setByPointer((e=>e[t]),o)),o}},Xd=r(24771),Yd=r(24771),Qd=t=>new Promise((e=>setTimeout(e,t))),Zd=Qd;function tp(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(r.length?" "+r.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function ep(t){return!!t&&!!t[Up]}function rp(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===Lp}(t)||Array.isArray(t)||!!t[Rp]||!!t.constructor[Rp]||lp(t)||hp(t))}function np(t){return ep(t)||tp(23,t),t[Up].t}function op(t,e,r){void 0===r&&(r=!1),0===ip(t)?(r?Object.keys:qp)(t).forEach((function(n){r&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(r,n){return e(n,r,t)}))}function ip(t){var e=t[Up];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:lp(t)?2:hp(t)?3:0}function sp(t,e){return 2===ip(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function ap(t,e){return 2===ip(t)?t.get(e):t[e]}function cp(t,e,r){var n=ip(t);2===n?t.set(e,r):3===n?(t.delete(e),t.add(r)):t[e]=r}function up(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function lp(t){return Vp&&t instanceof Map}function hp(t){return Mp&&t instanceof Set}function fp(t){return t.o||t.t}function dp(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=$p(t);delete e[Up];for(var r=qp(e),n=0;n<r.length;n++){var o=r[n],i=e[o];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(e[o]={configurable:!0,writable:!0,enumerable:i.enumerable,value:t[o]})}return Object.create(Object.getPrototypeOf(t),e)}function pp(t,e){return void 0===e&&(e=!1),gp(t)||ep(t)||!rp(t)||(ip(t)>1&&(t.set=t.add=t.clear=t.delete=vp),Object.freeze(t),e&&op(t,(function(t,e){return pp(e,!0)}),!0)),t}function vp(){tp(2)}function gp(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function yp(t){var e=Hp[t];return e||tp(18,t),e}function _p(){return qd}function bp(t,e){e&&(yp("Patches"),t.u=[],t.s=[],t.v=e)}function mp(t){wp(t),t.p.forEach(Pp),t.p=null}function wp(t){t===qd&&(qd=t.l)}function jp(t){return qd={p:[],l:qd,h:t,m:!0,_:0}}function Pp(t){var e=t[Up];0===e.i||1===e.i?e.j():e.O=!0}function Op(t,e){e._=e.p.length;var r=e.p[0],n=void 0!==t&&t!==r;return e.h.g||yp("ES5").S(e,t,n),n?(r[Up].P&&(mp(e),tp(4)),rp(t)&&(t=Sp(e,t),e.l||kp(e,t)),e.u&&yp("Patches").M(r[Up],t,e.u,e.s)):t=Sp(e,r,[]),mp(e),e.u&&e.v(e.u,e.s),t!==Np?t:void 0}function Sp(t,e,r){if(gp(e))return e;var n=e[Up];if(!n)return op(e,(function(o,i){return Tp(t,n,e,o,i,r)}),!0),e;if(n.A!==t)return e;if(!n.P)return kp(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=4===n.i||5===n.i?n.o=dp(n.k):n.o;op(3===n.i?new Set(o):o,(function(e,i){return Tp(t,n,o,e,i,r)})),kp(t,o,!1),r&&t.u&&yp("Patches").R(n,r,t.u,t.s)}return n.o}function Tp(t,e,r,n,o,i){if(ep(o)){var s=Sp(t,o,i&&e&&3!==e.i&&!sp(e.D,n)?i.concat(n):void 0);if(cp(r,n,s),!ep(s))return;t.m=!1}if(rp(o)&&!gp(o)){if(!t.h.F&&t._<1)return;Sp(t,o),e&&e.A.l||kp(t,o)}}function kp(t,e,r){void 0===r&&(r=!1),t.h.F&&t.m&&pp(e,r)}function Ap(t,e){var r=t[Up];return(r?fp(r):t)[e]}function Dp(t,e){if(e in t)for(var r=Object.getPrototypeOf(t);r;){var n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=Object.getPrototypeOf(r)}}function xp(t){t.P||(t.P=!0,t.l&&xp(t.l))}function Cp(t){t.o||(t.o=dp(t.t))}function Ip(t,e,r){var n=lp(e)?yp("MapSet").N(e,r):hp(e)?yp("MapSet").T(e,r):t.g?function(t,e){var r=Array.isArray(t),n={i:r?1:0,A:e?e.A:_p(),P:!1,I:!1,D:{},l:e,t:t,k:null,o:null,j:null,C:!1},o=n,i=Gp;r&&(o=[n],i=Wp);var s=Proxy.revocable(o,i),a=s.revoke,c=s.proxy;return n.k=c,n.j=a,c}(e,r):yp("ES5").J(e,r);return(r?r.A:_p()).p.push(n),n}function Fp(t){return ep(t)||tp(22,t),function t(e){if(!rp(e))return e;var r,n=e[Up],o=ip(e);if(n){if(!n.P&&(n.i<4||!yp("ES5").K(n)))return n.t;n.I=!0,r=Ep(e,o),n.I=!1}else r=Ep(e,o);return op(r,(function(e,o){n&&ap(n.t,e)===o||cp(r,e,t(o))})),3===o?new Set(r):r}(t)}function Ep(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return dp(t)}var Bp="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Vp="undefined"!=typeof Map,Mp="undefined"!=typeof Set,zp="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Np=Bp?Symbol.for("immer-nothing"):((Ld={})["immer-nothing"]=!0,Ld),Rp=Bp?Symbol.for("immer-draftable"):"__$immer_draftable",Up=Bp?Symbol.for("immer-state"):"__$immer_state",Lp=""+Object.prototype.constructor,qp="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,$p=Object.getOwnPropertyDescriptors||function(t){var e={};return qp(t).forEach((function(r){e[r]=Object.getOwnPropertyDescriptor(t,r)})),e},Hp={},Gp={get:function(t,e){if(e===Up)return t;var r=fp(t);if(!sp(r,e))return function(t,e,r){var n,o=Dp(e,r);return o?"value"in o?o.value:null===(n=o.get)||void 0===n?void 0:n.call(t.k):void 0}(t,r,e);var n=r[e];return t.I||!rp(n)?n:n===Ap(t.t,e)?(Cp(t),t.o[e]=Ip(t.A.h,n,t)):n},has:function(t,e){return e in fp(t)},ownKeys:function(t){return Reflect.ownKeys(fp(t))},set:function(t,e,r){var n=Dp(fp(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,r),!0;if(!t.P){var o=Ap(fp(t),e),i=null==o?void 0:o[Up];if(i&&i.t===r)return t.o[e]=r,t.D[e]=!1,!0;if(up(r,o)&&(void 0!==r||sp(t.t,e)))return!0;Cp(t),xp(t)}return t.o[e]===r&&"number"!=typeof r&&(void 0!==r||e in t.o)||(t.o[e]=r,t.D[e]=!0,!0)},deleteProperty:function(t,e){return void 0!==Ap(t.t,e)||e in t.t?(t.D[e]=!1,Cp(t),xp(t)):delete t.D[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var r=fp(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:r[e]}:n},defineProperty:function(){tp(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){tp(12)}},Wp={};op(Gp,(function(t,e){Wp[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),Wp.deleteProperty=function(t,e){return Gp.deleteProperty.call(this,t[0],e)},Wp.set=function(t,e,r){return Gp.set.call(this,t[0],e,r,t[0])};var Kp=function(){function t(t){var e=this;this.g=zp,this.F=!0,this.produce=function(t,r,n){if("function"==typeof t&&"function"!=typeof r){var o=r;r=t;var i=e;return function(t){var e=this;void 0===t&&(t=o);for(var n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return i.produce(t,(function(t){var n;return(n=r).call.apply(n,[e,t].concat(s))}))}}var s;if("function"!=typeof r&&tp(6),void 0!==n&&"function"!=typeof n&&tp(7),rp(t)){var a=jp(e),c=Ip(e,t,void 0),u=!0;try{s=r(c),u=!1}finally{u?mp(a):wp(a)}return"undefined"!=typeof Promise&&s instanceof Promise?s.then((function(t){return bp(a,n),Op(t,a)}),(function(t){throw mp(a),t})):(bp(a,n),Op(s,a))}if(!t||"object"!=typeof t){if((s=r(t))===Np)return;return void 0===s&&(s=t),e.F&&pp(s,!0),s}tp(21,t)},this.produceWithPatches=function(t,r){return"function"==typeof t?function(r){for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return e.produceWithPatches(r,(function(e){return t.apply(void 0,[e].concat(o))}))}:[e.produce(t,r,(function(t,e){n=t,o=e})),n,o];var n,o},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){rp(t)||tp(8),ep(t)&&(t=Fp(t));var e=jp(this),r=Ip(this,t,void 0);return r[Up].C=!0,wp(e),r},e.finishDraft=function(t,e){var r=t&&t[Up],n=r.A;return bp(n,e),Op(void 0,n)},e.setAutoFreeze=function(t){this.F=t},e.setUseProxies=function(t){t&&!zp&&tp(20),this.g=t},e.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}var o=yp("Patches").$;return ep(t)?o(t,e):this.produce(t,(function(t){return o(t,e.slice(r+1))}))},t}(),Jp=new Kp,Xp=(Jp.produce,Jp.produceWithPatches.bind(Jp),Jp.setAutoFreeze.bind(Jp),Jp.setUseProxies.bind(Jp),Jp.applyPatches.bind(Jp),Jp.createDraft.bind(Jp),Jp.finishDraft.bind(Jp),{currentProjectStateDefinitionVersion:"0.4.0"}),Yp=Xp;async function Qp(t,e,r){await Zd(0),t.transaction((({drafts:t})=>{var n;const o=e.address.projectId;function i(){t.ephemeral.coreByProject[o].loadingState={type:"loaded"},t.historic.coreByProject[o]={sheetsById:{},definitionVersion:Yp.currentProjectStateDefinitionVersion,revisionHistory:[]}}function s(e){t.ephemeral.coreByProject[o].loadingState={type:"loaded"},t.historic.coreByProject[o]=e}function a(){t.ephemeral.coreByProject[o].loadingState={type:"loaded"}}function c(e){t.ephemeral.coreByProject[o].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:e}}t.ephemeral.coreByProject[o]={lastExportedObject:null,loadingState:{type:"loading"}},t.ahistoric.coreByProject[o]={ahistoricStuff:""};const u=null==(n=np(t.historic))?void 0:n.coreByProject[e.address.projectId];u?r&&-1==u.revisionHistory.indexOf(r.revisionHistory[0])?c(r):a():r?s(r):i()}))}function Zp(){}function tv(t){var e,r;const n=(null==(e=null==t?void 0:t.logging)?void 0:e.internal)?null!=(r=t.logging.min)?r:256:1/0,o=n<=128,i=n<=512,s=sf(void 0,{_debug:o?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):Zp,_error:i?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):Zp});if(t){const{logger:e,logging:r}=t;e&&s.configureLogger(e),r?s.configureLogging(r):s.configureLogging({dev:!1})}return s.getLogger().named("Theatre")}var ev=class{constructor(t,e={},r){var n;this.config=e,this.publicApi=r,w(this,"pointers"),w(this,"_pointerProxies"),w(this,"address"),w(this,"_studioReadyDeferred"),w(this,"_assetStorageReadyDeferred"),w(this,"_readyPromise"),w(this,"_sheetTemplates",new Yd.Atom({})),w(this,"sheetTemplatesP",this._sheetTemplates.pointer),w(this,"_studio"),w(this,"assetStorage"),w(this,"type","Theatre_Project"),w(this,"_logger"),this._logger=tv({logging:{dev:!0}}).named("Project",t),this._logger.traceDev("creating project"),this.address={projectId:t};const o=new Yd.Atom({ahistoric:{ahistoricStuff:""},historic:null!=(n=e.state)?n:{sheetsById:{},definitionVersion:Yp.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=xf(),this.assetStorage={getAssetUrl:t=>{var r;return"".concat(null==(r=e.assets)?void 0:r.baseUrl,"/").concat(t)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new Xd.PointerProxy(o.pointer.historic),ahistoric:new Xd.PointerProxy(o.pointer.ahistoric),ephemeral:new Xd.PointerProxy(o.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},C.add(t,this),this._studioReadyDeferred=xf(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then((()=>{})),e.state?setTimeout((()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))}),0):"undefined"===typeof window?console.error('Argument config.state in Theatre.getProject("'.concat(t,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout((()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(t,'", config) is empty. This is fine ')+"while you are using @theatre/core along with @theatre/studio. But since @theatre/studio "+'is not loaded, the state of project "'.concat(t,'" will be empty.\n\n')+"To fix this, you need to add @theatre/studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state\n")}),1e3)}attachToStudio(t){if(this._studio){if(this._studio!==t)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId))}else this._studio=t,t.initialized.then((async()=>{var e;await Qp(t,this,this.config.state),this._pointerProxies.historic.setPointer(t.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(t.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(t.atomP.ephemeral.coreByProject[this.address.projectId]),await t.createAssetStorage(this,null==(e=this.config.assets)?void 0:e.baseUrl).then((t=>{this.assetStorage=t,this._assetStorageReadyDeferred.resolve(void 0)})),this._studioReadyDeferred.resolve(void 0)})).catch((t=>{throw console.error(t),t}))}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return"resolved"===this._studioReadyDeferred.status&&"resolved"===this._assetStorageReadyDeferred.status}getOrCreateSheet(t,e="default"){let r=this._sheetTemplates.get()[t];return r||(r=new Jd(this,t),this._sheetTemplates.reduce((e=>v(p({},e),{[t]:r})))),r.getInstance(e)}},rv=class{get type(){return"Theatre_Project_PublicAPI"}constructor(t,e={}){E(this,new ev(t,e,this))}get ready(){return F(this).ready}get isReady(){return F(this).isReady()}get address(){return p({},F(this).address)}getAssetUrl(t){if(this.isReady)return t.id?F(this).assetStorage.getAssetUrl(t.id):void 0;console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.")}sheet(t,e="default"){const r=Ud(t,"project.sheet");return F(this).getOrCreateSheet(r,e).publicApi}},nv=(b(S()),r(24771)),ov=r(24771);function iv(t,e={}){const r=C.get(t);if(r)return r.publicApi;const n=tv(),o=n.named("Project",t);return e.state?(av(t,e.state),o._debug("deep validated config.state on disk")):o._debug("no config.state"),new rv(t,e)}var sv=(t,e)=>{if(Array.isArray(e)||null==e||e.definitionVersion!==Yp.currentProjectStateDefinitionVersion)throw new Sf("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(t),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))},av=(t,e)=>{sv(t,e)};function cv(t,e,r){const n=r?F(r).ticker:Kf();if((0,nv.isPointer)(t)){const r=(0,ov.pointerToPrism)(t);return r.onChange(n,e,!0)}if((0,ov.isPrism)(t))return t.onChange(n,e,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function uv(t){if((0,nv.isPointer)(t))return(0,ov.pointerToPrism)(t).getValue();throw new Error("Called val(p) where p is not a pointer.")}var lv=class{constructor(){w(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"0.7.0"}getBitsForStudio(t,e){if(this._studio)throw new Error("@theatre/core is already attached to @theatre/studio");this._studio=t;const r={projectsP:C.atom.pointer.projects,privateAPI:F,coreExports:k,getCoreRafDriver:Wf};e(r)}};function hv(){if("undefined"==typeof window)return;const t=window[Mf];if("undefined"!==typeof t)throw"object"===typeof t&&t&&"string"===typeof t.version?new Error("It seems that the module '@theatre/core' is loaded more than once. This could have two possible causes:\n1. You might have two separate versions of Theatre.js in node_modules.\n2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.\n\nNote that it **is okay** to import '@theatre/core' multiple times. But those imports should point to the same module."):new Error("The variable window.".concat(Mf," seems to be already set by a module other than @theatre/core."));const e=new lv;window[Mf]=e;const r=window[Vf];r&&null!==r&&"Theatre_StudioBundle"===r.type&&r.registerCoreBundle(e)}
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/hv()}}]);
//# sourceMappingURL=6381.8af345a4.js.map