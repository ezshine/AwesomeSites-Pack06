(self["webpackChunkgl_starter"]=self["webpackChunkgl_starter"]||[]).push([[9278],{87584:function(e,t,s){var r=function(e){var t="";return t+="#pragma SLOT version\n\n#pragma SLOT definitions\n\n#pragma SLOT precision\n\n"+s(87426)()+"\n\n#pragma SLOT pf\n\n\n\n// MATH\n// =========\n#define saturate(x) clamp( x, 0.0, 1.0 )\n#define sdot( a, b ) saturate( dot(a,b) )\n\n\n\n//                MAIN\n// ===================\n\nvoid main( void ){\n\n  #pragma SLOT f\n\n vec3 _baseColor = vec3(1.0);\n  #if HAS_baseColor\n    _baseColor *= baseColor();\n  #endif\n  #if HAS_baseColorFactor\n    _baseColor *= baseColorFactor();\n  #endif\n\n\n\n  //\n  #ifdef HAS_vertexColor\n  #if HAS_vertexColor\n    _baseColor *= vertexColor();\n  #endif\n  #endif\n\n  FragColor.xyz = _baseColor;\n \n\n  float _alpha = 1.0;\n  #if HAS_alpha\n    _alpha *= alpha();\n  #endif\n  #if HAS_alphaFactor\n    _alpha *= alphaFactor();\n  #endif\n\n\n  #if alphaMode( MASK )\n    if( _alpha < alphaCutoff() ) discard;\n    FragColor.a = 1.0;\n  #elif alphaMode( BLEND )\n    FragColor.a = _alpha;\n  #else\n    FragColor.a = 1.0;\n  #endif\n\n\n  #pragma SLOT postf_linear\n  #pragma SLOT postf\n\n}",t};r.toString=r,e.exports=r,r.onHmr=function(){}},52303:function(e,t,s){var r=function(e){var t="";return t+="#pragma SLOT version\n\n#pragma SLOT definitions\n\n\n#ifndef hasNormals\n  #define hasNormals 0\n#endif \n#ifndef hasTangents\n  #define hasTangents 0\n#endif \n\n#if hasTangents && !hasNormals \n  #pragma error tan but no nrm\n  error\n#endif\n\n#pragma SLOT precision\n\n"+s(16067)()+"\n\n#pragma SLOT pv\n\n\nIN vec3 aPosition;\n\n\n// uniform mat4 uMVP;\nuniform mat4 uWorldMatrix;\nuniform mat4 uVP;\n\n\n\n\nstruct VertexData {\n  highp vec3 position;\n  highp vec3 worldPos;\n  #if hasNormals\n    vec3 normal;\n  #endif\n  #if hasTangents\n    vec3 tangent;\n  #endif\n  mat4 worldMatrix;\n};\n\n\nvoid InitVertexData( out VertexData vertex ){\n\n  vertex.position = aPosition;\n  #if hasNormals\n    vertex.normal = vec3(0.0);\n  #endif\n  #if hasTangents\n    vertex.tangent = vec3(0.0);\n  #endif\n\n  vertex.worldMatrix = uWorldMatrix;\n   \n}\n\n\nvoid main( void ){\n\n  #pragma SLOT v\n\n  VertexData vertex;\n  InitVertexData( vertex );\n\n  #pragma SLOT vertex_warp\n\n  vec4 worldPos = vertex.worldMatrix * vec4( vertex.position, 1.0 );\n  vertex.worldPos.xyz = worldPos.xyz / worldPos.w;\n\n  #pragma SLOT vertex_warp_world\n\n  gl_Position     = uVP * vec4( vertex.worldPos, 1.0 );\n  \n  #pragma SLOT postv\n}",t};r.toString=r,e.exports=r,r.onHmr=function(){}},33695:function(e,t,s){"use strict";s.d(t,{Z:function(){return A}});var r=s(63887),n=s(52303),a=s.n(n),i=s(87584),o=s.n(i),c=s(4378),l=s(96323),h=s(49500),u=s(48612),d=s(24033),p=s(41863),_=s(93497),m=s(65497);const f=r.mat4.create(),g="unlit";class A extends c.Z{constructor(e="unlit-pass"){super({uid:g,vert:a()(),frag:o()()});const t=this.inputs;t.add(this.version=new p.Z("100")),t.add(this.precision=new _.Z("highp")),t.add(this.shaderid=new l.Z("id_"+g,!0)),t.add(this.baseColor=new h.ZP("baseColor",3,h.Ho.FRAGMENT,m.u.SRGB)),t.add(this.baseColorFactor=new h.ZP("baseColorFactor",3,h.Ho.FRAGMENT,m.u.SRGB)),t.add(this.alpha=new h.ZP("alpha",1)),t.add(this.alphaFactor=new h.ZP("alphaFactor",1)),t.add(this.alphaCutoff=new h.ZP("alphaCutoff",1)),t.add(this.alphaMode=new d.Z("alphaMode",u.r)),t.add(this.doubleSided=new l.Z("doubleSided",!1))}setLightSetup(e){}prepare(e,t,s){e.uMVP&&(s.modelViewProjectionMatrix(f,t._wmatrix),e.uMVP(f)),e.uWorldMatrix&&e.uWorldMatrix(t._wmatrix),e.uVP&&e.uVP(s._viewProj)}}},79785:function(e,t,s){"use strict";var r=s(76670),n=s(42307);class a extends n.Z{constructor(){super(),this._type=r.Z.POINT,this._radius=0,this.radius=50}set castShadows(e){}get radius(){return this._radius}set radius(e){this._radius=e}projectionFromBounds(e){throw new Error("Shadow mapping not supported on point lights")}_createCamera(){throw new Error("Shadow mapping not supported on point lights")}getTexelBiasVector(){throw new Error("Shadow mapping not supported on point lights")}}t["Z"]=a},42307:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var r=s(86375),n=s(34072),a=s(8098),i=s(65031),o=s(63887),c=s(35979);const l=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]),h=o.mat4.create(),u=new Float32Array(6),d=o.vec3.create(),p=36096,_=36064;class m extends r.Z{constructor(){super(),this._fbo=null,this.shadowmapSize=512,this._castShadows=!1,this._color=new Float32Array([1,1,1]),this._wdir=new Float32Array(this._wmatrix.buffer,32,3),this._castShadows=!1,this._fbo=null,this._camera=null,this.iblShadowing=.5}set castShadows(e){this._castShadows!==e&&(this._castShadows=e,e||this._releaseShadowMapping())}get castShadows(){return this._castShadows}hasDepthShadowmap(){return this._castShadows&&this._fbo.getAttachment(p).isTexture()}initShadowmap(e){null===this._fbo&&this._initShadowMapping(e)}getShadowmap(){if(this._castShadows){var e=this._fbo.getAttachment(p);if(null!==e){const t=e.isTexture()?e.target:this._fbo.getAttachment(_).target;return t}}return null}bindShadowmap(){const e=this.shadowmapSize,t=this._fbo;t.resize(e,e),t.bind(),t.defaultViewport()}getShadowProjection(e){return this.projectionFromBounds(e),this._camera.updateViewProjectionMatrix(1,1),o.mat4.multiply(h,l,this._camera._viewProj),h}_initShadowMapping(e){var t=this.shadowmapSize;this._fbo=new n.Z(e),this._fbo.bind(),this._fbo.resize(t,t),this._fbo.attach(e.COLOR_ATTACHMENT0,new i.Z(e,e.RGB));var s=c.Z.getInstance(e).hasDepthTexture();const r=this._fbo.attachDepth(!0,!1,s);var o=r.isTexture()?r.target:this._fbo.getAttachment(_).target;o.bind(),(0,a.I)(e)?(o.setFilter(!0,!1,!1),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE)):o.setFilter(!1,!1,!1),this.getCamera()}getCamera(){return null===this._camera&&(this._camera=this._createCamera(),this.add(this._camera)),this._camera}_releaseShadowMapping(){var e;null===(e=this._fbo)||void 0===e||e.dispose(),this._fbo=null,this.remove(this._camera),this._camera=null}boundsInLocalSpace(e){u[0]=u[1]=u[2]=Number.MAX_VALUE,u[3]=u[4]=u[5]=-Number.MAX_VALUE;for(var t=0;8>t;t++)d[0]=1&t?e.max[0]:e.min[0],d[1]=2&t?e.max[1]:e.min[1],d[2]=4&t?e.max[2]:e.min[2],o.vec3.transformMat4(d,d,this._camera._view),u[0]=Math.min(u[0],d[0]),u[1]=Math.min(u[1],d[1]),u[2]=Math.min(u[2],d[2]),u[3]=Math.max(u[3],d[0]),u[4]=Math.max(u[4],d[1]),u[5]=Math.max(u[5],d[2]);return u}}},89906:function(e,t,s){"use strict";var r=s(85645),n=s(76670),a=s(42307);const i=new Float32Array(4);class o extends a.Z{constructor(){super(),this._type=n.Z.SPOT,this._innerAngle=0,this._outerAngle=0,this._radius=0,this._camera=null,this._attenuationData=new Float32Array(4),this.outerAngle=Math.PI/4,this.radius=50}projectionFromBounds(e){const t=this.boundsInLocalSpace(e);let s=-t[5],r=-t[2];const n=this._radius<=0?Number.MAX_VALUE:this._radius;s=Math.max(.001,Math.min(s,n)),r=Math.max(.005+s,Math.min(r,n));const a=this._camera.lens;a.near=s,a.far=r}getTexelBiasVector(){var e=this._camera._view,t=-2*Math.tan(this._outerAngle);return i[0]=e[2]*t,i[1]=e[6]*t,i[2]=e[10]*t,i[3]=e[14]*t,i}_createCamera(){var e=r.Z.makePerspectiveCamera();return e.lens.aspect=1,e.lens.fov=2*this._outerAngle,e.lens.near=10,e.lens.far=20,e}get innerAngle(){return this._innerAngle}set innerAngle(e){this._innerAngle=e,this._updateSpotData()}get angle(){return this._outerAngle}set angle(e){this.outerAngle=e}get outerAngle(){return this._outerAngle}set outerAngle(e){this._outerAngle=e,this._updateSpotData(),this.castShadows&&(this._camera.lens.fov=2*this._outerAngle)}get radius(){return this._radius}set radius(e){this._radius=e,this._updateSpotData()}_updateSpotData(){this._attenuationData[0]=1/(this._radius*this._radius),this._attenuationData[1]=this._radius*this._radius,this._attenuationData[2]=1/Math.max(.001,Math.cos(this._innerAngle)-Math.cos(this._outerAngle)),this._attenuationData[3]=-Math.cos(this._outerAngle)*this._attenuationData[2]}}t["Z"]=o},22999:function(e,t,s){"use strict";function r(e){return e.startsWith("/")&&(e=e.substring(1)),s.p+e}s.d(t,{Z:function(){return r}})},9278:function(e,t,s){"use strict";s.r(t);var r=s(29845),n=s(15415),a=s(75989);const i={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};async function o(e){return new Promise(((t,s)=>{const r=new Image;r.onload=()=>t(r.width>0&&r.height>0),r.onerror=()=>t(!1),r.src="data:image/webp;base64,"+i[e]}))}const c=Promise.all([o("lossy"),o("lossless"),o("alpha"),o("animation")]).then((e=>e.every((e=>e))));function l(){return c}const h="EXT_texture_webp";class u{constructor(e){this.name=h,this.priority=-10,this.loader=e}async acceptElement(e,t){if(t.gltftype===a.Z.TEXTURE&&e.extensions&&e.extensions[h]){const s=await l();s&&(t.source=await this.loader.getElement(a.Z.IMAGE,e.extensions[h].source))}return t}loadElement(e){return null}}class d{constructor(){this.name=h}createInstance(e){return new u(e)}}var p=s(63887),_=s(1517),m=s(49500);const f=p.mat3.create(),g="KHR_texture_transform";function A(e){if(void 0===e.createSampler)throw new Error("KHR_texture_transform used on element which doesn't implement ITextureInfo")}class E{constructor(e){var t,s,r;this.offset=null!==(t=e.offset)&&void 0!==t?t:[0,0],this.scale=null!==(s=e.scale)&&void 0!==s?s:[1,1],this.rotation=null!==(r=e.rotation)&&void 0!==r?r:0,this.texCoord=e.texCoord}getMatrix(e){const t=Math.cos(this.rotation),s=Math.sin(this.rotation);e[0]=this.scale[0]*t,e[1]=this.scale[0]*s,e[3]=this.scale[1]*-s,e[4]=this.scale[1]*t,e[6]=this.offset[0],e[7]=this.offset[1]}}let w=0;class x{constructor(e){this.name=g,this.priority=-1,this.loader=e}wrapElement(e,t){e.createSampler=()=>{var s,r;const a=e;if(null===a._sampler){t.getMatrix(f);const i=null!==(s=t.texCoord)&&void 0!==s?s:e.texCoord,o=n.Z.getSemantics().getAttributeName(`TEXCOORD_${i}`),c=_.ZP.createTransformed(o,f),l=new m.Z4(`tex${null!==(r=this.name)&&void 0!==r?r:""}tt_${w++}`,c);a._sampler=l,e.texture.glTexturePromise.then((e=>l.set(e)))}return a._sampler}}acceptElement(e,t){if(e.extensions&&e.extensions[g]){A(t);const s=new E(e.extensions[g]);this.wrapElement(t,s)}return Promise.resolve(t)}loadElement(e){return null}}class T{constructor(){this.name=g}createInstance(e){return new x(e)}}var v=s(85645),b=s(76670),S=s(42307);const R=new Float32Array(4);class I extends S.Z{constructor(){super(),this._type=b.Z.DIRECTIONAL,this._camera=null,this._shadowmapNearOffset=0}projectionFromBounds(e){const t=this.boundsInLocalSpace(e),s=this._camera;s.lens.near=-t[5]-this._shadowmapNearOffset,s.lens.far=-t[2],s.lens.setBound(t[0],t[3],t[1],t[4])}getTexelBiasVector(){const e=this._camera.lens;return R[3]=Math.max(e._xMax-e._xMin,e._yMax-e._yMin),R}_createCamera(){return v.Z.makeOrthoCamera()}}var U=I,M=s(79785),P=s(89906);p.mat3.create();const C="KHR_lights_punctual";var y;(function(e){e["Directional"]="directional",e["Point"]="point",e["Spot"]="spot"})(y||(y={}));class L{constructor(){this.list=[],this._items=[]}addLight(e,t){this.list.push(e),this._items.push({name:t,index:this.list.length-1})}getLightByName(e){let t;for(let s=0;s<this._items.length;s++)if(this._items[s].name==e){t=this.list[this._items[s].index];break}return t}getLightsByName(e){const t=[];for(let s=0;s<this._items.length;s++)this._items[s].name==e&&t.push(this.list[this._items[s].index]);return t}}class D{constructor(e){this.name=C,this.priority=1,this.loader=e,this.lights=new L,e.gltf.extras.lights=this.lights}_getLightData(e){var t;const s=null===(t=this.loader._data.extensions)||void 0===t?void 0:t[C];if(void 0===s)throw new Error(C+" no extension data");return s.lights[e]}_createDirectional(e){return new U}_createPoint(e){var t;const s=new M.Z;return s.radius=null!==(t=e.range)&&void 0!==t?t:-1,s}_createSpot(e){var t,s,r,n,a;const i=new P.Z;return i.radius=null!==(t=e.range)&&void 0!==t?t:-1,i.innerAngle=null!==(r=null===(s=e.spot)||void 0===s?void 0:s.innerConeAngle)&&void 0!==r?r:0,i.outerAngle=null!==(a=null===(n=e.spot)||void 0===n?void 0:n.outerConeAngle)&&void 0!==a?a:0,i}_createLightInstance(e){switch(e.type){case y.Directional:return this._createDirectional(e);case y.Point:return this._createPoint(e);case y.Spot:return this._createSpot(e)}}_createLight(e,t){var s,r;const n=this._getLightData(t.light),a=this._createLightInstance(n),i=null!==(s=n.color)&&void 0!==s?s:[1,1,1],o=null!==(r=n.intensity)&&void 0!==r?r:1;i[0]*=o,i[1]*=o,i[2]*=o,a._color.set(i),e.add(a);const c=n.name;return this.lights.addLight(a,c),a}acceptElement(e,t){if(t.gltftype===a.Z.NODE&&e.extensions&&e.extensions[C]){const s=t;this._createLight(s,e.extensions[C])}return null}loadElement(e){return null}}class F{constructor(){this.name=C}createInstance(e){return new D(e)}}var Z=s(95893),B=s(36552),G=s(79e3),X=s(65497);class N{async parse(e,t){var s;this.diffuseFactor=new Float32Array(t.diffuseFactor||[1,1,1,1]),this.specularFactor=new Float32Array(t.specularFactor||[1,1,1]),this.glossinessFactor=null!==(s=t.glossinessFactor)&&void 0!==s?s:1,void 0!==t.diffuseTexture&&(e.prepareGltfProperty(t.diffuseTexture,a.Z.TEXTURE_INFO,-1,null),this.diffuseTexture=await e._loadElement(t.diffuseTexture)),void 0!==t.specularGlossinessTexture&&(e.prepareGltfProperty(t.specularGlossinessTexture,a.Z.TEXTURE_INFO,-1,null),this.specularGlossinessTexture=await e._loadElement(t.specularGlossinessTexture))}setupPass(e){const t=new B.Y$;if(e.setSurface(t),this.diffuseTexture){const s=this.diffuseTexture.createSampler("diffuse");s.colorspace=X.u.SRGB,t.baseColor.attach(s,"rgb"),e.alpha.attach(s,"a")}if(!(0,G.I)(this.diffuseFactor)){const s=new m.xW("uBasecolorFactor",4);s.set(...this.diffuseFactor),t.baseColorFactor.attach(s,"rgb"),e.alphaFactor.attach(s,"a")}if(this.specularGlossinessTexture){const e=this.specularGlossinessTexture.createSampler("specgloss");e.colorspace=X.u.SRGB,t.specular.attach(e,"rgb"),t.glossiness.attach(e,"a")}(0,G.I)(this.specularFactor)||t.specularFactor.attachUniform("uMetalnessFactor").set(...this.specularFactor),1!==this.glossinessFactor&&t.glossinessFactor.attachUniform("uRoughnessFactor").set(this.glossinessFactor)}}class O extends Z.Z{async parsePbrInputsData(e,t){const s=t.extensions["KHR_materials_pbrSpecularGlossiness"];this.pbrInputsData=this.pbrSpecularGlossiness=new N,await this.pbrSpecularGlossiness.parse(e,s)}}const V="KHR_materials_pbrSpecularGlossiness";class W{constructor(e){this.name=V,this.priority=1,this.loader=e}loadElement(e){if(e.gltftype===a.Z.MATERIAL&&e.extensions&&e.extensions[V]){const t=new O;return t.parse(this.loader,e).then((()=>t))}return null}acceptElement(e,t){return null}}class H{constructor(){this.name=V}createInstance(e){return new W(e)}}var k=s(33695);class Q extends Z.n{setupMaterials(){const e=new k.Z(this.name);if(e.glconfig.enableDepthTest(),e.glconfig.enableCullface(!this.doubleSided),e.doubleSided.set(this.doubleSided),this.configureAlpha(e),void 0!==this.pbrInputsData){const t=this.pbrInputsData;if(t.baseColorTexture&&t.baseColorTexture){const s=t.baseColorTexture.createSampler("basecolor");e.baseColor.attach(s,"rgb"),e.alpha.attach(s,"a")}if(!(0,G.I)(t.baseColorFactor)){const s=new m.xW("uBasecolorFactor",4);s.set(...t.baseColorFactor),e.baseColorFactor.attach(s,"rgb"),e.alphaFactor.attach(s,"a")}}this._materialPass=e}}const j="KHR_materials_unlit";class z{constructor(e){this.name=j,this.priority=1,this.loader=e}acceptElement(e,t){return null}loadElement(e){if(e.gltftype===a.Z.MATERIAL&&e.extensions&&e.extensions[j]){const t=new Q;return t.parse(this.loader,e).then((()=>t))}return null}}class K{constructor(){this.name=j}createInstance(e){return new z(e)}}var Y=s(45950),$=s(35183),J=s(24352);const q="KHR_texture_basisu";class ee extends Y.ZP{constructor(e){super(),this._decoder=e,this._decodePromise=null}get hasAlpha(){return!1}async loadImage(e){this._basisFile=await this.loadBuffer(e.abortSignal)}async loadBuffer(e){if(this.bufferView){const e=this.bufferView.getByteOffset();return this.bufferView.buffer._bytes.slice(e,e+this.bufferView.byteLength)}{const t=(0,J.mr)(e),s=await fetch(this.resolvedUri,{signal:t}),r=await s.arrayBuffer();return r}}decode(e){return null===this._decodePromise&&(this._decodePromise=this._decoder.decode(e,this._basisFile)),this._decodePromise}async setupTexture(e,t,s,r,n){const a=e.gl,{buffer:i,webglFormat:o,mipLevels:c}=await this.decode(a);a.bindTexture(a.TEXTURE_2D,e.id),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c.length>1||o.uncompressed?a.LINEAR_MIPMAP_LINEAR:a.LINEAR);let l=null;for(let h of c)if(o.uncompressed){switch(o.type){case WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4:case WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1:case WebGLRenderingContext.UNSIGNED_SHORT_5_6_5:l=new Uint16Array(i,h.offset,h.size/2);break;default:l=new Uint8Array(i,h.offset,h.size);break}a.texImage2D(a.TEXTURE_2D,h.level,o.format,h.width,h.height,0,o.format,o.type,l)}else l=new Uint8Array(i,h.offset,h.size),a.compressedTexImage2D(a.TEXTURE_2D,h.level,o.format,h.width,h.height,0,l);(0,Y.s5)(r)&&o.uncompressed&&1==c.length&&a.generateMipmap(a.TEXTURE_2D)}}class te extends $.Z{async parse(e,t){void 0!==t.sampler&&(this.sampler=await e.getElement(a.Z.SAMPLER,t.sampler));const s=t.extensions[q].source;this.source=await e.getElement(a.Z.IMAGE,s)}}class se{constructor(e,t){this._decoder=t,this.name=q,this.priority=1,this.loader=e}acceptElement(e,t){return null}loadElement(e){var t;if(e.gltftype===a.Z.IMAGE&&("image/ktx2"===e.mimeType||(null===(t=e.uri)||void 0===t?void 0:t.endsWith("ktx2")))){const t=new ee(this._decoder);return t.parse(this.loader,e).then((()=>t))}if(e.gltftype===a.Z.TEXTURE&&e.extensions&&e.extensions[q]){const t=new te;return t.parse(this.loader,e).then((()=>t))}return null}}class re{constructor(e){this.decoder=e,this.name=q}createInstance(e){return new se(e,this.decoder)}}var ne=s(66826);const ae=new Uint8Array([171,75,84,88,32,49,49,187,13,10,26,10]);function ie(e){for(let t=0;t<12;t++)if(e[t]!==ae[t])return!1;return!0}class oe{constructor(){this.parse=e=>{const t=new Uint8Array(e,0,12);if(!ie(t))throw new Error("[KTXParser] Bad Magic");const s=new DataView(e),r=67305985===s.getUint32(12,!0);let n=16;const a=s.getUint32(n,r);n+=4;s.getUint32(n,r);n+=4;s.getUint32(n,r);n+=4;const i=s.getUint32(n,r);n+=4;s.getUint32(n,r);n+=4;const o=s.getUint32(n,r);n+=4;const c=s.getUint32(n,r);n+=4;s.getUint32(n,r);n+=4;const l=s.getUint32(n,r);n+=4;const h=s.getUint32(n,r);n+=4;const u=s.getUint32(n,r);n+=4;const d=s.getUint32(n,r);n+=4,n+=d;const p=u>0?u:1,_=l>0?l:1,m=h>0?h:1,f=[];for(let g=0;g<m;g++)f.push([]);for(let g=0;g<p;g++){const e=s.getUint32(n,r);n+=4;const t=-4&e;for(let r=0;r<_;r++)for(let e=0;e<m;e++){const r=new Uint8Array(s.buffer,n,t);n+=t,f[e].push(r)}}return{width:o,height:c,surfaces:f,format:i,internalFormat:i,type:a,cubemap:!1}}}}var ce=s(13933),le=s(89133),he=s(55411);class ue{constructor(){this.parser=new oe}decodeLod(e,t,s){const r=this.parser.parse(s[0]),n=r.surfaces[0].map((e=>({width:r.width,height:r.height,data:e}))),a={datatype:ce.f9.RAW_COMPRESSED,textureType:le.N.TEXTURE_2D,width:r.width,height:r.height,internalformat:r.internalFormat,format:r.format,type:r.type,requireMipmapGen:!1,sources:[{surfaces:[n]}]};return Promise.resolve(a)}decodeCube(e,t){const s=this.parser.parse(t[0]),r=s.surfaces.map((e=>e.map((e=>({width:s.width,height:s.height,data:e}))))),n={datatype:ce.f9.RAW_COMPRESSED,textureType:le.N.TEXTURE_CUBE,width:s.width,height:s.height,internalformat:s.internalFormat,format:s.format,type:s.type,requireMipmapGen:!1,sources:[{surfaces:r}]};return Promise.resolve(n)}}class de extends ue{constructor(){super(...arguments),this.name="dxt"}isSupported(e){return Promise.resolve(null!=(0,he.Z)(e).textureExtensions.dxt)}}class pe extends ue{constructor(){super(...arguments),this.name="etc"}isSupported(e){return Promise.resolve(null!=(0,he.Z)(e).textureExtensions.etc)}}class _e extends ue{constructor(){super(...arguments),this.name="pvr"}isSupported(e){return Promise.resolve(null!=(0,he.Z)(e).textureExtensions.pvr)}}class me extends ue{constructor(){super(...arguments),this.name="astc"}isSupported(e){return Promise.resolve(null!=(0,he.Z)(e).textureExtensions.astc)}}var fe=s(68736);const ge=-1!==navigator.userAgent.indexOf("Chrome")&&void 0!==window.createImageBitmap;function Ae(e){const t=new Uint32Array(e,0,2);return 1196314761===t[0]?"image/png":"image/jpeg"}class Ee{constructor(){this.name="std"}decodeImage(e){const t=Ae(e);return Ee.decodeImage(e,t)}static decodeImage(e,t){void 0==t&&(t=Ae(e));const s=new Blob([e],{type:t});if(ge)return createImageBitmap(s,{premultiplyAlpha:"none"});{const e=new fe.Z,t=URL.createObjectURL(s),r=new Image;return r.onload=e.resolve,r.onerror=e.reject,r.src=t,e.promise.finally((()=>URL.revokeObjectURL(t))),e.promise.then((()=>r))}}async decodeLod(e,t,s,r){const n=await this.decodeImage(s[0]),a={width:n.width,height:n.height,data:n},i=r.alpha?6408:6407;return{datatype:ce.f9.IMAGE,format:i,internalformat:i,type:5121,textureType:le.N.TEXTURE_2D,width:n.width,height:n.height,requireMipmapGen:r.mipmap,sources:[{surfaces:[[a]]}]}}async decodeCube(e,t,s){const r=s.alpha?6408:6407,n={requireMipmapGen:s.mipmap,datatype:ce.f9.IMAGE,format:r,internalformat:r,type:5121,textureType:le.N.TEXTURE_CUBE,width:1024,height:1024,sources:[{surfaces:[]}]},a=t.length/6;if(a!==Math.floor(a))throw new Error(`${t.length} is invalid number of buffers for cube texture, must be a multiple of 6`);n.sources[0].surfaces=[[],[],[],[],[],[]];for(let i=0;i<a;i++)for(let e=0;e<6;e++){const s=await this.decodeImage(t[e+6*i]),r={width:s.width,height:s.height,data:s};n.sources[0].surfaces[e].push(r)}return Promise.resolve(n)}isSupported(){return Promise.resolve(!0)}}class we extends Ee{constructor(){super(...arguments),this.name="webp"}isSupported(){return l()}}var xe=s(22999);function Te(e){return void 0!==e.error}class ve{get promise(){return this.deferred.promise}constructor(){this.deferred=new fe.Z}}class be{static getInstance(){return void 0===this._instance&&(this._instance=new be),this._instance}constructor(e){this.pendingTextures={},this.nextPendingTextureId=1,this.allowSeparateAlpha=!1,void 0===e&&(e=(0,xe.Z)("js/basis.worker.js")),this.worker=new Worker(e),this.worker.onmessage=e=>{const t=e.data,s=this.pendingTextures[e.data.id];return s?(delete this.pendingTextures[t.id],Te(t)?(console.error(`Basis transcode failed: ${t.error}`),void s.deferred.reject(`${t.error}`)):void s.deferred.resolve(t)):(Te(t)&&console.error(`Basis transcode failed: ${t.error}`),void console.error(`Invalid pending texture ID: ${t.id}`))}}decode(e,t){const s=new ve;return this.pendingTextures[this.nextPendingTextureId]=s,this.worker.postMessage({id:this.nextPendingTextureId,buffer:t,allowSeparateAlpha:this.allowSeparateAlpha,supportedFormats:Se(e)},[t]),this.nextPendingTextureId++,s.promise}static setupTexture(e,t){const s=t.gl,{buffer:r,webglFormat:n,mipLevels:a}=e;s.bindTexture(s.TEXTURE_2D,t.id),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a.length>1||n.uncompressed?s.LINEAR_MIPMAP_LINEAR:s.LINEAR);let i=null;t.width=e.mipLevels[0].width,t.height=e.mipLevels[0].height;for(const o of a)if(n.uncompressed){switch(n.type){case WebGLRenderingContext.UNSIGNED_SHORT_4_4_4_4:case WebGLRenderingContext.UNSIGNED_SHORT_5_5_5_1:case WebGLRenderingContext.UNSIGNED_SHORT_5_6_5:i=new Uint16Array(r,o.offset,o.size/2);break;default:i=new Uint8Array(r,o.offset,o.size);break}s.texImage2D(s.TEXTURE_2D,o.level,n.format,o.width,o.height,0,n.format,n.type,i)}else i=new Uint8Array(r,o.offset,o.size),s.compressedTexImage2D(s.TEXTURE_2D,o.level,n.format,o.width,o.height,0,i)}}function Se(e){return{s3tc:!!e.getExtension("WEBGL_compressed_texture_s3tc"),etc1:!!e.getExtension("WEBGL_compressed_texture_etc1"),etc2:!!e.getExtension("WEBGL_compressed_texture_etc"),pvrtc:!!e.getExtension("WEBGL_compressed_texture_pvrtc"),astc:!!e.getExtension("WEBGL_compressed_texture_astc"),bptc:!!e.getExtension("EXT_texture_compression_bptc")}}class Re{constructor(){this.name="basis"}async decodeLod(e,t,s){const r=await be.getInstance().decode(this.gl,s[0]),n=r.mipLevels.map((e=>({width:e.width,height:e.height,data:new Uint8Array(r.buffer,e.offset,e.size)}))),a={datatype:!0===r.webglFormat.uncompressed?ce.f9.RAW:ce.f9.RAW_COMPRESSED,textureType:le.N.TEXTURE_2D,width:r.mipLevels[0].width,height:r.mipLevels[0].height,internalformat:r.webglFormat.format,format:r.webglFormat.format,type:r.webglFormat.type,requireMipmapGen:!1,sources:[{surfaces:[n]}]};return Promise.resolve(a)}decodeCube(){throw new Error("Method not implemented.")}isSupported(e){this.gl=e;const t=(0,he.Z)(e).textureExtensions,s=null!=t.dxt||null!=t.etc||null!=t.pvr;return Promise.resolve(s)}}r.Z.debug=!1,ne.V.registerCodec(new Ee),ne.V.registerCodec(new we),ne.V.registerCodec(new de),ne.V.registerCodec(new pe),ne.V.registerCodec(new _e),ne.V.registerCodec(new me),ne.V.registerCodec(new Re),n.Z.addExtension(new T),n.Z.addExtension(new d),n.Z.addExtension(new F),n.Z.addExtension(new K),n.Z.addExtension(new H),n.Z.addExtension(new re(be.getInstance()))},66826:function(e,t,s){"use strict";s.d(t,{V:function(){return r}});class r{static registerCodec(e){void 0===this._codecs[e.name]?this._codecs[e.name]=e:console.warn(`TextureCodec.registerCodec() Codec ${e.name} already exist`)}static async getCodecForRequest(e,t){const s=e.sources;for(const r of s){const e=this._codecs[r.codec];if(void 0!==e){const s=await e.isSupported(t);if(s)return[e,r]}}return null}}r._codecs={}},13933:function(e,t,s){"use strict";var r,n;function a(e){switch(e){case 0:return r.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return r.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return r.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return r.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return r.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return r.TEXTURE_CUBE_MAP_NEGATIVE_Z}}s.d(t,{bv:function(){return a},f9:function(){return n}}),function(e){e[e["TEXTURE_CUBE_MAP_POSITIVE_X"]=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e["TEXTURE_CUBE_MAP_NEGATIVE_X"]=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e["TEXTURE_CUBE_MAP_POSITIVE_Y"]=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Y"]=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e["TEXTURE_CUBE_MAP_POSITIVE_Z"]=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Z"]=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(r||(r={})),function(e){e[e["RAW"]=0]="RAW",e[e["RAW_COMPRESSED"]=1]="RAW_COMPRESSED",e[e["IMAGE"]=2]="IMAGE"}(n||(n={}))}}]);
//# sourceMappingURL=9278.9bd9486a.js.map