import{u as V,P as N,U as q,aX as D,aY as g,B as w,aZ as F,r as _,o as c,c as m,w as p,F as A,a as G,b as t,O as b,G as S,H as v,aj as I,y as T,f as K,n as U,a_ as X,a1 as Y}from"./CmfzVdrr.js";import{_ as Z}from"./CpY-ecYb.js";const J=["media","srcset","format"],Q=["src","alt","loading","width","height"],R={key:0,class:"placeholder"},W=["srcset","format","media"],ee=["src","width","height"],te=["innerHTML"],ae=1,le={__name:"Image",props:{caption:{type:String,default:""},showCaption:{type:Boolean,default:!1},placeholder:{type:String,default:""},showPlaceholder:{type:Boolean,default:!0},srcs:{type:Object,default:{}},url:{type:String,default:""},width:{type:Number,default:()=>{}},height:{type:Number,default:()=>{}},alt:{type:String,default:""},mobile:{type:Object,default:()=>{}},theme:{type:String,default:""},lazy:{type:Boolean,default:!0},format:{type:String,default:"image/webp"},ratio:{type:Array,default:[]}},emits:["loaded"],setup(a,{emit:z}){var O;const s=a,x=z,L=V(),d=N(),i=N(!0),h=(O=s.mobile)==null?void 0:O.url,r=g(X.breakpoint.m),P=()=>{d.value&&(d.value.src=l.value.url)};q(()=>{D(()=>{var e;i.value=!((e=d.value)!=null&&e.complete),i.value||x("loaded")})});const E=()=>{var e;i.value=!((e=d.value)!=null&&e.complete),i.value||x("loaded")},k=[...h?Object.keys(s.mobile.srcs):[],...Object.keys(s.srcs)].reduce((e,o)=>(e[g(o)]=h&&g(o)<=r?s.mobile.srcs[o]:s.srcs[o],e),{}),f=Object.keys(k).map(g).sort((e,o)=>e-o),B=f.reduce((e,o,u)=>{const n=u===f.length-1?f[u-1]:o,y=h?n>r?Math.max(n,r+1):n:n*ae;return e[o]={srcs:k[o],media:`(${u===f.length-1?"min":"max"}-width: ${y}px)`},e},{});h&&(B[r]={srcs:s.mobile.srcs.w1600,media:`(max-width: ${r}px)`});const l=w(()=>{var e;return!L.m&&((e=s.mobile)!=null&&e.url)?s.mobile:s}),C=w(()=>s.ratio.length?s.ratio:[l.value.width,l.value.height]),H=w(()=>F()?l.value.url:void 0);return(e,o)=>{const u=Y,n=Z,y=_("visible"),$=_("ratio"),j=_("lay");return c(),m("figure",{class:U(["figure",a.theme])},[p((c(),m("picture",null,[(c(!0),m(A,null,G(t(B),M=>(c(),m("source",{media:M.media,srcset:M.srcs,format:`${a.format}`},null,8,J))),256)),p(b("img",{ref_key:"img",ref:d,src:t(H),alt:a.alt,loading:a.lazy?"lazy":"eager",onError:P,onLoad:E,width:t(l).width,height:t(l).height},null,40,Q),[[y,!t(i)],[$,t(C)]]),S(u,null,{default:v(()=>[S(I,{name:"fade"},{default:v(()=>[a.showPlaceholder&&t(i)?p((c(),m("picture",R,[b("source",{srcset:a.mobile.placeholder,format:`${a.format}`,media:`(max-width: ${t(r)}px)`},null,8,W),p(b("img",{src:a.placeholder,width:t(l).width,height:t(l).height},null,8,ee),[[$,t(C)]])])),[[j]]):T("",!0)]),_:1})]),_:1})])),[[j,{dir:"o",enabled:a.showPlaceholder}]]),a.showCaption&&t(l).caption?(c(),K(n,{key:0,tag:"figcaption"},{default:v(()=>[b("div",{innerHTML:t(l).caption},null,8,te)]),_:1})):T("",!0)],2)}}};export{le as default};
