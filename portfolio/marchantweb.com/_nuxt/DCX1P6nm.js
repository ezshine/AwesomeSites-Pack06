import{m as i,a2 as l,E as f,a as v,s as o}from"./BNj6qnUa.js";import{r as s}from"./5RneVIuN.js";let a;function m(t={}){const e=i("_preview-state",()=>({enabled:!1,state:{}}));if(e.value._initialized)return{enabled:l(e.value,"enabled"),state:e.value.state};if(e.value._initialized=!0,!e.value.enabled){const u=(t.shouldEnable??d)(e.value.state);typeof u=="boolean"&&(e.value.enabled=u)}return f(()=>e.value.enabled,n=>{if(n){const r=(t.getState??b)(e.value.state);r!==e.value.state&&Object.assign(e.value.state,r),a||((t.onEnable??s)(),a=t.onDisable??v().afterEach(()=>s()))}else a&&(a(),a=void 0)},{immediate:!0,flush:"sync"}),{enabled:l(e.value,"enabled"),state:e.value.state}}function d(){return o().query["preview"]==="true"}function b(t){if(t.token!==void 0)return t;const e=o();return t.token=Array.isArray(e.query.token)?e.query.token[0]:e.query.token,t}export{m as u};
