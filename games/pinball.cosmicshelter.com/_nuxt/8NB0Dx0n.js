var cr=Object.defineProperty;var Ar=(o,e,t)=>e in o?cr(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var M=(o,e,t)=>Ar(o,typeof e!="symbol"?e+"":e,t);import{a7 as hr,a8 as $,a9 as ur,aa as dr,ab as sa,ac as pr,ad as ct,ae as gr,af as ho,ag as Mi,ah as fr,ai as vi,aj as mr,ak as vr,al as _r,am as Cr,an as yr,ao as Er,ap as Ir,aq as xr,ar as br,as as Ts,at as bt,au as uo,av as Br,aw as po,ax as ot,ay as Sr,az as wr,aA as on,aB as ji,aC as Si,aD as rn,aE as go,aF as Mr,aG as Je,aH as T,q as Qr,U as _e,aI as fo,aJ as as,aK as ks,aL as U,aM as dt,aN as Nt,aO as je,aP as O,aQ as mo,aR as It,aS as Dr,aT as Pr,aU as Lr,aV as Rr,aW as Tr,aX as Nr,aY as Fr,aZ as Ur,a_ as Or,a$ as kr,b0 as Gr,b1 as ln,b2 as cn,E as R,b3 as Hr,b4 as zr,b5 as vo,b6 as qr,b7 as Vr,b8 as Ei,b9 as Ii,ba as gt,bb as An,bc as Jt,bd as si,be as Wr,bf as Ci,bg as Yr,bh as Zi,bi as Ya,bj as At,bk as $e,bl as ds,bm as Pt,bn as Ks,bo as Ni,bp as Ft,bq as ja,br as jr,bs as Xr,bt as Kr,bu as rs,bv as N,bw as Mt,bx as Jr,by as zt,bz as hn,bA as Zr,bB as _o,bC as Co,bD as ai,bE as $r,bF as el,bG as tl,bH as il,bI as sl,bJ as al,a2 as nl,bK as ol,bL as rl,bM as ll,bN as cl,bO as Al,bP as hl,R as yo,bQ as ul,bR as dl,bS as St,_ as pl,a as aa,r as gl,o as fl,e as ml,v as vl,x as _l}from"./CtWWdujy.js";import{a as Js,f as ls,c as Ct,l as Rt,u as Cl,m as un,b as yl,D as dn}from"./Caa45xAu.js";class Zs extends hr{constructor(e={}){super(),this._progress=0,this._preloadedResources=0,this._isComplete=!1,this._name=e.name,this._namespace=e.namespace,this._resources=this._setupResources(),this._bindAll()}get resources(){return this._resources}get isComplete(){return this._isComplete}get(e){for(let t=0;t<this._resources.length;t++)if(this._resources[t].name===e)return this._resources[t].data;console.error(`Resource manager "${this._namespace}" : Couln't find resource with name "${e}"`)}add(e){if(Array.isArray(e)){this._addMultiple(e);return}if(this._isResourceAdded(e)){console.warn(`Resource manager "${this._namespace}" : Resource with same name or path has already been added for "${e.name}"`);return}this._resources.push(e),$.resources.push(e)}addByName(e){if(Array.isArray(e)){this._addByNames(e);return}let t=null;for(let i=0;i<$.resources.length;i++){const s=$.resources[i];if(e===s.name){if(this._isResourceAdded(s)){console.warn(`Resource manager "${this._namespace}" : Resource with name "${s.name}" has already been added`),t=void 0;continue}this._resources.push(s),t=s;return}}t===null&&console.warn(`Resource manager "${this._namespace}" : Could not find any resource with name "${e}"`)}load(){const e=[];this._preloadStartHandler();for(let t=0;t<this._resources.length;t++){const i=this._resources[t],s=$.load(i);s.then(this._preloadProgressHandler,this._preloadErrorHandler),e.push(s)}return Promise.all(e).then(this._preloadCompleteHandler)}destroy(){this._progress=null,this._preloadedResources=null,this._name=null,this._namespace=null,this._resources=null}_setupResources(){const e=[];for(let t=0;t<$.resources.length;t++){const i=$.resources[t];(i.preload||i.namespace===this._namespace&&i.namespace!==void 0)&&e.push(i)}return e}_addMultiple(e){for(let t=0;t<e.length;t++){const i=e[t];if(this._isResourceAdded(i)){console.warn(`Resource manager "${this._namespace}" : Resource with same name or path has already been added for "${i.name}"`);return}this._resources.push(i),$.resources.push(i)}}_addByNames(e){for(let t=0;t<$.resources.length;t++){const i=$.resources[t];if(!e.includes(i.name))continue;if(this._isResourceAdded(i)){console.warn(`Resource manager "${this._namespace}" : Resource with same name or path has already been added for "${i.name}"`);const a=e.indexOf(i.name);e.splice(a,1);continue}this._resources.push(i);const s=e.indexOf(i.name);e.splice(s,1)}e.length>0&&console.warn(`Resource manager "${this._namespace}" : Could not find any resource with following name(s) : ${e.join(", ")}`)}_bindAll(){ur(this,"_preloadCompleteHandler","_preloadErrorHandler","_preloadProgressHandler")}_preloadStartHandler(){this.dispatchEvent("start",null)}_preloadProgressHandler(e){this._preloadedResources++,this._progress=this._preloadedResources/this._resources.length,this.dispatchEvent("progress",this._progress)}_preloadCompleteHandler(e){this._isComplete=!0,this.dispatchEvent("complete",e)}_preloadErrorHandler(){console.error(`Resource manager ${this._namespace} : something went wrong while preloading resources`)}_isResourceAdded(e){for(let t=0;t<this._resources.length;t++)if(this._resources[t].type===e.type&&(this._resources[t].name===e.name||this._resources[t].path===e.path))return!0}}class Fi{constructor(e,t,i){this._name=e,this._bgColor=i,this._fgColor=t,this._setup()}get dom(){return this._dom}update(e,t){const i=Math.min(this._min,e),s=Math.max(this._max,e);this._context.fillStyle=this._bgColor,this._context.globalAlpha=1,this._context.fillRect(0,0,this._WIDTH,this._GRAPH_Y),this._context.fillStyle=this._fgColor,this._context.fillText(Math.round(e)+" "+this._name+" ("+Math.round(i)+"-"+Math.round(s)+")",this._TEXT_X,this._TEXT_Y),this._context.drawImage(this._dom,this._GRAPH_X+this._PR,this._GRAPH_Y,this._GRAPH_WIDTH-this._PR,this._GRAPH_HEIGHT,this._GRAPH_X,this._GRAPH_Y,this._GRAPH_WIDTH-this._PR,this._GRAPH_HEIGHT),this._context.fillRect(this._GRAPH_X+this._GRAPH_WIDTH-this._PR,this._GRAPH_Y,this._PR,this._GRAPH_HEIGHT),this._context.fillStyle=this._bgColor,this._context.globalAlpha=.9,this._context.fillRect(this._GRAPH_X+this._GRAPH_WIDTH-this._PR,this._GRAPH_Y,this._PR,Math.round((1-e/t)*this._GRAPH_HEIGHT))}_setup(){this._min=1/0,this._max=0,this._PR=Math.round(window.devicePixelRatio||1),this._WIDTH=80*this._PR,this._HEIGHT=48*this._PR,this._TEXT_X=3*this._PR,this._TEXT_Y=2*this._PR,this._GRAPH_X=3*this._PR,this._GRAPH_Y=15*this._PR,this._GRAPH_WIDTH=74*this._PR,this._GRAPH_HEIGHT=30*this._PR,this._dom=document.createElement("canvas"),this._dom.width=this._WIDTH,this._dom.height=this._HEIGHT,this._dom.style.cssText="width:80px;height:48px",this._context=this._dom.getContext("2d"),this._context.font="bold "+9*this._PR+"px Helvetica,Arial,sans-serif",this._context.textBaseline="top",this._context.fillStyle=this._bgColor,this._context.fillRect(0,0,this._WIDTH,this._HEIGHT),this._context.fillStyle=this._fgColor,this._context.fillText(this._name,this._TEXT_X,this._TEXT_Y),this._context.fillRect(this._GRAPH_X,this._GRAPH_Y,this._GRAPH_WIDTH,this._GRAPH_HEIGHT),this._context.fillStyle=this._bgColor,this._context.globalAlpha=.9,this._context.fillRect(this._GRAPH_X,this._GRAPH_Y,this._GRAPH_WIDTH,this._GRAPH_HEIGHT)}}class El{constructor(e){this._renderer=e,this._setup()}get domContainer(){return this._domContainer}destroy(){this._removeEventListeners()}begin(){this._beginTime=(self.performance||Date).now()}end(){this._frames++,this._panels.drawCalls.update(this._renderer.info.render.calls,200);const e=(self.performance||Date).now();if(this._panels.ms.update(e-this._beginTime,200),e>=this._prevTime+1e3&&(this._panels.fps.update(this._frames*1e3/(e-this._prevTime),144),this._prevTime=e,this._frames=0,this._panels.mem)){const t=self.performance.memory;this._panels.mem.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}}gpuStartQuery(){if(this._extension===null)return;let e;this._isWebGL2?(e=this._context.createQuery(),this._context.beginQuery(this._extension.TIME_ELAPSED_EXT,e)):(e=this._extension.createQueryEXT(),this._extension.beginQueryEXT(this._extension.TIME_ELAPSED_EXT,e)),this._activeQueries++;const t=()=>{let i,s,a;this._isWebGL2?(i=this._context.getQueryParameter(e,this._context.QUERY_RESULT_AVAILABLE),s=this._context.getParameter(this._extension.GPU_DISJOINT_EXT),a=this._context.getQueryParameter(e,this._context.QUERY_RESULT)):(i=this._extension.getQueryObjectEXT(e,this._extension.QUERY_RESULT_AVAILABLE_EXT),s=this._context.getParameter(this._extension.GPU_DISJOINT_EXT),a=this._extension.getQueryObjectEXT(e,this._extension.QUERY_RESULT_EXT));const n=a*1e-6;i?(s||this._panels.gpu.update(n,this._maxTime),this._activeQueries--):this._context.isContextLost()===!1&&requestAnimationFrame(t)};requestAnimationFrame(t)}gpuEndQuery(){this._extension!==null&&(this._isWebGL2?this._context.endQuery(this._extension.TIME_ELAPSED_EXT):this._extension.endQueryEXT(this._extension.TIME_ELAPSED_EXT))}addPanel(e){return this._domContainer.appendChild(e.dom),e}showPanel(e){for(let t=0;t<this._domContainer.children.length;t++)this._domContainer.children[t].style.display=t===e?"block":"none";this._mode=e}_setup(){this._context=this._renderer.getContext(),this._beginTime=(self.performance||Date).now(),this._prevTime=this._beginTime,this._maxTime=30,this._frames=0,this._activeQueries=0,this._isWebGL2=!0,this._settings={id:0},this._extension=this._createExtension(),this._domContainer=this._createDomContainer(),this._panels=this._createPanels(),this._bindAll(),this._setupEventListeners()}_createDomContainer(){return this._domContainer=document.createElement("div"),this._domContainer.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:90000",this._domContainer}_createPanels(){const e={};e.drawCalls=new Fi("DRW","#f50","#200"),this.addPanel(e.drawCalls),e.fps=new Fi("FPS","#0ff","#002"),this.addPanel(e.fps),e.ms=new Fi("MS","#0f0","#020"),this.addPanel(e.ms),this._extension&&(e.gpu=new Fi("GPU","#fc0","#210"),this.addPanel(e.gpu)),self.performance&&self.performance.memory&&(e.mem=new Fi("MB","#f08","#201"),this.addPanel(e.mem));const t=JSON.parse(localStorage.getItem("stats-panel"));return(t==null?void 0:t.id)>this._domContainer.children.length&&(t.id=0),this.showPanel((t==null?void 0:t.id)||0),e}_createExtension(){let e=this._context.getExtension("EXT_disjoint_timer_query_webgl2");return e||(this._isWebGL2=!1,e=this._context.getExtension("EXT_disjoint_timer_query"),e||console.log("GPUStatsPanel: disjoint_time_query extension not available.")),e}_bindAll(){this._clickHandler=this._clickHandler.bind(this)}_setupEventListeners(){this._domContainer.addEventListener("click",this._clickHandler)}_removeEventListeners(){this._domContainer.removeEventListener("click",this._clickHandler)}_clickHandler(e){e.preventDefault(),this._settings.id=(this._mode+1)%this._domContainer.children.length,this.showPanel(this._settings.id),localStorage.setItem("stats-panel",JSON.stringify(this._settings))}}class Il{constructor(){this.data={},this.listeners={},this.fireAtStart={},this.instances=[],this.globals={}}on(e,t){this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)}off(e,t){e in this.listeners&&this.listeners[e].splice(this.listeners[e].indexOf(t),1)}register(e){this.instances.push(e);for(const t in this.fireAtStart)this.fireMethod(e,t)}unregister(e){const t=this.instances.indexOf(e);t>-1&&this.instances.splice(t,1)}nameToMethod(e){return`on${e.charAt(0).toUpperCase()+e.slice(1)}`}fireMethod(e,t){const i=e[this.nameToMethod(t)];typeof i=="function"&&i.call(e,this.data[t])}trigger({name:e,fireAtStart:t=!1,log:i=!1},s={}){if(this.data[e]=s,t&&(this.fireAtStart[e]=!0),i&&console.log(`👨‍🏫 ${e} – ${s}`),e in this.listeners)for(let a=0;a<this.listeners[e].length;a++)this.listeners[e][a].call(this,s);this.instances.forEach(a=>this.fireMethod(a,e))}registerGlobal(e,t){this.globals[`$${e}`]=t}}const et=new Il;function we(o=class{}){return class extends o{constructor(...e){super(...e),Object.assign(this,et.globals),this._args=e,this.init&&this.init(...e),et.register(this)}destroy(){et.unregister(this)}}}class xl{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const i=this.workersResolve[e];if(i&&i(t),this.queue.length){const{resolve:s,msg:a,transfer:n}=this.queue.shift();this.workersResolve[e]=s,this.workers[e].postMessage(a,n)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise(i=>{const s=this._getIdleWorker();s!==-1?(this._initWorker(s),this.workerStatus|=1<<s,this.workersResolve[s]=i,this.workers[s].postMessage(e,t)):this.queue.push({resolve:i,msg:e,transfer:t})})}dispose(){this.workers.forEach(e=>e.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const bl=0,pn=2,Bl=1,gn=2,Sl=0,wl=1,Ml=10,Ql=0,Eo=9,Io=15,xo=16,bo=22,Bo=37,So=43,wo=76,Mo=83,Qo=97,Do=100,Po=103,Lo=109,Ro=165,To=166;class Dl{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Ui{constructor(e,t,i,s){this._dataView=new DataView(e.buffer,e.byteOffset+t,i),this._littleEndian=s,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const i=this._offset;let s=0;for(;this._dataView.getUint8(this._offset)!==t&&s<e;)s++,this._offset++;return s<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+i,s)}}const lt=[171,75,84,88,32,50,48,187,13,10,26,10];function fn(o){return typeof TextDecoder<"u"?new TextDecoder().decode(o):Buffer.from(o).toString("utf8")}function Pl(o){const e=new Uint8Array(o.buffer,o.byteOffset,lt.length);if(e[0]!==lt[0]||e[1]!==lt[1]||e[2]!==lt[2]||e[3]!==lt[3]||e[4]!==lt[4]||e[5]!==lt[5]||e[6]!==lt[6]||e[7]!==lt[7]||e[8]!==lt[8]||e[9]!==lt[9]||e[10]!==lt[10]||e[11]!==lt[11])throw new Error("Missing KTX 2.0 identifier.");const t=new Dl,i=17*Uint32Array.BYTES_PER_ELEMENT,s=new Ui(o,lt.length,i,!0);t.vkFormat=s._nextUint32(),t.typeSize=s._nextUint32(),t.pixelWidth=s._nextUint32(),t.pixelHeight=s._nextUint32(),t.pixelDepth=s._nextUint32(),t.layerCount=s._nextUint32(),t.faceCount=s._nextUint32();const a=s._nextUint32();t.supercompressionScheme=s._nextUint32();const n=s._nextUint32(),r=s._nextUint32(),l=s._nextUint32(),h=s._nextUint32(),c=s._nextUint64(),A=s._nextUint64(),d=new Ui(o,lt.length+i,3*a*8,!0);for(let P=0;P<a;P++)t.levels.push({levelData:new Uint8Array(o.buffer,o.byteOffset+d._nextUint64(),d._nextUint64()),uncompressedByteLength:d._nextUint64()});const m=new Ui(o,n,r,!0),p={vendorId:m._skip(4)._nextUint16(),descriptorType:m._nextUint16(),versionNumber:m._nextUint16(),descriptorBlockSize:m._nextUint16(),colorModel:m._nextUint8(),colorPrimaries:m._nextUint8(),transferFunction:m._nextUint8(),flags:m._nextUint8(),texelBlockDimension:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],bytesPlane:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],samples:[]},f=(p.descriptorBlockSize/4-6)/4;for(let P=0;P<f;P++){const V={bitOffset:m._nextUint16(),bitLength:m._nextUint8(),channelType:m._nextUint8(),samplePosition:[m._nextUint8(),m._nextUint8(),m._nextUint8(),m._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&V.channelType?(V.sampleLower=m._nextInt32(),V.sampleUpper=m._nextInt32()):(V.sampleLower=m._nextUint32(),V.sampleUpper=m._nextUint32()),p.samples[P]=V}t.dataFormatDescriptor.length=0,t.dataFormatDescriptor.push(p);const _=new Ui(o,l,h,!0);for(;_._offset<h;){const P=_._nextUint32(),V=_._scan(P),G=fn(V),Ue=_._scan(P-V.byteLength);t.keyValue[G]=G.match(/^ktx/i)?fn(Ue):Ue,_._offset%4&&_._skip(4-_._offset%4)}if(A<=0)return t;const E=new Ui(o,c,A,!0),x=E._nextUint16(),y=E._nextUint16(),C=E._nextUint32(),u=E._nextUint32(),I=E._nextUint32(),w=E._nextUint32(),L=[];for(let P=0;P<a;P++)L.push({imageFlags:E._nextUint32(),rgbSliceByteOffset:E._nextUint32(),rgbSliceByteLength:E._nextUint32(),alphaSliceByteOffset:E._nextUint32(),alphaSliceByteLength:E._nextUint32()});const k=c+E._offset,J=k+C,j=J+u,q=j+I,pe=new Uint8Array(o.buffer,o.byteOffset+k,C),ve=new Uint8Array(o.buffer,o.byteOffset+J,u),ee=new Uint8Array(o.buffer,o.byteOffset+j,I),Me=new Uint8Array(o.buffer,o.byteOffset+q,w);return t.globalData={endpointCount:x,selectorCount:y,imageDescs:L,endpointsData:pe,selectorsData:ve,tablesData:ee,extendedData:Me},t}let na,Yt,Oa;const oa={env:{emscripten_notify_memory_growth:function(o){Oa=new Uint8Array(Yt.exports.memory.buffer)}}};class Ll{init(){return na||(na=typeof fetch<"u"?fetch("data:application/wasm;base64,"+mn).then(e=>e.arrayBuffer()).then(e=>WebAssembly.instantiate(e,oa)).then(this._init):WebAssembly.instantiate(Buffer.from(mn,"base64"),oa).then(this._init),na)}_init(e){Yt=e.instance,oa.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!Yt)throw new Error("ZSTDDecoder: Await .init() before decoding.");const i=e.byteLength,s=Yt.exports.malloc(i);Oa.set(e,s),t=t||Number(Yt.exports.ZSTD_findDecompressedSize(s,i));const a=Yt.exports.malloc(t),n=Yt.exports.ZSTD_decompress(a,t,s,i),r=Oa.slice(a,a+n);return Yt.exports.free(s),Yt.exports.free(a),r}}const mn="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ",ra=new WeakMap;let la=0,ca;class Tt extends dr{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new xl,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}async detectSupportAsync(e){return this.workerConfig={astcSupported:await e.hasFeatureAsync("texture-compression-astc"),etc1Supported:await e.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await e.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await e.hasFeatureAsync("texture-compression-bc"),bptcSupported:await e.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await e.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(e){return e.isWebGPURenderer===!0?this.workerConfig={astcSupported:e.hasFeature("texture-compression-astc"),etc1Supported:e.hasFeature("texture-compression-etc1"),etc2Supported:e.hasFeature("texture-compression-etc2"),dxtSupported:e.hasFeature("texture-compression-bc"),bptcSupported:e.hasFeature("texture-compression-bptc"),pvrtcSupported:e.hasFeature("texture-compression-pvrtc")}:(this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1)),this}init(){if(!this.transcoderPending){const e=new sa(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),i=new sa(this.manager);i.setPath(this.transcoderPath),i.setResponseType("arraybuffer"),i.setWithCredentials(this.withCredentials);const s=i.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,s]).then(([a,n])=>{const r=Tt.BasisWorker.toString(),l=["/* constants */","let _EngineFormat = "+JSON.stringify(Tt.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(Tt.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Tt.BasisFormat),"/* basis_transcoder.js */",a,"/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([l])),this.transcoderBinary=n,this.workerPool.setWorkerCreator(()=>{const h=new Worker(this.workerSourceURL),c=this.transcoderBinary.slice(0);return h.postMessage({type:"init",config:this.workerConfig,transcoderBinary:c},[c]),h})}),la>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),la++}return this.transcoderPending}load(e,t,i,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const a=new sa(this.manager);a.setResponseType("arraybuffer"),a.setWithCredentials(this.withCredentials),a.load(e,n=>{if(ra.has(n))return ra.get(n).promise.then(t).catch(s);this._createTexture(n).then(r=>t?t(r):null).catch(s)},i,s)}_createTextureFrom(e,t){const{faces:i,width:s,height:a,format:n,type:r,error:l,dfdFlags:h}=e;if(r==="error")return Promise.reject(l);let c;if(t.faceCount===6)c=new pr(i,n,ct);else{const A=i[0].mipmaps;c=t.layerCount>1?new gr(A,s,a,t.layerCount,n,ct):new ho(A,s,a,n,ct)}return c.minFilter=i[0].mipmaps.length===1?Mi:fr,c.magFilter=Mi,c.generateMipmaps=!1,c.needsUpdate=!0,c.colorSpace=No(t),c.premultiplyAlpha=!!(h&Bl),c}async _createTexture(e,t={}){const i=Pl(new Uint8Array(e));if(i.vkFormat!==Ql)return Tl(i);const s=t,a=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:s},[e])).then(n=>this._createTextureFrom(n.data,i));return ra.set(e,{promise:a}),a}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),la--,this}}Tt.BasisFormat={ETC1S:0,UASTC_4x4:1};Tt.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16};Tt.EngineFormat={RGBAFormat:vi,RGBA_ASTC_4x4_Format:mr,RGBA_BPTC_Format:vr,RGBA_ETC2_EAC_Format:_r,RGBA_PVRTC_4BPPV1_Format:Cr,RGBA_S3TC_DXT5_Format:yr,RGB_ETC1_Format:Er,RGB_ETC2_Format:Ir,RGB_PVRTC_4BPPV1_Format:xr,RGB_S3TC_DXT1_Format:br};Tt.BasisWorker=function(){let o,e,t;const i=_EngineFormat,s=_TranscoderFormat,a=_BasisFormat;self.addEventListener("message",function(p){const f=p.data;switch(f.type){case"init":o=f.config,n(f.transcoderBinary);break;case"transcode":e.then(()=>{try{const{faces:_,buffers:E,width:x,height:y,hasAlpha:C,format:u,dfdFlags:I}=r(f.buffer);self.postMessage({type:"transcode",id:f.id,faces:_,width:x,height:y,hasAlpha:C,format:u,dfdFlags:I},E)}catch(_){console.error(_),self.postMessage({type:"error",id:f.id,error:_.message})}});break}});function n(p){e=new Promise(f=>{t={wasmBinary:p,onRuntimeInitialized:f},BASIS(t)}).then(()=>{t.initializeBasis(),t.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function r(p){const f=new t.KTX2File(new Uint8Array(p));function _(){f.close(),f.delete()}if(!f.isValid())throw _(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");const E=f.isUASTC()?a.UASTC_4x4:a.ETC1S,x=f.getWidth(),y=f.getHeight(),C=f.getLayers()||1,u=f.getLevels(),I=f.getFaces(),w=f.getHasAlpha(),L=f.getDFDFlags(),{transcoderFormat:k,engineFormat:J}=A(E,x,y,w);if(!x||!y||!u)throw _(),new Error("THREE.KTX2Loader:	Invalid texture");if(!f.startTranscoding())throw _(),new Error("THREE.KTX2Loader: .startTranscoding failed");const j=[],q=[];for(let pe=0;pe<I;pe++){const ve=[];for(let ee=0;ee<u;ee++){const Me=[];let P,V;for(let Ue=0;Ue<C;Ue++){const qe=f.getImageLevelInfo(ee,Ue,pe);pe===0&&ee===0&&Ue===0&&(qe.origWidth%4!==0||qe.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),u>1?(P=qe.origWidth,V=qe.origHeight):(P=qe.width,V=qe.height);const Ye=new Uint8Array(f.getImageTranscodedSizeInBytes(ee,Ue,0,k));if(!f.transcodeImage(Ye,ee,Ue,pe,k,0,-1,-1))throw _(),new Error("THREE.KTX2Loader: .transcodeImage failed.");Me.push(Ye)}const G=m(Me);ve.push({data:G,width:P,height:V}),q.push(G.buffer)}j.push({mipmaps:ve,width:x,height:y,format:J})}return _(),{faces:j,buffers:q,width:x,height:y,hasAlpha:w,format:J,dfdFlags:L}}const l=[{if:"astcSupported",basisFormat:[a.UASTC_4x4],transcoderFormat:[s.ASTC_4x4,s.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[s.BC7_M5,s.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[s.BC1,s.BC3],engineFormat:[i.RGB_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[s.ETC1,s.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[s.ETC1],engineFormat:[i.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[a.ETC1S,a.UASTC_4x4],transcoderFormat:[s.PVRTC1_4_RGB,s.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],h=l.sort(function(p,f){return p.priorityETC1S-f.priorityETC1S}),c=l.sort(function(p,f){return p.priorityUASTC-f.priorityUASTC});function A(p,f,_,E){let x,y;const C=p===a.ETC1S?h:c;for(let u=0;u<C.length;u++){const I=C[u];if(o[I.if]&&I.basisFormat.includes(p)&&!(E&&I.transcoderFormat.length<2)&&!(I.needsPowerOfTwo&&!(d(f)&&d(_))))return x=I.transcoderFormat[E?1:0],y=I.engineFormat[E?1:0],{transcoderFormat:x,engineFormat:y}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),x=s.RGBA32,y=i.RGBAFormat,{transcoderFormat:x,engineFormat:y}}function d(p){return p<=2?!0:(p&p-1)===0&&p!==0}function m(p){if(p.length===1)return p[0];let f=0;for(let x=0;x<p.length;x++){const y=p[x];f+=y.byteLength}const _=new Uint8Array(f);let E=0;for(let x=0;x<p.length;x++){const y=p[x];_.set(y,E),E+=y.byteLength}return _}};const Rl=new Set([vi,ji,Si]),Aa={[Lo]:vi,[Qo]:vi,[Bo]:vi,[So]:vi,[Po]:ji,[Mo]:ji,[xo]:ji,[bo]:ji,[Do]:Si,[wo]:Si,[Io]:Si,[Eo]:Si,[To]:rn,[Ro]:rn},ha={[Lo]:Ts,[Qo]:bt,[Bo]:ct,[So]:ct,[Po]:Ts,[Mo]:bt,[xo]:ct,[bo]:ct,[Do]:Ts,[wo]:bt,[Io]:ct,[Eo]:ct,[To]:ct,[Ro]:ct};async function Tl(o){const{vkFormat:e}=o;if(Aa[e]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let t;o.supercompressionScheme===pn&&(ca||(ca=new Promise(async a=>{const n=new Ll;await n.init(),a(n)})),t=await ca);const i=[];for(let a=0;a<o.levels.length;a++){const n=Math.max(1,o.pixelWidth>>a),r=Math.max(1,o.pixelHeight>>a),l=o.pixelDepth?Math.max(1,o.pixelDepth>>a):0,h=o.levels[a];let c;if(o.supercompressionScheme===bl)c=h.levelData;else if(o.supercompressionScheme===pn)c=t.decode(h.levelData,h.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let A;ha[e]===Ts?A=new Float32Array(c.buffer,c.byteOffset,c.byteLength/Float32Array.BYTES_PER_ELEMENT):ha[e]===bt?A=new Uint16Array(c.buffer,c.byteOffset,c.byteLength/Uint16Array.BYTES_PER_ELEMENT):A=c,i.push({data:A,width:n,height:r,depth:l})}let s;if(Rl.has(Aa[e]))s=o.pixelDepth===0?new uo(i[0].data,o.pixelWidth,o.pixelHeight):new Br(i[0].data,o.pixelWidth,o.pixelHeight,o.pixelDepth);else{if(o.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");s=new ho(i,o.pixelWidth,o.pixelHeight)}return s.mipmaps=i,s.type=ha[e],s.format=Aa[e],s.colorSpace=No(o),s.needsUpdate=!0,Promise.resolve(s)}function No(o){const e=o.dataFormatDescriptor[0];return e.colorPrimaries===wl?e.transferFunction===gn?po:ot:e.colorPrimaries===Ml?e.transferFunction===gn?Sr:wr:e.colorPrimaries===Sl?on:(console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${e.colorPrimaries}"`),on)}class Nl extends go{constructor(e={}){if(super(e),this._loader=new Tt,this._transcoderPath=e.transcoderPath,this._renderer=e.renderer,!this._transcoderPath)throw new Error("ThreeKTX2TextureLoader: transcoderPath is not defined");if(!this._renderer)throw new Error("ThreeKTX2TextureLoader: renderer is not defined");this._loader.setTranscoderPath(this._transcoderPath),this._loader.detectSupport(this._renderer)}load({path:e,options:t={}}){return new Promise((s,a)=>{this._loader.load(e,n=>{for(const r in t)n[r]=t[r];s(n)},null,a)})}}class Fl extends go{load({path:e,options:t={}}){return new Promise(s=>{const a=new Mr.Sound(e,()=>{s(a)})})}}class Ul{constructor(){this._viewportWidth=Je.innerWidth,this._viewportHeight=Je.innerHeight,this._mousePosition=new T,this._normalizedMousePosition=new T,this._centeredMousePosition=new T}start(e){this._dragManager=this._createDragManager(e),this._bindAll(),this._setupEventListeners()}_createDragManager(e){return new Js({el:e,preventDefault:!0})}_bindAll(){this._mousemoveHandler=this._mousemoveHandler.bind(this),this._resizeHandler=this._resizeHandler.bind(this),this._tapHandler=this._tapHandler.bind(this)}_setupEventListeners(){var e;window.addEventListener("mousemove",this._mousemoveHandler),Je.addEventListener("resize",this._resizeHandler),(e=this._dragManager)==null||e.addEventListener("tap",this._tapHandler)}_mousemoveHandler(e){this._mousePosition.x=e.clientX,this._mousePosition.y=e.clientY,this._normalizedMousePosition.x=this._mousePosition.x/this._viewportWidth,this._normalizedMousePosition.y=1-this._mousePosition.y/this._viewportHeight,this._centeredMousePosition.x=this._mousePosition.x/this._viewportWidth*2-1,this._centeredMousePosition.y=-(this._mousePosition.y/this._viewportHeight)*2+1,et.trigger({name:"mousemove",fireAtStart:!1},{mousePosition:this._mousePosition,normalizedMousePosition:this._normalizedMousePosition,centeredMousePosition:this._centeredMousePosition})}_tapHandler(e){window.nativeButtonClicked||(this._mousePosition.x=e.position.x,this._mousePosition.y=e.position.y,this._normalizedMousePosition.x=this._mousePosition.x/this._viewportWidth,this._normalizedMousePosition.y=1-this._mousePosition.y/this._viewportHeight,this._centeredMousePosition.x=this._mousePosition.x/this._viewportWidth*2-1,this._centeredMousePosition.y=-(this._mousePosition.y/this._viewportHeight)*2+1,et.trigger({name:"click",fireAtStart:!1},{mousePosition:this._mousePosition,normalizedMousePosition:this._normalizedMousePosition,centeredMousePosition:this._centeredMousePosition}))}_resizeHandler({innerWidth:e,innerHeight:t}){this._viewportWidth=e,this._viewportHeight=t}}new Ul;class Ol{constructor(e,t){M(this,"context");M(this,"ext",null);M(this,"activeQuery",null);M(this,"isRunning",!1);M(this,"eventsPendingTimestamps",[]);M(this,"resolvedEvents",[]);M(this,"namedContextStack",[]);this.context=e,this.ext=t}isProfilerRunning(){return this.isRunning}start(){if(this.ext==null)throw new Error("EXT_disjoint_timer_query WebGL extension is not available. Cannot start profiler.");if(this.isRunning)throw new Error("Profiler is already running");this.isRunning=!0,this.eventsPendingTimestamps=[],this.resolvedEvents=[],this.activeQuery=this.context.createQuery(),this.context.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery),this.pushContext("profile")}stop(){if(this.ext!=null){if(!this.isRunning)throw new Error("Profiler is already stopped");this.isRunning=!1,this.popContext("profile"),this.activeQuery=null,this.context.endQuery(this.ext.TIME_ELAPSED_EXT)}}pushContext(e){this.markAction({type:$i.OPEN_FRAME,name:e}),this.namedContextStack.push(e)}popContext(e){if(this.namedContextStack.length===0)throw new Error("Tried to pop a context when the context stack is empty!");const t=this.namedContextStack.pop();if(t!==e)throw new Error(`Expected popContext to be called with ${t}, but it was called with ${e}`);this.markAction({type:$i.CLOSE_FRAME,name:e})}withContext(e,t){this.pushContext(e),t(),this.popContext(e)}async exportSpeedscopeProfile(){for(;this.eventsPendingTimestamps.length>0;)this.resolveEventsIfPossible(),await new Promise(e=>requestAnimationFrame(e));return this.toSpeedscopeProfile()}async downloadWhenReady(){const e=await this.exportSpeedscopeProfile(),t=document.createElement("a");t.href=URL.createObjectURL(new Blob([e],{type:"application/json"})),t.download=`gpuprofile-${+new Date}.speedscope.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t)}async stopAndDownload(){this.stop(),await this.downloadWhenReady()}async stopAndMeasure(){return this.stop(),await this.exportSpeedscopeProfile()}markAction(e){if(this.ext==null)return;if(this.activeQuery==null)throw new Error("Cannot mark actions while no profile is active");const t=this.activeQuery;this.activeQuery=this.context.createQuery(),this.context.endQuery(this.ext.TIME_ELAPSED_EXT),this.context.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery),this.eventsPendingTimestamps.push({action:e,query:t})}resolveEventsIfPossible(){if(this.ext==null)return;let e=0;for(;e<this.eventsPendingTimestamps.length;){const t=this.eventsPendingTimestamps[e],i=t.query;if(!this.context.getQueryParameter(i,this.context.QUERY_RESULT_AVAILABLE))break;this.context.getParameter(this.ext.GPU_DISJOINT_EXT)&&console.error("GPU_DISJOINT_EXT");const s=this.context.getQueryParameter(i,this.context.QUERY_RESULT);this.context.deleteQuery(i);const n=(this.resolvedEvents.length===0?0:this.resolvedEvents[this.resolvedEvents.length-1].timestamp)+s;this.resolvedEvents.push({action:t.action,timestamp:n}),e++}e>0&&(this.eventsPendingTimestamps=this.eventsPendingTimestamps.slice(e))}toSpeedscopeProfile(){const e=[],t=[];if(this.resolvedEvents.length===0)throw new Error("Profile is empty");const i={type:ka.EVENTED,name:"GPU Profile",unit:"nanoseconds",startValue:0,endValue:this.resolvedEvents[this.resolvedEvents.length-1].timestamp,events:t},s={$schema:"https://www.Speedscopeapp/file-format-schema.json",shared:{frames:e},profiles:[i]},a={};function n(r){return r in a||(a[r]=e.length,e.push({name:r})),a[r]}for(const r of this.resolvedEvents)t.push({type:r.action.type===$i.OPEN_FRAME?Gs.OPEN_FRAME:Gs.CLOSE_FRAME,frame:n(r.action.name),at:r.timestamp});return JSON.stringify(s)}}let $i;(function(o){o[o.OPEN_FRAME=0]="OPEN_FRAME",o[o.CLOSE_FRAME=1]="CLOSE_FRAME"})($i||($i={}));let ka;(function(o){o.EVENTED="evented",o.SAMPLED="sampled"})(ka||(ka={}));let Gs;(function(o){o.OPEN_FRAME="O",o.CLOSE_FRAME="C"})(Gs||(Gs={}));const vn=Qr(),kl=`http://${vn.public.DEV_SERVER_IP}:${vn.public.GPU_PROFILER_SERVER_PORT}/profile/`;class Gl extends Ol{constructor(e,t,i){super(e,t),this._renderer=i,this._extension=t}addDebuggerButton(e){!this._extension||!e||(e.addButton({title:"🔬 Profile GPU"}).on("click",this.profileGPU.bind(this)),e.addBlade({view:"separator"}))}add(e,t){if(!e.isMesh&&!e.isPoint&&!e.isLine)return console.warn(`Cosmic GPU Profiler: ${t||e.name||"Object"} is not of type Mesh, Line or Point`);e.onBeforeRender=()=>{!this._extension||!this.isProfilerRunning()||this.pushContext(t||e.name)},e.onAfterRender=()=>{!this._extension||!this.isProfilerRunning()||this.popContext(t||e.name)}}addObject(e,t){e.traverse(i=>{(i.isMesh||i.isPoint||i.isLine)&&this.add(i,`${t}/${i.name}`)})}profileGPU(){if(!this._extension)return console.error("Cosmic GPU Profiler: Extension EXT_disjoint_timer_query_webgl2 is not supported on your browser");this.start(),ls(()=>{this.stopAndMeasure().then(e=>{fetch(kl,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:e}).then(t=>{t.status===200&&console.log("Successfully saved")})})},60)}}function ua(o,e,t,i){return new(t||(t=Promise))(function(s,a){function n(h){try{l(i.next(h))}catch(c){a(c)}}function r(h){try{l(i.throw(h))}catch(c){a(c)}}function l(h){var c;h.done?s(h.value):(c=h.value,c instanceof t?c:new t(function(A){A(c)})).then(n,r)}l((i=i.apply(o,[])).next())})}const Hl=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function _n(o){return o=o.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const Fo=typeof window>"u",Lt=(()=>{if(Fo)return;const{userAgent:o,platform:e,maxTouchPoints:t}=window.navigator,i=/(iphone|ipod|ipad)/i.test(o),s=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:s,isMobile:/android/i.test(o)||i||s,isSafari12:/Version\/12.+Safari/.test(o),isFirefox:/Firefox/.test(o)}})();function zl(o,e,t){if(!t)return[e];const i=function(h){const c=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,A=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,d=h.createShader(35633),m=h.createShader(35632),p=h.createProgram();if(!(m&&d&&p))return;h.shaderSource(d,c),h.shaderSource(m,A),h.compileShader(d),h.compileShader(m),h.attachShader(p,d),h.attachShader(p,m),h.linkProgram(p),h.detachShader(p,d),h.detachShader(p,m),h.deleteShader(d),h.deleteShader(m),h.useProgram(p);const f=h.createBuffer();h.bindBuffer(34962,f),h.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const _=h.getAttribLocation(p,"aPosition");h.vertexAttribPointer(_,3,5126,!1,0,0),h.enableVertexAttribArray(_),h.clearColor(1,1,1,1),h.clear(16384),h.viewport(0,0,1,1),h.drawArrays(4,0,3);const E=new Uint8Array(4);return h.readPixels(0,0,1,1,6408,5121,E),h.deleteProgram(p),h.deleteBuffer(f),E.join("")}(o),s="801621810",a="8016218135",n="80162181161",r=Lt!=null&&Lt.isIpad?[["a7",n,12],["a8",a,15],["a8x",a,15],["a9",a,15],["a9x",a,15],["a10",a,15],["a10x",a,15],["a12",s,15],["a12x",s,15],["a12z",s,15],["a14",s,15],["a15",s,15],["m1",s,15],["m2",s,15]]:[["a7",n,12],["a8",a,12],["a9",a,15],["a10",a,15],["a11",s,15],["a12",s,15],["a13",s,15],["a14",s,15],["a15",s,15],["a16",s,15],["a17",s,15]];let l;return i==="80162181255"?l=r.filter(([,,h])=>h>=14):(l=r.filter(([,h])=>h===i),l.length||(l=r)),l.map(([h])=>`apple ${h} gpu`)}class Cn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const da=[],yn=[];function ql(o,e){if(o===e)return 0;const t=o;o.length>e.length&&(o=e,e=t);let i=o.length,s=e.length;for(;i>0&&o.charCodeAt(~-i)===e.charCodeAt(~-s);)i--,s--;let a,n=0;for(;n<i&&o.charCodeAt(n)===e.charCodeAt(n);)n++;if(i-=n,s-=n,i===0)return s;let r,l,h=0,c=0,A=0;for(;c<i;)yn[c]=o.charCodeAt(n+c),da[c]=++c;for(;A<s;)for(a=e.charCodeAt(n+A),r=A++,h=A,c=0;c<i;c++)l=a===yn[c]?r:r+1,r=da[c],h=da[c]=r>h?l>h?h+1:l:l>r?r+1:l;return h}function Vl(o){return o!=null}const Wl=({mobileTiers:o=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:i,failIfMajorPerformanceCaveat:s=!1,benchmarksURL:a="https://unpkg.com/detect-gpu@5.0.58/dist/benchmarks"}={})=>ua(void 0,void 0,void 0,function*(){const n={};if(Fo)return{tier:0,type:"SSR"};const{isIpad:r=!!(Lt!=null&&Lt.isIpad),isMobile:l=!!(Lt!=null&&Lt.isMobile),screenSize:h=window.screen,loadBenchmarks:c=u=>ua(void 0,void 0,void 0,function*(){const I=yield fetch(`${a}/${u}`).then(w=>w.json());if(parseInt(I.shift().split(".")[0],10)<4)throw new Cn("Detect GPU benchmark data is out of date. Please update to version 4x");return I})}=t;let{renderer:A}=t;const d=(u,I,w,L,k)=>({device:k,fps:L,gpu:w,isMobile:l,tier:u,type:I});let m,p="";if(A)A=_n(A),m=[A];else{const u=i||function(w,L=!1){const k={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:L,powerPreference:"high-performance",stencil:!1};w&&delete k.powerPreference;const J=window.document.createElement("canvas"),j=J.getContext("webgl",k)||J.getContext("experimental-webgl",k);return j??void 0}(Lt==null?void 0:Lt.isSafari12,s);if(!u)return d(0,"WEBGL_UNSUPPORTED");const I=Lt!=null&&Lt.isFirefox?null:u.getExtension("WEBGL_debug_renderer_info");if(A=I?u.getParameter(I.UNMASKED_RENDERER_WEBGL):u.getParameter(u.RENDERER),!A)return d(1,"FALLBACK");p=A,A=_n(A),m=function(w,L,k){return L==="apple gpu"?zl(w,L,k):[L]}(u,A,l)}const f=(yield Promise.all(m.map(function(u){var I;return ua(this,void 0,void 0,function*(){const w=(Ce=>{const Ge=l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const rt of Ge)if(Ce.includes(rt))return rt})(u);if(!w)return;const L=`${l?"m":"d"}-${w}${r?"-ipad":""}.json`,k=n[L]=(I=n[L])!==null&&I!==void 0?I:c(L);let J;try{J=yield k}catch(Ce){if(Ce instanceof Cn)throw Ce;return}const j=function(Ce){var Ge;const rt=(Ce=Ce.replace(/\([^)]+\)/,"")).match(/\d+/)||Ce.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(Ge=rt==null?void 0:rt.join("").replace(/\W|amd/g,""))!==null&&Ge!==void 0?Ge:""}(u);let q=J.filter(([,Ce])=>Ce===j);q.length||(q=J.filter(([Ce])=>Ce.includes(u)));const pe=q.length;if(pe===0)return;const ve=u.split(/[.,()\[\]/\s]/g).sort().filter((Ce,Ge,rt)=>Ge===0||Ce!==rt[Ge-1]).join(" ");let ee,[Me,,,,P]=pe>1?q.map(Ce=>[Ce,ql(ve,Ce[2])]).sort(([,Ce],[,Ge])=>Ce-Ge)[0][0]:q[0],V=Number.MAX_VALUE;const{devicePixelRatio:G}=window,Ue=h.width*G*h.height*G;for(const Ce of P){const[Ge,rt]=Ce,ri=Ge*rt,b=Math.abs(Ue-ri);b<V&&(V=b,ee=Ce)}if(!ee)return;const[,,qe,Ye]=ee;return[V,qe,Me,Ye]})}))).filter(Vl).sort(([u=Number.MAX_VALUE,I],[w=Number.MAX_VALUE,L])=>u===w?I-L:u-w);if(!f.length){const u=Hl.find(I=>A.includes(I));return u?d(0,"BLOCKLISTED",u):d(1,"FALLBACK",`${A} (${p})`)}const[,_,E,x]=f[0];if(_===-1)return d(0,"BLOCKLISTED",E,_,x);const y=l?o:e;let C=0;for(let u=0;u<y.length;u++)_>=y[u]&&(C=u);return d(C,"BENCHMARK",E,_,x)}),Oi={VERY_LOW:0,LOW:1,MEDIUM:2,HIGH:3};class Yl{constructor(){this.isReady=!1,this.range=2,this.globalProfile={maxDpr:1.5,maxResolution:4096},this.readyPromise=new Promise(this.init.bind(this))}async setGUI(e){await this.ready(),e&&this.setDebugFolder(e)}setDebugFolder(e){const t=e.addFolder({title:"📊 Performance Profile 📊",expanded:!1});this.gpuNameBlade=t.addBlade({view:"text",label:"GPU",parse:a=>String(a),value:this.gpuTier.gpu,disabled:!0}),this.gpuBaseTier=t.addBlade({view:"text",label:"Tier",parse:a=>String(a),value:Object.keys(Oi)[this.range],disabled:!0});const i=t.addFolder({title:"Current Profile Settings",expanded:!0});for(const[a,n]of Object.entries(this.globalProfile))i.addBlade({view:"text",label:a.toString(),parse:r=>String(r),value:n,disabled:!0});const s=t.addFolder({title:"Force Tiers",expanded:!0});s.addButton({title:'Force "Low"'}).on("click",()=>{sessionStorage.setItem("force-gpu-info",JSON.stringify({fps:19,gpu:"intel iris graphics 6100",isMobile:!1,tier:1,type:"BENCHMARK"})),location.reload()}),s.addButton({title:'Force "Medium"'}).on("click",()=>{sessionStorage.setItem("force-gpu-info",JSON.stringify({fps:49,gpu:"amd radeon pro 5500 xt",isMobile:!1,tier:2,type:"BENCHMARK"})),location.reload()}),s.addButton({title:'Force "High"'}).on("click",()=>{sessionStorage.setItem("force-gpu-info",JSON.stringify({fps:400,gpu:"nvidia geforce rtx 3060 laptop gpu",isMobile:!1,tier:3,type:"BENCHMARK"})),location.reload()}),sessionStorage.getItem("force-gpu-info")&&s.addButton({title:"Reset"}).on("click",()=>{sessionStorage.removeItem("force-gpu-info"),location.reload()}),s.addButton({title:"Log current"}).on("click",()=>{console.log(this.gpuTier)}),s.addBlade({view:"text",label:"Forced GPU tier?",parse:a=>String(a),value:sessionStorage.getItem("force-gpu-info"),disabled:!0})}async init(e){const t=sessionStorage.getItem("force-gpu-info");t?this.gpuTier=JSON.parse(t):(this.gpuTier=await Wl({benchmarksURL:"./webgl/benchmarks"}),this.gpuTier.type==="FALLBACK"&&(this.gpuTier.tier=2),localStorage.setItem("gpu-info",JSON.stringify(this.gpuTier))),this.range=this.gpuTier.tier,this.isReady=!0,this.setGlobalProfile(),e()}setGlobalProfile(){this.range===Oi.VERY_LOW?(this.globalProfile.maxDpr=.25,this.globalProfile.maxResolution=1024):this.range===Oi.LOW?(this.globalProfile.maxDpr=.75,this.globalProfile.maxResolution=2048):this.range===Oi.MEDIUM?(this.globalProfile.maxDpr=1,this.globalProfile.maxResolution=3072):this.range===Oi.HIGH&&(this.globalProfile.maxDpr=1.5,this.globalProfile.maxResolution=4096)}async ready(){await this.readyPromise}}const _i=new Yl,Xa={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`},jl={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new _e(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class oi{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Xl=new fo(-1,1,1,-1,0,1);class Kl extends as{constructor(){super(),this.setAttribute("position",new ks([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ks([0,2,0,0,2,0],2))}}const Jl=new Kl;class cs{constructor(e){this._mesh=new U(Jl,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Xl)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Qi extends oi{constructor(e,t,i,s){super(),this.strength=t!==void 0?t:1,this.radius=i,this.threshold=s,this.resolution=e!==void 0?new T(e.x,e.y):new T(256,256),this.clearColor=new _e(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let a=Math.round(this.resolution.x/2),n=Math.round(this.resolution.y/2);this.renderTargetBright=new dt(a,n,{type:bt}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let A=0;A<this.nMips;A++){const d=new dt(a,n,{type:bt});d.texture.name="UnrealBloomPass.h"+A,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);const m=new dt(a,n,{type:bt});m.texture.name="UnrealBloomPass.v"+A,m.texture.generateMipmaps=!1,this.renderTargetsVertical.push(m),a=Math.round(a/2),n=Math.round(n/2)}const r=jl;this.highPassUniforms=Nt.clone(r.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new je({uniforms:this.highPassUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.separableBlurMaterials=[];const l=[3,5,7,9,11];a=Math.round(this.resolution.x/2),n=Math.round(this.resolution.y/2);for(let A=0;A<this.nMips;A++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(l[A])),this.separableBlurMaterials[A].uniforms.invSize.value=new T(1/a,1/n),a=Math.round(a/2),n=Math.round(n/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const h=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=h,this.bloomTintColors=[new O(1,1,1),new O(1,1,1),new O(1,1,1),new O(1,1,1),new O(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const c=Xa;this.copyUniforms=Nt.clone(c.uniforms),this.blendMaterial=new je({uniforms:this.copyUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,blending:mo,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new _e,this.oldClearAlpha=1,this.basic=new It,this.fsQuad=new cs(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let i=Math.round(e/2),s=Math.round(t/2);this.renderTargetBright.setSize(i,s);for(let a=0;a<this.nMips;a++)this.renderTargetsHorizontal[a].setSize(i,s),this.renderTargetsVertical[a].setSize(i,s),this.separableBlurMaterials[a].uniforms.invSize.value=new T(1/i,1/s),i=Math.round(i/2),s=Math.round(s/2)}render(e,t,i,s,a){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const n=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),a&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let r=this.renderTargetBright;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=r.texture,this.separableBlurMaterials[l].uniforms.direction.value=Qi.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=Qi.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),r=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,a&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}getSeperableBlurMaterial(e){const t=[];for(let i=0;i<e;i++)t.push(.39894*Math.exp(-.5*i*i/(e*e))/e);return new je({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new T(.5,.5)},direction:{value:new T(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new je({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}Qi.BlurDirectionX=new T(1,0);Qi.BlurDirectionY=new T(0,1);class $s extends oi{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof je?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Nt.clone(e.uniforms),this.material=new je({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new cs(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class En extends oi{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const s=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);let n,r;this.inverse?(n=0,r=1):(n=1,r=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.buffers.stencil.setFunc(s.ALWAYS,n,4294967295),a.buffers.stencil.setClear(r),a.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.color.setMask(!0),a.buffers.depth.setMask(!0),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(s.EQUAL,1,4294967295),a.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.buffers.stencil.setLocked(!0)}}class Zl extends oi{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class $l{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const i=e.getSize(new T);this._width=i.width,this._height=i.height,t=new dt(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:bt}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new $s(Xa),this.copyPass.material.blending=Dr,this.clock=new Pr}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let s=0,a=this.passes.length;s<a;s++){const n=this.passes[s];if(n.enabled!==!1){if(n.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),n.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),n.needsSwap){if(i){const r=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(r.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(r.EQUAL,1,4294967295)}this.swapBuffers()}En!==void 0&&(n instanceof En?i=!0:n instanceof Zl&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new T);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let a=0;a<this.passes.length;a++)this.passes[a].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class Di extends oi{constructor(e={}){const{scene:t,camera:i,resolution:s,strength:a,radius:n,threshold:r,debugMask:l}=e;super(),this.debugMask=l,this.scene=t,this.camera=i,this.strength=a!==void 0?a:1,this.radius=n,this.resolution=s!==void 0?new T(s.x,s.y):new T(256,256),this.clearColor=new _e(0,0,0),this.renderTargetMask=new dt(this.resolution.x,this.resolution.y,{type:ct}),this.renderTargetMask.texture.generateMipmaps=!1,this.darkMaterial=new je({vertexShader:`varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }`,fragmentShader:`varying vec2 vUv;
            void main() {
                gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
            }`}),this.materials={},this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let h=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);for(let p=0;p<this.nMips;p++){const f=new dt(h,c,{type:ct});f.texture.name="UnrealBloomPass.h"+p,f.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(f);const _=new dt(h,c,{type:ct});_.texture.name="UnrealBloomPass.v"+p,_.texture.generateMipmaps=!1,this.renderTargetsVertical.push(_),h=Math.round(h/2),c=Math.round(c/2)}this.separableBlurMaterials=[];const A=[3,5,7,9,11];h=Math.round(this.resolution.x/2),c=Math.round(this.resolution.y/2);for(let p=0;p<this.nMips;p++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(A[p])),this.separableBlurMaterials[p].uniforms.invSize.value=new T(1/h,1/c),h=Math.round(h/2),c=Math.round(c/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=a,this.compositeMaterial.uniforms.bloomRadius.value=.1;const d=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=d,this.bloomTintColors=[new O(1,1,1),new O(1,1,1),new O(1,1,1),new O(1,1,1),new O(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const m=Xa;this.copyUniforms=Nt.clone(m.uniforms),this.blendMaterial=new je({uniforms:this.copyUniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader,blending:mo,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new _e,this.oldClearAlpha=1,this.basic=new It,this.fsQuad=new cs(null)}dispose(){this.renderTargetMask.dispose();for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let i=Math.round(e/2),s=Math.round(t/2);this.renderTargetMask.setSize(i,s);for(let a=0;a<this.nMips;a++)this.renderTargetsHorizontal[a].setSize(i,s),this.renderTargetsVertical[a].setSize(i,s),this.separableBlurMaterials[a].uniforms.invSize.value=new T(1/i,1/s),i=Math.round(i/2),s=Math.round(s/2)}render(e,t,i,s,a){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const n=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),a&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.renderMask(e);let r=this.renderTargetMask;for(let l=0;l<this.nMips;l++)this.fsQuad.material=this.separableBlurMaterials[l],this.separableBlurMaterials[l].uniforms.colorTexture.value=r.texture,this.separableBlurMaterials[l].uniforms.direction.value=Di.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[l]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[l].uniforms.colorTexture.value=this.renderTargetsHorizontal[l].texture,this.separableBlurMaterials[l].uniforms.direction.value=Di.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[l]),e.clear(),this.fsQuad.render(e),r=this.renderTargetsVertical[l];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,a&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(i),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n,e.setRenderTarget(this.renderTargetMask),e.clear(!0,!0,!1)}renderMask(e){this.scene.traverse(t=>{t.isMesh&&!t.userData.bloom&&(this.materials[t.uuid]=this.materials[t.uuid]||t.material,t.material=this.darkMaterial)}),e.setRenderTarget(this.renderTargetMask),e.render(this.scene,this.camera),this.debugMask||this.scene.traverse(t=>{this.materials[t.uuid]&&(t.material=this.materials[t.uuid],delete this.materials[t.uuid])})}getSeperableBlurMaterial(e){const t=[];for(let i=0;i<e;i++)t.push(.39894*Math.exp(-.5*i*i/(e*e))/e);return new je({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new T(.5,.5)},direction:{value:new T(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
                }`,fragmentShader:`#include <common>
                varying vec2 vUv;
                uniform sampler2D colorTexture;
                uniform vec2 invSize;
                uniform vec2 direction;
                uniform float gaussianCoefficients[KERNEL_RADIUS];

                void main() {
                    float weightSum = gaussianCoefficients[0];
                    vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
                    for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
                    float x = float(i);
                    float w = gaussianCoefficients[i];
                    vec2 uvOffset = direction * invSize * x;
                    vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
                    vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
                    diffuseSum += (sample1 + sample2) * w;
                    weightSum += 2.0 * w;
                    }
                    gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
                }`})}getCompositeMaterial(e){return new je({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
                }`,fragmentShader:`varying vec2 vUv;
                uniform sampler2D blurTexture1;
                uniform sampler2D blurTexture2;
                uniform sampler2D blurTexture3;
                uniform sampler2D blurTexture4;
                uniform sampler2D blurTexture5;
                uniform float bloomStrength;
                uniform float bloomRadius;
                uniform float bloomFactors[NUM_MIPS];
                uniform vec3 bloomTintColors[NUM_MIPS];

                float lerpBloomFactor(const in float factor) {
                    float mirrorFactor = 1.2 - factor;
                    return mix(factor, mirrorFactor, bloomRadius);
                }

                void main() {
                    gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
                    lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
                    lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
                    lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
                    lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
                }`})}}Di.BlurDirectionX=new T(1,0);Di.BlurDirectionY=new T(0,1);const ec={name:"OutputShader",uniforms:{tDiffuse:{value:null},toneMappingExposure:{value:1}},vertexShader:`
		precision highp float;

		uniform mat4 modelViewMatrix;
		uniform mat4 projectionMatrix;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
	
		precision highp float;

		uniform sampler2D tDiffuse;

		#include <tonemapping_pars_fragment>
		#include <colorspace_pars_fragment>

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );

			// tone mapping

			#ifdef LINEAR_TONE_MAPPING

				gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );

			#elif defined( REINHARD_TONE_MAPPING )

				gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );

			#elif defined( CINEON_TONE_MAPPING )

				gl_FragColor.rgb = OptimizedCineonToneMapping( gl_FragColor.rgb );

			#elif defined( ACES_FILMIC_TONE_MAPPING )

				gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );

			#elif defined( AGX_TONE_MAPPING )

				gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );

			#elif defined( NEUTRAL_TONE_MAPPING )

				gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );

			#endif

			// color space

			#ifdef SRGB_TRANSFER

				gl_FragColor = sRGBTransferOETF( gl_FragColor );

			#endif

		}`};class tc extends oi{constructor(){super();const e=ec;this.uniforms=Nt.clone(e.uniforms),this.material=new Lr({name:e.name,uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.fsQuad=new cs(this.material),this._outputColorSpace=null,this._toneMapping=null}render(e,t,i){this.uniforms.tDiffuse.value=i.texture,this.uniforms.toneMappingExposure.value=e.toneMappingExposure,(this._outputColorSpace!==e.outputColorSpace||this._toneMapping!==e.toneMapping)&&(this._outputColorSpace=e.outputColorSpace,this._toneMapping=e.toneMapping,this.material.defines={},Rr.getTransfer(this._outputColorSpace)===Tr&&(this.material.defines.SRGB_TRANSFER=""),this._toneMapping===Nr?this.material.defines.LINEAR_TONE_MAPPING="":this._toneMapping===Fr?this.material.defines.REINHARD_TONE_MAPPING="":this._toneMapping===Ur?this.material.defines.CINEON_TONE_MAPPING="":this._toneMapping===Or?this.material.defines.ACES_FILMIC_TONE_MAPPING="":this._toneMapping===kr?this.material.defines.AGX_TONE_MAPPING="":this._toneMapping===Gr&&(this.material.defines.NEUTRAL_TONE_MAPPING=""),this.material.needsUpdate=!0),this.renderToScreen===!0?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class ic extends oi{constructor(e,t,i=null,s=null,a=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=a,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new _e}render(e,t,i){const s=e.autoClear;e.autoClear=!1;let a,n;this.overrideMaterial!==null&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),this.clearAlpha!==null&&(a=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(a),this.overrideMaterial!==null&&(this.scene.overrideMaterial=n),e.autoClear=s}}const ps={name:"SMAAEdgesShader",defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		void SMAAEdgeDetectionVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAAEdgeDetectionVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];

		vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
			vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );

			// Calculate color deltas:
			vec4 delta;
			vec3 C = texture2D( colorTex, texcoord ).rgb;

			vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
			vec3 t = abs( C - Cleft );
			delta.x = max( max( t.r, t.g ), t.b );

			vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
			t = abs( C - Ctop );
			delta.y = max( max( t.r, t.g ), t.b );

			// We do the usual threshold:
			vec2 edges = step( threshold, delta.xy );

			// Then discard if there is no edge:
			if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
				discard;

			// Calculate right and bottom deltas:
			vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
			t = abs( C - Cright );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
			t = abs( C - Cbottom );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the maximum delta in the direct neighborhood:
			float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

			// Calculate left-left and top-top deltas:
			vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
			t = abs( C - Cleftleft );
			delta.z = max( max( t.r, t.g ), t.b );

			vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
			t = abs( C - Ctoptop );
			delta.w = max( max( t.r, t.g ), t.b );

			// Calculate the final maximum delta:
			maxDelta = max( max( maxDelta, delta.z ), delta.w );

			// Local contrast adaptation in action:
			edges.xy *= step( 0.5 * maxDelta, delta.xy );

			return vec4( edges, 0.0, 0.0 );
		}

		void main() {

			gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );

		}`},gs={name:"SMAAWeightsShader",defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 3 ];
		varying vec2 vPixcoord;

		void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
			vPixcoord = texcoord / resolution;

			// We will use these offsets for the searches later on (see @PSEUDO_GATHER4):
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 ); // WebGL port note: Changed sign in Y and W components
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 ); // WebGL port note: Changed sign in Y and W components

			// And these for the searches, they indicate the ends of the loops:
			vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );

		}

		void main() {

			vUv = uv;

			SMAABlendingWeightCalculationVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )

		uniform sampler2D tDiffuse;
		uniform sampler2D tArea;
		uniform sampler2D tSearch;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[3];
		varying vec2 vPixcoord;

		#if __VERSION__ == 100
		vec2 round( vec2 x ) {
			return sign( x ) * floor( abs( x ) + 0.5 );
		}
		#endif

		float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
			// Not required if searchTex accesses are set to point:
			// float2 SEARCH_TEX_PIXEL_SIZE = 1.0 / float2(66.0, 33.0);
			// e = float2(bias, 0.0) + 0.5 * SEARCH_TEX_PIXEL_SIZE +
			//     e * float2(scale, 1.0) * float2(64.0, 32.0) * SEARCH_TEX_PIXEL_SIZE;
			e.r = bias + e.r * scale;
			return 255.0 * texture2D( searchTex, e, 0.0 ).r;
		}

		float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			/**
				* @PSEUDO_GATHER4
				* This texcoord has been offset by (-0.25, -0.125) in the vertex shader to
				* sample between edge, thus fetching four edges in a row.
				* Sampling with different offsets in each direction allows to disambiguate
				* which edges are active from the four fetched ones.
				*/
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			// We correct the previous (-0.25, -0.125) offset we applied:
			texcoord.x += 0.25 * resolution.x;

			// The searches are bias by 1, so adjust the coords accordingly:
			texcoord.x += resolution.x;

			// Disambiguate the length added by the last step:
			texcoord.x += 2.0 * resolution.x; // Undo last step
			texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);

			return texcoord.x;
		}

		float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 0.0, 1.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 2.0, 0.0 ) * resolution;
				if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
			}

			texcoord.x -= 0.25 * resolution.x;
			texcoord.x -= resolution.x;
			texcoord.x -= 2.0 * resolution.x;
			texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );

			return texcoord.x;
		}

		float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord += vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y -= 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y; // WebGL port note: Changed sign
			texcoord.y -= 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
			vec2 e = vec2( 1.0, 0.0 );

			for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) { // WebGL port note: Changed while to for
				e = texture2D( edgesTex, texcoord, 0.0 ).rg;
				texcoord -= vec2( 0.0, 2.0 ) * resolution; // WebGL port note: Changed sign
				if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
			}

			texcoord.y += 0.25 * resolution.y; // WebGL port note: Changed sign
			texcoord.y += resolution.y; // WebGL port note: Changed sign
			texcoord.y += 2.0 * resolution.y; // WebGL port note: Changed sign
			texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 ); // WebGL port note: Changed sign

			return texcoord.y;
		}

		vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
			// Rounding prevents precision errors of bilinear filtering:
			vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;

			// We do a scale and bias for mapping to texel space:
			texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );

			// Move to proper place, according to the subpixel offset:
			texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;

			return texture2D( areaTex, texcoord, 0.0 ).rg;
		}

		vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
			vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );

			vec2 e = texture2D( edgesTex, texcoord ).rg;

			if ( e.g > 0.0 ) { // Edge at north
				vec2 d;

				// Find the distance to the left:
				vec2 coords;
				coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
				coords.y = offset[ 1 ].y; // offset[1].y = texcoord.y - 0.25 * resolution.y (@CROSSING_OFFSET)
				d.x = coords.x;

				// Now fetch the left crossing edges, two at a time using bilinear
				// filtering. Sampling at -0.25 (see @CROSSING_OFFSET) enables to
				// discern what value each edge has:
				float e1 = texture2D( edgesTex, coords, 0.0 ).r;

				// Find the distance to the right:
				coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
				d.y = coords.x;

				// We want the distances to be in pixel units (doing this here allow to
				// better interleave arithmetic and memory accesses):
				d = d / resolution.x - pixcoord.x;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the right crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;

				// Ok, we know how this pattern looks like, now it is time for getting
				// the actual area:
				weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
			}

			if ( e.r > 0.0 ) { // Edge at west
				vec2 d;

				// Find the distance to the top:
				vec2 coords;

				coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
				coords.x = offset[ 0 ].x; // offset[1].x = texcoord.x - 0.25 * resolution.x;
				d.x = coords.y;

				// Fetch the top crossing edges:
				float e1 = texture2D( edgesTex, coords, 0.0 ).g;

				// Find the distance to the bottom:
				coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
				d.y = coords.y;

				// We want the distances to be in pixel units:
				d = d / resolution.y - pixcoord.y;

				// SMAAArea below needs a sqrt, as the areas texture is compressed
				// quadratically:
				vec2 sqrt_d = sqrt( abs( d ) );

				// Fetch the bottom crossing edges:
				coords.y -= 1.0 * resolution.y; // WebGL port note: Added
				float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;

				// Get the area for this direction:
				weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
			}

			return weights;
		}

		void main() {

			gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );

		}`},pa={name:"SMAABlendShader",uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new T(1/1024,1/512)}},vertexShader:`

		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
			vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 ); // WebGL port note: Changed sign in W component
			vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 ); // WebGL port note: Changed sign in W component
		}

		void main() {

			vUv = uv;

			SMAANeighborhoodBlendingVS( vUv );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform sampler2D tColor;
		uniform vec2 resolution;

		varying vec2 vUv;
		varying vec4 vOffset[ 2 ];

		vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
			// Fetch the blending weights for current pixel:
			vec4 a;
			a.xz = texture2D( blendTex, texcoord ).xz;
			a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
			a.w = texture2D( blendTex, offset[ 1 ].xy ).a;

			// Is there any blending weight with a value greater than 0.0?
			if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
				return texture2D( colorTex, texcoord, 0.0 );
			} else {
				// Up to 4 lines can be crossing a pixel (one through each edge). We
				// favor blending by choosing the line with the maximum weight for each
				// direction:
				vec2 offset;
				offset.x = a.a > a.b ? a.a : -a.b; // left vs. right
				offset.y = a.g > a.r ? -a.g : a.r; // top vs. bottom // WebGL port note: Changed signs

				// Then we go in the direction that has the maximum weight:
				if ( abs( offset.x ) > abs( offset.y )) { // horizontal vs. vertical
					offset.y = 0.0;
				} else {
					offset.x = 0.0;
				}

				// Fetch the opposite color and lerp by hand:
				vec4 C = texture2D( colorTex, texcoord, 0.0 );
				texcoord += sign( offset ) * resolution;
				vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
				float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );

				// WebGL port note: Added gamma correction
				C.xyz = pow(C.xyz, vec3(2.2));
				Cop.xyz = pow(Cop.xyz, vec3(2.2));
				vec4 mixed = mix(C, Cop, s);
				mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));

				return mixed;
			}
		}

		void main() {

			gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );

		}`};class sc extends oi{constructor(e,t){super(),this.edgesRT=new dt(e,t,{depthBuffer:!1,type:bt}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new dt(e,t,{depthBuffer:!1,type:bt}),this.weightsRT.texture.name="SMAAPass.weights";const i=this,s=new Image;s.src=this.getAreaTexture(),s.onload=function(){i.areaTexture.needsUpdate=!0},this.areaTexture=new ln,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=s,this.areaTexture.minFilter=Mi,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;const a=new Image;a.src=this.getSearchTexture(),a.onload=function(){i.searchTexture.needsUpdate=!0},this.searchTexture=new ln,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=a,this.searchTexture.magFilter=cn,this.searchTexture.minFilter=cn,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,this.uniformsEdges=Nt.clone(ps.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/t),this.materialEdges=new je({defines:Object.assign({},ps.defines),uniforms:this.uniformsEdges,vertexShader:ps.vertexShader,fragmentShader:ps.fragmentShader}),this.uniformsWeights=Nt.clone(gs.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/t),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new je({defines:Object.assign({},gs.defines),uniforms:this.uniformsWeights,vertexShader:gs.vertexShader,fragmentShader:gs.fragmentShader}),this.uniformsBlend=Nt.clone(pa.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/t),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new je({uniforms:this.uniformsBlend,vertexShader:pa.vertexShader,fragmentShader:pa.fragmentShader}),this.fsQuad=new cs(null)}render(e,t,i){this.uniformsEdges.tDiffuse.value=i.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=i.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}setSize(e,t){this.edgesRT.setSize(e,t),this.weightsRT.setSize(e,t),this.materialEdges.uniforms.resolution.value.set(1/e,1/t),this.materialWeights.uniforms.resolution.value.set(1/e,1/t),this.materialBlend.uniforms.resolution.value.set(1/e,1/t)}getAreaTexture(){return"data:image/png;base64,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"}getSearchTexture(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}dispose(){this.edgesRT.dispose(),this.weightsRT.dispose(),this.areaTexture.dispose(),this.searchTexture.dispose(),this.materialEdges.dispose(),this.materialWeights.dispose(),this.materialBlend.dispose(),this.fsQuad.dispose()}}const ac=`#define GLSLIFY 1
varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,nc=`#define GLSLIFY 1
varying vec2 vUv;uniform vec2 uResolution;uniform sampler2D tDiffuse;uniform vec3 uColor1;uniform vec3 uColor2;uniform vec3 uColor3;uniform float uTime;uniform float uBorderWidth;uniform float uBorderRadius;float roundedBoxSDF(vec2 p,vec2 size,float radius){vec2 d=abs(p)-size+vec2(radius);return length(max(d,0.0))-radius;}float circleSDF(vec2 p,float radius){return length(p)-radius;}void main(){vec3 sceneColor=texture2D(tDiffuse,vUv).rgb;vec2 rectShape=uResolution.xy/2.0-vec2(uBorderWidth);vec2 center=gl_FragCoord.xy-uResolution.xy/2.0;float fDist=roundedBoxSDF(center,rectShape,uBorderRadius-uBorderWidth);float edgeSoftness=200.0;float smoothedAlpha=1.0-smoothstep(0.0,edgeSoftness,fDist);vec3 finalColor=mix(uColor2,sceneColor,smoothedAlpha);gl_FragColor=vec4(finalColor,1.0);}`,oc=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;void main(){vec4 pos=projectionMatrix*modelViewMatrix*vec4(position,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,rc=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D tDiffuse;uniform sampler2D uHeatmapTexture;uniform float uHeatAlpha;uniform float uHeatmapThreshold;uniform float uHeatmapIsolation;void main(){vec4 ball=texture2D(uHeatmapTexture,vUv);float heatColorIntensity=smoothstep(uHeatmapThreshold,1.0,ball.r);vec3 heatColor=mix(vec3(0.0,0.0,1.0),vec3(1.0,0.0,0.0),ball.r);float isolationFactor=clamp(1.0-uHeatmapIsolation,0.0,1.0);vec4 diffuse=texture2D(tDiffuse,vUv)*vec4(isolationFactor,isolationFactor,isolationFactor,1.0);gl_FragColor=diffuse+vec4(heatColor,uHeatAlpha)*heatColorIntensity;}`;class lc extends $s{constructor(e={}){const{scene:t,camera:i}=e;super({uniforms:{tDiffuse:{value:null},uHeatmapTexture:{value:null},uHeatmapAlpha:{value:1},uHeatmapThreshold:{value:.01},uHeatmapIsolation:{value:0}},vertexShader:oc,fragmentShader:rc}),this._scene=t,this._camera=i,this._intensity=.1,this._alpha=1,this._isolation=0,this._threshold=.01,this._renderTarget=this._createRenderTarget(),this._ballMaterial=this._createBallMaterial(),this.uniforms.uHeatmapTexture.value=this._renderTarget.texture}get scene(){return this._scene}set scene(e){this._scene=e}get camera(){return this._camera}set camera(e){this._camera=e}get intensity(){return this._intensity}set intensity(e){this._intensity=e,this._ballMaterial.uniforms.uAlpha.value=this._intensity}get alpha(){return this._alpha}set alpha(e){this._alpha=e,this.uniforms.uHeatmapAlpha.value=this._alpha}get threshold(){return this._threshold}set threshold(e){this._threshold=e,this.uniforms.uHeatmapThreshold.value=this._threshold}get isolation(){return this._isolation}set isolation(e){this._isolation=e,this.uniforms.uHeatmapIsolation.value=this._isolation}dispose(){this._ballMaterial.dispose(),this._material.dispose()}render(e,t,i,s){var a,n;(a=this._scene)==null||a.traverse(r=>{r.isMesh&&r.name==="ball"?(r.initialMaterial=r.material,r.material=this._ballMaterial):r.isMesh&&(r.initialVisible=r.visible,r.visible=!1)}),e.autoClear=!1,e.setRenderTarget(this._renderTarget),e.render(this._scene,this._camera),(n=this._scene)==null||n.traverse(r=>{r.isMesh&&r.name==="ball"?r.material=r.initialMaterial:r.isMesh&&(r.visible=r.initialVisible)}),e.autoClear=!0,super.render(e,t,i,s)}_createRenderTarget(){const e=new dt(Je.innerWidth,Je.innerHeight,{type:bt,alpha:!0});return e.generateMipmaps=!1,e}_createBallMaterial(){return new je({uniforms:{uAlpha:{value:this._intensity}},vertexShader:`
                varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
                }
            `,fragmentShader:`
                varying vec2 vUv;
                uniform float uAlpha;
                void main() {
                    gl_FragColor = vec4(1.0, 1.0, 1.0, uAlpha);
                }
            `,transparent:!0})}}const Ee={file:"./webgl/modules/Postprocessing/settings.js",passes:{render:{enabled:{value:!0}},bloom:{enabled:{value:!1},strength:{value:.31999999999999984},radius:{value:-6.887},threshold:{value:.7800000000000001}},selectiveBloom:{enabled:{value:!0},strength:{value:2.0900000000000003},radius:{value:.5830000000000002},threshold:{value:.5900000000000002},debugMask:{value:!1}},gradient:{enabled:{value:!0},color1:{value:"#DF003B"},color2:{value:"#F9411B"},color3:{value:"#B70089"},borderWidth:{value:50},borderRadius:{value:100},intensity:{value:0}},heatmap:{enabled:{value:!1},intensity:{value:.1},alpha:{value:1},isolation:{value:0},threshold:{value:.01}},smaa:{enabled:{value:!0}},output:{enabled:{value:!0}}}};class cc extends we(){init(e={}){this._renderer=e.renderer,this._debugger=e.debugger,this._nuxtApp=e.nuxtApp,this._context=e.context,this._renderTarget=this._createRenderTarget(),this._composer=this._createComposer(),this._passes=this._createPasses(),this._addEventListeners(),this._debugFolder=this._createDebugFolder()}get passes(){return this._passes}get composer(){return this._composer}destroy(){this._renderTarget.dispose(),this._composer.dispose()}reduceBloomIntensity(){R.to(this._passes.selectiveBloom,{strength:.1,duration:1,ease:"power3.inOut"})}increaseBloomIntensity(){R.to(this._passes.selectiveBloom,{strength:Ee.passes.selectiveBloom.strength.value,duration:1,ease:"power3.inOut"})}initBloomIntensity(){this._passes.selectiveBloom.strength=0}_createRenderTarget(){return new dt(0,0,{samples:2})}_createComposer(){return new $l(this._renderer,this._renderTarget)}_createPasses(){const e={};return e.render=this._createRenderPass(),e.bloom=this._createBloomPass(),e.selectiveBloom=this._createSelectiveBloomPass(),e.gradient=this._createGradientPass(),e.heatmap=this._createHeatmapPass(),e.output=this._createOutputPass(),e.smaa=this._createSMAAPass(),e}_createRenderPass(){const e=new ic;return e.enabled=Ee.passes.render.enabled.value,this._composer.addPass(e),e}_createBloomPass(){const e=new Qi(new T(512,512),Ee.passes.bloom.strength.value,Ee.passes.bloom.radius.value,Ee.passes.bloom.threshold.value);return e.enabled=Ee.passes.bloom.enabled.value,e.enabled&&this._composer.addPass(e),e}_createSelectiveBloomPass(){const e=new Di({scene:null,camera:null,resolution:new T(256,256),strength:Ee.passes.selectiveBloom.strength.value,radius:Ee.passes.selectiveBloom.radius.value,threshold:Ee.passes.selectiveBloom.threshold.value,debugMask:Ee.passes.selectiveBloom.debugMask.value});return e.enabled=Ee.passes.selectiveBloom.enabled.value,(this._context.isMachine||window.matchMedia("(pointer: fine)").matches&&!Hr())&&this._composer.addPass(e),e}_createGradientPass(){const e={uniforms:{uResolution:{value:new T},tDiffuse:{value:null},uColor1:{value:new _e(Ee.passes.gradient.color1.value)},uColor2:{value:new _e(Ee.passes.gradient.color2.value)},uColor3:{value:new _e(Ee.passes.gradient.color3.value)},uBorderWidth:Ee.passes.gradient.borderWidth,uBorderRadius:Ee.passes.gradient.borderRadius,uIntensity:{value:0},uTime:{value:0}},vertexShader:ac,fragmentShader:nc},t=new je(e),i=new $s(t);return i.enabled=Ee.passes.gradient.enabled,i}_createHeatmapPass(){const e=new lc({scene:null,camera:null});return e.enabled=Ee.passes.heatmap.enabled.value,e.intensity=Ee.passes.heatmap.intensity.value,e.alpha=Ee.passes.heatmap.alpha.value,e.threshold=Ee.passes.heatmap.threshold.value,e.isolation=Ee.passes.heatmap.isolation.value,Ee.passes.heatmap.enabled&&this._composer.addPass(e),e}_createOutputPass(){const e=new tc;return e.enabled=Ee.passes.output.enabled.value,this._composer.addPass(e),e}_createSMAAPass(){const e=new sc(window.innerWidth*Je.dpr,window.innerHeight*Je.dpr);return e.enabled=Ee.passes.smaa.enabled.value,this._context.isMachine&&this._composer.addPass(e),e}_addEventListeners(){this._nuxtApp.hook("game:prepare",this._gamePrepareHandler.bind(this)),this._nuxtApp.hook("game:over",this._gameOverHandler.bind(this)),_i.ready().then(()=>{this.onWindowResize(Je.dimensions)})}_gamePrepareHandler(){R.to(this._passes.gradient.material.uniforms.uIntensity,{value:Ee.passes.gradient.intensity.value,duration:1,ease:"sine.inOut"})}_gameOverHandler(){R.to(this._passes.gradient.material.uniforms.uIntensity,{value:0,duration:1,ease:"sine.inOut",delay:.5})}render(e,t,i){this._passes.render.scene=e,this._passes.render.camera=t,Ee.passes.selectiveBloom.enabled&&(this._passes.selectiveBloom.scene=e,this._passes.selectiveBloom.camera=t),Ee.passes.heatmap.enabled&&(this._passes.heatmap.scene=e,this._passes.heatmap.camera=t),this._composer.render()}update({time:e,deltaTime:t,frame:i}){this._passes.gradient.material.uniforms.uTime.value=e}onWindowResize(e){const{maxDpr:t,maxResolution:i}=_i.globalProfile,s=_i.isReady?Math.min(e.dpr,t):e.dpr,a=new T(Math.min(e.innerWidth*s,i),Math.min(e.innerHeight*s,i));this._composer.setSize(a.x,a.y),this._passes.gradient.material.uniforms.uResolution.value.x=a.x,this._passes.gradient.material.uniforms.uResolution.value.y=a.y}_createDebugFolder(){if(!this._debugger)return;const e=()=>{for(const i in Ee.passes)for(const s in Ee.passes[i])this._passes[i][s]=Ee.passes[i][s].value},t=this._debugger.addFolder({title:"Postprocessing",expanded:!1});for(const i in Ee.passes){const s=t.addFolder({title:i,expanded:!1});for(const a in Ee.passes[i])s.addBinding(Ee.passes[i][a],"value",{label:a}).on("change",e)}this._debugger.registerFile(Ee,Ee.file)}}const Ac=`
uniform float uKa;
uniform float uKd;
uniform float uKs;
uniform float uShininess;
uniform vec3 uColorA;
uniform vec3 uColorD;
uniform vec3 uColorS;
uniform vec3 uColorE;
uniform vec3 uLightPos;
uniform float uOpacity;

uniform int nonSelectiveDirLights[NUM_DIR_LIGHTS];
uniform int uSelectiveLightsArray[NUM_DIR_LIGHTS];

#define RECIPROCAL_PI 0.3183098861837907


vec3 blendMultiply(vec3 base, vec3 blend) {
	return base*blend;
}

vec3 blendMultiply(vec3 base, vec3 blend, float opacity) {
	return (blendMultiply(base, blend) * opacity + base * (1.0 - opacity));
}

float blendSoftLight(float base, float blend) {
	return (blend<0.5)?(2.0*base*blend+base*base*(1.0-2.0*blend)):(sqrt(base)*(2.0*blend-1.0)+2.0*base*(1.0-blend));
}

vec3 blendSoftLight(vec3 base, vec3 blend) {
	return vec3(blendSoftLight(base.r,blend.r),blendSoftLight(base.g,blend.g),blendSoftLight(base.b,blend.b));
}
vec3 blendSoftLight(vec3 base, vec3 blend, float opacity) {
	return (blendSoftLight(base, blend) * opacity + base * (1.0 - opacity));
}

struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};

vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}


vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {

	vec3 halfDir = normalize( lightDir + viewDir );

	float dotNH = max(dot(normal, halfDir), 0.0);
    float dotVH = max(dot(viewDir, halfDir), 0.0);

	vec3 F = F_Schlick( specularColor, 1.0, dotVH );

	float G = 0.25;

	float D = RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );

	return F * ( G * D );

} 

#if NUM_DIR_LIGHTS > 0

	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		bool visible;
	};

	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];

#endif

#if NUM_POINT_LIGHTS > 0

  struct PointLight {
    vec3 position;
    vec3 color;
    float distance;
    float decay;
	};

	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
#endif


#define saturate( a ) clamp( a, 0.0, 1.0 )
float pow2( const in float x ) { return x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }

float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}


struct BlinnPhongMaterial {

	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;

};

void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	if(!directLight.visible) return;
	
	float dotNL = max(dot(geometryNormal, directLight.direction), 0.0);
	vec3 irradiance = dotNL * directLight.color;

	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
	
}

void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {

	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );

}

#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
`,hc=`
ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );

BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = uColorS;
material.specularShininess = uShininess;
material.specularStrength = uKs * roughness;

IncidentLight directLight;


DirectionalLight directionalLight;

#if ( NUM_DIR_LIGHTS > 0 )

  #pragma unroll_loop_start
  for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
        directionalLight = directionalLights[ i ] ;

        directLight.color = directionalLight.color;
        directLight.direction = directionalLight.direction; 
        #ifdef SELECTIVE_DIR_LIGHTS
          directLight.visible = uSelectiveLightsArray[i] == 1;
        #else
          directLight.visible = nonSelectiveDirLights[i] == 1;
        #endif

        RE_Direct( directLight, -vViewPosition, normal, normalize( vViewPosition ), material, reflectedLight );
}
  #pragma unroll_loop_end
#endif


#ifdef USE_POINT_LIGHTS
  #if ( NUM_POINT_LIGHTS > 0 )
    PointLight pointLight;

    #pragma unroll_loop_start
    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
      pointLight = pointLights[ i ];

      directLight.direction = normalize( pointLight.position - - vViewPosition );
      directLight.color = pointLight.color;
      directLight.color *= getDistanceAttenuation( length( pointLight.position - - vViewPosition ), pointLight.distance, pointLight.decay );
      directLight.visible = ( directLight.color != vec3( 0.0 ) );

      RE_Direct( directLight, - vViewPosition, normal, normalize( vViewPosition ), material, reflectedLight );
    }
    #pragma unroll_loop_end
  #endif
#endif

RE_IndirectDiffuse( uColorA, -vViewPosition, normal, normalize( vViewPosition ), material, reflectedLight );

`,uc=`
  uniform sampler2D uMatcapMap;
  uniform vec2 uMatcapOffset;
  uniform float uMatcapIntensity;
`,dc=`
vec3 matcap(float roughness) {
  vec3 newNormal = normalize(vNormal);
  vec3 viewDir = normalize(vViewPosition);
  vec3 x = normalize(vec3(viewDir.z, 0.0, - viewDir.x));
  vec3 y = cross(viewDir, x);
  vec2 uv = vec2(dot(x, newNormal), dot(y, newNormal)) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
  uv *= roughness;
  uv.x += uMatcapOffset.x;
  uv.y += uMatcapOffset.y;
  vec3 final = texture2D(uMatcapMap, uv).rgb;
  
  return final;
}
`,pc=`
#define RECIP_PI 0.3183098861837907
#define RECIP_PI2 0.15915494309189535

vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIP_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIP_PI + 0.5;
	return vec2( u, v );
}
uniform sampler2D uEnvMap;
uniform vec2 uEnvRotation;
uniform float uEnvIntensity;
varying vec3 vReflect;

`,gc=`
vec3 envmap() {
	vec3 envColor = texture2D(uEnvMap, equirectUv(normalize(vReflect))).rgb;
		// finalColor = mix(finalColor, envColor, uEnvIntensity); // mirror reflection
  return envColor;
}
`,fc=`

    vec3 worldNormal = normalize((modelMatrix * vec4(normal, 0.0)).xyz);
    vec3 viewDirection = normalize(worldPosition.xyz - cameraPosition);

    float cosY = cos(uEnvRotation.y);
    float sinY = sin(uEnvRotation.y);
    float cosX = cos(uEnvRotation.x);
    float sinX = sin(uEnvRotation.x);

    mat3 envRotationMatrix = mat3(
        cosY, 0.0, sinY,
        sinX * sinY, cosX, -cosY * sinX,
        -sinY * cosX, sinX, cosY * cosX
    );

    vReflect = reflect(-viewDirection, worldNormal);
    vReflect.y = -vReflect.y;

    vReflect = envRotationMatrix * vReflect;
`,mc=`
struct uShadow {
    sampler2D map;
    vec2 mapSize;
    float bias;
    float radius;
};


// Varyings
varying vec4 vWorldPosition;
varying vec3 vPosition;
varying vec4 vShadowCoord;
varying mat4 vModelViewMatrix;

// Uniforms
uniform float uShadowBias;
uniform float uShadowRadius;
uniform float uShadowFalloff;
uniform float uLightNear;
uniform float uLightFar;

uniform bool receiveShadow;


uniform float uShadowIntensity;
uniform vec2 uShadowMapSize;

uniform vec3 uDLightPos;
uniform vec3 uShadowColor;


vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}

vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}

#ifdef USE_SHADOWMAP

	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

	struct DirectionalLightShadow {
		float shadowBias;
		float shadowNormalBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};

	uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

#endif

vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
	return unpackRGBATo2Half( texture2D( shadow, uv ) );
}

float VSMShadow (sampler2D shadow, vec2 uv, vec2 resolution, float compare ){

	float occlusion = 1.0;

	vec2 distribution = texture2DDistribution( shadow, uv );

	float hard_shadow = step( compare , distribution.x);

	if (hard_shadow != 1.0 ) {

		float distance = compare - distribution.x;
		float variance = max( 0.00000, distribution.y * distribution.y );
		float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
		softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
		occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

	}
	return occlusion;

}

float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

    float shadow = 1.0;

    shadowCoord.xyz /= shadowCoord.w;
    shadowCoord.z += shadowBias;

    shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowMapSize, shadowCoord.z );

    return shadow;
}

#endif
`,vc=`
float shadow = 1.;
#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0
        DirectionalLight light;
        DirectionalLightShadow lightShadow;
        light = directionalLights[0];
        lightShadow = directionalLightShadows[0];
        shadow *= receiveShadow ? getShadow( directionalShadowMap[ 0 ], lightShadow.shadowMapSize, lightShadow.shadowBias, lightShadow.shadowRadius, vDirectionalShadowCoord[ 0 ] ) : 1.;

        vec3 shadowColor = mix(uShadowColor, vec3(1.0), shadow);
    #endif
#endif

shadowColor = vec3(1.0) - (vec3(1.0) - shadowColor)  * uShadowIntensity;

diffuseColor.rgb = shadowColor;
`,_c=`
    // Uniforms
    uniform vec3 uBigLightPos;
    uniform mat4 uShadowCameraProjectMatrix;
    uniform mat4 uShadowCameraWorldInverseMatrix;

    vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
        return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
    }

    #ifdef USE_SHADOWMAP
        #if NUM_DIR_LIGHT_SHADOWS > 0
            uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
            varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
            struct DirectionalLightShadow {
                float shadowBias;
                float shadowNormalBias;
                float shadowRadius;
                vec2 shadowMapSize;
            };
            uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
        #endif
    #endif
`,Cc=`
vWorldPosition = modelMatrix*vec4(position, 1.0);
vec3 objectNormal = vec3(normal);
vec3 transformedNormal = objectNormal * normalMatrix;
vec3 shadowWorldNormal = inverseTransformDirection(transformedNormal, viewMatrix);

vec4 bigShadowWorldPosition = vWorldPosition+vec4(shadowWorldNormal*directionalLightShadows[ 0 ].shadowNormalBias, 0);
vDirectionalShadowCoord[ 0 ] = directionalShadowMatrix[0 ]*bigShadowWorldPosition;
`,fs={name:"Sample",resources:[]},In={file:"./webgl/scenes/SceneSample/settings.js"},xn={type:"change"},ga={type:"start"},bn={type:"end"},ms=new zr,Bn=new vo,yc=Math.cos(70*qr.DEG2RAD);class Ec extends Vr{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new O,this.cursor=new O,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ei.ROTATE,MIDDLE:Ei.DOLLY,RIGHT:Ei.PAN},this.touches={ONE:Ii.ROTATE,TWO:Ii.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return r.phi},this.getAzimuthalAngle=function(){return r.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(g){g.addEventListener("keydown",ae),this._domElementKeyEvents=g},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ae),this._domElementKeyEvents=null},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(xn),i.update(),a=s.NONE},this.update=function(){const g=new O,H=new gt().setFromUnitVectors(e.up,new O(0,1,0)),re=H.clone().invert(),Le=new O,Ze=new gt,Zt=new O,ft=2*Math.PI;return function(lr=null){const an=i.object.position;g.copy(an).sub(i.target),g.applyQuaternion(H),r.setFromVector3(g),i.autoRotate&&a===s.NONE&&q(J(lr)),i.enableDamping?(r.theta+=l.theta*i.dampingFactor,r.phi+=l.phi*i.dampingFactor):(r.theta+=l.theta,r.phi+=l.phi);let kt=i.minAzimuthAngle,Gt=i.maxAzimuthAngle;isFinite(kt)&&isFinite(Gt)&&(kt<-Math.PI?kt+=ft:kt>Math.PI&&(kt-=ft),Gt<-Math.PI?Gt+=ft:Gt>Math.PI&&(Gt-=ft),kt<=Gt?r.theta=Math.max(kt,Math.min(Gt,r.theta)):r.theta=r.theta>(kt+Gt)/2?Math.max(kt,r.theta):Math.min(Gt,r.theta)),r.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,r.phi)),r.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(c,i.dampingFactor):i.target.add(c),i.target.sub(i.cursor),i.target.clampLength(i.minTargetRadius,i.maxTargetRadius),i.target.add(i.cursor);let Ri=!1;if(i.zoomToCursor&&I||i.object.isOrthographicCamera)r.radius=Ue(r.radius);else{const Ht=r.radius;r.radius=Ue(r.radius*h),Ri=Ht!=r.radius}if(g.setFromSpherical(r),g.applyQuaternion(re),an.copy(i.target).add(g),i.object.lookAt(i.target),i.enableDamping===!0?(l.theta*=1-i.dampingFactor,l.phi*=1-i.dampingFactor,c.multiplyScalar(1-i.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),i.zoomToCursor&&I){let Ht=null;if(i.object.isPerspectiveCamera){const Ti=g.length();Ht=Ue(Ti*h);const us=Ti-Ht;i.object.position.addScaledVector(C,us),i.object.updateMatrixWorld(),Ri=!!us}else if(i.object.isOrthographicCamera){const Ti=new O(u.x,u.y,0);Ti.unproject(i.object);const us=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),i.object.updateProjectionMatrix(),Ri=us!==i.object.zoom;const nn=new O(u.x,u.y,0);nn.unproject(i.object),i.object.position.sub(nn).add(Ti),i.object.updateMatrixWorld(),Ht=g.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;Ht!==null&&(this.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Ht).add(i.object.position):(ms.origin.copy(i.object.position),ms.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(ms.direction))<yc?e.lookAt(i.target):(Bn.setFromNormalAndCoplanarPoint(i.object.up,i.target),ms.intersectPlane(Bn,i.target))))}else if(i.object.isOrthographicCamera){const Ht=i.object.zoom;i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/h)),Ht!==i.object.zoom&&(i.object.updateProjectionMatrix(),Ri=!0)}return h=1,I=!1,Ri||Le.distanceToSquared(i.object.position)>n||8*(1-Ze.dot(i.object.quaternion))>n||Zt.distanceToSquared(i.target)>n?(i.dispatchEvent(xn),Le.copy(i.object.position),Ze.copy(i.object.quaternion),Zt.copy(i.target),!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",ye),i.domElement.removeEventListener("pointerdown",De),i.domElement.removeEventListener("pointercancel",oe),i.domElement.removeEventListener("wheel",Pe),i.domElement.removeEventListener("pointermove",ge),i.domElement.removeEventListener("pointerup",oe),i.domElement.getRootNode().removeEventListener("keydown",Xe,{capture:!0}),i._domElementKeyEvents!==null&&(i._domElementKeyEvents.removeEventListener("keydown",ae),i._domElementKeyEvents=null)};const i=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=s.NONE;const n=1e-6,r=new An,l=new An;let h=1;const c=new O,A=new T,d=new T,m=new T,p=new T,f=new T,_=new T,E=new T,x=new T,y=new T,C=new O,u=new T;let I=!1;const w=[],L={};let k=!1;function J(g){return g!==null?2*Math.PI/60*i.autoRotateSpeed*g:2*Math.PI/60/60*i.autoRotateSpeed}function j(g){const H=Math.abs(g*.01);return Math.pow(.95,i.zoomSpeed*H)}function q(g){l.theta-=g}function pe(g){l.phi-=g}const ve=function(){const g=new O;return function(re,Le){g.setFromMatrixColumn(Le,0),g.multiplyScalar(-re),c.add(g)}}(),ee=function(){const g=new O;return function(re,Le){i.screenSpacePanning===!0?g.setFromMatrixColumn(Le,1):(g.setFromMatrixColumn(Le,0),g.crossVectors(i.object.up,g)),g.multiplyScalar(re),c.add(g)}}(),Me=function(){const g=new O;return function(re,Le){const Ze=i.domElement;if(i.object.isPerspectiveCamera){const Zt=i.object.position;g.copy(Zt).sub(i.target);let ft=g.length();ft*=Math.tan(i.object.fov/2*Math.PI/180),ve(2*re*ft/Ze.clientHeight,i.object.matrix),ee(2*Le*ft/Ze.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(ve(re*(i.object.right-i.object.left)/i.object.zoom/Ze.clientWidth,i.object.matrix),ee(Le*(i.object.top-i.object.bottom)/i.object.zoom/Ze.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function P(g){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?h/=g:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function V(g){i.object.isPerspectiveCamera||i.object.isOrthographicCamera?h*=g:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function G(g,H){if(!i.zoomToCursor)return;I=!0;const re=i.domElement.getBoundingClientRect(),Le=g-re.left,Ze=H-re.top,Zt=re.width,ft=re.height;u.x=Le/Zt*2-1,u.y=-(Ze/ft)*2+1,C.set(u.x,u.y,1).unproject(i.object).sub(i.object.position).normalize()}function Ue(g){return Math.max(i.minDistance,Math.min(i.maxDistance,g))}function qe(g){A.set(g.clientX,g.clientY)}function Ye(g){G(g.clientX,g.clientX),E.set(g.clientX,g.clientY)}function Ce(g){p.set(g.clientX,g.clientY)}function Ge(g){d.set(g.clientX,g.clientY),m.subVectors(d,A).multiplyScalar(i.rotateSpeed);const H=i.domElement;q(2*Math.PI*m.x/H.clientHeight),pe(2*Math.PI*m.y/H.clientHeight),A.copy(d),i.update()}function rt(g){x.set(g.clientX,g.clientY),y.subVectors(x,E),y.y>0?P(j(y.y)):y.y<0&&V(j(y.y)),E.copy(x),i.update()}function ri(g){f.set(g.clientX,g.clientY),_.subVectors(f,p).multiplyScalar(i.panSpeed),Me(_.x,_.y),p.copy(f),i.update()}function b(g){G(g.clientX,g.clientY),g.deltaY<0?V(j(g.deltaY)):g.deltaY>0&&P(j(g.deltaY)),i.update()}function B(g){let H=!1;switch(g.code){case i.keys.UP:g.ctrlKey||g.metaKey||g.shiftKey?pe(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Me(0,i.keyPanSpeed),H=!0;break;case i.keys.BOTTOM:g.ctrlKey||g.metaKey||g.shiftKey?pe(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Me(0,-i.keyPanSpeed),H=!0;break;case i.keys.LEFT:g.ctrlKey||g.metaKey||g.shiftKey?q(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Me(i.keyPanSpeed,0),H=!0;break;case i.keys.RIGHT:g.ctrlKey||g.metaKey||g.shiftKey?q(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):Me(-i.keyPanSpeed,0),H=!0;break}H&&(g.preventDefault(),i.update())}function S(g){if(w.length===1)A.set(g.pageX,g.pageY);else{const H=Ot(g),re=.5*(g.pageX+H.x),Le=.5*(g.pageY+H.y);A.set(re,Le)}}function Q(g){if(w.length===1)p.set(g.pageX,g.pageY);else{const H=Ot(g),re=.5*(g.pageX+H.x),Le=.5*(g.pageY+H.y);p.set(re,Le)}}function F(g){const H=Ot(g),re=g.pageX-H.x,Le=g.pageY-H.y,Ze=Math.sqrt(re*re+Le*Le);E.set(0,Ze)}function X(g){i.enableZoom&&F(g),i.enablePan&&Q(g)}function ce(g){i.enableZoom&&F(g),i.enableRotate&&S(g)}function te(g){if(w.length==1)d.set(g.pageX,g.pageY);else{const re=Ot(g),Le=.5*(g.pageX+re.x),Ze=.5*(g.pageY+re.y);d.set(Le,Ze)}m.subVectors(d,A).multiplyScalar(i.rotateSpeed);const H=i.domElement;q(2*Math.PI*m.x/H.clientHeight),pe(2*Math.PI*m.y/H.clientHeight),A.copy(d)}function Z(g){if(w.length===1)f.set(g.pageX,g.pageY);else{const H=Ot(g),re=.5*(g.pageX+H.x),Le=.5*(g.pageY+H.y);f.set(re,Le)}_.subVectors(f,p).multiplyScalar(i.panSpeed),Me(_.x,_.y),p.copy(f)}function Ae(g){const H=Ot(g),re=g.pageX-H.x,Le=g.pageY-H.y,Ze=Math.sqrt(re*re+Le*Le);x.set(0,Ze),y.set(0,Math.pow(x.y/E.y,i.zoomSpeed)),P(y.y),E.copy(x);const Zt=(g.pageX+H.x)*.5,ft=(g.pageY+H.y)*.5;G(Zt,ft)}function ue(g){i.enableZoom&&Ae(g),i.enablePan&&Z(g)}function Be(g){i.enableZoom&&Ae(g),i.enableRotate&&te(g)}function De(g){i.enabled!==!1&&(w.length===0&&(i.domElement.setPointerCapture(g.pointerId),i.domElement.addEventListener("pointermove",ge),i.domElement.addEventListener("pointerup",oe)),!Qt(g)&&(Te(g),g.pointerType==="touch"?Qe(g):xe(g)))}function ge(g){i.enabled!==!1&&(g.pointerType==="touch"?z(g):me(g))}function oe(g){switch(Ve(g),w.length){case 0:i.domElement.releasePointerCapture(g.pointerId),i.domElement.removeEventListener("pointermove",ge),i.domElement.removeEventListener("pointerup",oe),i.dispatchEvent(bn),a=s.NONE;break;case 1:const H=w[0],re=L[H];Qe({pointerId:H,pageX:re.x,pageY:re.y});break}}function xe(g){let H;switch(g.button){case 0:H=i.mouseButtons.LEFT;break;case 1:H=i.mouseButtons.MIDDLE;break;case 2:H=i.mouseButtons.RIGHT;break;default:H=-1}switch(H){case Ei.DOLLY:if(i.enableZoom===!1)return;Ye(g),a=s.DOLLY;break;case Ei.ROTATE:if(g.ctrlKey||g.metaKey||g.shiftKey){if(i.enablePan===!1)return;Ce(g),a=s.PAN}else{if(i.enableRotate===!1)return;qe(g),a=s.ROTATE}break;case Ei.PAN:if(g.ctrlKey||g.metaKey||g.shiftKey){if(i.enableRotate===!1)return;qe(g),a=s.ROTATE}else{if(i.enablePan===!1)return;Ce(g),a=s.PAN}break;default:a=s.NONE}a!==s.NONE&&i.dispatchEvent(ga)}function me(g){switch(a){case s.ROTATE:if(i.enableRotate===!1)return;Ge(g);break;case s.DOLLY:if(i.enableZoom===!1)return;rt(g);break;case s.PAN:if(i.enablePan===!1)return;ri(g);break}}function Pe(g){i.enabled===!1||i.enableZoom===!1||a!==s.NONE||(g.preventDefault(),i.dispatchEvent(ga),b(de(g)),i.dispatchEvent(bn))}function de(g){const H=g.deltaMode,re={clientX:g.clientX,clientY:g.clientY,deltaY:g.deltaY};switch(H){case 1:re.deltaY*=16;break;case 2:re.deltaY*=100;break}return g.ctrlKey&&!k&&(re.deltaY*=10),re}function Xe(g){g.key==="Control"&&(k=!0,i.domElement.getRootNode().addEventListener("keyup",We,{passive:!0,capture:!0}))}function We(g){g.key==="Control"&&(k=!1,i.domElement.getRootNode().removeEventListener("keyup",We,{passive:!0,capture:!0}))}function ae(g){i.enabled===!1||i.enablePan===!1||B(g)}function Qe(g){switch(Bt(g),w.length){case 1:switch(i.touches.ONE){case Ii.ROTATE:if(i.enableRotate===!1)return;S(g),a=s.TOUCH_ROTATE;break;case Ii.PAN:if(i.enablePan===!1)return;Q(g),a=s.TOUCH_PAN;break;default:a=s.NONE}break;case 2:switch(i.touches.TWO){case Ii.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;X(g),a=s.TOUCH_DOLLY_PAN;break;case Ii.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ce(g),a=s.TOUCH_DOLLY_ROTATE;break;default:a=s.NONE}break;default:a=s.NONE}a!==s.NONE&&i.dispatchEvent(ga)}function z(g){switch(Bt(g),a){case s.TOUCH_ROTATE:if(i.enableRotate===!1)return;te(g),i.update();break;case s.TOUCH_PAN:if(i.enablePan===!1)return;Z(g),i.update();break;case s.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;ue(g),i.update();break;case s.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Be(g),i.update();break;default:a=s.NONE}}function ye(g){i.enabled!==!1&&g.preventDefault()}function Te(g){w.push(g.pointerId)}function Ve(g){delete L[g.pointerId];for(let H=0;H<w.length;H++)if(w[H]==g.pointerId){w.splice(H,1);return}}function Qt(g){for(let H=0;H<w.length;H++)if(w[H]==g.pointerId)return!0;return!1}function Bt(g){let H=L[g.pointerId];H===void 0&&(H=new T,L[g.pointerId]=H),H.set(g.pageX,g.pageY)}function Ot(g){const H=g.pointerId===w[0]?w[1]:w[0];return L[H]}i.domElement.addEventListener("contextmenu",ye),i.domElement.addEventListener("pointerdown",De),i.domElement.addEventListener("pointercancel",oe),i.domElement.addEventListener("wheel",Pe,{passive:!1}),i.domElement.getRootNode().addEventListener("keydown",Xe,{passive:!0,capture:!0}),this.update()}}class Ic extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialSettings={fov:45,near:1,far:1e3,target:{x:0,y:0,z:0},position:{x:0,y:0,z:5},rotation:{x:0,y:0,z:0}},this._initialize(),this._applySavedSettings(),this._enabled=!1,this._debugFolder=this._createDebugFolder(),this._controls=this._createCameraControls(),this._initializeControls(),this._applySavedSettingsControls(),this._setupEventListeners()}destroy(){super.destroy(),this._controls.dispose(),this._removeEventListeners()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._controls.enabled=e}_initialize(){this.fov=this._initialSettings.fov,this.near=this._initialSettings.near,this.far=this._initialSettings.far,this.position.x=this._initialSettings.position.x,this.position.y=this._initialSettings.position.y,this.position.z=this._initialSettings.position.z,this.rotation.x=this._initialSettings.rotation.x,this.rotation.y=this._initialSettings.rotation.y,this.rotation.z=this._initialSettings.rotation.z,this.updateProjectionMatrix()}_applySavedSettings(){this.updateProjectionMatrix();const e=JSON.parse(sessionStorage.getItem(`camera-orbit-settings/${this._id}`)),t=JSON.parse(sessionStorage.getItem(`camera-orbit-position/${this._id}`)),i=JSON.parse(sessionStorage.getItem(`camera-orbit-rotation/${this._id}`));e&&e.fov&&(this.fov=e.fov),e&&e.near&&(this.near=e.near),e&&e.far&&(this.far=e.far),i&&(this.rotation.x=i.x),i&&(this.rotation.y=i.y),i&&(this.rotation.z=i.z),t&&(this.position.x=t.x),t&&(this.position.y=t.y),t&&(this.position.z=t.z)}_createCameraControls(){const e=new Ec(this,this.$renderer.domElement);return e.update(),e}_initializeControls(){this._controls.target.x=this._initialSettings.target.x,this._controls.target.y=this._initialSettings.target.y,this._controls.target.z=this._initialSettings.target.z,this._controls.update()}_applySavedSettingsControls(){const e=JSON.parse(sessionStorage.getItem(`camera-orbit-target/${this._id}`));e&&(this._controls.target.x=e.x),e&&(this._controls.target.y=e.y),e&&(this._controls.target.z=e.z),this._controls.update()}_bindAll(){this._controlsChangeHandler=this._controlsChangeHandler.bind(this),this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this),this._resetSettingsClickHandler=this._resetSettingsClickHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.fullHeight,this.updateProjectionMatrix()}_setupEventListeners(){this._controls.addEventListener("change",this._controlsChangeHandler)}_removeEventListeners(){this._controls.removeEventListener("change",this._controlsChangeHandler)}_controlsChangeHandler(e){sessionStorage.setItem(`camera-orbit-position/${this._id}`,JSON.stringify(this.position)),sessionStorage.setItem(`camera-orbit-rotation/${this._id}`,JSON.stringify(this.rotation)),sessionStorage.setItem(`camera-orbit-target/${this._id}`,JSON.stringify(this._controls.target))}_updateCameraSettingsHandler(){const e={fov:this.fov,near:this.near,far:this.far};this.updateProjectionMatrix(),sessionStorage.setItem(`camera-orbit-settings/${this._id}`,JSON.stringify(e))}_resetSettingsClickHandler(){this._initialize(),this._initializeControls(),this.$debugger.refresh(),sessionStorage.removeItem(`camera-orbit-settings/${this._id}`),sessionStorage.removeItem(`camera-orbit-position/${this._id}`),sessionStorage.removeItem(`camera-orbit-rotation/${this._id}`),sessionStorage.removeItem(`camera-orbit-target/${this._id}`)}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Orbit",expanded:!1});return e.addBinding(this,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"far").on("change",this._updateCameraSettingsHandler),e.addButton({label:" ",title:"Reset settings"}).on("click",this._resetSettingsClickHandler),e}}class xc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialSettings={fov:45,near:1,far:1e3,position:{x:0,y:0,z:5},rotation:{x:0,y:0,z:0}},this._initialize(),this._applySavedSettings(),this._enabled=!1,this._debugFolder=this._createDebugFolder()}get enabled(){return this._enabled}set enabled(e){this._enabled=e}_initialize(){this.fov=this._initialSettings.fov,this.near=this._initialSettings.near,this.far=this._initialSettings.far,this.position.x=this._initialSettings.position.x,this.position.y=this._initialSettings.position.y,this.position.z=this._initialSettings.position.z,this.rotation.x=this._initialSettings.rotation.x,this.rotation.y=this._initialSettings.rotation.y,this.rotation.z=this._initialSettings.rotation.z,this.updateProjectionMatrix()}_applySavedSettings(){const e=JSON.parse(sessionStorage.getItem(`camera-default-settings/${this._id}`)),t=JSON.parse(sessionStorage.getItem(`camera-default-position/${this._id}`)),i=JSON.parse(sessionStorage.getItem(`camera-default-rotation/${this._id}`));e&&e.fov&&(this.fov=e.fov),e&&e.near&&(this.near=e.near),e&&e.far&&(this.far=e.far),t&&t.x&&(this.position.x=t.x),t&&t.y&&(this.position.y=t.y),t&&t.z&&(this.position.z=t.z),i&&i.x&&(this.rotation.x=i.x),i&&i.y&&(this.rotation.y=i.y),i&&i.z&&(this.rotation.z=i.z),this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this),this._resetSettingsClickHandler=this._resetSettingsClickHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){const e={fov:this.fov,near:this.near,far:this.far};sessionStorage.setItem(`camera-default-settings/${this._id}`,JSON.stringify(e)),sessionStorage.setItem(`camera-default-position/${this._id}`,JSON.stringify(this.position)),sessionStorage.setItem(`camera-default-rotation/${this._id}`,JSON.stringify({x:this.rotation.x,y:this.rotation.y,z:this.rotation.z})),this.updateProjectionMatrix()}_resetSettingsClickHandler(){sessionStorage.removeItem(`camera-default-settings/${this._id}`),sessionStorage.removeItem(`camera-default-position/${this._id}`),sessionStorage.removeItem(`camera-default-rotation/${this._id}`),this._initialize(),this.$debugger.refresh()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Default",expanded:!1});return e.addBinding(this,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(this,"rotation").on("change",this._updateCameraSettingsHandler),e.addButton({label:" ",title:"Reset settings"}).on("click",this._resetSettingsClickHandler),e}}const Oe={file:"./webgl/modules/cameras/CameraFlipperMachine/settings.js",position:{x:0,y:13,z:-6.3},rotation:{x:1.12,y:3.14,z:0},fov:39,initialFov:39,near:.1,far:300};class bc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._enabled=!0,this._debugFolder=this._createDebugFolder()}get enabled(){return this._enabled}set enabled(e){this._enabled=e}zoomIn(){const e=Oe.initialFov-5,t=Oe.initialFov,i=Ct(this.fov-5,e,t);this.fov=Ct(this.fov-.02,e,t),this.updateProjectionMatrix();const s=(i-e)/(t-e),a=Math.pow(1-s,2);this.position.x+=(Math.random()-.5)*a*.01,this.position.y+=(Math.random()-.5)*a*.01,this.position.z+=(Math.random()-.5)*a*.01,this.rotation.x+=(Math.random()-.5)*a*.001,this.rotation.y+=(Math.random()-.5)*a*.001}zoomOut(){R.to(this,{duration:.4,ease:"bounce.out",fov:Oe.initialFov,onUpdate:()=>{this.updateProjectionMatrix()}}),R.to(this.position,{duration:.4,ease:"bounce.out",x:Oe.position.x,y:Oe.position.y,z:Oe.position.z}),R.to(this.rotation,{duration:.4,ease:"bounce.out",x:Oe.rotation.x,y:Oe.rotation.y,z:Oe.rotation.z})}shakeOnLose(){R.to(this.position,{x:`+=${(Math.random()-.5)*.01}`,y:`+=${(Math.random()-.5)*.01}`,z:`+=${(Math.random()-.5)*.01}`,duration:.05,repeat:7,yoyo:!0,ease:"power1.inOut"}),R.to(this.rotation,{x:`+=${(Math.random()-.5)*.01}`,y:`+=${(Math.random()-.5)*.01}`,duration:.05,repeat:7,yoyo:!0,ease:"power1.inOut"})}shakeOnCollision(){this.position.x+=(Math.random()-.5)*.4,this.position.y+=(Math.random()-.5)*.4,this.position.z+=(Math.random()-.5)*.4,this.rotation.x+=(Math.random()-.5)*.4,this.rotation.y+=(Math.random()-.5)*.4}_initialize(){this.fov=Oe.fov,this.near=Oe.near,this.far=Oe.far,this.position.x=Oe.position.x,this.position.y=Oe.position.y,this.position.z=Oe.position.z,this.rotation.x=Oe.rotation.x,this.rotation.y=Oe.rotation.y,this.rotation.z=Oe.rotation.z,this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Flipper Machine",expanded:!1});return e.addBinding(Oe,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(Oe,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(Oe,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(Oe,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(Oe,"rotation").on("change",this._updateCameraSettingsHandler),this.$debugger.registerFile(Oe,Oe.file),e}}const ie={file:"./webgl/modules/cameras/CameraFlipperMain/settings.js",position:{x:0,y:13,z:-6.3},rotation:{x:.6200000000000001,y:3.14,z:0},launcherPosition:{x:0,y:6,z:-6.3},mobile:{followBallOffset:{x:-.5548141479492188,y:7.5227111816406245,z:14.542285156250001},followBallIntensity:{x:.4,y:.8,z:.4999999999999999},followBallLerp:{x:.07,y:.03,z:.12}},desktop:{followBallOffset:{x:-.5548141479492188,y:5.022711181640625,z:-5.55771484375},followBallIntensity:{x:.4,y:.16000000000000003,z:.6699999999999998},followBallLerp:{x:.07,y:.03,z:.181},lookAtOffset:{x:0,y:0,z:-1.9000000000000001},lookAtMaxPosition:{x:{min:0,max:0},y:{min:0,max:0},z:{min:-3.3000000000000003,max:6.720000000000001}},maxPosition:{x:{min:-6,max:2},y:{min:-1.5,max:1.5},z:{min:-1.3058154922471008,max:3.190674149546229}}},fov:39,initialFov:39,near:.1,far:300};class Bc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._lookAtFactor={value:1},this._targetPosition=new O,this._targetLookAtPosition=new O,this._targetQuaternion=new gt,this._enabled=!0,this._allowFollowBall=!1,this._allowLookAt=!1,this._isDesktop=si.current==="large"||si.current==="extra-large",this._debugFolder=this._createDebugFolder()}get enabled(){return this._enabled}set enabled(e){this._enabled=e}get allowFollowBall(){return this._allowFollowBall}set allowFollowBall(e){this._allowFollowBall=e}zoomIn(){const e=ie.initialFov-5,t=ie.initialFov,i=Ct(this.fov-5,e,t);this.fov=Ct(this.fov-.02,e,t),this._allowLookAt=!0,this.updateProjectionMatrix();const s=(i-e)/(t-e),a=Math.pow(1-s,2);this._previousPosition=this.position.clone(),this._previousRotation=this.rotation.clone(),this.position.x+=(Math.random()-.5)*a*.01,this.position.y+=(Math.random()-.5)*a*.01,this.position.z+=(Math.random()-.5)*a*.01,this.rotation.x+=(Math.random()-.5)*a*.001,this.rotation.y+=(Math.random()-.5)*a*.001}zoomOut(){R.to(this._lookAtFactor,{value:.2,duration:.4,ease:"power3.out",onComplete:()=>{this._allowLookAt=!1}}),R.to(this,{duration:.4,ease:"bounce.out",fov:ie.initialFov,onUpdate:()=>{this.updateProjectionMatrix()}}),R.to(this.position,{duration:.4,ease:"bounce.out",x:this._previousPosition.x,y:this._previousPosition.y,z:this._previousPosition.z}),R.to(this.rotation,{duration:.4,ease:"bounce.out",x:this._previousRotation.x,y:this._previousRotation.y,z:this._previousRotation.z})}resetLookAtStates(e,t){this._allowLookAt=!1,this._lookAtFactor.value=1;const i=e.lookAt._getSpline(t).position;this._targetPosition.x=i.x,this._targetPosition.y=i.y,this._targetPosition.z=i.z}shakeOnLose(){R.to(this.position,{x:`+=${(Math.random()-.5)*.02}`,y:`+=${(Math.random()-.5)*.02}`,z:`+=${(Math.random()-.5)*.02}`,duration:.05,repeat:4,yoyo:!0,ease:"power1.inOut"}),R.to(this.rotation,{x:`+=${(Math.random()-.5)*.02}`,y:`+=${(Math.random()-.5)*.02}`,duration:.05,repeat:4,yoyo:!0,ease:"power1.inOut"})}shakeOnLoseFinal(){R.to(this.position,{x:`+=${(Math.random()-.5)*.03}`,y:`+=${(Math.random()-.5)*.03}`,z:`+=${(Math.random()-.5)*.03}`,duration:.05,repeat:8,yoyo:!0,ease:"power1.inOut"}),R.to(this.rotation,{x:`+=${(Math.random()-.5)*.03}`,y:`+=${(Math.random()-.5)*.03}`,duration:.05,repeat:8,yoyo:!0,ease:"power1.inOut"})}shakeOnCollision(){this.position.x+=(Math.random()-.5)*.01,this.position.y+=(Math.random()-.5)*.01,this.position.z+=(Math.random()-.5)*.01,this.rotation.x+=(Math.random()-.5)*.01,this.rotation.y+=(Math.random()-.5)*.01}followBall(e,t){this._isDesktop?this._followBallDesktop(e,t):this._followBallMobile(e,t)}playLoseToStartPos(e,t,i){var r,l;(r=this._timelineCamera)==null||r.kill(),(l=this._resetCameraTimeline)==null||l.kill(),this._resetCameraTimeline=new R.timeline({paused:!1,delay:.25,onComplete:()=>{i.canLaunch=!0}});const{position:s}=e.pos._getSpline(t);this._resetCameraTimeline.to(this.position,{x:s.x,y:s.y,z:s.z,duration:1.5,ease:"power3.inOut"});const a=new O;a.copy(this._targetLookAtPosition);const n=e.lookAt._getSpline(t).position;this._resetCameraTimeline.to(a,{x:n.x,y:n.y,z:n.z,duration:1.5,ease:"power3.inOut",onUpdate:()=>{const h=this.quaternion.clone();this.lookAt(a),this._targetQuaternion.copy(this.quaternion),this.quaternion.copy(h),this.quaternion.slerp(this._targetQuaternion,.1)}},0)}setCameraToSplinePos(e,t){var a;(a=this._timelineCamera)==null||a.kill();const{position:i}=e.pos._getSpline(t);this.position.set(i.x,i.y,i.z);const s=e.lookAt._getSpline(t).position;this.lookAt(s.x,s.y,s.z)}playCameraSplinePath(e,t,i){var n;(n=this._timelineCamera)==null||n.kill(),this._timelineCamera=new R.timeline({paused:!1,delay:t||0});const s={value:0},a={value:0};return(e.pos._name==="launcherMobileTutorialSplinePos"||e.pos._name==="launcherDesktopSplinePos")&&i&&R.delayedCall(1,()=>{i.canLaunch=!0}),this._timelineCamera.to(s,{value:1,duration:e.pos.settings.duration,ease:e.pos.settings.ease,onUpdate:()=>{const{position:r}=e.pos._getSpline(s.value);this._targetPosition.x=r.x,this._targetPosition.y=r.y,this._targetPosition.z=r.z,this.position.set(this._targetPosition.x,this._targetPosition.y,this._targetPosition.z)}},e.pos.settings.delay),this._timelineCamera.to(a,{value:1,duration:e.lookAt.settings.duration,ease:e.lookAt.settings.ease,onUpdate:()=>{const{position:r}=e.lookAt._getSpline(a.value);this.lookAt(r.x,r.y,r.z)}},e.lookAt.settings.delay),this._timelineCamera}setLauncherPosition(){this.position.y=ie.launcherPosition.y,this.position.z=ie.launcherPosition.z}_initialize(){this.fov=ie.fov,this.near=ie.near,this.far=ie.far,this.position.x=ie.position.x,this.position.y=ie.position.y,this.position.z=ie.position.z,this.rotation.x=ie.rotation.x,this.rotation.y=ie.rotation.y,this.rotation.z=ie.rotation.z,this.updateProjectionMatrix()}_followBallMobile(e,t){if(!this._allowLookAt&&this._allowFollowBall){this._targetLookAtPosition.x=this.position.x,this._targetLookAtPosition.y=this.position.y*this._lookAtFactor.value,this._targetLookAtPosition.z=this.position.z*this._lookAtFactor.value;const i={x:this.quaternion.x,y:this.quaternion.y,z:this.quaternion.z,w:this.quaternion.w};this.lookAt(this._targetLookAtPosition),this._targetQuaternion.x=this.quaternion.x,this._targetQuaternion.y=this.quaternion.y,this._targetQuaternion.z=this.quaternion.z,this._targetQuaternion.w=this.quaternion.w,this.quaternion.x=i.x,this.quaternion.y=i.y,this.quaternion.z=i.z,this.quaternion.w=i.w,this.quaternion.slerp(this._targetQuaternion,.1),this.position.z=Rt(this.position.z,(Ct(e.z,-6,2)-ie.mobile.followBallOffset.z)*ie.mobile.followBallIntensity.z,ie.mobile.followBallLerp.z*t/16),this.position.x=Rt(this.position.x,(e.x-ie.mobile.followBallOffset.x)*ie.mobile.followBallIntensity.x,ie.mobile.followBallLerp.x*t/16),this.position.y=Rt(this.position.y,ie.mobile.followBallOffset.y+Ct(e.z,0,2)*ie.mobile.followBallIntensity.y,ie.mobile.followBallLerp.y*t/16)}}_followBallDesktop(e,t){if(!this._allowLookAt&&this._allowFollowBall){this._targetLookAtPosition.x=this.position.x,this._targetLookAtPosition.y=this.position.y*this._lookAtFactor.value,this._targetLookAtPosition.z=Rt(this._targetLookAtPosition.z,Ct(e.z+ie.desktop.lookAtOffset.z,ie.desktop.lookAtMaxPosition.z.min,ie.desktop.lookAtMaxPosition.z.max),.02);const i={x:this.quaternion.x,y:this.quaternion.y,z:this.quaternion.z,w:this.quaternion.w};this.lookAt(this._targetLookAtPosition),this._targetQuaternion.x=this.quaternion.x,this._targetQuaternion.y=this.quaternion.y,this._targetQuaternion.z=this.quaternion.z,this._targetQuaternion.w=this.quaternion.w,this.quaternion.x=i.x,this.quaternion.y=i.y,this.quaternion.z=i.z,this.quaternion.w=i.w,this.quaternion.slerp(this._targetQuaternion,.1),this.position.z=Rt(this.position.z,Ct(e.z,ie.desktop.maxPosition.z.min,ie.desktop.maxPosition.z.max)+ie.desktop.followBallOffset.z,ie.desktop.followBallLerp.z*t/16),this.position.y=Rt(this.position.y,ie.desktop.followBallOffset.y+Ct(e.z*10,ie.desktop.maxPosition.y.min,ie.desktop.maxPosition.y.max)*ie.desktop.followBallIntensity.y,ie.desktop.followBallLerp.y*t/16),this.position.x=Rt(this.position.x,(e.x-ie.desktop.followBallOffset.x)*ie.desktop.followBallIntensity.x,ie.desktop.followBallLerp.x*t/16)}}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Flipper Main",expanded:!1});e.addBinding(ie.desktop,"followBallOffset"),e.addBinding(ie.desktop,"followBallIntensity"),e.addBinding(ie.desktop,"followBallLerp"),e.addBinding(ie.desktop,"lookAtOffset"),e.addBinding(ie.desktop.maxPosition,"x"),e.addBinding(ie.desktop.maxPosition,"y"),e.addBinding(ie.desktop.maxPosition,"z"),e.addBinding(ie.desktop.lookAtMaxPosition,"x"),e.addBinding(ie.desktop.lookAtMaxPosition,"y"),e.addBinding(ie.desktop.lookAtMaxPosition,"z"),this.$debugger.registerFile(ie,ie.file)}}const tt={file:"./webgl/modules/cameras/CameraFlipperCinematics/CameraIntro/settings.js",position:{x:0,y:.7999999999999998,z:-.10000000000000031},rotation:{x:.4,y:3.14,z:0},fov:73,near:.1,far:1e3};class Sc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._enabled=!0,this._debugFolder=this._createDebugFolder()}playCameraSplinePath(e){var s;(s=this._timelineCamera)==null||s.kill(),this._timelineCamera=new R.timeline({paused:!1,repeat:-1,yoyo:!0});const t={value:0},i={value:0};return this._timelineCamera.to(t,{value:1,duration:e.pos.settings.duration,ease:e.pos.settings.ease,onUpdate:()=>{const{position:a}=e.pos._getSpline(t.value);this._targetPosition.x=a.x,this._targetPosition.y=a.y,this._targetPosition.z=a.z,this.position.set(this._targetPosition.x,this._targetPosition.y,this._targetPosition.z)}},e.pos.settings.delay),this._timelineCamera.to(i,{value:1,duration:e.lookAt.settings.duration,ease:e.lookAt.settings.ease,onUpdate:()=>{const{position:a}=e.lookAt._getSpline(i.value);this.lookAt(a.x,a.y,a.z)}},e.lookAt.settings.delay),this._timelineCamera}get enabled(){return this._enabled}set enabled(e){this._enabled=e}_initialize(){this.fov=tt.fov,this.near=tt.near,this.far=tt.far,this.position.x=tt.position.x,this.position.y=tt.position.y,this.position.z=tt.position.z,this.rotation.x=tt.rotation.x,this.rotation.y=tt.rotation.y,this.rotation.z=tt.rotation.z,this._targetPosition={x:0,y:0,z:0},this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize(),this.playCinematicAnimation()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Intro",expanded:!1});return e.addBinding(tt,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(tt,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(tt,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(tt,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(tt,"rotation").on("change",this._updateCameraSettingsHandler),this.$debugger.registerFile(tt,tt.file),e}}const it={file:"./webgl/modules/cameras/CameraFlipperCinematics/CameraBeautyHub/settings.js",position:{x:0,y:.7999999999999998,z:-.10000000000000031},rotation:{x:.4,y:3.14,z:0},fov:73,near:.1,far:1e3};class wc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._enabled=!0,this._debugFolder=this._createDebugFolder()}playCameraSplinePath(e){var s;(s=this._timelineCamera)==null||s.kill(),this._timelineCamera=new R.timeline({paused:!1,repeat:-1,yoyo:!0});const t={value:0},i={value:0};return this._timelineCamera.to(t,{value:1,duration:e.pos.settings.duration,ease:e.pos.settings.ease,onUpdate:()=>{const{position:a}=e.pos._getSpline(t.value);this._targetPosition.x=a.x,this._targetPosition.y=a.y,this._targetPosition.z=a.z,this.position.set(this._targetPosition.x,this._targetPosition.y,this._targetPosition.z)}},e.pos.settings.delay),this._timelineCamera.to(i,{value:1,duration:e.lookAt.settings.duration,ease:e.lookAt.settings.ease,onUpdate:()=>{const{position:a}=e.lookAt._getSpline(i.value);this.lookAt(a.x,a.y,a.z)}},e.lookAt.settings.delay),this._timelineCamera}get enabled(){return this._enabled}set enabled(e){this._enabled=e}_initialize(){this.fov=it.fov,this.near=it.near,this.far=it.far,this.position.x=it.position.x,this.position.y=it.position.y,this.position.z=it.position.z,this.rotation.x=it.rotation.x,this.rotation.y=it.rotation.y,this.rotation.z=it.rotation.z,this._targetPosition={x:0,y:0,z:0},this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize(),this.playCinematicAnimation()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Beauty Hub",expanded:!1});return e.addBinding(it,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(it,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(it,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(it,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(it,"rotation").on("change",this._updateCameraSettingsHandler),this.$debugger.registerFile(it,it.file),e}}const st={file:"./webgl/modules/cameras/CameraFlipperCinematics/CameraLips/settings.js",position:{x:0,y:.7999999999999998,z:-.10000000000000031},rotation:{x:.4,y:3.14,z:0},fov:73,near:.1,far:1e3};class Mc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._enabled=!0,this._debugFolder=this._createDebugFolder()}playCameraSplinePath(e){var s;(s=this._timelineCamera)==null||s.kill(),this._timelineCamera=new R.timeline({paused:!1,repeat:-1,yoyo:!0});const t={value:0},i={value:0};return this._timelineCamera.to(t,{value:1,duration:e.pos.settings.duration,ease:e.pos.settings.ease,onUpdate:()=>{const{position:a}=e.pos._getSpline(t.value);this._targetPosition.x=a.x,this._targetPosition.y=a.y,this._targetPosition.z=a.z,this.position.set(this._targetPosition.x,this._targetPosition.y,this._targetPosition.z)}},e.pos.settings.delay),this._timelineCamera.to(i,{value:1,duration:e.lookAt.settings.duration,ease:e.lookAt.settings.ease,onUpdate:()=>{const{position:a}=e.lookAt._getSpline(i.value);this.lookAt(a.x,a.y,a.z)}},e.lookAt.settings.delay),this._timelineCamera}get enabled(){return this._enabled}set enabled(e){this._enabled=e}_initialize(){this.fov=st.fov,this.near=st.near,this.far=st.far,this.position.x=st.position.x,this.position.y=st.position.y,this.position.z=st.position.z,this.rotation.x=st.rotation.x,this.rotation.y=st.rotation.y,this.rotation.z=st.rotation.z,this._targetPosition={x:0,y:0,z:0},this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize(),this.playCinematicAnimation()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Lip",expanded:!1});return e.addBinding(st,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(st,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(st,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(st,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(st,"rotation").on("change",this._updateCameraSettingsHandler),this.$debugger.registerFile(st,st.file),e}}const at={file:"./webgl/modules/cameras/CameraFlipperCinematics/CameraTubeFlipper/settings.js",position:{x:0,y:.7999999999999998,z:-.10000000000000031},rotation:{x:.4,y:3.14,z:0},fov:73,near:.1,far:1e3};class Qc extends we(Jt){init(e={}){this._debug=e.debugFolder,this._id=e.id,this._bindAll(),this._initialize(),this._enabled=!0,this._debugFolder=this._createDebugFolder()}playCameraSplinePath(e){var s;(s=this._timelineCamera)==null||s.kill(),this._timelineCamera=new R.timeline({paused:!1,repeat:-1});const t={value:0},i={value:0};return this._timelineCamera.to(t,{value:1,duration:e.pos.settings.duration,ease:e.pos.settings.ease,onUpdate:()=>{const{position:a}=e.pos._getSpline(t.value);this._targetPosition.x=a.x,this._targetPosition.y=a.y,this._targetPosition.z=a.z,this.position.set(this._targetPosition.x,this._targetPosition.y,this._targetPosition.z)}},e.pos.settings.delay),this._timelineCamera.to(i,{value:1,duration:e.lookAt.settings.duration,ease:e.lookAt.settings.ease,onUpdate:()=>{const{position:a}=e.lookAt._getSpline(i.value);this.lookAt(a.x,a.y,a.z)}},e.lookAt.settings.delay),this._timelineCamera}get enabled(){return this._enabled}set enabled(e){this._enabled=e}_initialize(){this.fov=at.fov,this.near=at.near,this.far=at.far,this.position.x=at.position.x,this.position.y=at.position.y,this.position.z=at.position.z,this.rotation.x=at.rotation.x,this.rotation.y=at.rotation.y,this.rotation.z=at.rotation.z,this._targetPosition={x:0,y:0,z:0},this.updateProjectionMatrix()}onUpdate(){}_bindAll(){this._updateCameraSettingsHandler=this._updateCameraSettingsHandler.bind(this)}onWindowResize(e){this.aspect=e.innerWidth/e.innerHeight,this.updateProjectionMatrix()}_updateCameraSettingsHandler(){this._initialize(),this.playCinematicAnimation()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Camera Top Flipper",expanded:!1});return e.addBinding(at,"fov").on("change",this._updateCameraSettingsHandler),e.addBinding(at,"near").on("change",this._updateCameraSettingsHandler),e.addBinding(at,"far").on("change",this._updateCameraSettingsHandler),e.addBinding(at,"position").on("change",this._updateCameraSettingsHandler),e.addBinding(at,"rotation").on("change",this._updateCameraSettingsHandler),this.$debugger.registerFile(at,at.file),e}}const Sn={Default:xc,CameraFlipperMachine:bc,CameraFlipperMain:Bc,CameraIntro:Sc,CameraBeautyHub:wc,CameraLips:Mc,CameraTubeFlipper:Qc,Orbit:Ic};class ea extends we(){init(e={}){this._types=e.types||["Default"],this._debug=e.debugFolder||this.$debugger,this._id=e.id,this._bindAll(),this._settings={active:this._types[0]},this._applySavedActiveCameraType(),this._debugFolder=this._createDebugFolder(),this._cameras=this._createCameras(),this._camera=this._cameras[this._settings.active],this._camera.enabled=!0}get camera(){return this._camera}set camera(e){this._camera=e}get cameras(){return this._cameras}getCamera(e="Default"){if(!this._cameras[e])throw new Error(`No camera with type: "${e}" was found`);return this._cameras[e]}setCamera(e="Default"){if(!this._cameras[e])throw new Error(`No camera with type: "${e}" was found`);this._settings.active=e,this._updateActiveCamera(this._cameras[e])}_applySavedActiveCameraType(){const e=sessionStorage.getItem(`camera-manager-active-type/${this._id}`),t=this._types.includes(e)?e:this._types[0];this._settings.active=t}_createCameras(){const e={};for(let t=0;t<this._types.length;t++){const i=this._types[t];if(!Sn[i])throw new Error(`No camera with type: "${i}" was found`);e[i]=new Sn[i]({debugFolder:this._debugFolder,id:this._id})}return e}_updateActiveCamera(e){this._camera.enabled=!1,this._camera=e,this._camera.enabled=!0}_bindAll(){this._activeCameraChangedHandler=this._activeCameraChangedHandler.bind(this)}onUpdate({time:e,deltaTime:t,frame:i}){}onWindowResize(e){}_createDebugFolder(){if(!this._debug)return;const e={};for(let i=0;i<this._types.length;i++){const s=this._types[i];e[s]=s}const t=this._debug.addFolder({title:"Camera Manager",expanded:!0});return t.addBinding(this._settings,"active",{label:"Active",options:e}).on("change",this._activeCameraChangedHandler),t}_activeCameraChangedHandler(){sessionStorage.setItem(`camera-manager-active-type/${this._id}`,this._settings.active);const e=this._cameras[this._settings.active];this._updateActiveCamera(e)}}const li=new Wr,nt=new O,$t=new O,He=new gt,wn={X:new O(1,0,0),Y:new O(0,1,0),Z:new O(0,0,1)},fa={type:"change"},Mn={type:"mouseDown"},Qn={type:"mouseUp",mode:null},Dn={type:"objectChange"};class Uo extends Ci{constructor(e,t){super(),t===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Nc;this._gizmo=i,this.add(i);const s=new Fc;this._plane=s,this.add(s);const a=this;function n(x,y){let C=y;Object.defineProperty(a,x,{get:function(){return C!==void 0?C:y},set:function(u){C!==u&&(C=u,s[x]=u,i[x]=u,a.dispatchEvent({type:x+"-changed",value:u}),a.dispatchEvent(fa))}}),a[x]=y,s[x]=y,i[x]=y}n("camera",e),n("object",void 0),n("enabled",!0),n("axis",null),n("mode","translate"),n("translationSnap",null),n("rotationSnap",null),n("scaleSnap",null),n("space","world"),n("size",1),n("dragging",!1),n("showX",!0),n("showY",!0),n("showZ",!0);const r=new O,l=new O,h=new gt,c=new gt,A=new O,d=new gt,m=new O,p=new O,f=new O,_=0,E=new O;n("worldPosition",r),n("worldPositionStart",l),n("worldQuaternion",h),n("worldQuaternionStart",c),n("cameraPosition",A),n("cameraQuaternion",d),n("pointStart",m),n("pointEnd",p),n("rotationAxis",f),n("rotationAngle",_),n("eye",E),this._offset=new O,this._startNorm=new O,this._endNorm=new O,this._cameraScale=new O,this._parentPosition=new O,this._parentQuaternion=new gt,this._parentQuaternionInv=new gt,this._parentScale=new O,this._worldScaleStart=new O,this._worldQuaternionInv=new gt,this._worldScale=new O,this._positionStart=new O,this._quaternionStart=new gt,this._scaleStart=new O,this._getPointer=Dc.bind(this),this._onPointerDown=Lc.bind(this),this._onPointerHover=Pc.bind(this),this._onPointerMove=Rc.bind(this),this._onPointerUp=Tc.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&li.setFromCamera(e,this.camera);const t=ma(this._gizmo.picker[this.mode],li);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&li.setFromCamera(e,this.camera);const t=ma(this._plane,li,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Mn.mode=this.mode,this.dispatchEvent(Mn)}}pointerMove(e){const t=this.axis,i=this.mode,s=this.object;let a=this.space;if(i==="scale"?a="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(a="world"),s===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&li.setFromCamera(e,this.camera);const n=ma(this._plane,li,!0);if(n){if(this.pointEnd.copy(n.point).sub(this.worldPositionStart),i==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),a==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),a==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(a==="local"&&(s.position.applyQuaternion(He.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),a==="world"&&(s.parent&&s.position.add(nt.setFromMatrixPosition(s.parent.matrixWorld)),t.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(nt.setFromMatrixPosition(s.parent.matrixWorld))));else if(i==="scale"){if(t.search("XYZ")!==-1){let r=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(r*=-1),$t.set(r,r,r)}else nt.copy(this.pointStart),$t.copy(this.pointEnd),nt.applyQuaternion(this._worldQuaternionInv),$t.applyQuaternion(this._worldQuaternionInv),$t.divide(nt),t.search("X")===-1&&($t.x=1),t.search("Y")===-1&&($t.y=1),t.search("Z")===-1&&($t.z=1);s.scale.copy(this._scaleStart).multiply($t),this.scaleSnap&&(t.search("X")!==-1&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(i==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const r=20/this.worldPosition.distanceTo(nt.setFromMatrixPosition(this.camera.matrixWorld));let l=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(nt.copy(this.rotationAxis).cross(this.eye))*r):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(wn[t]),nt.copy(wn[t]),a==="local"&&nt.applyQuaternion(this.worldQuaternion),nt.cross(this.eye),nt.length()===0?l=!0:this.rotationAngle=this._offset.dot(nt.normalize())*r),(t==="E"||l)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),a==="local"&&t!=="E"&&t!=="XYZE"?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(He.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(He.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(fa),this.dispatchEvent(Dn)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(Qn.mode=this.mode,this.dispatchEvent(Qn)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(fa),this.dispatchEvent(Dn),this.pointStart.copy(this.pointEnd))}getRaycaster(){return li}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function Dc(o){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:o.button};{const e=this.domElement.getBoundingClientRect();return{x:(o.clientX-e.left)/e.width*2-1,y:-(o.clientY-e.top)/e.height*2+1,button:o.button}}}function Pc(o){if(this.enabled)switch(o.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(o));break}}function Lc(o){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(o.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(o)),this.pointerDown(this._getPointer(o)))}function Rc(o){this.enabled&&this.pointerMove(this._getPointer(o))}function Tc(o){this.enabled&&(this.domElement.releasePointerCapture(o.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(o)))}function ma(o,e,t){const i=e.intersectObject(o,!0);for(let s=0;s<i.length;s++)if(i[s].object.visible||t)return i[s];return!1}const vs=new Yr,Fe=new O(0,1,0),Pn=new O(0,0,0),Ln=new Zi,_s=new gt,Ns=new gt,Dt=new O,Rn=new Zi,Xi=new O(1,0,0),fi=new O(0,1,0),Ki=new O(0,0,1),Cs=new O,ki=new O,Gi=new O;class Nc extends Ci{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new It({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new Ya({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const s=t.clone();s.opacity=.5;const a=e.clone();a.color.setHex(16711680);const n=e.clone();n.color.setHex(65280);const r=e.clone();r.color.setHex(255);const l=e.clone();l.color.setHex(16711680),l.opacity=.5;const h=e.clone();h.color.setHex(65280),h.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const A=e.clone();A.opacity=.25;const d=e.clone();d.color.setHex(16776960),d.opacity=.25,e.clone().color.setHex(16776960);const p=e.clone();p.color.setHex(7895160);const f=new At(0,.04,.1,12);f.translate(0,.05,0);const _=new $e(.08,.08,.08);_.translate(0,.04,0);const E=new as;E.setAttribute("position",new ks([0,0,0,1,0,0],3));const x=new At(.0075,.0075,.5,3);x.translate(0,.25,0);function y(ee,Me){const P=new Ni(ee,.0075,3,64,Me*Math.PI*2);return P.rotateY(Math.PI/2),P.rotateX(Math.PI/2),P}function C(){const ee=new as;return ee.setAttribute("position",new ks([0,0,0,1,1,1],3)),ee}const u={X:[[new U(f,a),[.5,0,0],[0,0,-Math.PI/2]],[new U(f,a),[-.5,0,0],[0,0,Math.PI/2]],[new U(x,a),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new U(f,n),[0,.5,0]],[new U(f,n),[0,-.5,0],[Math.PI,0,0]],[new U(x,n)]],Z:[[new U(f,r),[0,0,.5],[Math.PI/2,0,0]],[new U(f,r),[0,0,-.5],[-Math.PI/2,0,0]],[new U(x,r),null,[Math.PI/2,0,0]]],XYZ:[[new U(new ds(.1,0),A.clone()),[0,0,0]]],XY:[[new U(new $e(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new U(new $e(.15,.15,.01),l.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new U(new $e(.15,.15,.01),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},I={X:[[new U(new At(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new U(new At(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new U(new At(.2,0,.6,4),i),[0,.3,0]],[new U(new At(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new U(new At(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new U(new At(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new U(new ds(.2,0),i)]],XY:[[new U(new $e(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new U(new $e(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new U(new $e(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},w={START:[[new U(new ds(.01,2),s),null,null,null,"helper"]],END:[[new U(new ds(.01,2),s),null,null,null,"helper"]],DELTA:[[new Pt(C(),s),null,null,null,"helper"]],X:[[new Pt(E,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Pt(E,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Pt(E,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},L={XYZE:[[new U(y(.5,1),p),null,[0,Math.PI/2,0]]],X:[[new U(y(.5,.5),a)]],Y:[[new U(y(.5,.5),n),null,[0,0,-Math.PI/2]]],Z:[[new U(y(.5,.5),r),null,[0,Math.PI/2,0]]],E:[[new U(y(.75,1),d),null,[0,Math.PI/2,0]]]},k={AXIS:[[new Pt(E,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},J={XYZE:[[new U(new Ks(.25,10,8),i)]],X:[[new U(new Ni(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new U(new Ni(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new U(new Ni(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new U(new Ni(.75,.1,2,24),i)]]},j={X:[[new U(_,a),[.5,0,0],[0,0,-Math.PI/2]],[new U(x,a),[0,0,0],[0,0,-Math.PI/2]],[new U(_,a),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new U(_,n),[0,.5,0]],[new U(x,n)],[new U(_,n),[0,-.5,0],[0,0,Math.PI]]],Z:[[new U(_,r),[0,0,.5],[Math.PI/2,0,0]],[new U(x,r),[0,0,0],[Math.PI/2,0,0]],[new U(_,r),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new U(new $e(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new U(new $e(.15,.15,.01),l),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new U(new $e(.15,.15,.01),h),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new U(new $e(.1,.1,.1),A.clone())]]},q={X:[[new U(new At(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new U(new At(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new U(new At(.2,0,.6,4),i),[0,.3,0]],[new U(new At(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new U(new At(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new U(new At(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new U(new $e(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new U(new $e(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new U(new $e(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new U(new $e(.2,.2,.2),i),[0,0,0]]]},pe={X:[[new Pt(E,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Pt(E,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Pt(E,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function ve(ee){const Me=new Ci;for(const P in ee)for(let V=ee[P].length;V--;){const G=ee[P][V][0].clone(),Ue=ee[P][V][1],qe=ee[P][V][2],Ye=ee[P][V][3],Ce=ee[P][V][4];G.name=P,G.tag=Ce,Ue&&G.position.set(Ue[0],Ue[1],Ue[2]),qe&&G.rotation.set(qe[0],qe[1],qe[2]),Ye&&G.scale.set(Ye[0],Ye[1],Ye[2]),G.updateMatrix();const Ge=G.geometry.clone();Ge.applyMatrix4(G.matrix),G.geometry=Ge,G.renderOrder=1/0,G.position.set(0,0,0),G.rotation.set(0,0,0),G.scale.set(1,1,1),Me.add(G)}return Me}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ve(u)),this.add(this.gizmo.rotate=ve(L)),this.add(this.gizmo.scale=ve(j)),this.add(this.picker.translate=ve(I)),this.add(this.picker.rotate=ve(J)),this.add(this.picker.scale=ve(q)),this.add(this.helper.translate=ve(w)),this.add(this.helper.rotate=ve(k)),this.add(this.helper.scale=ve(pe)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const i=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Ns;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let s=[];s=s.concat(this.picker[this.mode].children),s=s.concat(this.gizmo[this.mode].children),s=s.concat(this.helper[this.mode].children);for(let a=0;a<s.length;a++){const n=s[a];n.visible=!0,n.rotation.set(0,0,0),n.position.copy(this.worldPosition);let r;if(this.camera.isOrthographicCamera?r=(this.camera.top-this.camera.bottom)/this.camera.zoom:r=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),n.scale.set(1,1,1).multiplyScalar(r*this.size/4),n.tag==="helper"){n.visible=!1,n.name==="AXIS"?(n.visible=!!this.axis,this.axis==="X"&&(He.setFromEuler(vs.set(0,0,0)),n.quaternion.copy(i).multiply(He),Math.abs(Fe.copy(Xi).applyQuaternion(i).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="Y"&&(He.setFromEuler(vs.set(0,0,Math.PI/2)),n.quaternion.copy(i).multiply(He),Math.abs(Fe.copy(fi).applyQuaternion(i).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="Z"&&(He.setFromEuler(vs.set(0,Math.PI/2,0)),n.quaternion.copy(i).multiply(He),Math.abs(Fe.copy(Ki).applyQuaternion(i).dot(this.eye))>.9&&(n.visible=!1)),this.axis==="XYZE"&&(He.setFromEuler(vs.set(0,Math.PI/2,0)),Fe.copy(this.rotationAxis),n.quaternion.setFromRotationMatrix(Ln.lookAt(Pn,Fe,fi)),n.quaternion.multiply(He),n.visible=this.dragging),this.axis==="E"&&(n.visible=!1)):n.name==="START"?(n.position.copy(this.worldPositionStart),n.visible=this.dragging):n.name==="END"?(n.position.copy(this.worldPosition),n.visible=this.dragging):n.name==="DELTA"?(n.position.copy(this.worldPositionStart),n.quaternion.copy(this.worldQuaternionStart),nt.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),nt.applyQuaternion(this.worldQuaternionStart.clone().invert()),n.scale.copy(nt),n.visible=this.dragging):(n.quaternion.copy(i),this.dragging?n.position.copy(this.worldPositionStart):n.position.copy(this.worldPosition),this.axis&&(n.visible=this.axis.search(n.name)!==-1));continue}n.quaternion.copy(i),this.mode==="translate"||this.mode==="scale"?(n.name==="X"&&Math.abs(Fe.copy(Xi).applyQuaternion(i).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="Y"&&Math.abs(Fe.copy(fi).applyQuaternion(i).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="Z"&&Math.abs(Fe.copy(Ki).applyQuaternion(i).dot(this.eye))>.99&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="XY"&&Math.abs(Fe.copy(Ki).applyQuaternion(i).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="YZ"&&Math.abs(Fe.copy(Xi).applyQuaternion(i).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1),n.name==="XZ"&&Math.abs(Fe.copy(fi).applyQuaternion(i).dot(this.eye))<.2&&(n.scale.set(1e-10,1e-10,1e-10),n.visible=!1)):this.mode==="rotate"&&(_s.copy(i),Fe.copy(this.eye).applyQuaternion(He.copy(i).invert()),n.name.search("E")!==-1&&n.quaternion.setFromRotationMatrix(Ln.lookAt(this.eye,Pn,fi)),n.name==="X"&&(He.setFromAxisAngle(Xi,Math.atan2(-Fe.y,Fe.z)),He.multiplyQuaternions(_s,He),n.quaternion.copy(He)),n.name==="Y"&&(He.setFromAxisAngle(fi,Math.atan2(Fe.x,Fe.z)),He.multiplyQuaternions(_s,He),n.quaternion.copy(He)),n.name==="Z"&&(He.setFromAxisAngle(Ki,Math.atan2(Fe.y,Fe.x)),He.multiplyQuaternions(_s,He),n.quaternion.copy(He))),n.visible=n.visible&&(n.name.indexOf("X")===-1||this.showX),n.visible=n.visible&&(n.name.indexOf("Y")===-1||this.showY),n.visible=n.visible&&(n.name.indexOf("Z")===-1||this.showZ),n.visible=n.visible&&(n.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),n.material._color=n.material._color||n.material.color.clone(),n.material._opacity=n.material._opacity||n.material.opacity,n.material.color.copy(n.material._color),n.material.opacity=n.material._opacity,this.enabled&&this.axis&&(n.name===this.axis||this.axis.split("").some(function(l){return n.name===l}))&&(n.material.color.setHex(16776960),n.material.opacity=1)}super.updateMatrixWorld(e)}}class Fc extends U{constructor(){super(new Ft(1e5,1e5,2,2),new It({visible:!1,wireframe:!0,side:ja,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),Cs.copy(Xi).applyQuaternion(t==="local"?this.worldQuaternion:Ns),ki.copy(fi).applyQuaternion(t==="local"?this.worldQuaternion:Ns),Gi.copy(Ki).applyQuaternion(t==="local"?this.worldQuaternion:Ns),Fe.copy(ki),this.mode){case"translate":case"scale":switch(this.axis){case"X":Fe.copy(this.eye).cross(Cs),Dt.copy(Cs).cross(Fe);break;case"Y":Fe.copy(this.eye).cross(ki),Dt.copy(ki).cross(Fe);break;case"Z":Fe.copy(this.eye).cross(Gi),Dt.copy(Gi).cross(Fe);break;case"XY":Dt.copy(Gi);break;case"YZ":Dt.copy(Cs);break;case"XZ":Fe.copy(Gi),Dt.copy(ki);break;case"XYZ":case"E":Dt.set(0,0,0);break}break;case"rotate":default:Dt.set(0,0,0)}Dt.length()===0?this.quaternion.copy(this.cameraQuaternion):(Rn.lookAt(nt.set(0,0,0),Dt,Fe),this.quaternion.setFromRotationMatrix(Rn)),super.updateMatrixWorld(e)}}class Hs{constructor(e,t={}){this._object=e,this._debug=t.debugFolder,this.bindSettings(t.settings),this._config={size:1,modes:["translate","rotate","scale"],enabled:!1,mode:"translate",axis:"all",snap:!0,rotationSnap:.1,translationSnap:.1},this._bindAll(),this._isRunning=!1,this._isDebugSettingsActive=!1,this._debugFolder=this._createDebugFolder()}destroy(){var e;(e=this._controls)==null||e.dispose(),this._removeEventListeners()}bindSettings(e){if(!e)return;this._settings=e;const t=Object.keys(this._settings).includes("position")&&Object.keys(this._settings.position).join("")==="xyz",i=Object.keys(this._settings).includes("rotation")&&Object.keys(this._settings.rotation).join("")==="xyz",s=Object.keys(this._settings).includes("scale")&&Object.keys(this._settings.scale).join("")==="xyz";t||(this._settings.position={x:this._object.position.x,y:this._object.position.y,z:this._object.position.z}),i||(this._settings.rotation={x:this._object.rotation.x,y:this._object.rotation.y,z:this._object.rotation.z}),s||(this._settings.scale={x:this._object.scale.x,y:this._object.scale.y,z:this._object.scale.z}),this._applySettings(),this._createDebugSettings()}createDebugFolder(e){this._debug=e,this._debugFolder=this._createDebugFolder()}_applySettings(){this._object.position.x=this._settings.position.x,this._object.position.y=this._settings.position.y,this._object.position.z=this._settings.position.z,this._object.rotation.x=this._settings.rotation.x,this._object.rotation.y=this._settings.rotation.y,this._object.rotation.z=this._settings.rotation.z,this._object.scale.x=this._settings.scale.x,this._object.scale.y=this._settings.scale.y,this._object.scale.z=this._settings.scale.z}_start(){if(this._scene=this._findScene(this._object),this._cameraManager=this._findCameraManager(this._scene),this._camera=this._findOrbitCamera(this._cameraManager),this._controls=this._createControls(this._object,this._camera,this._scene.$renderer.domElement),!this._controls)return console.error("Cosmic Transform Controls: Could not create controls");this._setupEventListeners(),this._isRunning=!0}_createControls(e,t,i){if(!this._scene)return;if(!i)return console.error("Cosmic Transform Controls: domElement not defined");if(!t)return console.error("Cosmic Transform Controls: camera not defined");const s=new Uo(t,i);return s.attach(e),s.setSize(this._config.size),s.visible=this._config.enabled,s.enabled=this._config.enabled,this._scene.add(s),s}_findScene(e){let t=e.parent;if(!t)return;let i=t.isScene?t:null;for(;!i&&t;)t=t.parent,i=t&&t.isScene?t:null;return i||console.error("Cosmic Transform Controls: Could not find Scene")}_findCameraManager(e){if(e)return e.cameraManager?e.cameraManager:console.error("Cosmic Transform Controls: Could not find Camera Manager")}_findOrbitCamera(e){if(!e)return;const t=e.camera;return t||console.error("Cosmic Transform Controls: Could not find Camera")}_bindAll(){this._changeHandler=this._changeHandler.bind(this),this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._debugChangeHandler=this._debugChangeHandler.bind(this)}_setupEventListeners(){var e,t,i;(e=this._controls)==null||e.addEventListener("change",this._changeHandler),(t=this._controls)==null||t.addEventListener("mouseDown",this._mouseDownHandler),(i=this._controls)==null||i.addEventListener("mouseUp",this._mouseUpHandler)}_removeEventListeners(){var e,t,i;(e=this._controls)==null||e.removeEventListener("change",this._changeHandler),(t=this._controls)==null||t.removeEventListener("mouseDown",this._mouseDownHandler),(i=this._controls)==null||i.removeEventListener("mouseUp",this._mouseUpHandler)}_changeHandler(e){if(!this._settings)return;this._settings.position.x=this._object.position.x,this._settings.position.y=this._object.position.y,this._settings.position.z=this._object.position.z,this._settings.rotation.x=this._object.rotation.x,this._settings.rotation.y=this._object.rotation.y,this._settings.rotation.z=this._object.rotation.z,this._settings.scale.x=this._object.scale.x,this._settings.scale.y=this._object.scale.y,this._settings.scale.z=this._object.scale.z;const t=this._debugFolder.children.find(i=>i.pages&&i.pages[0].title==="position");t&&t.pages[0].children[0].controller.value.fetch(),t&&t.pages[1].children[0].controller.value.fetch(),t&&t.pages[2].children[0].controller.value.fetch()}_mouseDownHandler(e){const t=this._cameraManager.getCamera("Orbit");t.savedState=t.enabled,t.enabled=!1}_mouseUpHandler(e){const t=this._cameraManager.getCamera("Orbit");t.enabled=t.savedState}_debugChangeHandler(){if(!this._isRunning){if(this._config.enabled&&this._start(),this._isRunning&&this._debugFolder)for(let e=0;e<this._debugFolder.children.length;e++){const t=this._debugFolder.children[e];t.disabled=!1}return}this._applySettings(),this._controls.enabled=this._config.enabled,this._controls.visible=this._config.enabled,this._controls.mode=this._config.mode,this._controls.showX=this._config.axis==="x"||this._config.axis==="all",this._controls.showY=this._config.axis==="y"||this._config.axis==="all",this._controls.showZ=this._config.axis==="z"||this._config.axis==="all",this._controls.setSize(this._config.size),this._controls.rotationSnap=this._config.snap?this._config.rotationSnap:null,this._controls.translationSnap=this._config.snap?this._config.translationSnap:null}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Transform Controls",expanded:!1});return e.addBinding(this._config,"enabled").on("change",this._debugChangeHandler),e.addBinding(this._config,"size",{step:.01,disabled:!0}).on("change",this._debugChangeHandler),e.addBlade({view:"separator"}),this._config.modes.length!==1&&(e.addBinding(this._config,"mode",{view:"radiogrid",groupName:"mode",disabled:!0,size:[1,this._config.modes.length],cells:(t,i)=>({title:this._config.modes[i+t*2],value:this._config.modes[i+t*2]}),label:"mode"}).on("change",this._debugChangeHandler).disabled=!0),e.addBlade({view:"separator"}),e.addBinding(this._config,"axis",{disabled:!0,view:"radiogrid",groupName:"axis",size:[2,2],cells:(t,i)=>{const s=["all","x","y","z"];return{title:s[i+t*2],value:s[i+t*2]}},label:"axis"}).on("change",this._debugChangeHandler).disabled=!0,e.addBlade({view:"separator"}),e.addBinding(this._config,"snap",{disabled:!0}).on("change",this._debugChangeHandler),e.addBinding(this._config,"translationSnap",{disabled:!0}).on("change",this._debugChangeHandler),e.addBinding(this._config,"rotationSnap",{disabled:!0}).on("change",this._debugChangeHandler),this._createDebugSettings(e),e}_createDebugSettings(e){const t=e||this._debugFolder;if(!e||!this._settings||this._isDebugSettingsActive)return;this._isDebugSettingsActive=!0;const i=t.addTab({pages:[{title:"position"},{title:"rotation"},{title:"scale"}]});i.pages[0].addBinding(this._settings,"position").on("change",this._debugChangeHandler),i.pages[1].addBinding(this._settings,"rotation").on("change",this._debugChangeHandler),i.pages[2].addBinding(this._settings,"scale").on("change",this._debugChangeHandler),i.disabled=!0}}class Ka extends we(Xr){init(e,t,i={}){this._name=i.name||"Light",this._color=e,this._intensity=t,this.addEventListener("added",this._start)}get helper(){return this._helper}createDebugFolder(e,t){if(!e)return;if(!this._transformControlsPosition){console.error("Cosmic Directional Light: The light needs to be added to the scene before creating the debug folder");return}const i=e.addFolder({title:this._name});i.addBinding(this._helper,"visible",{label:"Helper visible"});const s=i.addTab({pages:[{title:"Global"},{title:"Target"}]});t&&(i.addBinding(t,"color",{label:"Color"}).on("change",()=>{this.color=new _e(t.color)}),i.addBinding(t,"intensity",{label:"Intensity"}).on("change",()=>{this.intensity=t.intensity})),t&&this._transformControlsPosition.bindSettings(t),this._transformControlsPosition.createDebugFolder(s.pages[0]),t&&this._transformControlsTarget.bindSettings(t.target),this._transformControlsTarget.createDebugFolder(s.pages[1])}_start(){this.target=this._createTarget(),this._helper=this._createHelper(),this.color=new _e(this._color),this.intensity=this._intensity,this._transformControlsPosition=this._createTransformControlsPosition(),this._transformControlsTarget=this._createTransformControlsTarget()}_createTarget(){const e=new Ci;return this.parent.add(e),e}_createHelper(){const e=new jr(this,5);return e.visible=!1,this.parent.add(e),e}_createTransformControlsPosition(){return new Hs(this)}_createTransformControlsTarget(){return new Hs(this.target)}onUpdate(){var e;(e=this._helper)==null||e.update()}}class Ut extends Ci{constructor(){super(),this.__debugFolder=null,this.__settings=null,this.__transformControls=this.__createTransformControls()}destroy(){super.destroy(),this.__transformControls.destroy()}get settings(){return this.__settings}set settings(e){this.__settings=e,this.__transformControls.bindSettings(e)}get debugFolder(){return this.__debugFolder}set debugFolder(e){this.__debugFolder=e,this.__transformControls.createDebugFolder(e)}get transformControls(){return this.__transformControls}__createTransformControls(){return new Hs(this)}}const va={file:"./webgl/components/ComponentBox/settings.js",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},material:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1.06},saturation:{value:1},brightness:{value:.9999999999999999},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1.27},diffuseIntensity:{value:1.79},specularIntensity:{value:1.2599999999999998},shininess:{value:41,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffeaea"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},renderTarget:{width:512,height:512,params:{minFilter:1008,magFilter:1006,format:1023,samples:1,stencilBuffer:!1,generateMipmaps:!0,type:1016}}}};class Uc extends we(Ut){init(e={}){this._debug=e.debugFolder,this.settings=va,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$profiler.addObject(this._mesh,"Box"),this.debugFolder=this._createDebugFolder()}get mesh(){return this._mesh}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){return new $e(1,1,1)}_createMaterial(){return new Kr}_createMesh(){const e=new U(this._geometry,this._material);return this.add(e),e}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Box"});return this.$debugger.registerFile(va,va.file),e}}const Oc={};class Oo extends we(rs){init(e={}){this._bindAll(),this._config=fs,this._debugFolder=this._createDebugFolder(),this._cameraManager=this._createCameraManager(),this._resourceManager=this._createResourceManager(),this._setupEventListeners()}destroy(){super.destroy(),this._destroyComponents(),this._removeEventListeners()}get config(){return this._config}get cameraManager(){return this._cameraManager}get camera(){return this._cameraManager.camera}precompile(){const e=[];e[0]=new Promise(r=>{r()});const t=fs.resources.filter(r=>r.type==="texture"),i=[...t],s=[],a=4,n=1;for(let r=0;r<t.length;r+=a)s.push(i.slice(r,r+a));for(let r=0;r<s.length;r++){const l=new Promise(h=>{ls(()=>{for(let c=0;c<s[r].length;c++){const A=$.get(s[r][c].name);A&&this.$renderer.initTexture(A)}h()},r*n)});e.push(l)}return Promise.all(e)}_start(){this._components=this._createComponents()}_createCameraManager(){return new ea({types:["Orbit","Default"],debugFolder:this._debugFolder,id:"Sample Scene"})}_createResourceManager(){const e=new Zs;return e.add(fs.resources),e.load(),e}_bindAll(){this._loadCompleteHandler=this._loadCompleteHandler.bind(this)}_createComponents(){return{box:this._createComponentBox()}}_createComponentBox(){const e=new Uc({debugFolder:this._debugFolder});return this.add(e),e}_destroyComponents(){if(this._components)for(const e in this._components)typeof this._components[e].destroy=="function"&&this._components[e].destroy()}onUpdate({time:e,deltaTime:t,frame:i}){for(const s in this._components)typeof this._components[s].update=="function"&&this._components[s].update({time:e,deltaTime:t,frame:i})}onWindowResize(e){}_setupEventListeners(){this._resourceManager.addEventListener("complete",this._loadCompleteHandler)}_removeEventListeners(){this._resourceManager.removeEventListener("complete",this._loadCompleteHandler)}_loadCompleteHandler(){this._start()}_createDebugFolder(){if(!this.$debugger)return;const e=this.$debugger.addFolder({title:`Scene ${fs.name}`});return this.$debugger.registerFile(In,In.file),e}}Object.assign(Oo.prototype,Oc);const _a={name:"Scene Materials",resources:[{name:"model-sample",type:"gltf",path:"./webgl/models/model-sample.glb"},{name:"matcap-sample",type:"texture",path:"./webgl/textures/matcaps/matcap-sample.jpg"},{name:"perlin-combined",type:"texture",path:"./webgl/textures/noises/perlin-combined.jpg",options:{wrapS:N,wrapT:N}},{name:"albedo-sample",type:"texture",path:"./webgl/textures/sample/albedo-sample.jpg",options:{wrapS:N,wrapT:N,colorSpace:ot}},{name:"ao-sample",type:"texture",path:"./webgl/textures/sample/ao-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"roughness-sample",type:"texture",path:"./webgl/textures/sample/roughness-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"normal-sample",type:"texture",path:"./webgl/textures/sample/normal-sample.jpg",options:{wrapS:N,wrapT:N}}]},qt={file:"./webgl/scenes/SceneMaterials/settings.js",shadows:{enabled:!0,showHelper:!1,color:"#000000",intensity:.9,near:0,far:30,mapSize:{x:1024,y:1024},bias:-1e-4,radius:4,blurSamples:4,frustumSize:5},lights:{light_shadows:{target:{position:{x:-1.6,y:2,z:.5},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}},position:{x:-10.600000000000001,y:9.5,z:5},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},intensity:4.6499999999999995,color:"#ffffff"}}},ci={file:"./webgl/components/ComponentModel/settings.js",scale:{x:1,y:1,z:1},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},material:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!0},aoVertexIntensity:{value:1},shadows:{value:!1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:2.27},specularIntensity:{value:1},shininess:{value:3},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#dd0000"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},normal:{map:{value:"normal-sample",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},ao:{map:{value:"ao-sample",type:"texture"},intensity:{value:1},repeat:{value:{x:1,y:1}}},albedo:{map:{value:"albedo-sample",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},roughness:{map:{value:"roughness-sample",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:.7,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:0}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.3},noiseChannel:{value:{x:0,y:0,z:0}}}},templateMaterial:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!0},aoVertexIntensity:{value:1},shadows:{value:!0}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:2.27},specularIntensity:{value:1},shininess:{value:3},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#dd0000"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},normal:{map:{value:"normal-sample",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},ao:{map:{value:"ao-sample",type:"texture"},intensity:{value:1},repeat:{value:{x:1,y:1}}},albedo:{map:{value:"albedo-sample",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},roughness:{map:{value:"roughness-sample",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:.7,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:0}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.3},noiseChannel:{value:{x:0,y:0,z:0}}}}},kc=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_VERTEX_COLORS
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_VERTEX_COLORS
vColor=color;
#endif
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(position,1.0);
#include <env_vertex>
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Gc=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#ifdef USE_ENV
#include <env_pars>
#include <env_fragment>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_ENV
vec3 envColor=envmap();finalColor=blendSoftLight(finalColor,envColor,uEnvIntensity);
#endif
float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,Hc=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;uniform sampler2D uHeightMap;uniform vec2 uHeightPlaneResolution;uniform vec2 uBallPos;uniform vec2 uBallRot;uniform vec2 uOffset;uniform float uActiveHeightMapChannel;
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_SHADOWMAP
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
mat4 rotationXZ(float angleX,float angleZ){float sX=sin(angleX);float cX=cos(angleX);float sZ=sin(angleZ);float cZ=cos(angleZ);return mat4(cZ,-sZ,0.0,0.0,sZ*cX,cZ*cX,-sX,0.0,sZ*sX,cZ*sX,cX,0.0,0.0,0.0,0.0,1.0);}void main(){
#ifdef USE_FOG
#include <fog_vertex>
#endif
vec2 heightUv=vec2(((uBallPos.x+(uHeightPlaneResolution.x/2.))/uHeightPlaneResolution.x),((uBallPos.y+(uHeightPlaneResolution.y/2.))/uHeightPlaneResolution.y)+uOffset.y);vec3 s=texture2D(uHeightMap,heightUv).rgb;float activeChannel=0.0;if(uActiveHeightMapChannel==0.0){activeChannel=s.r;}if(uActiveHeightMapChannel==1.0){activeChannel=s.g;}if(uActiveHeightMapChannel==2.0){activeChannel=s.b;}vec3 transformedPos=position;mat4 rotMatrixXZ=rotationXZ(uBallRot.x,uBallRot.y);transformedPos=(rotMatrixXZ*vec4(transformedPos,1.0)).xyz;transformedPos.y+=activeChannel*3.5;
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(transformedPos,1.0);
#include <env_vertex>
#endif
vec3 transformedNormal=normalize((rotMatrixXZ*vec4(normal,0.0)).xyz);vNormal=normalize(normalMatrix*transformedNormal);vec4 mvPosition=modelViewMatrix*vec4(transformedPos,1.0);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWMAP
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(transformedPos,1.0);}`,zc=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;
#ifdef USE_VERTEX_AO
varying vec3 vColor;uniform float uAOVertexIntensity;
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWMAP
#include <shadows_fragment_pars>
#endif
#ifdef USE_ENV
#include <env_pars>
#include <env_fragment>
#endif
#include <phong_pars_fragment>
mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWMAP
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_ENV
vec3 envColor=envmap();finalColor=blendSoftLight(finalColor,envColor,uEnvIntensity);
#endif
float ao=1.;
#ifdef USE_AO_MAP
ao*=(texture2D(uAOMap,vUv*uAOMapRepeat).r-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#endif
finalColor*=ao;
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=(matcapColor-1.0)*uMatcapIntensity+1.0;
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,qc=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_VERTEX_COLORS
vColor=color;
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Vc=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);diffuseColor.rgb=mix(vec3(0.),diffuseColor.rgb,vColor.g);if(diffuseColor.r==0.0&&diffuseColor.g==0.0&&diffuseColor.b==0.0){diffuseColor.rgb+=vec3(.1);}
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;float ao=1.;ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,Wc=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
varying vec3 vColor;
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
vColor=color;
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(position,1.0);
#include <env_vertex>
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Yc=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#ifdef USE_ENV
#include <env_pars>
#include <env_fragment>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_ENV
vec3 envColor=envmap();finalColor=blendSoftLight(finalColor,envColor,uEnvIntensity);
#endif
float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);matcapColor=mix(vec3(.1),matcapColor,vColor.g);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,jc=`#define GLSLIFY 1
attribute vec3 color;attribute vec2 uv1;varying vec2 vUv;varying vec2 vUv2;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;uniform float uBendAmount;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_VERTEX_COLORS
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_VERTEX_COLORS
vColor=color;
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;vUv2=uv1;float bendFactor2=uBendAmount*smoothstep(1.0-vUv2.x,0.585,1.);float bendFactor=uBendAmount*-pow(vUv2.x,4.)*0.3;float theta=bendFactor;mat4 rotationMatrix=mat4(cos(theta),0.0,-sin(theta),0.0,0.0,1.0,0.0,0.0,sin(theta),0.0,cos(theta),0.0,0.0,0.0,0.0,1.0);vec3 transformed=(rotationMatrix*vec4(position,1.0)).xyz;transformed.z+=bendFactor2*bendFactor;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(transformed,1.0);}`,Xc=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vUv2;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,Kc=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Jc=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
float shadow=1.;
#ifdef USE_SHADOWMAP
#if NUM_DIR_LIGHT_SHADOWS > 0
DirectionalLight light;DirectionalLightShadow lightShadow;light=directionalLights[0];lightShadow=directionalLightShadows[0];shadow*=getShadow(directionalShadowMap[0],lightShadow.shadowMapSize,lightShadow.shadowBias,lightShadow.shadowRadius,vDirectionalShadowCoord[0]);vec3 shadowColor=mix(uShadowColor,vec3(1.0),shadow);
#endif
#endif
shadowColor=vec3(1.0)-(vec3(1.0)-shadowColor)*uShadowIntensity,vec3(0.0);diffuseColor.rgb*=shadowColor;
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,Zc=`#define GLSLIFY 1
attribute vec3 color;attribute vec2 uv1;varying vec2 vUv;varying vec2 vUv2;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_VERTEX_COLORS
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_VERTEX_COLORS
vColor=color;
#endif
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(position,1.0);
#include <env_vertex>
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;vUv2=uv1;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,$c=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vUv2;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
uniform sampler2D uColorTex;
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#ifdef USE_ENV
#include <env_pars>
#include <env_fragment>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);vec3 colorTex=texture2D(uColorTex,vUv2).rgb;float alpha=texture2D(uAlphaMap,vUv).r;
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}albedoMap.rgb=mix(albedoMap.rgb,colorTex,pow(alpha,4.));diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_ENV
vec3 envColor=envmap();finalColor=blendSoftLight(finalColor,envColor,uEnvIntensity);
#endif
float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,eA=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
varying vec3 vColor;
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
vColor=color;
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(position,1.0);
#include <env_vertex>
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,tA=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;uniform float uLightIntensity;uniform vec3 uBordersColor;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
#ifdef USE_ENV
#include <env_pars>
#include <env_fragment>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}vec2 rotateAroundPivot(vec2 uv,vec2 pivot,float angle){float cosAngle=cos(angle);float sinAngle=sin(angle);vec2 centeredUv=uv-pivot;return vec2(cosAngle*centeredUv.x-sinAngle*centeredUv.y,sinAngle*centeredUv.x+cosAngle*centeredUv.y)+pivot;}float roundedBoxSDF(vec2 CenterPosition,vec2 Size,float Radius){return length(max(abs(CenterPosition)-Size+Radius,0.0))-Radius;}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb*uBordersColor,diffuseColor.rgb*albedoMap.rgb,vColor.r);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
#ifdef USE_SECOND_NORMAL
vec3 secondNormalMap=texture2D(uSecondNormalMap,vUv*uSecondNormalRepeat).xyz*2.0-1.0;secondNormalMap.xy*=uSecondNormalScale;secondNormalMap=mix(secondNormalMap,normalMap,0.5);normal=normalize(tbn*secondNormalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
#include <shadows_fragment>
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_ENV
vec3 envColor=envmap();finalColor=blendSoftLight(finalColor,envColor,uEnvIntensity);
#endif
float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao=mix(aoMap.g*uAOMapIntensity,aoMap.r*uAOMapIntensity,vColor.r);
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;finalColor=mix(finalColor,finalColor*5.*ao,vColor.b);vec3 bottomLightColor=vec3(.9,.1,.1);vec2 shadesUvOffset=vec2(0.01,-0.003);vec2 shadesUvOffset2=vec2(0.2,0.);float pointLightsShades=0.007/(distance(vUv,vec2(0.165,0.16)+shadesUvOffset));pointLightsShades+=0.007/(distance(vUv,vec2(0.115,0.185)+shadesUvOffset));pointLightsShades+=0.007/(distance(vUv,vec2(0.215,0.138)+shadesUvOffset));pointLightsShades+=0.007/(distance(vUv,vec2(0.165,0.16)+shadesUvOffset2));pointLightsShades+=0.007/(distance(vUv,vec2(0.115,0.138)+shadesUvOffset2));pointLightsShades+=0.007/(distance(vUv,vec2(0.215,0.185)+shadesUvOffset2));finalColor=mix(finalColor,finalColor+pointLightsShades*bottomLightColor,pointLightsShades*(1.0-vColor.g)*uLightIntensity);vec2 size=vec2(.05,.02);vec2 location=vec2(0.08,0.51);vec2 location2=vec2(0.7,0.53);float edgeSoftness=0.018;float radius=0.02;vec2 rotatedUv=rotateAroundPivot(vUv,location,-0.55);vec2 rotatedUv2=rotateAroundPivot(vUv,location2,0.57);float distance=roundedBoxSDF(rotatedUv-location-(size/2.0),size/2.0,radius);float distance2=roundedBoxSDF(rotatedUv2-location2-(size/2.0),size/2.0,radius);float smoothedAlpha=1.0-smoothstep(0.0,edgeSoftness*2.0,distance);smoothedAlpha+=1.0-smoothstep(0.0,edgeSoftness*2.0,distance2);finalColor=mix(finalColor,finalColor+smoothedAlpha*bottomLightColor,smoothedAlpha*vColor.g*uLightIntensity);gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,ko=`#define GLSLIFY 1
attribute vec3 color;attribute float geometryId;attribute vec2 uv1;varying vec2 vUv;varying vec2 vUv2;varying vec3 vViewPosition;varying vec3 vNormal;varying float vGeometryId;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_VERTEX_COLORS
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
#ifdef USE_ENV
#include <env_pars>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
#ifdef USE_VERTEX_COLORS
vColor=color;
#endif
#ifdef USE_ENV
vec4 worldPosition=modelMatrix*vec4(position,1.0);
#include <env_vertex>
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;vUv2=uv1;vGeometryId=geometryId;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Go=`precision highp float;
#define GLSLIFY 1
varying vec2 vUv;varying vec2 vUv2;varying float vGeometryId;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;uniform sampler2D uShadowMap;uniform sampler2D uDataTexture;uniform sampler2D uEmissiveMap;uniform float uNbItems;uniform float uLightIntensity;
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;
#endif
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);if(albedoMap.r==0.0&&albedoMap.g==0.0&&albedoMap.b==0.0){albedoMap.rgb+=vec3(.05);}diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);if(vColor.r==0.0&&vColor.g==0.0&&vColor.b==0.0){diffuseColor.rgb+=vec3(.05);}
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
float roughness=1.;
#include <phong_fragment>
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;vec2 texelSize=vec2(1.0/uNbItems);float dataIndex=(vGeometryId+0.5)/uNbItems;vec2 correctedCoord=vec2(dataIndex,0.5);vec4 dataTexture=texture2D(uDataTexture,correctedCoord);vec4 emissiveMap=texture2D(uEmissiveMap,vUv);float ao=1.;vec3 shadowMap=texture2D(uShadowMap,vUv2).rgb;shadowMap=mix(shadowMap,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,shadowMap,1.0);finalColor=blendSoftLight(finalColor,shadowMap,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;finalColor=mix(finalColor,finalColor+(emissiveMap.rgb*uLightIntensity),dataTexture.r);gl_FragColor=clamp(vec4(finalColor.rgb,pow(alpha,2.)),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
}`,iA=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;
#ifdef USE_NOISE_MAP
uniform sampler2D uNoiseMap;uniform vec2 uNoiseMapScale;uniform float uNoiseMapIntensity;
#endif
#ifdef USE_VERTEX_AO
varying vec3 vColor;
#endif
#ifdef USE_SHADOWS
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;
#ifdef USE_SHADOWS
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,sA=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;uniform float uTime;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#ifdef USE_SECONDARY_AO_VERTEX
uniform float uAOVertexMix;
#endif
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_ALPHA
uniform sampler2D uAlphaMap;uniform float uAlphaThreshold;uniform float uAlphaWidth;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_SECOND_NORMAL
uniform sampler2D uSecondNormalMap;uniform vec2 uSecondNormalRepeat;uniform vec2 uSecondNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform vec2 uAOMapRepeat;uniform float uAOMapIntensity;
#endif
#ifdef USE_COMBINED_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWS
#include <shadows_fragment_pars>
#endif
uniform sampler2D uScoreMap;uniform vec2 uDotResolution;uniform float uDotSize;uniform vec3 uBackgroundColor;
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALPHA
float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);diffuseColor.a=alpha*uOpacity;
#endif
#ifdef USE_VERTEX_COLORS
diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*vColor.rgb,1.0);
#endif
vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
#ifdef USE_SHADOWS
float shadow=1.;
#ifdef USE_SHADOWMAP
#if NUM_DIR_LIGHT_SHADOWS > 0
DirectionalLight light;DirectionalLightShadow lightShadow;light=directionalLights[0];lightShadow=directionalLightShadows[0];shadow*=getShadow(directionalShadowMap[0],lightShadow.shadowMapSize,lightShadow.shadowBias,lightShadow.shadowRadius,vDirectionalShadowCoord[0]);vec3 shadowColor=mix(uShadowColor,vec3(1.0),shadow);
#endif
#endif
shadowColor=vec3(1.0)-(vec3(1.0)-shadowColor)*uShadowIntensity,vec3(0.0);diffuseColor.rgb*=shadowColor;
#endif
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;float ao=1.;
#ifdef USE_AO_MAP
vec4 aoMap=texture2D(uAOMap,vUv*uAOMapRepeat);ao*=(aoMap.g-1.0)*uAOMapIntensity+1.0;
#endif
#ifdef USE_COMBINED_AO_MAP
vec4 shadowAoMap=texture2D(uCombinedAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#ifdef USE_SECONDARY_AO_VERTEX
ao=mix((vColor.r-1.)*uAOVertexIntensity+1.0,(vColor.g-1.)*uAOVertexIntensity+1.0,uAOVertexMix);
#endif
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor.rgb,diffuseColor.a),0.,1.);vec2 gridPos=mod(vUv*uDotResolution,vec2(1.0))/1.0;float dist=length(gridPos-0.5);float dotPattern=step(dist,uDotSize);vec2 centerUv=(floor(vUv*uDotResolution)+0.5)/uDotResolution;vec4 scoreColor=texture2D(uScoreMap,centerUv);vec2 reflectionOffset=vec2(-0.25,0.25);float reflectionDist=length(gridPos-(0.5+reflectionOffset*uDotSize));float reflectionPattern=step(reflectionDist,uDotSize*0.25);vec3 baseColor=scoreColor.rgb*dotPattern;float smoothCircleClip=1.0-smoothstep(0.2,0.55,length(vUv-0.5));gl_FragColor.rgb=baseColor*smoothCircleClip+((1.0-dotPattern)+(1.0-smoothCircleClip))*uBackgroundColor;gl_FragColor.a=scoreColor.a;float circleClip=step(length(vUv-0.5),0.5);gl_FragColor.a=circleClip;
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`,Tn={phong:{vertexShader:kc,fragmentShader:Gc},ball:{vertexShader:Hc,fragmentShader:zc},launcherStick:{vertexShader:jc,fragmentShader:Xc},blanket:{vertexShader:Kc,fragmentShader:Jc},score:{vertexShader:iA,fragmentShader:sA},blackWhite:{vertexShader:qc,fragmentShader:Vc},stool:{vertexShader:Wc,fragmentShader:Yc},ground:{vertexShader:eA,fragmentShader:tA},stickers:{vertexShader:ko,fragmentShader:Go},lipstick:{vertexShader:Zc,fragmentShader:$c}};class Pi extends je{constructor(e){const t=e.settings,i=t.customShader?Tn[t.customShader.shadersName]:Tn.phong;t.customShader&&t.customShader.shadersName;let s={};if(e.settings.customShader&&e.settings.customShader.additionalUniforms&&Object.keys(e.settings.customShader.additionalUniforms).forEach(n=>{e.settings.customShader.additionalUniforms[n].type==="texture"?s[n]={value:$.get(e.settings.customShader.additionalUniforms[n].value)}:e.settings.customShader.additionalUniforms[n].type==="color"?s[n]={value:new _e(e.settings.customShader.additionalUniforms[n].value)}:e.settings.customShader.additionalUniforms[n].type==="vector2"?s[n]={value:new T(e.settings.customShader.additionalUniforms[n].value.x,e.settings.customShader.additionalUniforms[n].value.y)}:e.settings.customShader.additionalUniforms[n].type==="vector3"?s[n]={value:new O(e.settings.customShader.additionalUniforms[n].value.x,e.settings.customShader.additionalUniforms[n].value.y,e.settings.customShader.additionalUniforms[n].value.z)}:s[n]={value:e.settings.customShader.additionalUniforms[n].value}}),e.settings.env){const n=$.get(e.settings.env.map.value);s={...s,uEnvMap:{value:n},uEnvRotation:{value:t.env.rotation?new T(t.env.rotation.value.x,t.env.rotation.value.y):new T(0,0)},uEnvIntensity:{value:t.env.intensity?t.env.intensity.value:1}}}if(t.lights){const n=Mt.lights.selectiveDirLights.value.map(r=>t.lights.includes(r.key)?1:0);s={...s,uSelectiveLightsArray:{value:n}}}if(e.settings.albedo){const n=$.get(e.settings.albedo.map.value);s={...s,uAlbedoMap:{value:n},uAlbedoRepeat:{value:t.albedo.repeat?new T(t.albedo.repeat.value.x,t.albedo.repeat.value.y):new T(1,1)},uAlbedoIntensity:{value:t.albedo.intensity?t.albedo.intensity.value:1}},n.colorSpace=ot}if(e.settings.normal){const n=$.get(e.settings.normal.map.value);s={...s,uNormalMap:{value:n},uNormalRepeat:{value:t.normal.repeat?new T(t.normal.repeat.value.x,t.normal.repeat.value.y):new T(1,1)},uNormalScale:{value:t.normal.scale?new T(t.normal.scale.value.x,t.normal.scale.value.y):new T(1,1)}}}if(e.settings.secondNormal){const n=$.get(e.settings.secondNormal.map.value);s={...s,uSecondNormalMap:{value:n},uSecondNormalRepeat:{value:t.secondNormal.repeat?new T(t.secondNormal.repeat.value.x,t.secondNormal.repeat.value.y):new T(1,1)},uSecondNormalScale:{value:t.secondNormal.scale?new T(t.secondNormal.scale.value.x,t.secondNormal.scale.value.y):new T(1,1)}}}if(e.settings.matcap){const n=$.get(e.settings.matcap.map.value);if(s={...s,uMatcapMap:{value:n},uMatcapOffset:{value:t.matcap.offset?new T(t.matcap.offset.value.x,t.matcap.offset.value.y):new T(0,0)},uMatcapIntensity:{value:t.matcap.intensity?t.matcap.intensity.value:1}},e.settings.matcap.noise){const r=$.get(e.settings.matcap.noise.value);s={...s,uMatcapNoiseMap:{value:r},uMatcapNoiseRepeat:{value:t.matcap.noiseRepeat?new T(t.matcap.noiseRepeat.value.x,t.matcap.noiseRepeat.value.y):new T(1,1)},uMatcapNoiseIntensity:{value:t.matcap.noiseIntensity?t.matcap.noiseIntensity.value:0},uMatcapNoiseChannel:{value:t.matcap.noiseChannel?t.matcap.noiseChannel.value:new O(0,0,0)}}}}if(e.settings.roughness){const n=$.get(e.settings.roughness.map.value);s={...s,uRoughnessMap:{value:n},uRoughnessRepeat:{value:t.roughness.repeat?new T(t.roughness.repeat.value.x,t.roughness.repeat.value.y):new T(1,1)},uRoughnessIntensity:{value:t.roughness.intensity?t.roughness.intensity.value:1}}}if(e.settings.ao){const n=$.get(e.settings.ao.map.value);s={...s,uAOMap:{value:n},uAOMapRepeat:{value:t.ao.repeat?new T(t.ao.repeat.value.x,t.ao.repeat.value.y):new T(1,1)},uAOMapIntensity:{value:t.ao.intensity?t.ao.intensity.value:0}}}if(e.settings.combinedAo){const n=$.get(e.settings.ao.map.value);s={...s,uAOMap:{value:n},uAOMapShadowIntensity:{value:t.combinedAo.shadowIntensity?t.combinedAo.shadowIntensity.value:1},uAOMapOcclusionIntensity:{value:t.combinedAo.occlusionIntensity?t.combinedAo.occlusionIntensity.value:1}}}if(e.settings.env){const n=$.get(e.settings.env.map.value);s={...s,uEnvMap:{value:n},uEnvRotation:{value:t.env.rotation?new T(t.env.rotation.value.x,t.env.rotation.value.y):new T(0,0)},uEnvIntensity:{value:t.env.intensity?t.env.intensity.value:1}}}if(e.settings.alpha){const n=$.get(e.settings.alpha.map.value);s={...s,uAlphaMap:{value:n},uAlphaThreshold:{value:t.alpha.threshold?t.alpha.threshold.value:.5},uAlphaWidth:{value:t.alpha.width?t.alpha.width.value:.1}}}if(t.lights){const n=Mt.lights.selectiveDirLights.value.map(r=>t.lights.includes(r.key)?1:0);s={...s,uSelectiveLightsArray:{value:n}}}const a=Nt.merge([Mt.fog,Mt.lights,{...s,uAOVertexIntensity:{value:t.options.aoVertexIntensity?t.options.aoVertexIntensity.value:1},uContrast:{value:t.options.contrast?t.options.contrast.value:1},uSaturation:{value:t.options.saturation?t.options.saturation.value:1},uBrightness:{value:t.options.brightness?t.options.brightness.value:1},uKa:{value:t.lighting.ambientIntensity.value},uKd:{value:t.lighting.diffuseIntensity.value},uKs:{value:t.lighting.specularIntensity.value},uShininess:{value:t.lighting.shininess.value},uColorA:{value:new _e(t.lighting.ambientColor.value)},uColorD:{value:new _e(t.lighting.diffuseColor.value)},uColorS:{value:new _e(t.lighting.specularColor.value)},uColorE:{value:new _e(t.lighting.emissiveColor.value)},uOpacity:{value:t.options.opacity.value}}]);super({uniforms:a,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:t.options.side||Jr,name:t.customShader?t.customShader.shadersName:"CSPhongMaterial",fog:t.options.fog?t.options.fog.value:!1,lights:!0,transparent:t.options.opacity.value<1||!!t.alpha,blending:e.blending||1,depthTest:e.depthTest||!0,depthWrite:e.depthWrite||!0,wireframe:t.options.wireframe.value||!1,extensions:{derivatives:!0},defines:{USE_ALBEDO:!!t.albedo,USE_NORMAL:!!t.normal,USE_SECOND_NORMAL:!!t.secondNormal,USE_ENV:!!t.env,USE_MATCAP:!!t.matcap,USE_ROUGHNESS:!!t.roughness,USE_AO_MAP:!!t.ao,USE_COMBINED_AO_MAP:!!t.combinedAo,USE_ALPHA:!!t.alpha,USE_VERTEX_AO:t.options.useVertexAO?t.options.useVertexAO.value:!1,USE_VERTEX_COLORS:t.options.useVertexColors?t.options.useVertexColors.value:!1,USE_MATCAP_ROUGHNESS:t.matcap?!!t.matcap.noise:!1,USE_POINT_LIGHTS:!!t.pointLights,USE_SHADOWS:t.options.shadows?t.options.shadows.value:!1,SELECTIVE_DIR_LIGHTS:!!t.lights}})}}function yi(o,e,t){for(const i in e){if(i==="position"||i==="rotation"||i==="scale"||i==="renderTarget")continue;const s=o.addFolder({title:i,expanded:!1});for(const a in e[i]){const n=e[i][a];if(n){if(n.type==="texture"){if($.get(n.value).isCompressedTexture)continue;s.addBinding($.get(n.value),"image",{label:a,view:"image",height:40,showMonitor:!0}).on("change",({value:r})=>Fn({material:t,key:i,value:r}))}else if(n.value!==void 0)s.addBinding(n,"value",{label:a,step:.01,...n.params}).on("change",()=>Nn({material:t,settingsName:e}));else if(a==="additionalUniforms")for(const r in n){const l=n[r],h=aA(r);if(l.debug!==!1)if(l.type==="texture"){if($.get(l.value).isCompressedTexture)continue;s.addBinding($.get(l.value),"image",{label:h,view:"image",height:40,showMonitor:!0}).on("change",({value:c})=>Fn({material:t,key:r,value:c,isAdditionalUniforms:!0}))}else l.value&&s.addBinding(l,"value",{label:h,step:.01,...l.params}).on("change",()=>Nn({material:t,settingsName:e}))}}}}}function Nn(o){const e=o.material.uniforms,t=o.settingsName;if(t.albedo&&t.albedo.repeat&&(e.uAlbedoRepeat.value.copy(t.albedo.repeat.value),e.uAlbedoIntensity.value=t.albedo.intensity.value),t.albedo&&t.albedo.offset&&(e.uAlbedoOffset.value.copy(t.albedo.offset.value),e.uAlbedoIntensity.value=t.albedo.intensity.value),t.matcap&&t.matcap.offset&&(e.uMatcapOffset.value.copy(t.matcap.offset.value),e.uMatcapIntensity.value=t.matcap.intensity.value),t.matcap0&&t.matcap0.offset&&(e.uMatcap0Offset.value.copy(t.matcap0.offset.value),e.uMatcap0Intensity.value=t.matcap0.intensity.value),t.matcap1&&t.matcap1.offset&&(e.uMatcap1Offset.value.copy(t.matcap1.offset.value),e.uMatcap1Intensity.value=t.matcap1.intensity.value),t.matcap&&t.matcap.noiseRepeat&&(e.uMatcapNoiseRepeat.value.copy(t.matcap.noiseRepeat.value),e.uMatcapNoiseIntensity.value=t.matcap.noiseIntensity.value),t.ao&&t.ao.map&&(e.uAOMapRepeat.value.copy(t.ao.repeat.value),e.uAOMapIntensity.value=t.ao.intensity.value),t.secondaryAo&&t.secondaryAo.map&&(e.uSecondaryAOMapIntensity.value=t.secondaryAo.intensity.value),t.useVertexAO&&(o.material.defines.USE_VERTEX_AO=t.useVertexAO.value,o.material.needsUpdate=!0),t.options.aoVertexIntensity&&(e.uAOVertexIntensity.value=t.options.aoVertexIntensity.value),t.normal&&t.normal.repeat&&(e.uNormalRepeat.value.copy(t.normal.repeat.value),t.options.useSingleRepeat&&t.options.useSingleRepeat.value&&e.uNormalRepeat.value.copy(t.albedo.repeat.value),e.uNormalScale.value.copy(t.normal.scale.value)),t.normal2&&t.normal2.repeat&&(e.uNormal2Repeat.value.copy(t.normal2.repeat.value),e.uNormal2Scale.value.copy(t.normal2.scale.value)),t.alpha&&(e.uAlphaThreshold.value=t.alpha.threshold.value,e.uAlphaWidth.value=t.alpha.width.value),t.roughness&&t.roughness.repeat&&(e.uRoughnessRepeat.value.copy(t.roughness.repeat.value),t.options.useSingleRepeat&&t.options.useSingleRepeat.value&&e.uRoughnessRepeat.value.copy(t.albedo.repeat.value),e.uRoughnessIntensity.value=t.roughness.intensity.value),t.reflection&&(e.uReflectionIntensity.value=t.reflection.intensity.value),t.reflectionRoughness&&(e.uReflectionRoughnessRepeat.value.copy(t.reflectionRoughness.repeat.value),e.uReflectionRoughnessIntensity.value=t.reflectionRoughness.intensity.value,e.uReflectionMipStrength.value=t.reflectionRoughness.mipStrength.value),t.env&&(e.uEnvIntensity.value=t.env.intensity.value,t.env.rotation&&e.uEnvRotation.value.copy(t.env.rotation.value)),t.options.contrast&&(e.uContrast.value=t.options.contrast.value,e.uSaturation.value=t.options.saturation.value,e.uBrightness.value=t.options.brightness.value),t.options.wireframe&&(o.material.wireframe=t.options.wireframe.value),t.options.opacity&&(e.uOpacity.value=t.options.opacity.value,t.options.opacity.value<1&&(o.material.transparent=!0)),t.lighting.ambientIntensity&&(e.uKa.value=t.lighting.ambientIntensity.value,e.uKd.value=t.lighting.diffuseIntensity.value,e.uKs.value=t.lighting.specularIntensity.value,e.uShininess.value=t.lighting.shininess.value,e.uColorA.value.set(t.lighting.ambientColor.value),e.uColorD.value.set(t.lighting.diffuseColor.value),e.uColorS.value.set(t.lighting.specularColor.value),e.uColorE.value.set(t.lighting.emissiveColor.value)),t.customShader&&t.customShader.additionalUniforms)for(const i in t.customShader.additionalUniforms){const s=t.customShader.additionalUniforms[i];s.debug!==!1&&(s.type&&s.type==="color"?e[i].value=new _e(s.value):s.type&&s.type!=="texture"?e[i].value.copy(s.value):s.type!=="texture"&&(e[i].value=s.value))}}function Fn(o){const e=o.material.uniforms;e.uAlbedoMap&&o.key==="albedo"&&(e.uAlbedoMap.value=new zt().load(o.value.src)),e.uNormalMap&&o.key==="normal"&&(e.uNormalMap.value=new zt().load(o.value.src)),e.uMatcapMap&&o.key==="matcap"&&(e.uMatcapMap.value=new zt().load(o.value.src)),e.uMatcapNoiseMap&&o.key==="matcapNoise"&&(e.uMatcapNoiseMap.value=new zt().load(o.value.src)),e.uAOMap&&o.key==="ao"&&(e.uAOMap.value=new zt().load(o.value.src)),e.uRoughnessMap&&o.key==="roughness"&&(e.uRoughnessMap.value=new zt().load(o.value.src)),e.uReflectionRoughnessMap&&o.key==="reflectionRoughness"&&(e.uReflectionRoughnessMap.value=new zt().load(o.value.src)),e.uEnvMap&&o.key==="env"&&(e.uEnvMap.value=new zt().load(o.value.src),e.uEnvMap.value.wrapS=e.uEnvMap.value.wrapT=o.value.wrapS||o.value.wrapT),o.isAdditionalUniforms&&(e[o.key].value=new zt().load(o.value.src))}function aA(o){return o.replace("u","").replace("value","").replace(/([A-Z])/g," $1").trim()}class Ho extends we(Ut){init(e){this._debug=e.debugFolder,this.settings=ci,this._material=this._createMaterial(),this._mesh=this._createMesh(),this.debugFolder=this._createDebugFolder()}destroy(){super.destroy(),this._material.dispose()}_createMaterial(){return new Pi({settings:ci.material})}_createObjectMaterial(e){e=this._toCamelCase(e);const t=`${e}Material`;if(!this.settings[t]){const s={...this.settings.templateMaterial};ci[t]=s}const i=new Pi({settings:ci[t]});return this._materials[e]=i,i}_createMesh(){const e=$.get("model-sample").scene;return e.traverse(t=>{t.isMesh&&(t.material=this._material,t.castShadow=!0,t.receiveShadow=!0)}),this.add(e),e}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Model",expanded:!1}),t=e.addFolder({title:"Material",expanded:!1});return yi(t,ci.material,this._material),this.$debugger.registerFile(ci,ci.file),e}_settingsChangeHandler(e){}}const ei={file:"./webgl/components/ComponentReflector/settings.js",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},updateEveryTwoFrames:!0,material:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:.9999999999999999},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:3.84},specularIntensity:{value:.9999999999999997},shininess:{value:7,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},renderTarget:{width:512,height:512,params:{minFilter:1008,magFilter:1006,format:1023,samples:1,generateMipmaps:!0,stencilBuffer:!1,type:1016}},reflection:{intensity:{value:1}},reflectionRoughness:{intensity:{value:3},repeat:{value:{x:1,y:1}},map:{value:"roughness-sample",type:"texture"},mipStrength:{value:.3}}}},nA=`#define GLSLIFY 1
attribute vec3 color;varying vec2 vUv;varying vec3 vViewPosition;varying vec3 vNormal;varying vec4 vWorldPosition;varying vec4 vReflectionCoord;uniform mat4 uTextureMatrix;varying vec3 vColor;
#ifdef USE_SHADOWMAP
#include <shadows_vertex_pars>
#endif
#ifdef USE_FOG
#include <fog_pars_vertex>
#endif
void main(){vec4 mvPosition=modelViewMatrix*vec4(position,1.0);
#ifdef USE_FOG
#include <fog_vertex>
#endif
#ifdef USE_VERTEX_AO
vColor=color;
#endif
vNormal=normalize(normalMatrix*normal);vViewPosition=-mvPosition.xyz;vUv=uv;vReflectionCoord=uTextureMatrix*vec4(position,1.0);
#ifdef USE_SHADOWMAP
#include <shadows_vertex>
#endif
gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,oA=`#define GLSLIFY 1
varying vec2 vUv;varying vec3 vNormal;varying vec3 vViewPosition;varying vec3 vColor;varying vec4 vReflectionCoord;
#ifdef USE_VERTEX_AO
uniform float uAOVertexIntensity;
#endif
#ifdef USE_ALBEDO
uniform sampler2D uAlbedoMap;uniform vec2 uAlbedoRepeat;uniform float uAlbedoIntensity;
#endif
#ifdef USE_ROUGHNESS
uniform sampler2D uRoughnessMap;uniform vec2 uRoughnessRepeat;uniform float uRoughnessIntensity;
#endif
#ifdef USE_REFLECTION_ROUGHNESS
uniform sampler2D uReflectionRoughnessMap;uniform float uReflectionRoughnessIntensity;uniform float uReflectionMipStrength;uniform vec2 uReflectionRoughnessMapResolution;uniform vec2 uReflectionRoughnessRepeat;
#endif
#ifdef USE_NORMAL
uniform sampler2D uNormalMap;uniform vec2 uNormalRepeat;uniform vec2 uNormalScale;
#endif
#ifdef USE_AO_MAP
uniform sampler2D uAOMap;uniform float uAOMapIntensity;uniform float uAOMapShadowIntensity;uniform float uAOMapOcclusionIntensity;
#endif
#ifdef USE_MATCAP
#include <matcap_pars_fragment>
#include <matcap_fragment>
#ifdef USE_MATCAP_ROUGHNESS
uniform sampler2D uMatcapNoiseMap;uniform vec2 uMatcapNoiseRepeat;uniform vec3 uMatcapNoiseChannel;uniform float uMatcapNoiseIntensity;
#endif
#endif
uniform float uContrast;uniform float uSaturation;uniform float uBrightness;uniform float uReflectionIntensity;uniform sampler2D uReflection;
#ifdef USE_FOG
#include <fog_pars_fragment>
#endif
#ifdef USE_SHADOWMAP
#include <shadows_fragment_pars>
#endif
#include <phong_pars_fragment>
vec3 contrastSaturationBrightness(vec3 color,float con,float sat,float brt){const float AvgLumR=0.5;const float AvgLumG=0.5;const float AvgLumB=0.5;const vec3 LumCoeff=vec3(0.2125,0.7154,0.0721);vec3 AvgLumin=vec3(AvgLumR,AvgLumG,AvgLumB);vec3 brtColor=color*brt;vec3 intensity=vec3(dot(brtColor,LumCoeff));vec3 satColor=mix(intensity,brtColor,sat);vec3 conColor=mix(AvgLumin,satColor,con);return conColor;}mat3 getTangentFrame(vec3 eye_pos,vec3 surf_norm,vec2 uv){vec3 q0=dFdx(eye_pos.xyz);vec3 q1=dFdy(eye_pos.xyz);vec2 st0=dFdx(uv.st);vec2 st1=dFdy(uv.st);vec3 N=surf_norm;vec3 q1perp=cross(q1,N);vec3 q0perp=cross(N,q0);vec3 T=q1perp*st0.x+q0perp*st1.x;vec3 B=q1perp*st0.y+q0perp*st1.y;float det=max(dot(T,T),dot(B,B));float scale=(det==0.0)? 0.0 : inversesqrt(det);return mat3(T*scale,B*scale,N);}
#define r0 1.0
#define v0 0.339
#define m0 - 2.0
#define r1 0.8
#define v1 0.276
#define m1 - 1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness){float mip=0.0;if(roughness>=r1){mip=(r0-roughness)*(m1-m0)/(r0-r1)+m0;}else if(roughness>=r4){mip=(r1-roughness)*(m4-m1)/(r1-r4)+m1;}else if(roughness>=r5){mip=(r4-roughness)*(m5-m4)/(r4-r5)+m4;}else if(roughness>=r6){mip=(r5-roughness)*(m6-m5)/(r5-r6)+m5;}else{mip=-2.0*log2(1.16*roughness);}return mip;}vec4 cubic(float v){vec4 n=vec4(1.0,2.0,3.0,4.0)-v;vec4 s=n*n*n;float x=s.x;float y=s.y-4.0*s.x;float z=s.z-4.0*s.y+6.0*s.x;float w=6.0-x-y-z;return vec4(x,y,z,w)*(1.0/6.0);}vec4 textureBicubic(sampler2D sampler,vec2 texCoords,vec2 textureResolution){vec2 texSize=textureResolution;vec2 invTexSize=1.0/texSize;texCoords=texCoords*texSize-0.5;vec2 fxy=fract(texCoords);texCoords-=fxy;vec4 xcubic=cubic(fxy.x);vec4 ycubic=cubic(fxy.y);vec4 c=texCoords.xxyy+vec2(-0.5,+1.5).xyxy;vec4 s=vec4(xcubic.xz+xcubic.yw,ycubic.xz+ycubic.yw);vec4 offset=c+vec4(xcubic.yw,ycubic.yw)/s;offset*=invTexSize.xxyy;vec4 sample0=texture2D(sampler,offset.xz);vec4 sample1=texture2D(sampler,offset.yz);vec4 sample2=texture2D(sampler,offset.xw);vec4 sample3=texture2D(sampler,offset.yw);float sx=s.x/(s.x+s.y);float sy=s.z/(s.z+s.w);return mix(mix(sample3,sample2,sx),mix(sample1,sample0,sx),sy);}vec4 textureBicubicLod(sampler2D sampler,vec2 texCoords,float mipmaplvl,vec2 textureResolution){vec2 texSize=textureResolution;vec2 invTexSize=1.0/texSize;texCoords=texCoords*texSize-0.5;vec2 fxy=fract(texCoords);texCoords-=fxy;vec4 xcubic=cubic(fxy.x);vec4 ycubic=cubic(fxy.y);vec4 c=texCoords.xxyy+vec2(-0.5,+1.5).xyxy;vec4 s=vec4(xcubic.xz+xcubic.yw,ycubic.xz+ycubic.yw);vec4 offset=c+vec4(xcubic.yw,ycubic.yw)/s;offset*=invTexSize.xxyy;vec4 sample0=texture2DLodEXT(sampler,offset.xz,mipmaplvl);vec4 sample1=texture2DLodEXT(sampler,offset.yz,mipmaplvl);vec4 sample2=texture2DLodEXT(sampler,offset.xw,mipmaplvl);vec4 sample3=texture2DLodEXT(sampler,offset.yw,mipmaplvl);float sx=s.x/(s.x+s.y);float sy=s.z/(s.z+s.w);return mix(mix(sample3,sample2,sx),mix(sample1,sample0,sx),sy);}void main(){vec4 diffuseColor=vec4(uColorD,uOpacity);
#ifdef USE_ALBEDO
vec4 albedoMap=texture2D(uAlbedoMap,vUv*uAlbedoRepeat);diffuseColor.rgb=mix(diffuseColor.rgb,diffuseColor.rgb*albedoMap.rgb,uAlbedoIntensity);
#endif
vec2 mapUv=vUv;vec2 reflectionUv=vReflectionCoord.xy/vReflectionCoord.w;vec4 color=texture2D(uReflection,reflectionUv);
#ifdef USE_REFLECTION_ROUGHNESS
float roughnessReflection=texture2D(uReflectionRoughnessMap,mapUv*uReflectionRoughnessRepeat).r*uReflectionRoughnessIntensity;float mipmapLevel=roughnessToMip(roughnessReflection)*uReflectionMipStrength;float mipF=fract(mipmapLevel);float mipLow=floor(mipmapLevel);float mipHigh=mipLow+1.0;vec2 sizeLow=vec2(pow(2.,10.-mipLow));vec2 resolutionLow=vec2(sizeLow);vec4 colorLow=textureBicubicLod(uReflection,reflectionUv,mipLow,resolutionLow);if(mipF==0.0){color=colorLow;}else{vec2 sizeHigh=vec2(pow(2.,10.-mipHigh));vec2 resolutionHigh=vec2(sizeHigh);vec4 colorHigh=textureBicubicLod(uReflection,reflectionUv,mipHigh,resolutionHigh);color=mix(colorLow,colorHigh,mipF);}
#endif
diffuseColor.rgb=mix(diffuseColor.rgb,color.rgb,uReflectionIntensity);vec3 normal=normalize(vNormal);
#ifdef USE_NORMAL
mat3 tbn=getTangentFrame(-vViewPosition,normal,vUv);vec3 normalMap=texture2D(uNormalMap,vUv*uNormalRepeat).xyz*2.0-1.0;normalMap.xy*=uNormalScale;normal=normalize(tbn*normalMap);
#endif
float roughness=1.;
#ifdef USE_ROUGHNESS
roughness=texture2D(uRoughnessMap,vUv*uRoughnessRepeat).r*uRoughnessIntensity;
#endif
#include <phong_fragment>
vec3 finalColor=(reflectedLight.directDiffuse*uKd)+(reflectedLight.indirectDiffuse*uKa)+reflectedLight.directSpecular+reflectedLight.indirectSpecular+uColorE;
#ifdef USE_SHADOWMAP
float shadow=1.;
#ifdef USE_SHADOWMAP
#if NUM_DIR_LIGHT_SHADOWS > 0
DirectionalLight light;DirectionalLightShadow lightShadow;light=directionalLights[0];lightShadow=directionalLightShadows[0];shadow*=getShadow(directionalShadowMap[0],lightShadow.shadowMapSize,lightShadow.shadowBias,lightShadow.shadowRadius,vDirectionalShadowCoord[0]);vec3 shadowColor=mix(uShadowColor,vec3(1.0),shadow);
#endif
#endif
shadowColor=vec3(1.0)-(vec3(1.0)-shadowColor)*uShadowIntensity,vec3(0.0);float shadowFalloff=clamp(vDirectionalShadowCoord[0].z*20.0-uShadowFalloff,0.0,1.0);shadowColor=mix(shadowColor,vec3(1.0),shadowFalloff);diffuseColor.rgb*=shadowColor;
#endif
float ao=1.;
#ifdef USE_AO_MAP
vec4 shadowAoMap=texture2D(uAOMap,vUv);ao*=(shadowAoMap.g-1.0)*uAOMapShadowIntensity+1.0;ao*=(shadowAoMap.r-1.0)*uAOMapOcclusionIntensity+1.0;
#endif
#ifdef USE_VERTEX_AO
ao*=(vColor.r-1.)*uAOVertexIntensity+1.0;
#endif
vec3 aoColor=vec3(1.0);aoColor=mix(aoColor,vec3(0.01,0.0,0.01),1.0-ao);finalColor=blendMultiply(finalColor,aoColor,1.0);finalColor=blendSoftLight(finalColor,aoColor,0.5);
#ifdef USE_MATCAP
float matcapRoughness=1.;
#ifdef USE_MATCAP_ROUGHNESS
vec3 matcapNoise=texture2D(uMatcapNoiseMap,vUv*uMatcapNoiseRepeat).rgb;matcapRoughness+=(matcapNoise.r*uMatcapNoiseChannel.r+matcapNoise.g*uMatcapNoiseChannel.g+matcapNoise.b*uMatcapNoiseChannel.b)*uMatcapNoiseIntensity;
#endif
vec3 matcapColor=matcap(matcapRoughness);finalColor*=clamp((matcapColor-1.0)*uMatcapIntensity+1.0,0.0,1.0);
#endif
finalColor=contrastSaturationBrightness(finalColor,uContrast,uSaturation,uBrightness);finalColor*=diffuseColor.rgb;gl_FragColor=clamp(vec4(finalColor,diffuseColor.a),0.,1.);
#include <tonemapping_fragment>
#include <colorspace_fragment>
#ifdef USE_FOG
#include <fog_fragment>
#endif
}`;class rA extends je{constructor(e){let t={};const i=e.settings;if(e.settings.albedo){const a=$.get(e.settings.albedo.map.value);t={uAlbedoMap:{value:a},uAlbedoRepeat:{value:i.albedo.repeat?new T(i.albedo.repeat.value.x,i.albedo.repeat.value.y):new T(1,1)},uAlbedoIntensity:{value:i.albedo.intensity?i.albedo.intensity.value:1}},a.colorSpace=LinearSRGBColorSpace}if(e.settings.normal){const a=$.get(e.settings.normal.map.value);t={...t,uNormalMap:{value:a},uNormalRepeat:{value:i.normal.repeat?new T(i.normal.repeat.value.x,i.normal.repeat.value.y):new T(1,1)},uNormalScale:{value:i.normal.scale?new T(i.normal.scale.value.x,i.normal.scale.value.y):new T(1,1)}}}if(e.settings.matcap){const a=$.get(e.settings.matcap.map.value);if(t={...t,uMatcapMap:{value:a},uMatcapOffset:{value:i.matcap.offset?new T(i.matcap.offset.value.x,i.matcap.offset.value.y):new T(0,0)},uMatcapIntensity:{value:i.matcap.intensity?i.matcap.intensity.value:1}},e.settings.matcap.noise){const n=$.get(e.settings.matcap.noise.value);t={...t,uMatcapNoiseMap:{value:n},uMatcapNoiseRepeat:{value:i.matcap.noiseRepeat?new T(i.matcap.noiseRepeat.value.x,i.matcap.noiseRepeat.value.y):new T(1,1)},uMatcapNoiseIntensity:{value:i.matcap.noiseIntensity?i.matcap.noiseIntensity.value:0},uMatcapNoiseChannel:{value:i.matcap.noiseChannel?i.matcap.noiseChannel.value:new O(0,0,0)}}}}if(e.settings.roughness){const a=$.get(e.settings.roughness.map.value);t={...t,uRoughnessMap:{value:a},uRoughnessRepeat:{value:i.roughness.repeat?new T(i.roughness.repeat.value.x,i.roughness.repeat.value.y):new T(1,1)},uRoughnessIntensity:{value:i.roughness.intensity?i.roughness.intensity.value:1}}}if(e.settings.reflectionRoughness){const a=$.get(e.settings.reflectionRoughness.map.value);t={...t,uReflectionRoughnessMap:{value:a},uReflectionRoughnessMapResolution:{value:new T(a.image.width,a.image.height)},uReflectionRoughnessRepeat:{value:i.reflectionRoughness.repeat?new T(i.reflectionRoughness.repeat.value.x,i.reflectionRoughness.repeat.value.y):new T(1,1)},uReflectionRoughnessIntensity:{value:i.reflectionRoughness.intensity?i.reflectionRoughness.intensity.value:1},uReflectionMipStrength:{value:i.reflectionRoughness.mipStrength?i.reflectionRoughness.mipStrength.value:.1}}}if(t={...t,uReflectionIntensity:{value:i.reflection&&i.reflection.intensity?i.reflection.intensity.value:1}},e.settings.ao){const a=$.get(e.settings.ao.map.value);t={...t,uAOMap:{value:a},uAOMapRepeat:{value:i.ao.repeat?new T(i.ao.repeat.value.x,i.ao.repeat.value.y):new T(1,1)},uAOMapIntensity:{value:i.ao.intensity?i.ao.intensity.value:0}}}if(e.settings.env){const a=$.get(e.settings.env.map.value);t={...t,uEnvMap:{value:a},uEnvRotation:{value:i.env.rotation?new T(i.env.rotation.value.x,i.env.rotation.value.y):new T(0,0)},uEnvIntensity:{value:i.env.intensity?i.env.intensity.value:1}}}if(e.settings.alpha){const a=$.get(e.settings.alpha.map.value);t={...t,uAlphaMap:{value:a},uAlphaThreshold:{value:i.alpha.threshold?i.alpha.threshold.value:.5},uAlphaWidth:{value:i.alpha.width?i.alpha.width.value:.1}}}if(e.settings.lights){const a=Mt.lights.selectiveDirLights.value.map(n=>i.lights.includes(n.key)?1:0);t={...t,uSelectiveLightsArray:{value:a}}}const s=Nt.merge([Mt.fog,Mt.lights,{...t,uAOVertexIntensity:{value:i.options.aoVertexIntensity?i.options.aoVertexIntensity.value:1},uContrast:{value:i.options.contrast?i.options.contrast.value:1},uSaturation:{value:i.options.saturation?i.options.saturation.value:1},uBrightness:{value:i.options.brightness?i.options.brightness.value:1},uKa:{value:i.lighting.ambientIntensity.value},uKd:{value:i.lighting.diffuseIntensity.value},uKs:{value:i.lighting.specularIntensity.value},uShininess:{value:i.lighting.shininess.value},uColorA:{value:new _e(i.lighting.ambientColor.value)},uColorD:{value:new _e(i.lighting.diffuseColor.value)},uColorS:{value:new _e(i.lighting.specularColor.value)},uColorE:{value:new _e(i.lighting.emissiveColor.value)},uOpacity:{value:i.options.opacity.value}}]);super({uniforms:s,vertexShader:nA,fragmentShader:oA,side:e.side||ja,name:i.customShader?i.customShader.shadersName:"CSPhongMaterial",fog:e.fog||!1,lights:!0,transparent:i.options.opacity.value<1,blending:e.blending||1,depthTest:e.depthTest||!0,depthWrite:e.depthWrite||!0,wireframe:i.options.wireframe.value||!1,defines:{USE_ALBEDO:!!i.albedo,USE_NORMAL:!!i.normal,USE_ENV:!!i.env,USE_MATCAP:!!i.matcap,USE_ROUGHNESS:!!i.roughness,USE_REFLECTION_ROUGHNESS:!!i.reflectionRoughness,USE_AO_MAP:!!i.ao,USE_ALPHA:!!i.alpha,USE_VERTEX_AO:i.options.useVertexAO?i.options.useVertexAO.value:!1,USE_MATCAP_ROUGHNESS:i.matcap?!!i.matcap.noise:!1,USE_POINT_LIGHTS:!!i.pointLights,SELECTIVE_DIR_LIGHTS:!!i.lights}}),this._createFloorReflection(e)}get mesh(){return this._mesh}set mesh(e){this._mesh=e}_createFloorReflection(e={}){this._normal=new O,this._reflectorWorldPosition=new O,this._cameraWorldPosition=new O,this._rotationMatrix=new Zi,this._lookAtPosition=new O(0,0,-1),this._clipPlane=new hn,this._view=new O,this._target=new O,this._q=new hn,this._reflectorPlane=new vo,this._clipBias=.003,this._neutralTextureMatrix=new Zi,this.uniforms.uTextureMatrix={value:new Zi},this._renderTarget=new dt(e.settings.renderTarget.width?e.settings.renderTarget.width:512,e.settings.renderTarget.height?e.settings.renderTarget.height:512,e.settings.renderTarget.params?e.settings.renderTarget.params:""),this.uniforms.uReflection={value:this._renderTarget.texture},this._virtualCamera=new Jt,this._camera=e.camera,this._renderer=e.renderer,this._mesh=e.mesh,this._scene=e.scene}renderReflection(){if(this._reflectorWorldPosition.setFromMatrixPosition(this._mesh.matrixWorld),this._cameraWorldPosition.setFromMatrixPosition(this._camera.matrixWorld),this._rotationMatrix.extractRotation(this._mesh.matrixWorld),this._rotationMatrix.makeRotationX(-Math.PI/2),this._normal.set(0,0,1),this._normal.applyMatrix4(this._rotationMatrix),this._view.subVectors(this._reflectorWorldPosition,this._cameraWorldPosition),this._view.dot(this._normal)>0)return;this._view.reflect(this._normal).negate(),this._view.add(this._reflectorWorldPosition),this._rotationMatrix.extractRotation(this._camera.matrixWorld),this._lookAtPosition.set(0,0,-1),this._lookAtPosition.applyMatrix4(this._rotationMatrix),this._lookAtPosition.add(this._cameraWorldPosition),this._target.subVectors(this._reflectorWorldPosition,this._lookAtPosition),this._target.reflect(this._normal).negate(),this._target.add(this._reflectorWorldPosition),this._virtualCamera.position.copy(this._view),this._virtualCamera.up.set(0,1,0),this._virtualCamera.up.applyMatrix4(this._rotationMatrix),this._virtualCamera.up.reflect(this._normal),this._virtualCamera.lookAt(this._target),this._virtualCamera.far=this._camera.far,this._virtualCamera.updateMatrixWorld(),this._virtualCamera.projectionMatrix.copy(this._camera.projectionMatrix),this.uniforms.uTextureMatrix.value.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.uniforms.uTextureMatrix.value.multiply(this._virtualCamera.projectionMatrix),this.uniforms.uTextureMatrix.value.multiply(this._virtualCamera.matrixWorldInverse),this._neutralTextureMatrix.copy(this.uniforms.uTextureMatrix.value),this.uniforms.uTextureMatrix.value.multiply(this._mesh.matrixWorld),this._reflectorPlane.setFromNormalAndCoplanarPoint(this._normal,this._reflectorWorldPosition),this._reflectorPlane.applyMatrix4(this._virtualCamera.matrixWorldInverse),this._clipPlane.set(this._reflectorPlane.normal.x,this._reflectorPlane.normal.y,this._reflectorPlane.normal.z,this._reflectorPlane.constant);const e=this._virtualCamera.projectionMatrix;this._q.x=(Math.sign(this._clipPlane.x)+e.elements[8])/e.elements[0],this._q.y=(Math.sign(this._clipPlane.y)+e.elements[9])/e.elements[5],this._q.z=-1,this._q.w=(1+e.elements[10])/e.elements[14],this._clipPlane.multiplyScalar(2/this._clipPlane.dot(this._q)),e.elements[2]=this._clipPlane.x,e.elements[6]=this._clipPlane.y,e.elements[10]=this._clipPlane.z+1-this._clipBias,e.elements[14]=this._clipPlane.w,this._mesh.visible=!1;const t=this._renderer,i=t.getRenderTarget(),s=t.xr.enabled,a=t.shadowMap.autoUpdate,n=t.outputColorSpace,r=t.toneMapping;t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.toneMapping=Zr,t.setRenderTarget(this._renderTarget),t.state.buffers.depth.setMask(!0),t.autoClear===!1&&t.clear(),t.render(this._scene,this._virtualCamera),t.xr.enabled=s,t.shadowMap.autoUpdate=a,t.outputColorSpace=n,t.toneMapping=r,t.setRenderTarget(i);const l=this._camera.viewport;l!==void 0&&t.state.viewport(l),this._mesh.visible=!0}}class zo extends we(Ut){init(e={}){this._debug=e.debugFolder,this._camera=e.camera,this._scene=e.scene,this.settings=ei,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$profiler.addObject(this._mesh,"PLANE");const t=this._mesh.onBeforeRender;let i=0;this._mesh.onBeforeRender=(...s)=>{t==null||t.apply(this._mesh,s),ei.updateEveryTwoFrames&&i%2===0?this._material.renderReflection():ei.updateEveryTwoFrames||this._material.renderReflection(),i++},this.debugFolder=this._createDebugFolder()}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){return new Ft(10,10)}_createMaterial(){return new rA({settings:ei.material,camera:this._camera,renderer:this.$renderer,scene:this._scene})}_createMesh(){const e=new U(this._geometry,this._material);return this._material.mesh=e,e.rotation.x=-Math.PI/2,e.position.y=-1,this.add(e),e}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Reflector"});e.addBinding(ei,"updateEveryTwoFrames",{label:"Update every two frames"});const t=e.addFolder({title:"Material",expanded:!1});return yi(t,ei.material,this._material),this.$debugger.registerFile(ei,ei.file),e}}class qo{constructor(e={}){this._debug=e.debugFolder,this._light=e.light,this._settings=e.settings,this._scene=e.scene,this._shadows=this._createShadows(),this._createShadowsUniforms(),this._debugFolder=this._createDebugFolder()}get light(){return this._light}get shadows(){return this._shadows}_createShadows(){return this._light.castShadow=!0,this._light.shadow.camera.left=-this._settings.frustumSize/2,this._light.shadow.camera.right=this._settings.frustumSize/2,this._light.shadow.camera.top=this._settings.frustumSize/2,this._light.shadow.camera.bottom=-this._settings.frustumSize/2,this._light.shadow.camera.near=this._settings.near,this._light.shadow.camera.far=this._settings.far,this._light.shadow.camera.position.copy(this._light.position),this._light.direction=new O,this._light.direction.subVectors(this._light.target.position,this._light.position).normalize(),this._light.shadow.mapSize.x=this._settings.mapSize.x,this._light.shadow.mapSize.y=this._settings.mapSize.y,this._light.shadow.bias=this._settings.bias,this._light.shadow.blurSamples=this._settings.blurSamples?this._settings.blurSamples:8,this._light.shadow.radius=this._settings.radius?this._settings.radius:2,this._lightHelper=new _o(this._light.shadow.camera),this._lightHelper.visible=this._settings.showHelper,this._scene.add(this._lightHelper),this._light.shadow}_createShadowsUniforms(){Mt.lights.uShadowColor={value:new _e(this._settings.color)},Mt.lights.uShadowIntensity={value:this._settings.intensity}}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"ShadowMap"});return e.addBinding(this._settings,"enabled",{label:"Enable"}).on("change",t=>{this._light.castShadow=this._settings.enabled,this._settings.showHelper&&(this._lightHelper.visible=this._settings.enabled)}),e.addBinding(this._settings,"showHelper",{label:"Show Helper"}).on("change",t=>{this._lightHelper.visible=this._settings.showHelper}),e.addBinding(this._settings,"color",{label:"Color"}).on("change",this._onChangeSettings.bind(this)),e.addBinding(this._settings,"frustumSize",{label:"Frustum"}).on("change",t=>{this._light.shadow.camera.left=-this._settings.frustumSize/2,this._light.shadow.camera.right=this._settings.frustumSize/2,this._light.shadow.camera.top=this._settings.frustumSize/2,this._light.shadow.camera.bottom=-this._settings.frustumSize/2,this._light.shadow.camera.updateProjectionMatrix(),this._lightHelper.update()}),e.addBinding(this._settings,"near",{label:"Near"}).on("change",t=>{this._light.shadow.camera.near=this._settings.near,this._light.shadow.camera.updateProjectionMatrix(),this._lightHelper.update()}),e.addBinding(this._settings,"far",{label:"Far"}).on("change",t=>{this._light.shadow.camera.far=this._settings.far,this._light.shadow.camera.updateProjectionMatrix(),this._lightHelper.update()}),e.addBinding(this._settings,"bias",{label:"Map Size"}).on("change",t=>{this._light.shadow.bias=this._settings.bias}),e.addBinding(this._settings,"intensity",{label:"Intensity"}).on("change",this._onChangeSettings.bind(this)),e}_onChangeSettings(){this._scene.traverse(e=>{if(e.material){const t=e.material.uniforms;t&&t.uShadowColor&&(t.uShadowColor.value=new _e(this._settings.color),t.uShadowIntensity.value=this._settings.intensity)}})}}const lA={};class Vo extends we(rs){init(e={}){this._bindAll(),this._config=_a,this._resourceManager=this._createResourceManager(),this._cameraManager=this._createCameraManager(),this._lights=this._createLights(),this._debugFolder=this._createDebugFolder(),this._shadowMap=this._createShadowMap(),this._setupEventListeners()}destroy(){super.destroy(),this._destroyComponents(),this._removeEventListeners()}get config(){return this._config}get cameraManager(){return this._cameraManager}get camera(){return this._cameraManager.camera}precompile(){const e=[];e[0]=new Promise(r=>{r()});const t=_a.resources.filter(r=>r.type==="texture"),i=[...t],s=[],a=4,n=1;for(let r=0;r<t.length;r+=a)s.push(i.slice(r,r+a));for(let r=0;r<s.length;r++){const l=new Promise(h=>{ls(()=>{for(let c=0;c<s[r].length;c++){const A=$.get(s[r][c].name);A&&this.$renderer.initTexture(A)}h()},r*n)});e.push(l)}return Promise.all(e)}_start(){this._components=this._createComponents()}_createCameraManager(){return new ea({types:["Orbit","Default"],debugFolder:this._debugFolder,id:"Scene Materials"})}_createResourceManager(){const e=new Zs;return e.add(_a.resources),e.load(),e}_createLights(){const e={};for(const t in qt.lights){const i=qt.lights[t],s=new Ka(i.color,i.intensity,{name:t,settings:i});e[t]=s,this.add(s)}return e}_createShadowMap(){if(!qt.shadows||!qt.shadows.enabled)return;const e=new qo({light:this._lights.light_shadows,settings:qt.shadows,scene:this,debugFolder:this._debugFolder});return this.$renderer.shadowMap.enabled=!0,this.$renderer.shadowMap.autoUpdate=!0,this.$renderer.shadowMap.type=Co,e}_bindAll(){this._loadCompleteHandler=this._loadCompleteHandler.bind(this)}_createComponents(){return{model:this._createComponentModel(),reflector:this._createComponentReflector()}}_createComponentModel(){const e=new Ho({debugFolder:this._debugFolder});return this.add(e),e}_createComponentReflector(){const e=new zo({debugFolder:this._debugFolder,camera:this._cameraManager.camera,scene:this});return this.add(e),e}_destroyComponents(){if(this._components)for(const e in this._components)typeof this._components[e].destroy=="function"&&this._components[e].destroy()}onUpdate({time:e,deltaTime:t,frame:i}){for(const s in this._components)typeof this._components[s].update=="function"&&this._components[s].update({time:e,deltaTime:t,frame:i})}onWindowResize(e){}_setupEventListeners(){this._resourceManager.addEventListener("complete",this._loadCompleteHandler)}_removeEventListeners(){this._resourceManager.removeEventListener("complete",this._loadCompleteHandler)}_loadCompleteHandler(){this._start()}_createDebugFolder(){if(!this.$debugger)return;const e=this.$debugger.addFolder({title:`${this._config.name}`});for(const t in qt.lights)this._lights[t].createDebugFolder(e,qt.lights[t]);return this.$debugger.registerFile(qt,qt.file),e}}Object.assign(Vo.prototype,lA);const Ca={name:"Physics",resources:[{name:"model-flipper",type:"gltf",path:"./webgl/models/model-flipper13.glb"},{name:"ground-alb",type:"ktx2",path:"./webgl/textures/ground/1024/uastc_high/ground-alb.ktx2",options:{wrapS:N,wrapT:N,flipY:!1,colorSpace:ot}},{name:"ground-shadow-combined",type:"ktx2",path:"./webgl/textures/ground/1024/uastc_high/ground-shadow-combined.ktx2",options:{wrapS:N,wrapT:N,flipY:!1,colorSpace:ot}},{name:"matcap-sample",type:"texture",path:"./webgl/textures/matcaps/matcap-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"matcap-metal",type:"texture",path:"./webgl/textures/matcaps/matcap-metal.webp",options:{wrapS:N,wrapT:N}},{name:"perlin-combined",type:"texture",path:"./webgl/textures/noises/perlin-combined.jpg",options:{wrapS:N,wrapT:N}},{name:"heightmap",type:"texture",path:"./webgl/textures/height2.jpg",options:{}},{name:"shades-alb",type:"texture",path:"./webgl/textures/shades/atlas-color.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-alb",type:"ktx2",path:"./webgl/textures/stickers/1024/uastc_high/stickers-ground-alb.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"stickers-ground-emi",type:"ktx2",path:"./webgl/textures/stickers/1024/uastc_high/stickers-ground-emi.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"stickers-ground-alpha",type:"ktx2",path:"./webgl/textures/stickers/1024/uastc_high/stickers-ground-alpha.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"stickers-ground-shadow",type:"ktx2",path:"./webgl/textures/stickers/512/etc1s_low/stickers-ground-shadow.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"stickers-ground-nrm",type:"ktx2",path:"./webgl/textures/stickers/1024/uastc_high/stickers-ground-nrm.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"lipstick-alb",type:"ktx2",path:"./webgl/textures/lipstick/1024/uastc_high/lipstick-alb.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"lipstick-alpha",type:"ktx2",path:"./webgl/textures/lipstick/512/etc1s_high/lipstick-alpha.ktx2",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"lipstick-nrm",type:"ktx2",path:"./webgl/textures/lipstick/512/uastc_high/lipstick-nrm.ktx2",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"env-sample",type:"texture",path:"./webgl/textures/sample/env-sample.webp",options:{wrapS:N,wrapT:N}},{name:"star-alpha",type:"texture",path:"./webgl/textures/dot-visuals/star-full.png"},{name:"star-alpha-border",type:"texture",path:"./webgl/textures/dot-visuals/star-border.png"},{name:"ball-texture",type:"texture",path:"./webgl/textures/dot-visuals/ball.png"},{name:"loop-main",type:"audio",path:"./sounds/mp3/IG_AMB_NOFX_1000-33000.mp3"},{name:"ball-launch",type:"audio",path:"./sounds/mp3/IG_BALL_LAUNCH.mp3"},{name:"ball-lost",type:"audio",path:"./sounds/mp3/IG_BALL_LOST.mp3"},{name:"ball-new",type:"audio",path:"./sounds/mp3/IG_BALL_NEW.mp3"},{name:"pinball-shake",type:"audio",path:"./sounds/mp3/IG_PINBALL_SHAKE_4000-6000.mp3"},{name:"flipper-left",type:"audio",path:"./sounds/mp3/IG_FLIPPER_02.mp3"},{name:"flipper-right",type:"audio",path:"./sounds/mp3/IG_FLIPPER_03.mp3"},{name:"bumper-hit-01",type:"audio",path:"./sounds/mp3/IG_HIT_BUMPER_01.mp3"},{name:"seat-hit-01",type:"audio",path:"./sounds/mp3/IG_HIT_SEAT_01.mp3"},{name:"slingshot-hit-01",type:"audio",path:"./sounds/mp3/IG_HIT_SLINGSHOT_01.mp3"},{name:"target-hit-01",type:"audio",path:"./sounds/mp3/IG_BONUS_TARGET_02.mp3"},{name:"second-chance",type:"audio",path:"./sounds/mp3/IG_SECOND_CHANCE.mp3"},{name:"game-over",type:"audio",path:"./sounds/mp3/IG_GAME_OVER.mp3"},{name:"score-02",type:"audio",path:"./sounds/mp3/IG_SCORE_02.mp3"},{name:"bonus-hole",type:"audio",path:"./sounds/mp3/IG_BONUS_HOLE.mp3"},{name:"bonus-lips",type:"audio",path:"./sounds/mp3/IG_BONUS_RAMP_ROLL.mp3"},{name:"ui-countdown",type:"audio",path:"./sounds/mp3/UI_COUNTDOWN.mp3"},{name:"ui-main-click",type:"audio",path:"./sounds/mp3/UI_MAIN_CLICK.mp3"},{name:"ui-secondary-click",type:"audio",path:"./sounds/mp3/UI_SECONDARY_CLICK.mp3"},{name:"ui-score-promo",type:"audio",path:"./sounds/mp3/UI_SCORE_PROMO.mp3"}]},Un={name:"Physics",resources:[{name:"model-flipper",type:"gltf",path:"./webgl/models/model-flipper11.glb"},{name:"ground-alb",type:"texture",path:"./webgl/textures/ground/ground-alb.png",options:{wrapS:N,wrapT:N,flipY:!1,colorSpace:ot}},{name:"ground-shadow-combined",type:"texture",path:"./webgl/textures/ground/ground-shadow-combined.png",options:{wrapS:N,wrapT:N,flipY:!1}},{name:"matcap-sample",type:"texture",path:"./webgl/textures/matcaps/matcap-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"matcap-metal",type:"texture",path:"./webgl/textures/matcaps/matcap-metal.jpg",options:{wrapS:N,wrapT:N}},{name:"perlin-combined",type:"texture",path:"./webgl/textures/noises/perlin-combined.jpg",options:{wrapS:N,wrapT:N}},{name:"heightmap",type:"texture",path:"./webgl/textures/height2.jpg",options:{}},{name:"shades-alb",type:"texture",path:"./webgl/textures/shades/atlas-color.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-alb",type:"texture",path:"./webgl/textures/stickers/stickers-ground-alb.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-emi",type:"texture",path:"./webgl/textures/stickers/stickers-ground-emi.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-alpha",type:"texture",path:"./webgl/textures/stickers/stickers-ground-alpha.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-shadow",type:"texture",path:"./webgl/textures/stickers/stickers-ground-shadow.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"stickers-ground-nrm",type:"texture",path:"./webgl/textures/stickers/stickers-ground-nrm.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"lipstick-alb",type:"texture",path:"./webgl/textures/lipstick/lipstick-alb.png",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"lipstick-alpha",type:"texture",path:"./webgl/textures/lipstick/lipstick-alpha.png",options:{flipY:!1,wrapS:N,wrapT:N}},{name:"lipstick-nrm",type:"texture",path:"./webgl/textures/lipstick/lipstick-nrm.png",options:{flipY:!1,wrapS:N,wrapT:N,colorSpace:ot}},{name:"env-sample",type:"texture",path:"./webgl/textures/sample/env-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"star-alpha",type:"texture",path:"./webgl/textures/dot-visuals/star-full.png"},{name:"star-alpha-border",type:"texture",path:"./webgl/textures/dot-visuals/star-border.png"},{name:"ball-texture",type:"texture",path:"./webgl/textures/dot-visuals/ball.png"},{name:"loop-main",type:"audio",path:"./sounds/IG_AMB_NOFX_1000-33000.wav"},{name:"ball-launch",type:"audio",path:"./sounds/IG_BALL_LAUNCH.wav"},{name:"ball-lost",type:"audio",path:"./sounds/IG_BALL_LOST.wav"},{name:"ball-new",type:"audio",path:"./sounds/IG_BALL_NEW.wav"},{name:"pinball-shake",type:"audio",path:"./sounds/IG_PINBALL_SHAKE_4000-6000.wav"},{name:"flipper-left",type:"audio",path:"./sounds/IG_FLIPPER_02.wav"},{name:"flipper-right",type:"audio",path:"./sounds/IG_FLIPPER_03.wav"},{name:"bumper-hit-01",type:"audio",path:"./sounds/IG_HIT_BUMPER_01.wav"},{name:"seat-hit-01",type:"audio",path:"./sounds/IG_HIT_SEAT_01.wav"},{name:"slingshot-hit-01",type:"audio",path:"./sounds/IG_HIT_SLINGSHOT_01.wav"},{name:"target-hit-01",type:"audio",path:"./sounds/IG_BONUS_TARGET_02.wav"},{name:"second-chance",type:"audio",path:"./sounds/IG_SECOND_CHANCE.wav"},{name:"game-over",type:"audio",path:"./sounds/IG_GAME_OVER.wav"},{name:"score-02",type:"audio",path:"./sounds/IG_SCORE_02.wav"},{name:"bonus-hole",type:"audio",path:"./sounds/IG_BONUS_HOLE.wav"},{name:"bonus-lips",type:"audio",path:"./sounds/IG_BONUS_RAMP_ROLL.wav"},{name:"ui-countdown",type:"audio",path:"./sounds/UI_COUNTDOWN.wav"},{name:"ui-main-click",type:"audio",path:"./sounds/UI_MAIN_CLICK.wav"},{name:"ui-secondary-click",type:"audio",path:"./sounds/UI_SECONDARY_CLICK.wav"},{name:"ui-score-promo",type:"audio",path:"./sounds/UI_SCORE_PROMO.wav"}]},cA={},Se={file:"./webgl/scenes/SceneFlipper/settings.js",showCameraHelper:!1,backgroundColor:"#9f0303",lights:{light_01:{target:{position:{x:2,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}},position:{x:5.2,y:3.7,z:.5},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},intensity:4,color:"#ffffff"},light_03:{target:{position:{x:2.5,y:0,z:-.4},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}},position:{x:-6.9,y:3.4000000000000004,z:.001791725175869452},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},intensity:4,color:"#ffffff"}},pointLights:{light_04:{position:{x:1.6,y:.2,z:.6000000000000001},intensity:6.4799999999999995,color:"#ff0098",rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},influence:1,distance:1.6999999999999988,decay:0},light_05:{position:{x:-1.6,y:.6000000000000001,z:.7000000000000001},intensity:10,color:"#ff0062",rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},influence:1,distance:2.239999999999999,decay:2.82},light_06:{position:{x:-1.8000000000000007,y:0,z:-1.4000000000000004},intensity:5,color:"#ffffff",rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},influence:1,distance:1.98,decay:2.56}},debugPhysics:!1,activeDebugPosition:"lipsRamp",debugPositionArray:["lipsRamp","holeRamp","beautyHub"],debugPositions:{beautyHub:{position:{x:0,y:2.35},ramp:""},slingShotLeft:{position:{x:1.8,y:-1.4},ramp:""},slingShotRight:{position:{x:-1.8,y:-1.4},ramp:""},lipsRamp:{position:{x:-1.1,y:.2},ramps:["lipsRamp","lipsRamp2"],acitveHeightMapChannel:1},lipsRampLeft:{position:{x:1.5,y:-.8},ramps:["lipsRamp","lipsRamp2"],acitveHeightMapChannel:1},holeRamp:{position:{x:1.5,y:.8},ramps:["holeRampEnter","holeRampLeave"],acitveHeightMapChannel:0}},cameraPaths:{intro:{debug:!1,pos:{segments:5,duration:15,delay:0,ease:"linear",controlPoints:[{x:-.06054483766322477,y:2.6143399758108856,z:-1.6692220531309911,t:0},{x:-.06474550514628291,y:2.588642609815416,z:-1.6968096193234783,t:.25},{x:-.06474550514628291,y:2.6525726480914296,z:-3.525293927034061,t:.5},{x:-.05561206059347551,y:4.488184756140058,z:-4.3543730769243645,t:.75},{x:-.05561206059347551,y:4.488184756140058,z:-4.3543730769243645,t:1}]},lookAt:{segments:5,duration:15,delay:0,ease:"linear",debugColor:"yellow",controlPoints:[{x:-.007932999204481705,y:.5659966971678085,z:1.7974678763290206,t:0},{x:-.013742727045274128,y:.5713695851144724,z:1.7638193220961262,t:.3333333333333333},{x:-.02772912969233693,y:.7272571259488314,z:-.8028573851384042,t:.6666666666666666},{x:-.027744908915071642,y:.7194524564078015,z:-.7979562602746808,t:1}]}},beautyHub:{debug:!1,pos:{segments:5,duration:15,delay:0,ease:"linear",controlPoints:[{x:1.2730583593815799,y:.795769293095173,z:-3.2325679119446384,t:0},{x:1.2674190744144096,y:.7951403042932714,z:-3.263739628070453,t:.3333333333333333},{x:1.1286308204343367,y:.8468613986681639,z:-1.9493792876026839,t:.6666666666666666},{x:1.1286308204343367,y:.8468613986681639,z:-1.9493792876026839,t:1}]},lookAt:{segments:5,duration:15,delay:0,ease:"linear",debugColor:"yellow",controlPoints:[{x:.6787188607998953,y:.5659966971678085,z:-1.8167978923834842,t:0},{x:.6777963407531395,y:.5713695851144724,z:-1.848789256503735,t:.3333333333333333},{x:0,y:.7272571259488314,z:3.0347211906059774,t:.6666666666666666},{x:0,y:.7194524564078015,z:3.041610682481653,t:1}]}},lips:{debug:!1,pos:{segments:30,duration:15,delay:0,ease:"linear",controlPoints:[{x:-.4929082789576016,y:.4683864027978122,z:-2.1139122853830328,t:0},{x:-.46200473983376333,y:.4380127810888639,z:-2.010394919912233,t:.16666666666666666},{x:-1.2358657746267652,y:.47046097433698186,z:-.9024900534273157,t:.3333333333333333},{x:-.5025493450632427,y:.48444913784525356,z:.40485177879543977,t:.5},{x:.9945901215999398,y:.4546908288117646,z:.07710741469347526,t:.6666666666666666},{x:1.3543265376481486,y:1.2307552027239919,z:-.9659831923971747,t:.8333333333333334},{x:1.3543265376481486,y:1.2307552027239919,z:-.9659831923971747,t:1}]},lookAt:{segments:30,duration:15,delay:0,ease:"linear",debugColor:"yellow",controlPoints:[{x:-1.5774164250572156,y:.5659966971678085,z:-.6491179781496947,t:0},{x:-1.5887147834300783,y:.5713695851144729,z:-.6512960110882812,t:.16666666666666666},{x:-1.2707390013047712,y:.5884892448479926,z:.3423628201816566,t:.3333333333333333},{x:.3349201269575348,y:.5394693699811015,z:1.620647473898451,t:.5},{x:.8625979669606718,y:.8060227118912098,z:.8053297552211716,t:.6666666666666666},{x:-.03519315775548382,y:.8591076820404009,z:.1859678932356621,t:.8333333333333334},{x:-.03802701731578906,y:.8511792026957752,z:.19279588314225204,t:1}]}},tubeFlipper:{debug:!1,pos:{segments:30,duration:20,delay:0,ease:"linear",controlPoints:[{x:-2.275396420359067,y:.16018224924536262,z:-3.9239283046936158,t:0},{x:-2.2859327009527504,y:.16017172268414848,z:-3.925305130952107,t:.1111111111111111},{x:-2.313108054035781,y:.15805243076402564,z:-.4059325450848834,t:.2222222222222222},{x:-2.3168637453073586,y:.17401707509480263,z:2.0662935983924067,t:.3333333333333333},{x:-2.3483817896859183,y:.2027110186106595,z:3.0847384067292185,t:.4444444444444444},{x:-1.8588328080179959,y:.09925204374154137,z:3.8227292413111833,t:.5555555555555556},{x:-.4415577500530835,y:.09088128156402475,z:3.953190433022683,t:.6666666666666666},{x:.35438678465721013,y:.09824812182046139,z:2.3233229702449725,t:.7777777777777778},{x:.4881815158604086,y:.15253955831928967,z:.2670197512100011,t:.8888888888888888},{x:.4881815158604086,y:.15253955831928967,z:.2670197512100011,t:1}]},lookAt:{segments:30,duration:20,delay:0,ease:"linear",debugColor:"yellow",controlPoints:[{x:-2.3291116580372537,y:.14213463882090405,z:2.828374101511862,t:0},{x:-2.340541966881071,y:.14764171764164158,z:2.8262051181876844,t:.16666666666666666},{x:-1.755801024333988,y:.2774475765155898,z:4.235705861035752,t:.3333333333333333},{x:.06863854272195963,y:.17034541269480524,z:3.6334465304142927,t:.5},{x:.5932948662049935,y:.4356884004341418,z:1.9139222559436846,t:.6666666666666666},{x:.2326197319605634,y:.4830004919302062,z:-.6554688672149587,t:.8333333333333334},{x:.23407579401680367,y:.4754334186703775,z:-.6525984224804766,t:1}]}},launcherMobileTutorial:{debug:!1,pos:{segments:30,duration:1.7,delay:0,debugColor:"purple",ease:"power4.inOut",controlPoints:[{x:-.023522695115769765,y:6,z:-3.982467229493249,t:0},{x:-.023522695115769765,y:6,z:-3.982467229493249,t:.16666666666666666},{x:-.3720265243636506,y:6.241658037883897,z:-5.2285294868053045,t:.3333333333333333},{x:-1.075103139202743,y:6.650393497317556,z:-5.701562796810466,t:.5},{x:-1.9152764048880804,y:7.233008215302971,z:-5.931098152128969,t:.6666666666666666},{x:-2.332883320869671,y:7.672718755837864,z:-5.242332981724667,t:.8333333333333334},{x:-2.332883320869671,y:7.672718755837864,z:-5.242332981724667,t:1}]},lookAt:{segments:30,duration:1.7,delay:0,ease:"power4.inOut",debugColor:"green",controlPoints:[{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:0},{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:.16666666666666666},{x:-.6928891294500108,y:.08836436615050902,z:-3.0595378028219966,t:.3333333333333333},{x:-1.362877343407848,y:.16000154761454277,z:-3.3936029267710515,t:.5},{x:-1.8870941823760425,y:.2602501141401805,z:-3.690151276663916,t:.6666666666666666},{x:-2.3161535212966933,y:.45130482663801097,z:-3.999419588156806,t:.8333333333333334},{x:-2.3171148261235643,y:.44255953783756097,z:-3.9955295098963077,t:1}]}},launcherDesktop:{debug:!1,pos:{segments:30,duration:1.7,delay:0,debugColor:"purple",ease:"power4.inOut",controlPoints:[{x:-.019920254844265406,y:4.32991306484481,z:-4.506636037605789,t:0},{x:-.019920254844265406,y:4.310853295071755,z:-4.506636037605789,t:.16666666666666666},{x:-.14280393104163763,y:4.17822521713613,z:-5.187709621537202,t:.3333333333333333},{x:-.548761517594209,y:4.008947346443902,z:-5.5323413249763504,t:.5},{x:-.9795927312367121,y:3.7586082145397954,z:-5.380306993217742,t:.6666666666666666},{x:-1.4086886051500969,y:3.440137474086215,z:-4.924592908706541,t:.8333333333333334},{x:-1.4086886051500969,y:3.440137474086215,z:-4.924592908706541,t:1}]},lookAt:{segments:30,duration:1.7,delay:0,ease:"power4.inOut",debugColor:"green",controlPoints:[{x:-.006545349443070392,y:.04911745693580449,z:-3.293984227806428,t:0},{x:-.006545349443070392,y:.04911745693580449,z:-3.293984227806428,t:.16666666666666666},{x:-.37246542203135397,y:.08836436615050902,z:-3.3370383739896234,t:.3333333333333333},{x:-.7489133968434359,y:.16000154761454277,z:-3.3936029267710515,t:.5},{x:-1.1033401601317803,y:.2602501141401805,z:-3.690151276663916,t:.6666666666666666},{x:-1.390951916455049,y:.45130482663801097,z:-3.999419588156806,t:.8333333333333334},{x:-1.3912008151046322,y:.44255953783756097,z:-3.9955295098963077,t:1}]}},launcherMobile:{debug:!1,pos:{segments:30,duration:1.7,delay:0,debugColor:"purple",ease:"power4.inOut",controlPoints:[{x:-.023522695115769765,y:6,z:-3.982467229493249,t:0},{x:-.023522695115769765,y:6,z:-3.982467229493249,t:.16666666666666666},{x:.028138608194082315,y:6.241658037883897,z:-5.608261603571722,t:.3333333333333333},{x:-.6597123006590306,y:6.144032819911767,z:-6.909727348137976,t:.5},{x:-1.5317809014378994,y:6.068823989922402,z:-7.544303956012998,t:.6666666666666666},{x:-2.332883320869671,y:5.531205816579612,z:-7.292704370741797,t:.8333333333333334},{x:-2.332883320869671,y:5.531205816579612,z:-7.292704370741797,t:1}]},lookAt:{segments:30,duration:1.7,delay:0,ease:"power4.inOut",debugColor:"green",controlPoints:[{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:0},{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:.3333333333333333},{x:-2.2765869202912414,y:.45130482663801097,z:-2.2503434064196095,t:.6666666666666666},{x:-2.277474173354233,y:.44255953783756097,z:-2.26514666925838,t:1}]}},flippersMobile:{debug:!1,pos:{segments:30,duration:1.7,delay:0,ease:"power4.inOut",controlPoints:[{x:-.017241555349105653,y:12,z:-4.768385704667377,t:0},{x:-.017241555349105653,y:12,z:-4.768385704667377,t:.3333333333333333},{x:-.023522695115769765,y:6,z:-3.982467229493249,t:.6666666666666666},{x:-.023522695115769765,y:6,z:-3.982467229493249,t:1}]},lookAt:{segments:30,duration:1.5,delay:0,ease:"power4.inOut",debugColor:"yellow",controlPoints:[{x:-.007918710286678454,y:1.3119075879890287,z:-3.313793298906597,t:0},{x:-.007918710286678454,y:1.3119075879890287,z:-3.313793298906597,t:.3333333333333333},{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:.6666666666666666},{x:-.035206034868313196,y:.04911745693580449,z:-2.9915940359248427,t:1}]}},flippersDesktop:{debug:!1,pos:{segments:30,duration:1.7,delay:0,ease:"power4.inOut",controlPoints:[{x:-.017241555349105653,y:9.05351818450912,z:-4.558739643619929,t:0},{x:-.017241555349105653,y:9.05351818450912,z:-4.558739643619929,t:.3333333333333333},{x:-.02380825851542895,y:4.322278888282463,z:-4.510360131769169,t:.6666666666666666},{x:-.02380825851542895,y:4.322278888282463,z:-4.510360131769169,t:1}]},lookAt:{segments:30,duration:1.5,delay:0,ease:"power4.inOut",debugColor:"yellow",controlPoints:[{x:-.03122695513006274,y:1.3119075879890287,z:-3.405523829822623,t:0},{x:-.03122695513006274,y:1.3119075879890287,z:-3.405523829822623,t:.3333333333333333},{x:-.0031023378692700554,y:.04911745693580449,z:-3.2954960292273086,t:.6666666666666666},{x:-.0031023378692700554,y:.04911745693580449,z:-3.2954960292273086,t:1}]}}}};class AA{constructor(e={}){this._playfieldData=e.playfieldData,this._eventDispatcher=e.eventDispatcher,this._score=0,this._lastScore=0,this._pointsSteps={0:5e4,1:1e5,2:2e5},this._currentPointsStep=0,this._missions=this._setupMissions(),this._colliders=this._setupColliders()}get score(){return this._score}get lastScore(){return this._lastScore}get missions(){return this._missions}get colliders(){return this._colliders}get pointsStep(){return this._pointsSteps}get currentPointsStep(){return this._currentPointsStep}set currentPointsStep(e){this._currentPointsStep=e}onCollide(e){e.missionPoints&&this._collideMission(e),e.colliderPoints&&(this._score+=e.colliderPoints)}resetScore(){this._lastScore=this._score,this._score=0,this._resetMissions()}resetMissions(){this._resetMissions()}_setupMissions(){const e={};for(let t=0;t<this._playfieldData.shapes.length;t++){const i=this._playfieldData.shapes[t],s=i.customData.missionName;s&&i.customData.colliderName.includes(s)&&(e[s]||(e[s]={isCompleted:!1,points:i.customData.missionPoints,elements:[],itemsCompleted:0,restartMissionOnComplete:i.customData.restartMissionOnComplete}),e[s].elements.push(i.customData))}return e}_setupColliders(){const e={};for(let t=0;t<this._playfieldData.shapes.length;t++){const i=this._playfieldData.shapes[t],s=i.customData.colliderName,a=i.customData.colliderPoints;!s||!a||(e[s]={points:a})}return e}_collideMission(e){const t=this._missions[e.missionName].elements.filter(i=>i.colliderName===e.colliderName);t[0].missionActive||(t[0].missionActive=!0,this._missions[e.missionName].itemsCompleted++),this._missions[e.missionName].itemsCompleted===this._missions[e.missionName].elements.length&&!this._missions[e.missionName].isCompleted&&this._completeMission(e.missionName)}_completeMission(e){this._missions[e].isCompleted=!0,this._missions[e].itemsCompleted=0,this._missions[e].restartMissionOnComplete&&this._resetMission(e),this._eventDispatcher.dispatchEvent("mission:complete",e),this._score+=this._missions[e].points}_resetMission(e){this._missions[e].isCompleted=!1,this._missions[e].itemsCompleted=0;for(let t=0;t<this._missions[e].elements.length;t++){const i=this._missions[e].elements[t];i.missionActive=!1,R.delayedCall(.5,()=>{this._eventDispatcher.dispatchEvent("mission:resetObject",{element:i,reversed:!0})})}}_resetMissions(){for(const e in this._missions){this._missions[e].isCompleted=!1,this._missions[e].itemsCompleted=0;for(let t=0;t<this._missions[e].elements.length;t++){const i=this._missions[e].elements[t];i.missionActive=!1}}}_getColliderScore(e){}}const ta=typeof P2_ARRAY_TYPE<"u"?P2_ARRAY_TYPE:typeof Float32Array<"u"?Float32Array:Array,Fs=(o,e)=>{for(let t=0,i=e.length;t!==i;++t)o.push(e[t])},hA=function(o,e,t){t===void 0&&(t=1);const i=o.length-t;for(let s=e;s<i;s++)o[s]=o[s+t];o.length=i},ys=(o,e)=>{const t=o.indexOf(e);t!==-1&&hA(o,t,1)};function ht(o,e){return o[0]*e[1]-o[1]*e[0]}function Ga(o,e,t){return Re(o,e,-Math.PI/2),se(o,o,t),o}function Re(o,e,t){if(t!==0){const i=Math.cos(t),s=Math.sin(t),a=e[0],n=e[1];o[0]=i*a-s*n,o[1]=s*a+i*n}else o[0]=e[0],o[1]=e[1];return o}function mi(o,e){const t=e[0],i=e[1];return o[0]=i,o[1]=-t,o}function ni(o,e,t,i){const s=Math.cos(-i),a=Math.sin(-i),n=e[0]-t[0],r=e[1]-t[1];return o[0]=s*n-a*r,o[1]=a*n+s*r,o}function ke(o,e,t,i){const s=Math.cos(i),a=Math.sin(i),n=e[0],r=e[1],l=t[0],h=t[1];o[0]=s*n-a*r+l,o[1]=a*n+s*r+h}function Wo(o,e,t){const i=Math.cos(-t),s=Math.sin(-t),a=e[0],n=e[1];return o[0]=i*a-s*n,o[1]=s*a+i*n,o}const uA=Re;function dA(o,e,t,i){return Y(o,e,t),Y(o,o,i),se(o,o,1/3),o}function v(){const o=new ta(2);return o[0]=0,o[1]=0,o}function yt(o){const e=new ta(2);return e[0]=o[0],e[1]=o[1],e}function ut(o,e){const t=new ta(2);return t[0]=o,t[1]=e,t}function he(o,e){return o[0]=e[0],o[1]=e[1],o}function le(o,e,t){return o[0]=e,o[1]=t,o}function Y(o,e,t){return o[0]=e[0]+t[0],o[1]=e[1]+t[1],o}function D(o,e,t){return o[0]=e[0]-t[0],o[1]=e[1]-t[1],o}function zs(o,e,t){return o[0]=e[0]*t[0],o[1]=e[1]*t[1],o}function se(o,e,t){return o[0]=e[0]*t,o[1]=e[1]*t,o}function Ja(o,e){const t=e[0]-o[0],i=e[1]-o[1];return Math.sqrt(t*t+i*i)}function Za(o,e){const t=e[0]-o[0],i=e[1]-o[1];return t*t+i*i}function ns(o){const e=o[0],t=o[1];return Math.sqrt(e*e+t*t)}function Et(o){const e=o[0],t=o[1];return e*e+t*t}function ze(o,e){const t=e[0],i=e[1];let s=t*t+i*i;return s>0&&(s=1/Math.sqrt(s),o[0]=e[0]*s,o[1]=e[1]*s),o}function be(o,e){return o[0]*e[0]+o[1]*e[1]}function es(o,e,t,i){const s=e[0],a=e[1];return o[0]=s+i*(t[0]-s),o[1]=a+i*(t[1]-a),o}function Yo(o,e,t,i){const s=e[0]-o[0],a=e[1]-o[1],n=i[0]-t[0],r=i[1]-t[1],l=(-a*(o[0]-t[0])+s*(o[1]-t[1]))/(-n*a+s*r),h=(n*(o[1]-t[1])-r*(o[0]-t[0]))/(-n*a+s*r);return l>=0&&l<=1&&h>=0&&h<=1?h:-1}class $a{constructor(e){e===void 0&&(e={}),this.lowerBound=e.lowerBound?yt(e.lowerBound):v(),this.upperBound=e.upperBound?yt(e.upperBound):v()}setFromPoints(e,t,i,s){i===void 0&&(i=0),s===void 0&&(s=0);const a=this.lowerBound,n=this.upperBound;i!==0?Re(a,e[0],i):he(a,e[0]),he(n,a);const r=Math.cos(i),l=Math.sin(i);for(let h=1;h<e.length;h++){let c=e[h];if(i!==0){const A=c[0],d=c[1];ya[0]=r*A-l*d,ya[1]=l*A+r*d,c=ya}for(let A=0;A<2;A++)c[A]>n[A]&&(n[A]=c[A]),c[A]<a[A]&&(a[A]=c[A])}t&&(Y(a,a,t),Y(n,n,t)),s&&(a[0]-=s,a[1]-=s,n[0]+=s,n[1]+=s)}copy(e){he(this.lowerBound,e.lowerBound),he(this.upperBound,e.upperBound)}extend(e){const t=this.lowerBound,i=this.upperBound;let s=2;for(;s--;){const a=e.lowerBound[s];t[s]>a&&(t[s]=a);const n=e.upperBound[s];i[s]<n&&(i[s]=n)}}overlaps(e){const t=this.lowerBound,i=this.upperBound,s=e.lowerBound,a=e.upperBound;return(s[0]<=i[0]&&i[0]<=a[0]||t[0]<=a[0]&&a[0]<=i[0])&&(s[1]<=i[1]&&i[1]<=a[1]||t[1]<=a[1]&&a[1]<=i[1])}containsPoint(e){const t=this.lowerBound,i=this.upperBound;return t[0]<=e[0]&&e[0]<=i[0]&&t[1]<=e[1]&&e[1]<=i[1]}overlapsRay(e){const t=1/e.direction[0],i=1/e.direction[1],s=e.from,a=this.lowerBound,n=this.upperBound,r=(a[0]-s[0])*t,l=(n[0]-s[0])*t,h=(a[1]-s[1])*i,c=(n[1]-s[1])*i,A=Math.max(Math.max(Math.min(r,l),Math.min(h,c))),d=Math.min(Math.min(Math.max(r,l),Math.max(h,c)));return d<0||A>d?-1:A/e.length}}const ya=v(),pA=[0,0],gA=[0,0],fA=[[0,0],[0,0]],mA=[[0,0],[0,0]];function vA(o,e,t){t===void 0&&(t=0),t=t||0;const i=[0,0],s=o[1][1]-o[0][1],a=o[0][0]-o[1][0],n=s*o[0][0]+a*o[0][1],r=e[1][1]-e[0][1],l=e[0][0]-e[1][0],h=r*e[0][0]+l*e[0][1],c=s*l-r*a;return Jo(c,0,t)||(i[0]=(l*n-a*h)/c,i[1]=(s*h-r*n)/c),i}function Ha(o,e,t,i){const s=e[0]-o[0],a=e[1]-o[1],n=i[0]-t[0],r=i[1]-t[1];if(n*a-r*s===0)return!1;const l=(s*(t[1]-o[1])+a*(o[0]-t[0]))/(n*a-r*s),h=(n*(o[1]-t[1])+r*(t[0]-o[0]))/(r*s-n*a);return l>=0&&l<=1&&h>=0&&h<=1}function As(o,e,t){return(e[0]-o[0])*(t[1]-o[1])-(t[0]-o[0])*(e[1]-o[1])}function Us(o,e,t){return As(o,e,t)>0}function za(o,e,t){return As(o,e,t)>=0}function jo(o,e,t){return As(o,e,t)<0}function ts(o,e,t){return As(o,e,t)<=0}function _A(o,e,t,i){if(i===void 0&&(i=0),i){const s=pA,a=gA;s[0]=e[0]-o[0],s[1]=e[1]-o[1],a[0]=t[0]-e[0],a[1]=t[1]-e[1];const n=s[0]*a[0]+s[1]*a[1],r=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return Math.acos(n/(r*l))<i}else return As(o,e,t)===0}function is(o,e){const t=e[0]-o[0],i=e[1]-o[1];return t*t+i*i}function W(o,e){const t=o.length;return o[e<0?e%t+t:e%t]}function CA(o){o.length=0}function mt(o,e,t,i){for(let s=t;s<i;s++)o.push(e[s])}function yA(o){let e=0;const t=o;for(let i=1;i<o.length;++i)(t[i][1]<t[e][1]||t[i][1]===t[e][1]&&t[i][0]>t[e][0])&&(e=i);return Us(W(o,e-1),W(o,e),W(o,e+1))?!1:(EA(o),!0)}function EA(o){const e=[],t=o.length;for(let i=0;i!==t;i++)e.push(o.pop());for(let i=0;i!==t;i++)o[i]=e[i]}function Xo(o,e){return jo(W(o,e-1),W(o,e),W(o,e+1))}function IA(o,e,t){const i=fA,s=mA;if(za(W(o,e+1),W(o,e),W(o,t))&&ts(W(o,e-1),W(o,e),W(o,t)))return!1;const a=is(W(o,e),W(o,t));for(let n=0;n!==o.length;++n)if(!((n+1)%o.length===e||n===e)&&za(W(o,e),W(o,t),W(o,n+1))&&ts(W(o,e),W(o,t),W(o,n))){i[0]=W(o,e),i[1]=W(o,t),s[0]=W(o,n),s[1]=W(o,n+1);const r=vA(i,s);if(is(W(o,e),r)<a)return!1}return!0}function xA(o,e,t){for(let i=0;i!==o.length;++i)if(!(i===e||i===t||(i+1)%o.length===e||(i+1)%o.length===t)&&Ha(W(o,e),W(o,t),W(o,i),W(o,i+1)))return!1;return!0}function qs(o,e,t,i){if(i===void 0&&(i=[]),CA(i),e<t)for(let s=e;s<=t;s++)i.push(o[s]);else{for(let s=0;s<=t;s++)i.push(o[s]);for(let s=e;s<o.length;s++)i.push(o[s])}return i}function qa(o){let e=[],t,i;const s=[];let a=Number.MAX_VALUE;for(let n=0;n<o.length;++n)if(Xo(o,n)){for(let r=0;r<o.length;++r)if(IA(o,n,r)){t=qa(qs(o,n,r,s)),i=qa(qs(o,r,n,s));for(let l=0;l<i.length;l++)t.push(i[l]);t.length<a&&(e=t,a=t.length,e.push([W(o,n),W(o,r)]))}}return e}function bA(o){const e=qa(o);return e.length>0?Ko(o,e):[o]}function Ko(o,e){if(e.length===0)return[o];if(e instanceof Array&&e.length&&e[0]instanceof Array&&e[0].length===2&&e[0][0]instanceof Array){const t=[o];for(let i=0;i<e.length;i++){const s=e[i];for(let a=0;a<t.length;a++){const n=t[a],r=Ko(n,s);if(r){t.splice(a,1),t.push(r[0],r[1]);break}}}return t}else{const t=e,i=o.indexOf(t[0]),s=o.indexOf(t[1]);return i!==-1&&s!==-1?[qs(o,i,s),qs(o,s,i)]:!1}}function BA(o){const e=o;let t;for(t=0;t<e.length-1;t++)for(let i=0;i<t-1;i++)if(Ha(e[t],e[t+1],e[i],e[i+1]))return!1;for(t=1;t<e.length-2;t++)if(Ha(e[0],e[e.length-1],e[t],e[t+1]))return!1;return!0}function On(o,e,t,i,s){s===void 0&&(s=0);const a=e[1]-o[1],n=o[0]-e[0],r=a*o[0]+n*o[1],l=i[1]-t[1],h=t[0]-i[0],c=l*t[0]+h*t[1],A=a*h-l*n;return Jo(A,0,s)?[0,0]:[(h*r-n*c)/A,(a*c-l*r)/A]}function Ji(o,e,t,i,s,a,n){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i=[]),s===void 0&&(s=25),a===void 0&&(a=100),n===void 0&&(n=0);let r=[0,0],l=[0,0],h=[0,0],c=0,A=0,d=0,m=0,p=0,f=0,_=0;const E=[],x=[],y=o,C=o;if(C.length<3)return e;if(n++,n>a)return console.warn("quickDecomp: max level ("+a+") reached."),e;for(let u=0;u<o.length;++u)if(Xo(y,u)){t.push(y[u]),c=A=Number.MAX_VALUE;for(let I=0;I<o.length;++I)Us(W(y,u-1),W(y,u),W(y,I))&&ts(W(y,u-1),W(y,u),W(y,I-1))&&(h=On(W(y,u-1),W(y,u),W(y,I),W(y,I-1)),jo(W(y,u+1),W(y,u),h)&&(d=is(y[u],h),d<A&&(A=d,l=h,f=I))),Us(W(y,u+1),W(y,u),W(y,I+1))&&ts(W(y,u+1),W(y,u),W(y,I))&&(h=On(W(y,u+1),W(y,u),W(y,I),W(y,I+1)),Us(W(y,u-1),W(y,u),h)&&(d=is(y[u],h),d<c&&(c=d,r=h,p=I)));if(f===(p+1)%o.length)h[0]=(l[0]+r[0])/2,h[1]=(l[1]+r[1])/2,i.push(h),u<p?(mt(E,y,u,p+1),E.push(h),x.push(h),f!==0&&mt(x,y,f,y.length),mt(x,y,0,u+1)):(u!==0&&mt(E,y,u,y.length),mt(E,y,0,p+1),E.push(h),x.push(h),mt(x,y,f,u+1));else{if(f>p&&(p+=o.length),m=Number.MAX_VALUE,p<f)return e;for(let I=f;I<=p;++I)za(W(y,u-1),W(y,u),W(y,I))&&ts(W(y,u+1),W(y,u),W(y,I))&&(d=is(W(y,u),W(y,I)),d<m&&xA(y,u,I)&&(m=d,_=I%o.length));u<_?(mt(E,y,u,_+1),_!==0&&mt(x,y,_,C.length),mt(x,y,0,u+1)):(u!==0&&mt(E,y,u,C.length),mt(E,y,0,_+1),mt(x,y,_,u+1))}return E.length<x.length?(Ji(E,e,t,i,s,a,n),Ji(x,e,t,i,s,a,n)):(Ji(x,e,t,i,s,a,n),Ji(E,e,t,i,s,a,n)),e}return e.push(o),e}function kn(o,e){e===void 0&&(e=0);let t=0;for(let i=o.length-1;o.length>3&&i>=0;--i)_A(W(o,i-1),W(o,i),W(o,i+1),e)&&(o.splice(i%o.length,1),t++);return t}function Jo(o,e,t){return t===void 0&&(t=0),t=t||0,Math.abs(o-e)<=t}const jt=class jt{constructor(e){M(this,"direction",v());M(this,"length",1);M(this,"_currentBody",null);M(this,"_currentShape",null);e===void 0&&(e={}),this.from=e.from?yt(e.from):v(),this.to=e.to?yt(e.to):v(),this.checkCollisionResponse=e.checkCollisionResponse??!0,this.skipBackfaces=!!e.skipBackfaces,this.collisionMask=e.collisionMask??-1,this.collisionGroup=e.collisionGroup??-1,this.mode=e.mode??jt.ANY,this.callback=(e==null?void 0:e.callback)||function(){},this.update()}update(){const e=this.direction;D(e,this.to,this.from),this.length=ns(e),ze(e,e)}intersectBodies(e,t){for(let i=0,s=t.length;!e.shouldStop(this)&&i<s;i++){const a=t[i],n=a.getAABB();(n.overlapsRay(this)>=0||n.containsPoint(this.from))&&this.intersectBody(e,a)}}intersectBody(e,t){const i=this.checkCollisionResponse;if(i&&!t.collisionResponse)return;const s=wA;for(let a=0,n=t.shapes.length;a<n;a++){const r=t.shapes[a];if(i&&!r.collisionResponse||!(this.collisionGroup&r.collisionMask)||!(r.collisionGroup&this.collisionMask))continue;Re(s,r.position,t.angle),Y(s,s,t.position);const l=r.angle+t.angle;if(this.intersectShape(e,r,l,s,t),e.shouldStop(this))break}}intersectShape(e,t,i,s,a){const n=this.from;SA(n,this.direction,s)>t.boundingRadius*t.boundingRadius||(this._currentBody=a,this._currentShape=t,t.raycast(e,this,s,i),this._currentBody=this._currentShape=null)}getAABB(e){const t=this.to,i=this.from;le(e.lowerBound,Math.min(t[0],i[0]),Math.min(t[1],i[1])),le(e.upperBound,Math.max(t[0],i[0]),Math.max(t[1],i[1]))}reportIntersection(e,t,i,s){s===void 0&&(s=-1);const a=this._currentShape,n=this._currentBody;if(!(this.skipBackfaces&&be(i,this.direction)>0))switch(this.mode){case jt.ALL:e.set(i,a,n,t,s),this.callback(e);break;case jt.CLOSEST:(t<e.fraction||!e.hasHit())&&e.set(i,a,n,t,s);break;case jt.ANY:e.set(i,a,n,t,s);break}}};M(jt,"CLOSEST",1),M(jt,"ANY",2),M(jt,"ALL",4);let os=jt;const Gn=v(),Es=v();function SA(o,e,t){D(Gn,t,o);const i=be(Gn,e);return se(Es,e,i),Y(Es,Es,o),Za(t,Es)}const wA=v();class MA{constructor(){this.normal=v(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}reset(){le(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}getHitDistance(e){return Ja(e.from,e.to)*this.fraction}hasHit(){return this.fraction!==-1}getHitPoint(e,t){return es(e,t.from,t.to,this.fraction)}stop(){this.isStopped=!0}shouldStop(e){return this.isStopped||this.fraction!==-1&&e.mode===os.ANY}set(e,t,i,s,a){he(this.normal,e),this.shape=t,this.body=i,this.fraction=s,this.faceIndex=a}}class Zo{constructor(){M(this,"listeners",{})}on(e,t){let i=this.listeners[e];return i===void 0&&(i=[],this.listeners[e]=i),i.indexOf(t)===-1&&i.push(t),this}off(e,t){const i=this.listeners[e];if(i){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}return this}has(e,t){const i=this.listeners[e];return t?i!==void 0&&i.indexOf(t)!==-1:i!==void 0}emit(e){if(this.listeners===void 0)return this;const t=this.listeners[e.type];if(t!==void 0)for(const i of[...t])i(e);return this}}function QA(o){const e=o.length>>1;if(e<3)return[];const t=[],i=[];for(let n=0;n<e;n++)i.push(n);let s=0,a=e;for(;a>3;){const n=i[(s+0)%a],r=i[(s+1)%a],l=i[(s+2)%a],h=o[2*n],c=o[2*n+1],A=o[2*r],d=o[2*r+1],m=o[2*l],p=o[2*l+1];let f=!1;if(PA(h,c,A,d,m,p)){f=!0;for(let _=0;_<a;_++){const E=i[_];if(!(E==n||E==r||E==l)&&DA(o[2*E],o[2*E+1],h,c,A,d,m,p)){f=!1;break}}}if(f)t.push(n,r,l),i.splice((s+1)%a,1),a--,s=0;else if(s++>3*a)break}return t.push(i[0],i[1],i[2]),t}function DA(o,e,t,i,s,a,n,r){const l=n-t,h=r-i,c=s-t,A=a-i,d=o-t,m=e-i,p=l*l+h*h,f=l*c+h*A,_=l*d+h*m,E=c*c+A*A,x=c*d+A*m,y=1/(p*E-f*f),C=(E*_-f*x)*y,u=(p*x-f*_)*y;return C>=0&&u>=0&&C+u<1}function PA(o,e,t,i,s,a){return(e-i)*(s-t)+(t-o)*(a-i)>=0}const _t=class _t{constructor(e){M(this,"body",null);M(this,"position",v());M(this,"boundingRadius",0);M(this,"area",0);this.id=_t.idCounter++,this.body=null,e.position&&he(this.position,e.position),this.type=e.type,this.angle=e.angle??0,this.collisionGroup=e.collisionGroup??1,this.collisionResponse=e.collisionResponse??!0,this.collisionMask=e.collisionMask??1,this.sensor=e.sensor??!1,this.material=e.material??null}updateBoundingRadius(){}updateArea(){}raycast(e,t,i,s){}pointTest(e){return!1}worldPointToLocal(e,t){const i=this.body;return Re(Is,this.position,i.angle),Y(Is,Is,i.position),ni(e,t,Is,this.body.angle+this.angle),e}};M(_t,"idCounter",0),M(_t,"CIRCLE",1),M(_t,"PARTICLE",2),M(_t,"PLANE",4),M(_t,"CONVEX",8),M(_t,"LINE",16),M(_t,"BOX",32),M(_t,"CAPSULE",64),M(_t,"HEIGHTFIELD",128);let K=_t;const Is=v();class Kt extends K{constructor(e){e===void 0&&(e={});const t={type:K.CONVEX,vertices:[],axes:[],...e};super(t),this.axes=t.axes,this.vertices=[];for(let i=0;i<t.vertices.length;i++)this.vertices.push(yt(t.vertices[i]));this.normals=[];for(let i=0;i<t.vertices.length;i++)this.normals.push(v());if(this.updateNormals(),this.centerOfMass=v(),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in counter-clockwise winding.")}updateNormals(){for(let e=0;e<this.vertices.length;e++){const t=this.vertices[e],i=this.vertices[(e+1)%this.vertices.length],s=this.normals[e];D(s,i,t),mi(s,s),ze(s,s)}}projectOntoLocalAxis(e,t){let i=0,s=0;e=LA;for(let a=0;a<this.vertices.length;a++){const n=this.vertices[a],r=be(n,e);(i===null||r>i)&&(i=r),(s===null||r<s)&&(s=r)}if(s>i){const a=s;s=i,i=a}le(t,s,i)}projectOntoWorldAxis(e,t,i,s){let a=RA;this.projectOntoLocalAxis(e,s),i!==0?Re(a,e,i):a=e;const n=be(t,a);le(s,s[0]+n,s[1]+n)}updateTriangles(){this.triangles.length=0;const e=[];for(let i=0;i<this.vertices.length;i++){const s=this.vertices[i];e.push(s[0],s[1])}const t=QA(e);for(let i=0;i<t.length;i+=3){const s=t[i],a=t[i+1],n=t[i+2];this.triangles.push([s,a,n])}}updateCenterOfMass(){const e=this.triangles,t=this.vertices,i=this.centerOfMass,s=TA;let a=FA,n=UA,r=OA;const l=NA;le(i,0,0);let h=0;for(let c=0;c!==e.length;c++){const A=e[c];a=t[A[0]],n=t[A[1]],r=t[A[2]],dA(s,a,n,r);const d=Kt.triangleArea(a,n,r);h+=d,se(l,s,d),Y(i,i,l)}se(i,i,1/h)}computeMomentOfInertia(){let e=0,t=0;const i=this.vertices.length;for(let s=i-1,a=0;a<i;s=a,a++){const n=this.vertices[s],r=this.vertices[a],l=Math.abs(ht(n,r)),h=be(r,r)+be(r,n)+be(n,n);e+=l*h,t+=l}return 1/6*(e/t)}updateBoundingRadius(){const e=this.vertices;let t=0;for(let i=0;i!==e.length;i++){const s=Et(e[i]);s>t&&(t=s)}this.boundingRadius=Math.sqrt(t)}updateArea(){this.updateTriangles(),this.area=0;const e=this.triangles,t=this.vertices;for(let i=0;i!==e.length;i++){const s=e[i],a=t[s[0]],n=t[s[1]],r=t[s[2]],l=Kt.triangleArea(a,n,r);this.area+=l}}computeAABB(e,t,i){e.setFromPoints(this.vertices,t,i,0)}raycast(e,t,i,s){const a=kA,n=GA,r=HA,l=this.vertices;ni(a,t.from,i,s),ni(n,t.to,i,s);const h=l.length;for(let c=0;c<h&&!e.shouldStop(t);c++){const A=l[c],d=l[(c+1)%h],m=Yo(a,n,A,d);m>=0&&(D(r,d,A),Re(r,r,-Math.PI/2+s),ze(r,r),t.reportIntersection(e,m,r,c))}}pointTest(e){const t=zA,i=qA,s=this.vertices,a=s.length;let n=null;for(let r=0;r<a+1;r++){const l=s[r%a],h=s[(r+1)%a];D(t,l,e),D(i,h,e);const c=ht(t,i);if(n===null&&(n=c),c*n<0)return!1;n=c}return!0}static triangleArea(e,t,i){return((t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1]))*.5}}const LA=v(),RA=v(),TA=v(),NA=v(),FA=v(),UA=v(),OA=v(),kA=v(),GA=v(),HA=v(),zA=v(),qA=v(),Ne=class Ne extends Zo{constructor(t){t===void 0&&(t={});super();M(this,"world",null);this.id=t.id||++Ne._idCounter,this.index=-1,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=v(),this.position=t.position?yt(t.position):v(),this.interpolatedPosition=yt(this.position),this.previousPosition=yt(this.position),this.velocity=t.velocity?yt(t.velocity):v(),this.vlambda=v(),this.wlambda=0,this.angle=t.angle||0,this.previousAngle=this.angle,this.interpolatedAngle=this.angle,this.angularVelocity=t.angularVelocity||0,this.force=t.force?yt(t.force):v(),this.angularForce=t.angularForce||0,this.damping=t.damping??.1,this.angularDamping=t.angularDamping??.1,this.type=Ne.STATIC,t.type!==void 0?this.type=t.type:t.mass?this.type=Ne.DYNAMIC:this.type=Ne.STATIC,this.boundingRadius=0,this.aabb=new $a,this.aabbNeedsUpdate=!0,this.allowSleep=t.allowSleep??!0,this.wantsToSleep=!1,this.sleepState=Ne.AWAKE,this.sleepSpeedLimit=t.sleepSpeedLimit??.2,this.sleepTimeLimit=t.sleepTimeLimit??1,this.idleTime=0,this.timeLastSleepy=0,this.collisionResponse=t.collisionResponse??!0,this.ccdSpeedThreshold=t.ccdSpeedThreshold??-1,this.ccdIterations=t.ccdIterations??10,this.gravityScale=t.gravityScale??1,this.islandId=-1,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}updateSolveMassProperties(){this.sleepState===Ne.SLEEPING||this.type===Ne.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)}setDensity(t){const i=this.getArea();this.mass=i*t,this.updateMassProperties()}getArea(){let t=0;for(let i=0;i<this.shapes.length;i++)t+=this.shapes[i].area;return t}getAABB(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb}updateAABB(){const t=this.shapes,i=t.length,s=VA,a=this.angle;for(let n=0;n!==i;n++){const r=t[n],l=r.angle+a;ke(s,r.position,this.position,a),r.computeAABB(Ea,s,l),n===0?this.aabb.copy(Ea):this.aabb.extend(Ea)}this.aabbNeedsUpdate=!1}updateBoundingRadius(){const t=this.shapes,i=t.length;let s=0;for(let a=0;a!==i;a++){const n=t[a],r=ns(n.position),l=n.boundingRadius;r+l>s&&(s=r+l)}this.boundingRadius=s}addShape(t,i,s){if(t.body)throw new Error("A shape can only be added to one body.");const a=this.world;if(a&&a.stepping)throw new Error("A shape cannot be added during step.");t.body=this,i?he(t.position,i):le(t.position,0,0),t.angle=s||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0}removeShape(t){const i=this.world;if(i&&i.stepping)throw new Error("A shape cannot be removed during step.");const s=this.shapes.indexOf(t);return s!==-1?(this.shapes.splice(s,1),this.aabbNeedsUpdate=!0,t.body=null,!0):!1}updateMassProperties(){if(this.type===Ne.STATIC||this.type===Ne.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{const t=this.shapes,i=t.length;let s=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(let a=0;a<i;a++){const n=t[a],r=Et(n.position),l=n.computeMomentOfInertia();s+=l+r}this.inertia=this.mass*s,this.invInertia=s>0?1/s:0}this.invMass=1/this.mass,le(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}}applyForce(t,i){if(Y(this.force,this.force,t),i){const s=ht(i,t);this.angularForce+=s}}applyForceLocal(t,i){i=i||jA;const s=WA,a=YA;this.vectorToWorldFrame(s,t),this.vectorToWorldFrame(a,i),this.applyForce(s,a)}applyImpulse(t,i){if(this.type!==Ne.DYNAMIC)return;const s=XA;if(se(s,t,this.invMass),zs(s,this.massMultiplier,s),Y(this.velocity,s,this.velocity),i){let a=ht(i,t);a*=this.invInertia,this.angularVelocity+=a}}applyImpulseLocal(t,i){i=i||ZA;const s=KA,a=JA;this.vectorToWorldFrame(s,t),this.vectorToWorldFrame(a,i),this.applyImpulse(s,a)}toLocalFrame(t,i){ni(t,i,this.position,this.angle)}toWorldFrame(t,i){ke(t,i,this.position,this.angle)}vectorToLocalFrame(t,i){Wo(t,i,this.angle)}vectorToWorldFrame(t,i){uA(t,i,this.angle)}fromPolygon(t,i){i===void 0&&(i={});for(let l=this.shapes.length;l>=0;--l)this.removeShape(this.shapes[l]);const s=[];for(let l=0;l<t.length;l++)s[l]=yt(t[l]);if(yA(s),i.removeCollinearPoints!==void 0&&(typeof i.removeCollinearPoints=="boolean"?i.removeCollinearPoints===!0&&kn(s):kn(s,i.removeCollinearPoints)),!i.skipSimpleCheck&&!BA(s))return!1;const a=this.concavePath=[];for(let l=0;l<s.length;l++)a[l]=yt(s[l]);let n;if(i.optimalDecomp){if(n=bA(s),n===!1)throw new Error("Convex decomposition failed!")}else n=Ji(s);const r=v();for(let l=0;l!==n.length;l++){let h=new Kt({vertices:n[l]});for(let c=0;c!==h.vertices.length;c++){const A=h.vertices[c];D(A,A,h.centerOfMass)}he(r,h.centerOfMass),h=new Kt({vertices:h.vertices}),this.addShape(h,r)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0}adjustCenterOfMass(){const t=$A,i=eh,s=th;let a=0;le(i,0,0);for(let n=0;n!==this.shapes.length;n++){const r=this.shapes[n];se(t,r.position,r.area),Y(i,i,t),a+=r.area}se(s,i,1/a);for(let n=0;n!==this.shapes.length;n++){const r=this.shapes[n];D(r.position,r.position,s)}Y(this.position,this.position,s);for(let n=0;this.concavePath&&n<this.concavePath.length;n++)D(this.concavePath[n],this.concavePath[n],s);this.updateMassProperties(),this.updateBoundingRadius()}setZeroForce(){const t=this.force;t[0]=t[1]=this.angularForce=0}applyDamping(t){if(this.type===Ne.DYNAMIC){const i=this.velocity;se(i,i,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}}wakeUp(){const t=this.sleepState;this.sleepState=Ne.AWAKE,this.idleTime=0,t!==Ne.AWAKE&&this.emit({type:"wakeup"})}sleep(){this.sleepState=Ne.SLEEPING,this.angularVelocity=this.angularForce=0,le(this.velocity,0,0),le(this.force,0,0),this.emit({type:"sleep"})}sleepTick(t,i,s){if(!this.allowSleep||this.type===Ne.SLEEPING)return;this.wantsToSleep=!1;const a=Et(this.velocity)+Math.pow(this.angularVelocity,2),n=Math.pow(this.sleepSpeedLimit,2);a>=n?(this.idleTime=0,this.sleepState=Ne.AWAKE):(this.idleTime+=s,this.sleepState!==Ne.SLEEPY&&(this.sleepState=Ne.SLEEPY,this.emit({type:"sleepy"}))),this.idleTime>this.sleepTimeLimit&&(i?this.wantsToSleep=!0:this.sleep())}overlaps(t){return this.world===null?!1:this.world.overlapKeeper.bodiesAreOverlapping(this,t)}integrate(t){const i=this.invMass,s=this.force,a=this.position,n=this.velocity;he(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),se(xs,s,t*i),zs(xs,this.massMultiplier,xs),Y(n,xs,n),this.integrateToTimeOfImpact(t)||(se(xi,n,t),Y(a,a,xi),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0}getVelocityAtPoint(t,i){return Ga(t,i,this.angularVelocity),D(t,this.velocity,t),t}integrateToTimeOfImpact(t){if(this.world===null)throw new Error("world is not set for body");if(this.ccdSpeedThreshold<0||Et(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;const i=[],s=this.world.disabledBodyCollisionPairs;for(let p=0;p<s.length;p+=2){const f=s[p],_=s[p+1];f===this?i.push(_):_===this&&i.push(f)}ze(ih,this.velocity),se(ti,this.velocity,t),Y(ti,ti,this.position),D(Hi,ti,this.position);const a=this.angularVelocity*t,n=ns(Hi);let r=1,l=null;he(Ai.from,this.position),he(Ai.to,ti),Ai.update();for(let p=0;p<this.shapes.length;p++){const f=this.shapes[p];if(bs.reset(),Ai.collisionGroup=f.collisionGroup,Ai.collisionMask=f.collisionMask,this.world.raycast(bs,Ai),l=bs.body,l!==null&&(l===this||i.indexOf(l)!==-1)&&(l=null),l)break}if(!l||!r)return!1;bs.getHitPoint(ti,Ai),D(Hi,ti,this.position),r=Ja(ti,this.position)/n;const h=this.angle;he(Ia,this.position);let c=0,A=0,d=r,m=1;for(;m>=A&&c<this.ccdIterations;)c++,d=(m+A)/2,se(xi,Hi,d),Y(this.position,Ia,xi),this.angle=h+a*d,this.updateAABB(),this.aabb.overlaps(l.aabb)&&this.world.narrowphase.bodiesOverlap(this,l,!0)?m=d:A=d;return r=m,he(this.position,Ia),this.angle=h,se(xi,Hi,r),Y(this.position,this.position,xi),this.fixedRotation||(this.angle+=a*r),!0}resetConstraintVelocity(){const t=this.vlambda;le(t,0,0),this.wlambda=0}addConstraintVelocity(){const t=this.velocity;Y(t,t,this.vlambda),this.angularVelocity+=this.wlambda}};M(Ne,"DYNAMIC",1),M(Ne,"STATIC",2),M(Ne,"KINEMATIC",4),M(Ne,"AWAKE",0),M(Ne,"SLEEPY",1),M(Ne,"SLEEPING",2),M(Ne,"_idCounter",0);let fe=Ne;const Ea=new $a,VA=v(),WA=v(),YA=v(),jA=v(),XA=v(),KA=v(),JA=v(),ZA=v(),$A=v(),eh=v(),th=v(),xs=v(),xi=v(),bs=new MA,Ai=new os({mode:os.CLOSEST,skipBackfaces:!0}),ih=v(),ti=v(),Hi=v(),Ia=v(),wt=class wt{static boundingRadiusCheck(e,t){const i=Za(e.position,t.position),s=e.boundingRadius+t.boundingRadius;return i<=s*s}static aabbCheck(e,t){return e.getAABB().overlaps(t.getAABB())}static canCollide(e,t){const i=fe.KINEMATIC,s=fe.STATIC,a=e.type,n=t.type;return!(a===s&&n===s||a===i&&n===s||a===s&&n===i||a===i&&n===i||e.sleepState===fe.SLEEPING&&t.sleepState===fe.SLEEPING||e.sleepState===fe.SLEEPING&&n===s||t.sleepState===fe.SLEEPING&&a===s)}constructor(e){this.type=e,this.result=[],this.world=void 0,this.boundingVolumeType=wt.AABB}setWorld(e){this.world=e}boundingVolumeCheck(e,t){switch(this.boundingVolumeType){case wt.BOUNDING_CIRCLE:return wt.boundingRadiusCheck(e,t);case wt.AABB:return wt.aabbCheck(e,t);default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}}};M(wt,"AABB",1),M(wt,"BOUNDING_CIRCLE",2),M(wt,"NAIVE",1),M(wt,"SAP",2);let ss=wt;class en extends Kt{constructor(e){e===void 0&&(e={});const t=e.width??1,i=e.height??1,s=[ut(-t/2,-i/2),ut(t/2,-i/2),ut(t/2,i/2),ut(-t/2,i/2)],a={...e,type:K.BOX,vertices:s};super(a),this.width=t,this.height=i,this.updateBoundingRadius(),this.updateArea()}computeMomentOfInertia(){const e=this.width,t=this.height;return(t*t+e*e)/12}updateBoundingRadius(){const e=this.width,t=this.height;this.boundingRadius=Math.sqrt(e*e+t*t)/2}computeAABB(e,t,i){const s=Math.abs(Math.cos(i)),a=Math.abs(Math.sin(i)),n=this.width,r=this.height,l=(n*a+r*s)*.5,h=(r*a+n*s)*.5,c=e.lowerBound,A=e.upperBound,d=t[0],m=t[1];c[0]=d-h,c[1]=m-l,A[0]=d+h,A[1]=m+l}updateArea(){this.area=this.width*this.height}pointTest(e){return Math.abs(e[0])<=this.width*.5&&Math.abs(e[1])<=this.height*.5}}class hs extends K{constructor(e){e===void 0&&(e={});const t={radius:1,...e,type:K.CIRCLE};super(t),this.radius=t.radius,this.updateBoundingRadius(),this.updateArea()}updateBoundingRadius(){this.boundingRadius=this.radius}computeMomentOfInertia(){const e=this.radius;return e*e/2}updateArea(){this.area=Math.PI*this.radius*this.radius}computeAABB(e,t){const i=this.radius;le(e.upperBound,i,i),le(e.lowerBound,-i,-i),t&&(Y(e.lowerBound,e.lowerBound,t),Y(e.upperBound,e.upperBound,t))}raycast(e,t,i){const s=t.from,a=t.to,n=this.radius,r=Math.pow(a[0]-s[0],2)+Math.pow(a[1]-s[1],2),l=2*((a[0]-s[0])*(s[0]-i[0])+(a[1]-s[1])*(s[1]-i[1])),h=Math.pow(s[0]-i[0],2)+Math.pow(s[1]-i[1],2)-Math.pow(n,2),c=Math.pow(l,2)-4*r*h,A=sh,d=ah;if(!(c<0))if(c===0)es(A,s,a,c),D(d,A,i),ze(d,d),t.reportIntersection(e,c,d,-1);else{const m=Math.sqrt(c),p=1/(2*r),f=(-l-m)*p,_=(-l+m)*p;if(f>=0&&f<=1&&(es(A,s,a,f),D(d,A,i),ze(d,d),t.reportIntersection(e,f,d,-1),e.shouldStop(t)))return;_>=0&&_<=1&&(es(A,s,a,_),D(d,A,i),ze(d,d),t.reportIntersection(e,_,d,-1))}}pointTest(e){const t=this.radius;return Et(e)<=t*t}}const sh=v(),ah=v(),wi=class wi{constructor(e,t,i,s){this.bodyA=e,this.bodyB=t,this.minForce=i??-Number.MAX_VALUE,this.maxForce=s??Number.MAX_VALUE,this.maxBias=Number.MAX_VALUE,this.stiffness=wi.DEFAULT_STIFFNESS,this.relaxation=wi.DEFAULT_RELAXATION,this.G=new ta(6);for(let a=0;a<6;a++)this.G[a]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0,this.lambda=this.B=this.invC=this.minForceDt=this.maxForceDt=0,this.index=-1}update(){const e=this.stiffness,t=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*t)),this.b=4*t/(1+4*t),this.epsilon=4/(i*i*e*(1+4*t)),this.needsUpdate=!1}gmult(e,t,i,s,a){return e[0]*t[0]+e[1]*t[1]+e[2]*i+e[3]*s[0]+e[4]*s[1]+e[5]*a}computeB(e,t,i){const s=this.computeGW();let a=this.computeGq();const n=this.maxBias;Math.abs(a)>n&&(a=a>0?n:-n);const r=this.computeGiMf();return-a*e-s*t-r*i}computeGq(){const e=this.G,t=this.bodyA,i=this.bodyB,s=t.angle,a=i.angle;return this.gmult(e,nh,s,oh,a)+this.offset}computeGW(){const e=this.G,t=this.bodyA,i=this.bodyB,s=t.velocity,a=i.velocity,n=t.angularVelocity,r=i.angularVelocity;return this.gmult(e,s,n,a,r)+this.relativeVelocity}computeGWlambda(){const e=this.G,t=this.bodyA,i=this.bodyB,s=t.vlambda,a=i.vlambda,n=t.wlambda,r=i.wlambda;return this.gmult(e,s,n,a,r)}computeGiMf(){const e=this.bodyA,t=this.bodyB,i=e.force,s=e.angularForce,a=t.force,n=t.angularForce,r=e.invMassSolve,l=t.invMassSolve,h=e.invInertiaSolve,c=t.invInertiaSolve,A=this.G;return se(Bs,i,r),zs(Bs,e.massMultiplier,Bs),se(Ss,a,l),zs(Ss,t.massMultiplier,Ss),this.gmult(A,Bs,s*h,Ss,n*c)}computeGiMGt(){const e=this.bodyA,t=this.bodyB,i=e.invMassSolve,s=t.invMassSolve,a=e.invInertiaSolve,n=t.invInertiaSolve,r=this.G;return r[0]*r[0]*i*e.massMultiplier[0]+r[1]*r[1]*i*e.massMultiplier[1]+r[2]*r[2]*a+r[3]*r[3]*s*t.massMultiplier[0]+r[4]*r[4]*s*t.massMultiplier[1]+r[5]*r[5]*n}addToWlambda(e){const t=this.bodyA,i=this.bodyB,s=t.invMassSolve,a=i.invMassSolve,n=t.invInertiaSolve,r=i.invInertiaSolve,l=this.G;Hn(t.vlambda,l[0],l[1],s,e,t.massMultiplier),t.wlambda+=n*l[2]*e,Hn(i.vlambda,l[3],l[4],a,e,i.massMultiplier),i.wlambda+=r*l[5]*e}computeInvC(e){return 1/(this.computeGiMGt()+e)}};M(wi,"DEFAULT_STIFFNESS",1e6),M(wi,"DEFAULT_RELAXATION",4);let xt=wi;const nh=v(),oh=v(),Bs=v(),Ss=v();function Hn(o,e,t,i,s,a){o[0]+=e*i*s*a[0],o[1]+=t*i*s*a[1]}function rh(o,e,t,i,s){o[0]=e[0]+t[0]-i[0]-s[0],o[1]=e[1]+t[1]-i[1]-s[1]}const zn=v(),qn=v(),Vn=v(),Wn=new hs({radius:1});class lh extends xt{constructor(e,t){super(e,t,0,Number.MAX_VALUE),this.contactPointA=v(),this.penetrationVec=v(),this.contactPointB=v(),this.normalA=v(),this.restitution=0,this.firstImpact=!1,this.shapeA=Wn,this.shapeB=Wn}computeB(e,t,i){const s=this.bodyA,a=this.bodyB,n=this.contactPointA,r=this.contactPointB,l=s.position,h=a.position,c=this.normalA,A=this.G,d=ht(n,c),m=ht(r,c);A[0]=-c[0],A[1]=-c[1],A[2]=-d,A[3]=c[0],A[4]=c[1],A[5]=m;let p,f;if(this.firstImpact&&this.restitution!==0)f=0,p=1/t*(1+this.restitution)*this.computeGW();else{const x=this.penetrationVec;rh(x,h,r,l,n),f=be(c,x)+this.offset,p=this.computeGW()}const _=this.computeGiMf();return-f*e-p*t-i*_}getVelocityAlongNormal(){return this.bodyA.getVelocityAtPoint(zn,this.contactPointA),this.bodyB.getVelocityAtPoint(qn,this.contactPointB),D(Vn,zn,qn),be(this.normalA,Vn)}}class tn{constructor(e){M(this,"objects",[]);(e==null?void 0:e.size)!==void 0&&this.resize(e.size)}resize(e){const t=this.objects;for(;t.length>e;)t.pop();for(;t.length<e;)t.push(this.create());return this}get(){const e=this.objects;return e.length?e.pop():this.create()}release(e){return this.destroy(e),this.objects.push(e),this}}class ch extends tn{create(){return new lh(xa,xa)}destroy(e){return e.bodyA=e.bodyB=xa,this}}const xa=new fe;class $o extends xt{constructor(e,t,i){i===void 0&&(i=Number.MAX_VALUE),super(e,t,-i,i),this.contactPointA=v(),this.contactPointB=v(),this.t=v(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}setSlipForce(e){this.maxForce=e,this.minForce=-e}getSlipForce(){return this.maxForce}computeB(e,t,i){const s=this.contactPointA,a=this.contactPointB,n=this.t,r=this.G;r[0]=-n[0],r[1]=-n[1],r[2]=-ht(s,n),r[3]=n[0],r[4]=n[1],r[5]=ht(a,n);const l=this.computeGW(),h=this.computeGiMf();return-l*t-i*h}}class Ah extends tn{create(){return new $o(ba,ba)}destroy(e){return e.bodyA=e.bodyB=ba,this}}const ba=new fe;class Os{constructor(){M(this,"data",{});M(this,"keys",[])}getKey(e,t){return e=e|0,t=t|0,(e|0)===(t|0)?-1:((e|0)>(t|0)?e<<16|t&65535:t<<16|e&65535)|0}getByKey(e){return e=e|0,this.data[e]}get(e,t){return this.data[this.getKey(e,t)]}set(e,t,i){if(!i)throw new Error("No data!");const s=this.getKey(e,t);return this.data[s]||this.keys.push(s),this.data[s]=i,s}reset(){this.keys=[],this.data={}}copy(e){this.keys=e.keys,this.data=e.data}}class hh{constructor(){M(this,"convexLine",function(e,t,i,s,a,n,r,l,h){return 0});M(this,"lineBox",function(e,t,i,s,a,n,r,l,h){return 0});M(this,"convexCapsule",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Uh,d=r.length/2;le(A,d,0),ke(A,A,l,h);const m=e.circleConvex(n,r,A,h,t,i,s,a,c,r.radius);le(A,-d,0),ke(A,A,l,h);const p=e.circleConvex(n,r,A,h,t,i,s,a,c,r.radius);if(c&&m+p!==0)return 1;const f=Fh;return Ma(f,r),e.convexConvex(t,i,s,a,n,f,l,h,c)+m+p}})());M(this,"lineCapsule",function(e,t,i,s,a,n,r,l,h){return 0});M(this,"capsuleCapsule",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);let A=!0;const d=Oh,m=kh;let p=0;for(let x=0;x<2;x++){le(d,(x===0?-1:1)*i.length/2,0),ke(d,d,s,a);for(let y=0;y<2;y++){le(m,(y===0?-1:1)*r.length/2,0),ke(m,m,l,h),e.enableFrictionReduction&&(A=e.enableFriction,e.enableFriction=!1);const C=e.circleCircle(t,i,d,a,n,r,m,h,c,i.radius,r.radius);if(e.enableFrictionReduction&&(e.enableFriction=A),c&&C!==0)return 1;p+=C}}e.enableFrictionReduction&&(A=e.enableFriction,e.enableFriction=!1);const f=Gh;Ma(f,i);const _=e.convexCapsule(t,f,s,a,n,r,l,h,c);if(e.enableFrictionReduction&&(e.enableFriction=A),c&&_!==0)return 1;p+=_,e.enableFrictionReduction&&(A=e.enableFriction,e.enableFriction=!1),Ma(f,r);const E=e.convexCapsule(n,f,l,h,t,i,s,a,c);return e.enableFrictionReduction&&(e.enableFriction=A),c&&E!==0?1:(p+=E,e.enableFrictionReduction&&p&&e.enableFriction&&e.frictionEquations.push(e.createFrictionFromAverage(p)),p)}})());M(this,"lineLine",function(e,t,i,s,a,n,r,l,h){return 0});M(this,"planeLine",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Vt,d=hi,m=bi,p=zi,f=qi,_=Vi,E=Ms,x=Ba,y=Yn,C=Jn;let u=0;le(A,-r.length/2,0),le(d,r.length/2,0),ke(m,A,l,h),ke(p,d,l,h),he(A,m),he(d,p),D(f,d,A),ze(_,f),mi(y,_),Re(x,ws,a),C[0]=A,C[1]=d;for(let I=0;I<C.length;I++){const w=C[I];D(E,w,s);const L=be(E,x);if(L<0){if(c)return 1;const k=e.createContactEquation(t,n,i,r);u++,he(k.normalA,x),ze(k.normalA,k.normalA),se(E,x,L),D(k.contactPointA,w,E),D(k.contactPointA,k.contactPointA,t.position),D(k.contactPointB,w,l),Y(k.contactPointB,k.contactPointB,l),D(k.contactPointB,k.contactPointB,n.position),e.contactEquations.push(k),e.enableFrictionReduction||e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(k))}}return c?0:(e.enableFrictionReduction||u&&e.enableFriction&&e.frictionEquations.push(e.createFrictionFromAverage(u)),u)}})());M(this,"particleCapsule",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){return c===void 0&&(c=!1),e.circleLine(t,i,s,a,n,r,l,h,c,r.radius,0)}})());M(this,"circleLine",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c,A,d){c===void 0&&(c=!1),A===void 0&&(A=0),d===void 0&&(d=i.radius);const m=Vt,p=hi,f=bi,_=zi,E=qi,x=Vi,y=Ms,C=Ba,u=Yn,I=jn,w=Xn,L=uh,k=Sa,J=wa,j=Jn,q=r.length/2;le(C,-q,0),le(u,q,0),ke(I,C,l,h),ke(w,u,l,h),he(C,I),he(u,w),D(x,u,C),ze(y,x),mi(E,y),D(L,s,C);const pe=be(L,E);D(_,C,l),D(k,s,l);const ve=d+A;if(Math.abs(pe)<ve){se(m,E,pe),D(f,s,m),se(p,E,be(E,k)),ze(p,p),se(p,p,A),Y(f,f,p);const ee=be(y,f),Me=be(y,C),P=be(y,u);if(ee>Me&&ee<P){if(c)return 1;const V=e.createContactEquation(t,n,i,r);return se(V.normalA,m,-1),ze(V.normalA,V.normalA),se(V.contactPointA,V.normalA,d),Y(V.contactPointA,V.contactPointA,s),D(V.contactPointA,V.contactPointA,t.position),D(V.contactPointB,f,l),Y(V.contactPointB,V.contactPointB,l),D(V.contactPointB,V.contactPointB,n.position),e.contactEquations.push(V),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(V)),1}}j[0]=C,j[1]=u;for(let ee=0;ee<j.length;ee++){const Me=j[ee];if(D(L,Me,s),Et(L)<Math.pow(ve,2)){if(c)return 1;const P=e.createContactEquation(t,n,i,r);return he(P.normalA,L),ze(P.normalA,P.normalA),se(P.contactPointA,P.normalA,d),Y(P.contactPointA,P.contactPointA,s),D(P.contactPointA,P.contactPointA,t.position),D(P.contactPointB,Me,l),se(J,P.normalA,-A),Y(P.contactPointB,P.contactPointB,J),Y(P.contactPointB,P.contactPointB,l),D(P.contactPointB,P.contactPointB,n.position),e.contactEquations.push(P),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(P)),1}}return 0}})());M(this,"circleCapsule",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){return c===void 0&&(c=!1),e.circleLine(t,i,s,a,n,r,l,h,c,r.radius)}})());M(this,"circleConvex",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c,A){c===void 0&&(c=!1),A===void 0&&(A=i.radius);const d=Vt,m=hi,p=bi,f=zi,_=qi,E=Vi,x=Ms,y=Ba,C=jn,u=Xn,I=Sa,w=wa,L=Kn;let k=-1,J=Number.MAX_VALUE;le(E,0,0),ni(x,s,l,h);const j=r.vertices,q=r.normals,pe=j.length;let ve=-1,ee=-Number.MAX_VALUE;const Me=r.boundingRadius+A;for(let P=0;P<pe;P++){D(y,x,j[P]);const V=be(q[P],y);if(V>Me)return 0;V>ee&&(ee=V,ve=P)}for(let P=ve+pe-1;P<ve+pe+2;P++){const V=j[P%pe],G=q[P%pe];if(se(w,G,-A),Y(w,w,x),qh(w,r)){D(L,V,w);const Ue=Math.abs(be(L,G));Ue<J&&(J=Ue,k=P)}}if(k!==-1){if(c)return 1;const P=j[k%pe],V=j[(k+1)%pe];ke(d,P,l,h),ke(m,V,l,h),D(p,m,d),ze(f,p),mi(_,f),se(w,_,-A),Y(w,w,s),se(I,_,J),Y(I,I,w);const G=e.createContactEquation(t,n,i,r);return D(G.normalA,w,s),ze(G.normalA,G.normalA),se(G.contactPointA,G.normalA,A),Y(G.contactPointA,G.contactPointA,s),D(G.contactPointA,G.contactPointA,t.position),D(G.contactPointB,I,l),Y(G.contactPointB,G.contactPointB,l),D(G.contactPointB,G.contactPointB,n.position),e.contactEquations.push(G),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(G)),1}if(A>0&&ve!==-1)for(let P=ve+pe;P<ve+pe+2;P++){const V=j[P%pe];if(D(C,V,x),Et(C)<A*A){if(c)return 1;ke(u,V,l,h),D(C,u,s);const G=e.createContactEquation(t,n,i,r);return he(G.normalA,C),ze(G.normalA,G.normalA),se(G.contactPointA,G.normalA,A),Y(G.contactPointA,G.contactPointA,s),D(G.contactPointA,G.contactPointA,t.position),D(G.contactPointB,u,l),Y(G.contactPointB,G.contactPointB,l),D(G.contactPointB,G.contactPointB,n.position),e.contactEquations.push(G),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(G)),1}}return 0}})());M(this,"particleConvex",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Vt,d=hi,m=bi,p=zi,f=qi,_=Vi,E=Ms,x=Sa,y=wa,C=Kn,u=r.vertices;let I=Number.MAX_VALUE,w=!1;if(!zh(s,r,l,h))return 0;if(c)return 1;for(let L=0,k=u.length;L!==k+1;L++){const J=u[L%k],j=u[(L+1)%k];Re(A,J,h),Re(d,j,h),Y(A,A,l),Y(d,d,l),D(m,d,A),ze(p,m),mi(f,p),D(_,A,l),D(E,s,l),D(y,A,s);const q=Math.abs(be(y,f));q<I&&(I=q,se(x,f,q),Y(x,x,s),he(C,f),w=!0)}if(w){const L=e.createContactEquation(t,n,i,r);return se(L.normalA,C,-1),ze(L.normalA,L.normalA),le(L.contactPointA,0,0),Y(L.contactPointA,L.contactPointA,s),D(L.contactPointA,L.contactPointA,t.position),D(L.contactPointB,x,l),Y(L.contactPointB,L.contactPointB,l),D(L.contactPointB,L.contactPointB,n.position),e.contactEquations.push(L),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(L)),1}return 0}})());M(this,"circleCircle",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c,A,d){c===void 0&&(c=!1),A===void 0&&(A=i.radius),d===void 0&&(d=r.radius);const m=Vt;D(m,s,l);const p=A+d;if(Et(m)>p*p)return 0;if(c)return 1;const f=e.createContactEquation(t,n,i,r),_=f.contactPointA,E=f.contactPointB,x=f.normalA;return D(x,l,s),ze(x,x),se(_,x,A),se(E,x,-d),Zn(_,_,s,t.position),Zn(E,E,l,n.position),e.contactEquations.push(f),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(f)),1}})());M(this,"planeConvex",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Vt,d=hi,m=bi,p=zi,f=qi,_=Vi;let E=0;Re(d,ws,a),Wo(f,d,h),ni(p,s,l,h);const x=r.vertices;for(let y=0,C=x.length;y!==C;y++){const u=x[y];if(D(_,u,p),be(_,f)<=0){if(c)return 1;ke(A,u,l,h),D(m,A,s),E++;const I=e.createContactEquation(t,n,i,r);D(m,A,s),he(I.normalA,d);const w=be(m,I.normalA);se(m,I.normalA,w),D(I.contactPointB,A,n.position),D(I.contactPointA,A,m),D(I.contactPointA,I.contactPointA,t.position),e.contactEquations.push(I),e.enableFrictionReduction||e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(I))}}return e.enableFrictionReduction&&e.enableFriction&&E&&e.frictionEquations.push(e.createFrictionFromAverage(E)),E}})());M(this,"particlePlane",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Vt,d=hi;h=h||0,D(A,s,l),Re(d,ws,h);const m=be(A,d);if(m>0)return 0;if(c)return 1;const p=e.createContactEquation(n,t,r,i);return he(p.normalA,d),se(A,p.normalA,m),D(p.contactPointA,s,A),D(p.contactPointA,p.contactPointA,n.position),D(p.contactPointB,s,t.position),e.contactEquations.push(p),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(p)),1}})());M(this,"circleParticle",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Vt,d=i.radius;if(D(A,l,s),Et(A)>d*d)return 0;if(c)return 1;const m=e.createContactEquation(t,n,i,r),p=m.normalA,f=m.contactPointA,_=m.contactPointB;return he(p,A),ze(p,p),se(f,p,d),Y(f,f,s),D(f,f,t.position),D(_,l,n.position),e.contactEquations.push(m),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(m)),1}})());M(this,"planeCapsule",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=Wh,d=Yh,m=Vh,p=r.length/2;le(A,-p,0),le(d,p,0),ke(A,A,l,h),ke(d,d,l,h),m.radius=r.radius;let f=!0;e.enableFrictionReduction&&(f=e.enableFriction,e.enableFriction=!1);const _=e.circlePlane(n,m,A,0,t,i,s,a,c),E=e.circlePlane(n,m,d,0,t,i,s,a,c);if(e.enableFrictionReduction&&(e.enableFriction=f),c)return _+E;{const x=_+E;return e.enableFrictionReduction&&x&&e.frictionEquations.push(e.createFrictionFromAverage(x)),x}}})());M(this,"circlePlane",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=i.radius,d=Vt,m=hi,p=bi;D(d,s,l),Re(m,ws,h);const f=be(m,d);if(f>A)return 0;if(c)return 1;const _=e.createContactEquation(n,t,r,i);he(_.normalA,m);const E=_.contactPointB;se(E,_.normalA,-A),Y(E,E,s),D(E,E,t.position);const x=_.contactPointA;return se(p,_.normalA,f),D(x,d,p),Y(x,x,l),D(x,x,n.position),e.contactEquations.push(_),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(_)),1}})());M(this,"convexConvex",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=0,d=bh,m=gh,p=fh,f=$n(m,i,s,a,r,l,h),_=m[0];if(_>A)return 0;const E=$n(p,r,l,h,i,s,a),x=p[0];if(x>A)return 0;let y,C,u,I,w,L,k,J,j;x>_?(y=r,C=i,k=n,J=t,u=l,w=h,I=s,L=a,j=E):(y=i,C=r,k=t,J=n,u=s,w=a,I=l,L=h,j=f);const q=wh;$h(q,y,u,w,j,C,I,L);const pe=y.vertices.length,ve=y.vertices,ee=j,Me=j+1<pe?j+1:0,P=Ih,V=xh;he(P,ve[ee]),he(V,ve[Me]);const G=mh;D(G,V,P),ze(G,G),Ga(vh,G,1);const qe=_h;Y(qe,P,V),se(qe,qe,.5);const Ye=Ch;Re(Ye,G,w);const Ce=yh;Ga(Ce,Ye,1),ke(P,P,u,w),ke(V,V,u,w);const Ge=be(Ce,P),rt=-be(Ye,P)+A,ri=be(Ye,V)+A,b=Bh,B=Sh;let S=0;const Q=Eh;if(se(Q,Ye,-1),S=eo(b,q,Q,rt),S<2||(S=eo(B,b,Ye,ri),S<2))return 0;let F=0;for(let X=0;X<Mh;++X){const ce=be(Ce,B[X])-Ge;if(ce<=A){if(c)return 1;++F;const te=e.createContactEquation(k,J,y,C);he(te.normalA,Ce),he(te.contactPointB,B[X]),D(te.contactPointB,te.contactPointB,J.position),se(d,Ce,-ce),Y(te.contactPointA,B[X],d),D(te.contactPointA,te.contactPointA,k.position),e.contactEquations.push(te),e.enableFriction&&!e.enableFrictionReduction&&e.frictionEquations.push(e.createFrictionFromContact(te))}}return F&&e.enableFrictionReduction&&e.enableFriction&&e.frictionEquations.push(e.createFrictionFromAverage(F)),F}})());M(this,"circleHeightfield",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c,A){c===void 0&&(c=!1),A===void 0&&(A=i.radius);const d=r.heights,m=r.elementWidth,p=Dh,f=Qh,_=Rh,E=Nh,x=Th,y=Ph,C=Lh;let u=Math.floor((s[0]-A-l[0])/m),I=Math.ceil((s[0]+A-l[0])/m);u<0&&(u=0),I>=d.length&&(I=d.length-1);let w=d[u],L=d[I];for(let J=u;J<I;J++)d[J]<L&&(L=d[J]),d[J]>w&&(w=d[J]);if(s[1]-A>w)return 0;let k=!1;for(let J=u;J<I;J++){le(y,J*m,d[J]),le(C,(J+1)*m,d[J+1]),Y(y,y,l),Y(C,C,l),D(x,C,y),Re(x,x,Math.PI/2),ze(x,x),se(f,x,-A),Y(f,f,s),D(p,f,y);const j=be(p,x);if(f[0]>=y[0]&&f[0]<C[0]&&j<=0){if(c)return 1;k=!0,se(p,x,-j),Y(_,f,p),he(E,x);const q=e.createContactEquation(n,t,r,i);he(q.normalA,E),se(q.contactPointB,q.normalA,-A),Y(q.contactPointB,q.contactPointB,s),D(q.contactPointB,q.contactPointB,t.position),he(q.contactPointA,_),D(q.contactPointA,q.contactPointA,n.position),e.contactEquations.push(q),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(q))}}if(k=!1,A>0){for(let J=u;J<=I;J++)if(le(y,J*m,d[J]),Y(y,y,l),D(p,s,y),Et(p)<Math.pow(A,2)){if(c)return 1;k=!0;const j=e.createContactEquation(n,t,r,i);he(j.normalA,p),ze(j.normalA,j.normalA),se(j.contactPointB,j.normalA,-A),Y(j.contactPointB,j.contactPointB,s),D(j.contactPointB,j.contactPointB,t.position),D(j.contactPointA,y,l),Y(j.contactPointA,j.contactPointA,l),D(j.contactPointA,j.contactPointA,n.position),e.contactEquations.push(j),e.enableFriction&&e.frictionEquations.push(e.createFrictionFromContact(j))}}return k?1:0}})());M(this,"convexHeightfield",(()=>{var e=this;return function(t,i,s,a,n,r,l,h,c){c===void 0&&(c=!1);const A=r.heights,d=r.elementWidth,m=eu,p=tu,f=iu,_=su;let E=Math.floor((t.aabb.lowerBound[0]-l[0])/d),x=Math.ceil((t.aabb.upperBound[0]-l[0])/d);E<0&&(E=0),x>=A.length&&(x=A.length-1);let y=A[E],C=A[x];for(let I=E;I<x;I++)A[I]<C&&(C=A[I]),A[I]>y&&(y=A[I]);if(t.aabb.lowerBound[1]>y)return 0;let u=0;for(let I=E;I<x;I++){le(m,I*d,A[I]),le(p,(I+1)*d,A[I+1]),Y(m,m,l),Y(p,p,l);const w=100;le(f,(p[0]+m[0])*.5,(p[1]+m[1]-w)*.5),D(_.vertices[0],p,f),D(_.vertices[1],m,f),he(_.vertices[2],_.vertices[1]),he(_.vertices[3],_.vertices[0]),_.vertices[2][1]-=w,_.vertices[3][1]-=w,_.updateNormals(),u+=e.convexConvex(t,i,s,a,n,_,f,0,c)}return u}})());M(this,"narrowphases",{[K.CONVEX|K.LINE]:this.convexLine,[K.LINE|K.BOX]:this.lineBox,[K.CONVEX|K.CAPSULE]:this.convexCapsule,[K.BOX|K.CAPSULE]:this.convexCapsule,[K.LINE|K.CAPSULE]:this.lineCapsule,[K.CAPSULE]:this.capsuleCapsule,[K.LINE]:this.lineLine,[K.PLANE|K.LINE]:this.planeLine,[K.PARTICLE|K.CAPSULE]:this.particleCapsule,[K.CIRCLE|K.LINE]:this.circleLine,[K.CIRCLE|K.CAPSULE]:this.circleCapsule,[K.CIRCLE|K.CONVEX]:this.circleConvex,[K.CIRCLE|K.BOX]:this.circleConvex,[K.PARTICLE|K.CONVEX]:this.particleConvex,[K.PARTICLE|K.BOX]:this.particleConvex,[K.CIRCLE]:this.circleCircle,[K.PLANE|K.CONVEX]:this.planeConvex,[K.PLANE|K.BOX]:this.planeConvex,[K.PARTICLE|K.PLANE]:this.particlePlane,[K.CIRCLE|K.PARTICLE]:this.circleParticle,[K.PLANE|K.CAPSULE]:this.planeCapsule,[K.CIRCLE|K.PLANE]:this.circlePlane,[K.CONVEX]:this.convexConvex,[K.CONVEX|K.BOX]:this.convexConvex,[K.BOX]:this.convexConvex,[K.CIRCLE|K.HEIGHTFIELD]:this.circleHeightfield,[K.BOX|K.HEIGHTFIELD]:this.convexHeightfield,[K.CONVEX|K.HEIGHTFIELD]:this.convexHeightfield});this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.contactEquationPool=new ch({size:32}),this.frictionEquationPool=new Ah({size:64}),this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new Os,this.currentContactMaterial=null}bodiesOverlap(e,t,i){const s=dh,a=ph;for(let n=0,r=e.shapes.length;n!==r;n++){const l=e.shapes[n];for(let h=0,c=t.shapes.length;h!==c;h++){const A=t.shapes[h];if(i&&!(l.collisionGroup&A.collisionMask&&A.collisionGroup&l.collisionMask))return!1;if(e.toWorldFrame(s,l.position),t.toWorldFrame(a,A.position),l.type<=A.type){if(this.narrowphases[l.type|A.type](e,l,s,l.angle+e.angle,t,A,a,A.angle+t.angle,!0))return!0}else if(this.narrowphases[l.type|A.type](t,A,a,A.angle+t.angle,e,l,s,l.angle+e.angle,!0))return!0}}return!1}collidedLastStep(e,t){const i=e.id|0,s=t.id|0;return!!this.collidingBodiesLastStep.get(i,s)}reset(){this.collidingBodiesLastStep.reset();const e=this.contactEquations;let t=e.length;for(;t--;){const a=e[t],n=a.bodyA.id,r=a.bodyB.id;this.collidingBodiesLastStep.set(n,r,!0)}const i=this.contactEquations,s=this.frictionEquations;for(let a=0;a<i.length;a++)this.contactEquationPool.release(i[a]);for(let a=0;a<s.length;a++)this.frictionEquationPool.release(s[a]);this.contactEquations.length=this.frictionEquations.length=0}createContactEquation(e,t,i,s){const a=this.contactEquationPool.get(),n=this.currentContactMaterial;return a.bodyA=e,a.bodyB=t,a.shapeA=i,a.shapeB=s,a.enabled=this.enabledEquations,a.firstImpact=!this.collidedLastStep(e,t),a.restitution=n.restitution,a.stiffness=n.stiffness,a.relaxation=n.relaxation,a.offset=n.contactSkinSize,a.needsUpdate=!0,a}createFrictionEquation(e,t,i,s){const a=this.frictionEquationPool.get(),n=this.currentContactMaterial;return a.bodyA=e,a.bodyB=t,a.shapeA=i,a.shapeB=s,a.setSlipForce(this.slipForce),a.enabled=this.enabledEquations,a.frictionCoefficient=n.friction,a.relativeVelocity=n.surfaceVelocity,a.stiffness=n.frictionStiffness,a.relaxation=n.frictionRelaxation,a.needsUpdate=!0,a.contactEquations.length=0,a}createFrictionFromContact(e){const t=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB);return he(t.contactPointA,e.contactPointA),he(t.contactPointB,e.contactPointB),mi(t.t,e.normalA),t.contactEquations.push(e),t}createFrictionFromAverage(e){let t=this.contactEquations[this.contactEquations.length-1];const i=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB),s=t.bodyA;le(i.contactPointA,0,0),le(i.contactPointB,0,0),le(i.t,0,0);for(let n=0;n!==e;n++)t=this.contactEquations[this.contactEquations.length-1-n],t.bodyA===s?(Y(i.t,i.t,t.normalA),Y(i.contactPointA,i.contactPointA,t.contactPointA),Y(i.contactPointB,i.contactPointB,t.contactPointB)):(D(i.t,i.t,t.normalA),Y(i.contactPointA,i.contactPointA,t.contactPointB),Y(i.contactPointB,i.contactPointB,t.contactPointA)),i.contactEquations.push(t);const a=1/e;return se(i.contactPointA,i.contactPointA,a),se(i.contactPointB,i.contactPointB,a),ze(i.t,i.t),mi(i.t,i.t),i}}const ws=ut(0,1),Vt=v(),hi=v(),bi=v(),zi=v(),qi=v(),Vi=v(),Ms=v(),Ba=v(),Yn=v(),jn=v(),Xn=v(),uh=v(),Sa=v(),wa=v(),Kn=v(),Jn=[],dh=v(),ph=v(),gh=v(),fh=v(),mh=v(),vh=v(),_h=v(),Ch=v(),yh=v(),Eh=v(),Ih=v(),xh=v(),bh=v(),Bh=[v(),v()],Sh=[v(),v()],wh=[v(),v()],Mh=2,Qh=v(),Dh=v(),Ph=v(),Lh=v(),Rh=v(),Th=v(),Nh=v();function Ma(o,e){const t=e.radius,i=e.length*.5,s=o.vertices;le(s[0],-i,-t),le(s[1],i,-t),le(s[2],i,t),le(s[3],-i,t)}const Fh=new en({width:1,height:1}),Uh=v(),Oh=v(),kh=v(),Gh=new en({width:1,height:1}),Hh=v(),er=v(),tr=v();function zh(o,e,t,i){const s=Hh,a=er,n=tr,r=e.vertices;let l=null;ni(s,o,t,i);for(let h=0,c=r.length;h!==c+1;h++){const A=r[h%c],d=r[(h+1)%c];D(a,A,s),D(n,d,s);const m=ht(a,n);if(l===null&&(l=m),m*l<0)return!1;l=m}return!0}function Zn(o,e,t,i){o[0]=e[0]+t[0]-i[0],o[1]=e[1]+t[1]-i[1]}function qh(o,e){const t=er,i=tr,s=e.vertices,a=s.length;let n=null;for(let r=0;r<a+1;r++){const l=s[r%a],h=s[(r+1)%a];D(t,l,o),D(i,h,o);const c=ht(t,i);if(n===null&&(n=c),c*n<0)return!1;n=c}return!0}const Vh=new hs({radius:1}),Wh=v(),Yh=v(),jh=v(),Xh=v(),Kh=v(),Jh=v();function $n(o,e,t,i,s,a,n){const r=e.vertices.length,l=s.vertices.length,h=e.normals,c=e.vertices,A=s.vertices,d=jh,m=Xh,p=Kh,f=Jh,_=i-n;let E=0,x=-Number.MAX_VALUE;for(let y=0;y<r;++y){Re(d,h[y],_),ke(f,c[y],t,i),ni(m,f,a,n);let C=Number.MAX_VALUE;for(let u=0;u<l;++u){D(p,A[u],m);const I=be(d,p);I<C&&(C=I)}C>x&&(x=C,E=y)}return o[0]=x,E}const Zh=v();function $h(o,e,t,i,s,a,n,r){const l=e.normals,h=a.vertices.length,c=a.vertices,A=a.normals,d=Zh;Re(d,l[s],i-r);let m=0,p=Number.MAX_VALUE;for(let E=0;E<h;++E){const x=be(d,A[E]);x<p&&(p=x,m=E)}const f=m,_=f+1<h?f+1:0;ke(o[0],c[f],n,r),ke(o[1],c[_],n,r)}function eo(o,e,t,i){let s=0;const a=be(t,e[0])-i,n=be(t,e[1])-i;if(a<=0&&he(o[s++],e[0]),n<=0&&he(o[s++],e[1]),a*n<0){const r=a/(a-n),l=o[s];D(l,e[1],e[0]),se(l,l,r),Y(l,l,e[0]),++s}return s}const eu=v(),tu=v(),iu=v(),su=new Kt({vertices:[v(),v(),v(),v()]});class au extends ss{constructor(){super(ss.SAP);M(this,"axisList",[]);M(this,"axisIndex",0);this.addBodyHandler=t=>{this.axisList.push(t.body)},this.removeBodyHandler=t=>{const i=this.axisList.indexOf(t.body);i!==-1&&this.axisList.splice(i,1)}}setWorld(t){this.axisList.length=0,Fs(this.axisList,t.bodies),t.off("addBody",this.addBodyHandler).off("removeBody",this.removeBodyHandler),t.on("addBody",this.addBodyHandler).on("removeBody",this.removeBodyHandler),this.world=t}sortList(){const t=this.axisList,i=this.axisIndex;nu(t,i)}getCollisionPairs(t){const i=this.axisList,s=this.result,a=this.axisIndex;s.length=0;let n=i.length;for(;n--;){const r=i[n];r.aabbNeedsUpdate&&r.updateAABB()}this.sortList();for(let r=0,l=i.length|0;r!==l;r++){const h=i[r];for(let c=r+1;c<l;c++){const A=i[c];if(!(A.aabb.lowerBound[a]<=h.aabb.upperBound[a]))break;ss.canCollide(h,A)&&this.boundingVolumeCheck(h,A)&&s.push(h,A)}}return s}aabbQuery(t,i,s){s===void 0&&(s=[]),this.sortList();const a=this.axisList;for(let n=0;n<a.length;n++){const r=a[n];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(i)&&s.push(r)}return s}}function nu(o,e){e=e|0;for(let t=1,i=o.length;t<i;t++){const s=o[t];let a;for(a=t-1;a>=0&&!(o[a].aabb.lowerBound[e]<=s.aabb.lowerBound[e]);a--)o[a+1]=o[a];o[a+1]=s}return o}const Xt=class Xt{constructor(e,t,i,s){i===void 0&&(i=Xt.OTHER),s===void 0&&(s={}),this.type=i,this.equations=[],this.bodyA=e,this.bodyB=t,this.collideConnected=s.collideConnected??!0,s.wakeUpBodies!==!1&&(e&&e.wakeUp(),t&&t.wakeUp())}update(){throw new Error("method update() not implemented in this Constraint subclass!")}setStiffness(e){const t=this.equations;for(let i=0;i!==t.length;i++){const s=t[i];s.stiffness=e,s.needsUpdate=!0}}setRelaxation(e){const t=this.equations;for(let i=0;i!==t.length;i++){const s=t[i];s.relaxation=e,s.needsUpdate=!0}}setMaxBias(e){const t=this.equations;for(let i=0;i!==t.length;i++){const s=t[i];s.maxBias=e}}};M(Xt,"OTHER",-1),M(Xt,"DISTANCE",1),M(Xt,"GEAR",2),M(Xt,"LOCK",3),M(Xt,"PRISMATIC",4),M(Xt,"REVOLUTE",5);let Vs=Xt;v();v();v();v();v();v();ut(1,0);ut(0,1);class to extends xt{constructor(e,t,i){i===void 0&&(i={}),super(e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;const s=this.G;s[2]=1,s[5]=-1}computeGq(){return Re(io,ou,this.bodyA.angle+this.angle),Re(so,ru,this.bodyB.angle),be(io,so)}}const io=v(),so=v(),ou=ut(1,0),ru=ut(0,1);v();v();v();v();v();v();class lu extends xt{constructor(e,t){super(e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}computeB(e,t,i){const s=this.G;s[2]=-1,s[5]=this.ratio;const a=this.computeGiMf();return-this.computeGW()*t-i*a}}class ao extends Vs{get motorEnabled(){return this.motorEquation.enabled}set motorEnabled(e){this.motorEquation.enabled=e}get motorSpeed(){return this.motorEquation.relativeVelocity}set motorSpeed(e){this.motorEquation.relativeVelocity=e}get motorMaxForce(){return this.motorEquation.maxForce}set motorMaxForce(e){const t=this.motorEquation;t.maxForce=e,t.minForce=-e}constructor(e,t,i){i===void 0&&(i={}),super(e,t,Vs.REVOLUTE,i);const s=this.maxForce=i.maxForce??Number.MAX_VALUE,a=this.pivotA=v(),n=this.pivotB=v();i.worldPivot?(D(a,i.worldPivot,e.position),D(n,i.worldPivot,t.position),Re(a,a,-e.angle),Re(n,n,-t.angle)):(i.localPivotA&&he(a,i.localPivotA),i.localPivotB&&he(n,i.localPivotB));const r=this.motorEquation=new lu(e,t);r.enabled=!1;const l=this.upperLimitEquation=new to(e,t),h=this.lowerLimitEquation=new to(e,t);l.minForce=h.maxForce=0;const c=this.equations=[new xt(e,t,-s,s),new xt(e,t,-s,s),r,l,h],A=c[0],d=c[1];A.computeGq=function(){return Re(ui,a,e.angle),Re(di,n,t.angle),Y(vt,t.position,di),D(vt,vt,e.position),D(vt,vt,ui),be(vt,Qa)},d.computeGq=function(){return Re(ui,a,e.angle),Re(di,n,t.angle),Y(vt,t.position,di),D(vt,vt,e.position),D(vt,vt,ui),be(vt,Da)},d.minForce=A.minForce=-s,d.maxForce=A.maxForce=s,A.G[0]=-1,A.G[1]=0,A.G[3]=1,A.G[4]=0,d.G[0]=0,d.G[1]=-1,d.G[3]=0,d.G[4]=1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0}setLimits(e,t){this.lowerLimit=e,this.upperLimit=t,this.lowerLimitEnabled=this.upperLimitEnabled=!0}update(){const e=this.bodyA,t=this.bodyB,i=this.pivotA,s=this.pivotB,a=this.equations,n=a[0],r=a[1],l=this.upperLimit,h=this.lowerLimit,c=this.upperLimitEquation,A=this.lowerLimitEquation,d=this.angle=t.angle-e.angle;c.angle=l,c.enabled=this.upperLimitEnabled&&d>l,A.angle=h,A.enabled=this.lowerLimitEnabled&&d<h,Re(ui,i,e.angle),Re(di,s,t.angle);const m=n.G;m[2]=-ht(ui,Qa),m[5]=ht(di,Qa);const p=r.G;p[2]=-ht(ui,Da),p[5]=ht(di,Da)}enableMotor(){console.warn("revolute.enableMotor() is deprecated, do revolute.motorEnabled = true; instead."),this.motorEnabled=!0}disableMotor(){console.warn("revolute.disableMotor() is deprecated, do revolute.motorEnabled = false; instead."),this.motorEnabled=!1}motorIsEnabled(){return console.warn("revolute.motorIsEnabled() is deprecated, use revolute.motorEnabled instead."),this.motorEnabled}setMotorSpeed(e){console.warn("revolute.setMotorSpeed(speed) is deprecated, do revolute.motorSpeed = speed; instead."),this.motorSpeed=e}getMotorSpeed(){return console.warn("revolute.getMotorSpeed() is deprecated, use revolute.motorSpeed instead."),this.motorSpeed}}const ui=v(),di=v(),Qa=ut(1,0),Da=ut(0,1),vt=v(),js=class js{constructor(){this.id=js.idCounter++}};M(js,"idCounter",0);let Li=js;const Xs=class Xs{constructor(e,t,i){if(i===void 0&&(i={}),!(e instanceof Li)||!(t instanceof Li))throw new Error("First two arguments must be Material instances.");this.id=Xs.idCounter++,this.materialA=e,this.materialB=t,this.friction=i.friction??.3,this.restitution=i.restitution??0,this.stiffness=i.stiffness??xt.DEFAULT_STIFFNESS,this.relaxation=i.relaxation??xt.DEFAULT_RELAXATION,this.frictionStiffness=i.frictionStiffness??xt.DEFAULT_STIFFNESS,this.frictionRelaxation=i.frictionRelaxation??xt.DEFAULT_RELAXATION,this.surfaceVelocity=i.surfaceVelocity??0,this.contactSkinSize=.005}};M(Xs,"idCounter",0);let Ws=Xs;v();v();v();v();v();v();v();v();v();v();v();v();v();v();v();v();v();ut(0,1);v(),v(),v(),v();v();v();v();v();v();class ir extends K{constructor(e){e===void 0&&(e={});const t={length:1,...e,type:K.LINE};super(t),this.length=t.length,this.updateBoundingRadius(),this.updateArea()}computeMomentOfInertia(){return Math.pow(this.length,2)/12}updateBoundingRadius(){this.boundingRadius=this.length/2}computeAABB(e,t,i){const s=this.length/2;le(Pa[0],-s,0),le(Pa[1],s,0),e.setFromPoints(Pa,t,i,0)}raycast(e,t,i,s){const a=t.from,n=t.to,r=Au,l=hu,h=this.length/2;le(r,-h,0),le(l,h,0),ke(r,r,i,s),ke(l,l,i,s);const c=Yo(a,n,r,l);if(c>=0){const A=cu;Re(A,uu,s),t.reportIntersection(e,c,A,-1)}}}const Pa=[v(),v()],cu=v(),Au=v(),hu=v(),uu=ut(0,1);v();v();v();class La{constructor(e,t){e===void 0&&(e={}),this.type=t,this.equations=[],this.equationSortFunction=e.equationSortFunction}sortEquations(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)}addEquation(e){e.enabled&&this.equations.push(e)}addEquations(e){for(let t=0,i=e.length;t!==i;t++){const s=e[t];s.enabled&&this.equations.push(s)}}removeEquation(e){const t=this.equations.indexOf(e);t!==-1&&this.equations.splice(t,1)}removeAllEquations(){this.equations.length=0}}class du extends La{constructor(t){t===void 0&&(t={});super(t,La.GS);M(this,"type",La.GS);this.iterations=t.iterations??10,this.tolerance=t.tolerance??1e-7,this.frictionIterations=t.frictionIterations??0,this.usedIterations=0}solve(t,i){this.sortEquations();let s=0;const a=this.iterations,n=this.frictionIterations,r=this.equations,l=r.length,h=Math.pow(this.tolerance*l,2),c=i.bodies,A=c.length;if(this.usedIterations=0,l)for(let _=0;_!==A;_++)c[_].updateSolveMassProperties();for(let _=0;_!==l;_++){const E=r[_];E.lambda=0,(E.timeStep!==t||E.needsUpdate)&&(E.timeStep=t,E.update()),E.B=E.computeB(E.a,E.b,t),E.invC=E.computeInvC(E.epsilon),E.maxForceDt=E.maxForce*t,E.minForceDt=E.minForce*t}let d,m,p,f;if(l!==0){for(p=0;p!==A;p++)c[p].resetConstraintVelocity();if(n){for(s=0;s!==n;s++){for(m=0,f=0;f!==l;f++){d=r[f];const _=oo(d);m+=Math.abs(_)}if(this.usedIterations++,m*m<=h)break}for(no(r,1/t),f=0;f!==l;f++){const _=r[f];if(_ instanceof $o){let E=0;for(let x=0;x!==_.contactEquations.length;x++)E+=_.contactEquations[x].multiplier;E*=_.frictionCoefficient/_.contactEquations.length,_.maxForce=E,_.minForce=-E,_.maxForceDt=E*t,_.minForceDt=-E*t}}}for(s=0;s!==a;s++){for(m=0,f=0;f!==l;f++){d=r[f];const _=oo(d);m+=Math.abs(_)}if(this.usedIterations++,m*m<h)break}for(p=0;p!==A;p++)c[p].addConstraintVelocity();no(r,1/t)}}}function no(o,e){let t=o.length;for(;t--;){const i=o[t];i.multiplier=i.lambda*e}}function oo(o){const e=o.B,t=o.epsilon,i=o.invC,s=o.lambda,a=o.computeGWlambda(),n=o.maxForceDt,r=o.minForceDt;let l=i*(e-a-t*s);const h=s+l;return h<r?l=r-s:h>n&&(l=n-s),o.lambda+=l,o.addToWlambda(l),l}class pu{constructor(e,t,i,s){this.bodyA=e,this.shapeA=t,this.bodyB=i,this.shapeB=s}set(e,t,i,s){this.bodyA=e,this.shapeA=t,this.bodyB=i,this.shapeB=s}}class gu extends tn{create(){return new pu(Ta,Ra,Ta,Ra)}destroy(e){return e.bodyA=e.bodyB=Ta,e.shapeA=e.shapeB=Ra,this}}const Ra=new hs({radius:1}),Ta=new fe;class fu{constructor(){this.overlappingShapesLastState=new Os,this.overlappingShapesCurrentState=new Os,this.recordPool=new gu({size:16}),this.tmpDict=new Os,this.tmpArray1=[]}tick(){const e=this.overlappingShapesLastState,t=this.overlappingShapesCurrentState;let i=e.keys.length;for(;i--;){const s=e.keys[i],a=e.getByKey(s);a&&this.recordPool.release(a)}e.copy(t),t.reset()}bodiesAreOverlapping(e,t){const i=this.overlappingShapesCurrentState;let s=i.keys.length;for(;s--;){const a=i.keys[s],n=i.data[a];if(n.bodyA===e&&n.bodyB===t||n.bodyA===t&&n.bodyB===e)return!0}return!1}setOverlapping(e,t,i,s){const a=this.overlappingShapesCurrentState;if(!a.get(t.id,s.id)){const n=this.recordPool.get();n.set(e,t,i,s),a.set(t.id,s.id,n)}}getNewOverlaps(e){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,e)}getEndOverlaps(e){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,e)}getDiff(e,t,i){i===void 0&&(i=[]);const s=e,a=t;i.length=0;let n=a.keys.length;for(;n--;){const r=a.keys[n],l=a.data[r];if(!l)throw new Error("Key "+r+" had no data!");s.data[r]||i.push(l)}return i}isNewOverlap(e,t){const i=e.id|0,s=t.id|0,a=this.overlappingShapesLastState,n=this.overlappingShapesCurrentState;return!a.get(i,s)&&!!n.get(i,s)}getNewBodyOverlaps(e){this.tmpArray1.length=0;const t=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)}getEndBodyOverlaps(e){this.tmpArray1.length=0;const t=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)}getBodyDiff(e,t){t===void 0&&(t=[]);const i=this.tmpDict;let s=e.length;for(;s--;){const a=e[s];i.set(a.bodyA.id|0,a.bodyB.id|0,a)}for(s=i.keys.length;s--;){const a=i.getByKey(i.keys[s]);a&&t.push(a.bodyA,a.bodyB)}return i.reset(),t}}class mu{constructor(e){M(this,"id",[]);M(this,"sz",[]);this.size=e,this.count=e,this.resize(e)}resize(e){this.count=this.size=e;const t=this.sz,i=this.id;for(let s=0;s<e;s++)i[s]=s,t[s]=1}find(e){const t=this.id;for(;e!==t[e];)t[e]=t[t[e]],e=t[e];return e}union(e,t){const i=this.find(e),s=this.find(t);if(i===s)return;const a=this.sz,n=this.id;a[i]<a[s]?(n[i]=s,a[s]+=a[i]):(n[s]=i,a[i]+=a[s]),this.count--}}const ii=class ii extends Zo{constructor(t){t===void 0&&(t={});super();M(this,"springs",[]);M(this,"bodies",[]);M(this,"hasActiveBodies",!1);M(this,"narrowphase",new hh);M(this,"useWorldGravityAsFrictionGravity",!0);M(this,"useFrictionGravityOnZeroGravity",!0);M(this,"constraints",[]);M(this,"lastTimeStep",1/60);M(this,"applySpringForces",!0);M(this,"applyDamping",!0);M(this,"applyGravity",!0);M(this,"solveConstraints",!0);M(this,"contactMaterials",[]);M(this,"time",0);M(this,"accumulator",0);M(this,"stepping",!1);M(this,"emitImpactEvent",!0);M(this,"sleepMode",ii.NO_SLEEPING);M(this,"overlapKeeper",new fu);M(this,"disabledBodyCollisionPairs",[]);M(this,"unionFind",new mu(1));this.solver=t.solver||new du,this.gravity=ut(0,-9.78),t.gravity&&he(this.gravity,t.gravity),this.frictionGravity=ns(this.gravity)||10,this.broadphase=t.broadphase||new au,this.broadphase.setWorld(this),this.defaultMaterial=new Li,this.defaultContactMaterial=new Ws(this.defaultMaterial,this.defaultMaterial),this.islandSplit=t.islandSplit??!0}addConstraint(t){if(this.stepping)throw new Error("Constraints cannot be added during step.");const i=this.bodies;if(i.indexOf(t.bodyA)===-1)throw new Error("Cannot add Constraint: bodyA is not added to the World.");if(i.indexOf(t.bodyB)===-1)throw new Error("Cannot add Constraint: bodyB is not added to the World.");this.constraints.push(t)}addContactMaterial(t){this.contactMaterials.push(t)}removeContactMaterial(t){ys(this.contactMaterials,t)}getContactMaterial(t,i){const s=this.contactMaterials;for(let a=0,n=s.length;a!==n;a++){const r=s[a];if(r.materialA===t&&r.materialB===i||r.materialA===i&&r.materialB===t)return r}return!1}removeConstraint(t){if(this.stepping)throw new Error("Constraints cannot be removed during step.");ys(this.constraints,t)}step(t,i,s){if(s===void 0&&(s=10),i===void 0)this.internalStep(t),this.time+=t;else{this.accumulator+=i;let a=0;for(;this.accumulator>=t&&a<s;)this.internalStep(t),this.time+=t,this.accumulator-=t,a++;const n=this.accumulator%t/t;for(let r=0;r!==this.bodies.length;r++){const l=this.bodies[r];es(l.interpolatedPosition,l.previousPosition,l.position,n),l.interpolatedAngle=l.previousAngle+n*(l.angle-l.previousAngle)}}}internalStep(t){this.stepping=!0;const i=this.springs.length,s=this.springs,a=this.bodies,n=this.gravity,r=this.solver,l=this.bodies.length,h=this.broadphase,c=this.narrowphase,A=this.constraints,d=yu,m=Y;if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){const C=ns(this.gravity);C===0&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=C)}if(this.applyGravity)for(let C=0;C!==l;C++){const u=a[C],I=u.force;u.type!==fe.DYNAMIC||u.sleepState===fe.SLEEPING||(se(d,n,u.mass*u.gravityScale),m(I,I,d))}if(this.applySpringForces)for(let C=0;C!==i;C++)s[C].applyForce();if(this.applyDamping)for(let C=0;C!==l;C++){const u=a[C];u.type===fe.DYNAMIC&&u.applyDamping(t)}const p=h.getCollisionPairs(this),f=this.disabledBodyCollisionPairs;for(let C=f.length-2;C>=0;C-=2)for(let u=p.length-2;u>=0;u-=2)(f[C]===p[u]&&f[C+1]===p[u+1]||f[C+1]===p[u]&&f[C]===p[u+1])&&p.splice(u,2);let _=A.length;for(let C=0;C!==_;C++){const u=A[C];if(!u.collideConnected)for(let I=p.length-2;I>=0;I-=2)(u.bodyA===p[I]&&u.bodyB===p[I+1]||u.bodyB===p[I]&&u.bodyA===p[I+1])&&p.splice(I,2)}this.emit({type:"postBroadphase",pairs:p}),c.reset();const E=this.defaultContactMaterial,x=this.frictionGravity;for(let C=0,u=p.length;C!==u;C+=2){const I=p[C],w=p[C+1];for(let L=0,k=I.shapes.length;L!==k;L++){const J=I.shapes[L],j=J.position,q=J.angle;for(let pe=0,ve=w.shapes.length;pe!==ve;pe++){const ee=w.shapes[pe],Me=ee.position,P=ee.angle;let V=!1;J.material&&ee.material&&(V=this.getContactMaterial(J.material,ee.material)),Cu(this,c,I,J,j,q,w,ee,Me,P,V||E,x)}}}for(let C=0;C!==l;C++){const u=a[C];u._wakeUpAfterNarrowphase&&(u.wakeUp(),u._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(Ps);let C=Ps.length;for(;C--;){const u=Ps[C],I={type:"endContact",shapeA:u.shapeA,shapeB:u.shapeB,bodyA:u.bodyA,bodyB:u.bodyB};this.emit(I)}Ps.length=0}this.emit({type:"preSolve",contactEquations:c.contactEquations,frictionEquations:c.frictionEquations}),_=A.length;for(let C=0;C!==_;C++)A[C].update();if(c.contactEquations.length||c.frictionEquations.length||_){let C=[];Fs(C,c.contactEquations),Fs(C,c.frictionEquations);for(let u=0;u!==_;u++)Fs(C,A[u].equations);if(this.islandSplit){const u=this.unionFind;u.resize(this.bodies.length+1);for(let w=0;w<C.length;w++)C[w].index=w;for(let w=0;w<C.length;w++){const L=C[w].bodyA,k=C[w].bodyB;L.type===fe.DYNAMIC&&k.type===fe.DYNAMIC&&u.union(L.index,k.index)}for(let w=0;w<a.length;w++){const L=a[w];L.islandId=L.type===fe.DYNAMIC?u.find(L.index):-1}C=C.sort(_u);let I=0;for(;I<C.length;){const w=C[I++];r.addEquation(w);const L=w.bodyA.islandId>0?w.bodyA.islandId:w.bodyB.islandId;let k=-1;C[I]&&(k=C[I].bodyA.islandId>0?C[I].bodyA.islandId:C[I].bodyB.islandId),(k!==L||I===C.length)&&(this.solveConstraints&&r.solve(t,this),r.removeAllEquations())}}else r.addEquations(C),this.solveConstraints&&r.solve(t,this),r.removeAllEquations()}for(let C=0;C!==l;C++){const u=a[C];(u.type===fe.DYNAMIC||u.type===fe.KINEMATIC)&&u.integrate(t)}for(let C=0;C!==l;C++)a[C].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(let C=0;C!==c.contactEquations.length;C++){const u=c.contactEquations[C];u.firstImpact&&this.emit({type:"impact",bodyA:u.bodyA,bodyB:u.bodyB,shapeA:u.shapeA,shapeB:u.shapeB,contactEquation:u})}let y=!0;if(this.sleepMode===ii.BODY_SLEEPING){y=!1;for(let C=0;C!==l;C++){const u=a[C];u.sleepTick(this.time,!1,t),u.sleepState!==fe.SLEEPING&&u.type!==fe.STATIC&&(y=!0)}}else if(this.sleepMode===ii.ISLAND_SLEEPING&&this.islandSplit){for(let I=0;I!==l;I++)a[I].sleepTick(this.time,!0,t);const C=a.sort(vu);let u=1;for(let I=0;I<C.length;I=u){const w=C[I].islandId;for(u=I+1;u<C.length&&C[u].islandId===w;u++);if(w===-1)continue;let L=!0;for(let k=I;k<u;k++)if(!C[k].wantsToSleep){L=!1;break}if(L)for(let k=I;k<u;k++)C[k].sleep()}y=!1;for(let I=0;I!==l;I++){const w=a[I];if(w.sleepState!==fe.SLEEPING&&w.type!==fe.STATIC){y=!0;break}}}this.hasActiveBodies=y,this.stepping=!1,this.emit({type:"postStep"})}addSpring(t){if(this.stepping)throw new Error("Springs cannot be added during step.");this.springs.push(t),this.emit({type:"addSpring",spring:t})}removeSpring(t){if(this.stepping)throw new Error("Springs cannot be removed during step.");ys(this.springs,t),this.emit({type:"removeSpring",spring:t})}addBody(t){if(this.stepping)throw new Error("Bodies cannot be added during step.");if(t.world)throw new Error("Body is already added to a World.");t.index=this.bodies.length,this.bodies.push(t),t.world=this,this.emit({type:"addBody",body:t})}removeBody(t){if(this.stepping)throw new Error("Bodies cannot be removed during step.");const i=this.constraints;let s=i.length;for(;s--;)if(i[s].bodyA===t||i[s].bodyB===t)throw new Error("Cannot remove Body from World: it still has constraints connected to it.");t.world=null;const a=this.bodies;for(ys(a,t),t.index=-1,s=a.length;s--;)a[s].index=s;t.resetConstraintVelocity(),this.emit({type:"removeBody",body:t});const n=this.disabledBodyCollisionPairs;let r=0;for(;r<n.length;)n[r]===t||n[r+1]===t?n.splice(r,2):r+=2}getBodyByID(t){const i=this.bodies;for(let s=0;s<i.length;s++){const a=i[s];if(a.id===t)return a}return!1}disableBodyCollision(t,i){this.disabledBodyCollisionPairs.push(t,i)}enableBodyCollision(t,i){const s=this.disabledBodyCollisionPairs;for(let a=0;a<s.length;a+=2)if(s[a]===t&&s[a+1]===i||s[a+1]===t&&s[a]===i){s.splice(a,2);return}}clear(){this.solver.removeAllEquations();const t=this.constraints;let i=t.length;for(;i--;)this.removeConstraint(t[i]);const s=this.bodies;for(i=s.length;i--;)this.removeBody(s[i]);const a=this.springs;for(i=a.length;i--;)this.removeSpring(a[i]);const n=this.contactMaterials;for(i=n.length;i--;)this.removeContactMaterial(n[i])}hitTest(t,i,s){s===void 0&&(s=0);const a=Eu,n=Iu,r=[];for(let l=0,h=i.length;l!==h;l++){const c=i[l];for(let A=0,d=c.shapes.length;A!==d;A++){const m=c.shapes[A];m.worldPointToLocal(n,t),m.pointTest(n)?r.push(c):(Re(a,m.position,c.angle),Y(a,a,c.position),m.type===K.PARTICLE&&Za(a,t)<s*s&&r.push(c))}}return r}setGlobalStiffness(t){this.setGlobalEquationParameters({stiffness:t});const i=this.contactMaterials;for(let a=0;a!==i.length;a++){const n=i[a];n.stiffness=n.frictionStiffness=t}const s=this.defaultContactMaterial;s.stiffness=s.frictionStiffness=t}setGlobalRelaxation(t){this.setGlobalEquationParameters({relaxation:t});for(let s=0;s!==this.contactMaterials.length;s++){const a=this.contactMaterials[s];a.relaxation=a.frictionRelaxation=t}const i=this.defaultContactMaterial;i.relaxation=i.frictionRelaxation=t}raycast(t,i){return i.getAABB(ro),this.broadphase.aabbQuery(this,ro,Na),i.intersectBodies(t,Na),Na.length=0,t.hasHit()}setGlobalEquationParameters(t){const i=this.constraints;for(let s=0;s!==i.length;s++){const n=i[s].equations;for(let r=0;r!==n.length;r++){const l=n[r];l.relaxation=t.relaxation??l.relaxation,l.stiffness=t.stiffness??l.stiffness,l.needsUpdate=!0}}}};M(ii,"NO_SLEEPING",1),M(ii,"BODY_SLEEPING",2),M(ii,"ISLAND_SLEEPING",4);let Ys=ii;function vu(o,e){return o.islandId-e.islandId}function _u(o,e){const t=o.bodyA.islandId>0?o.bodyA.islandId:o.bodyB.islandId,i=e.bodyA.islandId>0?e.bodyA.islandId:e.bodyB.islandId;return t!==i?t-i:o.index-e.index}function Cu(o,e,t,i,s,a,n,r,l,h,c,A){if(!(i.collisionGroup&r.collisionMask&&r.collisionGroup&i.collisionMask)||(ke(Qs,s,t.position,t.angle),ke(Ds,l,n.position,n.angle),Ja(Qs,Ds)>i.boundingRadius+r.boundingRadius))return;const d=a+t.angle,m=h+n.angle;e.enableFriction=c.friction>0;let p;t.type===fe.STATIC||t.type===fe.KINEMATIC?p=n.mass:n.type===fe.STATIC||n.type===fe.KINEMATIC?p=t.mass:p=t.mass*n.mass/(t.mass+n.mass),e.slipForce=c.friction*A*p,e.currentContactMaterial=c,e.enabledEquations=t.collisionResponse&&n.collisionResponse&&i.collisionResponse&&r.collisionResponse;const f=e.narrowphases[i.type|r.type];let _=0;if(f){const E=i.sensor||r.sensor,x=e.frictionEquations.length;i.type<r.type?_=f.call(e,t,i,Qs,d,n,r,Ds,m,E):_=f.call(e,n,r,Ds,m,t,i,Qs,d,E);const y=e.frictionEquations.length-x;if(_){if(t.allowSleep&&t.type===fe.DYNAMIC&&t.sleepState===fe.SLEEPING&&n.sleepState===fe.AWAKE&&n.type!==fe.STATIC){const C=Et(n.velocity)+Math.pow(n.angularVelocity,2),u=Math.pow(n.sleepSpeedLimit,2);C>=u*2&&(t._wakeUpAfterNarrowphase=!0)}if(n.allowSleep&&n.type===fe.DYNAMIC&&n.sleepState===fe.SLEEPING&&t.sleepState===fe.AWAKE&&t.type!==fe.STATIC){const C=Et(t.velocity)+Math.pow(t.angularVelocity,2),u=Math.pow(t.sleepSpeedLimit,2);C>=u*2&&(n._wakeUpAfterNarrowphase=!0)}if(o.overlapKeeper.setOverlapping(t,i,n,r),o.has("beginContact")&&o.overlapKeeper.isNewOverlap(i,r)){const C=[];if(!E)for(let u=e.contactEquations.length-_;u<e.contactEquations.length;u++)C.push(e.contactEquations[u]);o.emit({type:"beginContact",shapeA:i,shapeB:r,bodyA:t,bodyB:n,contactEquations:C})}if(!E&&y>1)for(let C=e.frictionEquations.length-y;C<e.frictionEquations.length;C++){const u=e.frictionEquations[C];u.setSlipForce(u.getSlipForce()/y)}}}}const ro=new $a,Na=[],yu=v(),Qs=v(),Ds=v(),Ps=[],Eu=v(),Iu=v(),Ie={world:{gravity:{x:0,y:-9.82},iterations:20,tolerance:.001,fixedTimeStep:1/180,maxSubSteps:10,deltaTimeRatio:1200},materials:{bumperRestitution:.9,bumperHubRestitution:.95,slingshotRestitution:1},ballBody:{mass:1.1,radius:.115,position:{x:-2.27,y:-4.35},velocity:{x:0,y:0},damping:.1,angularDamping:.9,maxVelocity:12,loseBallThreshold:-4.6},flippers:{mass:1,top:{limits:{min:Math.PI/4-.25,max:Math.PI/1.25},position:{x:1.58,y:.15},keyUpMotorSpeed:40,keyDownMotorSpeed:-40},left:{limits:{min:Math.PI/3,max:Math.PI/1.5},position:{x:.75,y:-3.13},keyUpMotorSpeed:10,keyDownMotorSpeed:-40},right:{limits:{min:-Math.PI/1.5,max:-Math.PI/3},position:{x:-.75,y:-3.13},keyUpMotorSpeed:-10,keyDownMotorSpeed:40}}};class xu{constructor(e={}){this._eventDispatcher=e.eventDispatcher,this._debug=e.debugFolder||this.$debugger,this._scene=e.scene,this._playfieldData=e.playfieldData,this._gameManager=e.gameManager,this._bindAll(),this._sensorsState={launcherPassed:!1,holeRampPassed:!1,lipsRampPassed:!1,leftSlingshotPassed:!1,rightSlingshotPassed:!1,losePassed:!1,isBallOnLauncher:!1},this._launchSpeed=0,this._colliderName=null,this._colliderGroupObjects={},this._rotateSensors={},this._world=this._createWorld(),this._createPhysicsContact(),this._ballMaterial=this._createMaterial(),this._ballBody=this._createBallBody(),this._bumperMaterial=this._createMaterial(),this._rotateSensorMaterial=this._createMaterial(),this._bumperHubMaterial=this._createMaterial(),this._slingshotMaterial=this._createMaterial(),this._flipperMaterial=this._createMaterial();for(let t=0;t<this._playfieldData.shapes.length;t++){const i=this._playfieldData.shapes[t];if(i.points)this._createSegmentsFromPoints(i.points,i.customData);else{const s=i.customData.colliderType==="flipper"?Ie.flippers.mass:0;if(i.customData.colliderType==="rotateSensor"){const a=this._createCustomShape(i.vertices,i.customData,1);this._createRotationSensor({body:a,position:{x:1.95,y:-.45}})}else{const a=this._createCustomShape(i.vertices,i.customData,s);i.customData.colliderType==="flipper"&&(i.customData.colliderName==="topFlipper"?this._topFlipper=this._createFlipper({body:a,...Ie.flippers.top}):i.customData.colliderName==="leftFlipper"?this._leftFlipper=this._createFlipper({body:a,...Ie.flippers.left}):i.customData.colliderName==="rightFlipper"&&(this._rightFlipper=this._createFlipper({body:a,...Ie.flippers.right})))}}}this._rotateSensorsMaterial=this._createContactMaterial(this._rotateSensorMaterial,this._ballMaterial,{friction:.01,restitution:0}),this._contactBumperMaterial=this._createContactMaterial(this._bumperMaterial,this._ballMaterial,{restitution:Ie.materials.bumperRestitution,stiffness:Number.MAX_VALUE}),this._contactBumperHubMaterial=this._createContactMaterial(this._bumperHubMaterial,this._ballMaterial,{restitution:Ie.materials.bumperHubRestitution,stiffness:Number.MAX_VALUE}),this._contactSlingshotMaterial=this._createContactMaterial(this._slingshotMaterial,this._ballMaterial,{restitution:Ie.materials.slingshotRestitution,stiffness:Number.MAX_VALUE}),this._contactFlipperMaterial=this._createContactMaterial(this._flipperMaterial,this._ballMaterial,{restitution:0,stiffness:1e7,friction:1,restitutionThreshold:1}),this._debugFolder=this._createDebugFolder()}get world(){return this._world}get ballBody(){return this._ballBody}get topFlipper(){return this._topFlipper}get leftFlipper(){return this._leftFlipper}get rightFlipper(){return this._rightFlipper}get mirror(){return this._rotateSensors.mirror}get sensorsState(){return this._sensorsState}destroy(){this._world.clear(),this._world=null,this._ballBody=null,this._topFlipper=null,this._leftFlipper=null,this._rightFlipper=null,this._rotateSensors=null,this._colliderGroupObjects=null,this._sensorsState=null,this._rotateSensors=null,this._eventDispatcher=null}keyDown(e){e==="left"&&(this._leftFlipper.revoluteConstraint.motorSpeed=Ie.flippers.left.keyDownMotorSpeed,this._topFlipper.revoluteConstraint.motorSpeed=Ie.flippers.top.keyDownMotorSpeed),e==="right"&&(this._rightFlipper.revoluteConstraint.motorSpeed=Ie.flippers.right.keyDownMotorSpeed)}keyUp(e){e==="left"&&(this._leftFlipper.revoluteConstraint.motorSpeed=Ie.flippers.left.keyUpMotorSpeed,this._topFlipper.revoluteConstraint.motorSpeed=Ie.flippers.top.keyUpMotorSpeed),e==="right"&&(this._rightFlipper.revoluteConstraint.motorSpeed=Ie.flippers.right.keyUpMotorSpeed)}updateLaunchSpeed(){this._launchSpeed=Ct(this._launchSpeed+.005,0,1)}launchBall(){this._ballBody.mass=Ie.ballBody.mass;const e=Ct(3e4*this._launchSpeed,3e3,3200);this._ballBody.applyForce([0,e]),this._sensorsState.isBallOnLauncher=!1}launchBallDebug(){this._ballBody.mass=1,this._ballBody.applyForce([0,1e3])}ballReset(){this._sensorsState.launcherPassed=!1,this._sensorsState.holeRampPassed=!1,this._sensorsState.lipsRampPassed=!1,this._sensorsState.leftSlingshotPassed=!1,this._sensorsState.rightSlingshotPassed=!1,this._sensorsState.isBallOnLauncher=!0,this._ballBody.mass=0,this._ballBody.angularVelocity=0,this._ballBody.angle=0,this._ballBody.velocity=[Ie.ballBody.velocity.x,Ie.ballBody.velocity.y],this._ballBody.position=[Ie.ballBody.position.x,Ie.ballBody.position.y],this._launchSpeed=0,R.to(this._rotateSensors.mirror,{duration:1.5,angle:0,ease:"power3.inOut"}),this._setCollisionGroupAndMask(["launcherRampLowspeed"],2,1),this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2","holeRampEnter","holeRampLeave","launcherRampHighspeed","slingshotRight","slingshotLeft"],0,0)}ballLose(){this._sensorsState.launcherPassed=!1,this._sensorsState.holeRampPassed=!1,this._sensorsState.lipsRampPassed=!1,this._sensorsState.leftSlingshotPassed=!1,this._sensorsState.rightSlingshotPassed=!1,this._sensorsState.isBallOnLauncher=!0,this._ballBody.mass=0,this._ballBody.angularVelocity=0,this._ballBody.angle=0,this._ballBody.velocity=[Ie.ballBody.velocity.x,Ie.ballBody.velocity.y],this._ballBody.position=[Ie.ballBody.position.x,Ie.ballBody.position.y],this._launchSpeed=0,R.to(this._rotateSensors.mirror,{duration:1.5,angle:0,ease:"power3.inOut"}),this._eventDispatcher.dispatchEvent("ball:lose",{}),this._scene.ballLose(),this._setCollisionGroupAndMask(["launcherRampLowspeed"],2,1),this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2","holeRampEnter","holeRampLeave","launcherRampHighspeed","slingshotRight","slingshotLeft"],0,0)}setDebugPosition(e,t){this._ballBody.mass=0,this._ballBody.velocity=[0,0],this._ballBody.position=[e.x,e.y],this._setCollisionGroupAndMask(["holeRampEnter","holeRampLeave","lipsRamp","lipsRamp2","launcherRampHighspeed","launcherRampLowspeed"],0,0),this._setCollisionGroupAndMask(t,2,1)}_createWorld(){const e=new Ys({gravity:[Ie.world.gravity.x,Ie.world.gravity.y]});return e.sleepMode=Ys.BODY_SLEEPING,e.solver.iterations=Ie.world.iterations,e.solver.tolerance=Ie.world.tolerance,e}_createBallBody(){const e=new hs({radius:Ie.ballBody.radius}),t=new fe({mass:Ie.ballBody.mass,position:[Ie.ballBody.position.x,Ie.ballBody.position.y]});return t.allowSleep=!1,t.damping=Ie.ballBody.damping,t.angularDamping=Ie.ballBody.angularDamping,e.material=this._ballMaterial,this._sensorsState.isBallOnLauncher=!0,e.collisionGroup=1,e.collisionMask=2,t.addShape(e),this._world.addBody(t),t}_createCustomShape(e,t,i){const s=new Kt({vertices:e});s.collisionGroup=t.colliderGroup||2,s.collisionMask=t.colliderMask||1;const a=new fe({mass:i,position:[0,0]});return t.colliderName&&t.colliderName.includes("Flipper")&&(a.allowSleep=!1,a.contactResponse=!1,s.material=this._flipperMaterial),a.customData=t,t.colliderType==="rotateSensor"&&(a.angularDamping=.8,s.material=this._rotateSensorMaterial),t.colliderType==="bumper"&&(s.material=this._bumperMaterial),t.colliderType==="bumper-hub"&&(s.material=this._bumperHubMaterial),t.colliderType==="slingshot"&&(s.material=this._slingshotMaterial),t.colliderType==="sensor"&&(s.sensor=!0),a.addShape(s),this._world.addBody(a),this._colliderGroupObjects[t.colliderName]=a,a}_createMaterial(){return new Li}_createContactMaterial(e,t,i){this._world.addContactMaterial(new Ws(e,t,i))}_createSegmentsFromPoints(e,t){const i=[];for(let s=0;s<e.length-1;s++){const a=e[s],n=e[s+1],r=Math.sqrt((n.x-a.x)**2+(n.y-a.y)**2),l=Math.atan2(n.y-a.y,n.x-a.x),h=new ir({length:r}),c=new fe({position:[(a.x+n.x)/2,(a.y+n.y)/2],angle:l,mass:0});h.collisionGroup=t.colliderGroup||0,h.collisionMask=t.colliderMask||0,c.name=t.colliderName,c.addShape(h),c.customData=t,this._world.addBody(c),i.push(c)}return this._colliderGroupObjects[t.colliderName]=i,i}_createFlipper(e){e.body.minAngle=e.limits.min,e.body.maxAngle=e.limits.max;const t=[e.position.x,e.position.y],i=new fe({mass:0,position:[e.body.position[0]+t[0],e.body.position[1]+t[1]]});i.contactResponse=!1,i.collisionGroup=2,i.collisionMask=1,this._world.addBody(i);const s=new ao(e.body,i,{collideConnected:!1});return s.setLimits(e.limits.min,e.limits.max),s.motorEnabled=!0,s.motorSpeed=e.keyUpMotorSpeed,e.body.revoluteConstraint=s,this._world.addConstraint(s),e.body}_createRotationSensor(e){const t=[e.position.x,e.position.y],i=new fe({mass:0,position:[e.body.position[0]+t[0],e.body.position[1]+t[1]]});this._world.addBody(i);const s=new ao(e.body,i,{});return e.body.revoluteConstraint=s,this._world.addConstraint(s),this._rotateSensors[e.body.customData.colliderName]=e.body,e.body}_createPhysicsContact(){this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2","holeRampEnter","holeRampLeave","slingshotLeft","slingshotRight"],0,0),this._setCollisionGroupAndMask(["launcherRampLowspeed"],2,1),this._world.on("postStep",()=>{this._sensorsState.launcherPassed&&this._clampVelocity(this._ballBody,Ie.ballBody.maxVelocity),this._checkBallPosition()}),this._world.on("beginContact",e=>{if(e.bodyA.customData&&this._gameManager.onCollideObject(e.bodyA.customData),e.bodyB.customData&&this._gameManager.onCollideObject(e.bodyB.customData),e.bodyA.customData&&e.bodyA.customData.colliderType==="sensor"){const{colliderName:t}=e.bodyA.customData;this._colliderName=t}if(e.bodyB.customData&&e.bodyB.customData.colliderType==="sensor"){const{colliderName:t}=e.bodyB.customData;this._colliderName=t}if(this._colliderName)switch(this._colliderName){case"launcherSensor":case"launcherSensorHighspeedLeave":this._sensorsState.launcherPassed||(this._sensorsState.launcherPassed=!0,this._sensorsState.losePassed=!1,this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2"],2,1),this._setCollisionGroupAndMask(["launcherRampLowspeed"],0,0));break;case"launcherSensorHighspeed":this._launchSpeed>.8&&(this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2","holeRampEnter","holeRampLeave","launcherRampLowspeed"],0,0),this._setCollisionGroupAndMask(["launcherRampHighspeed"],2,1));break;case"holeRampSensorSpeed2":if(this._sensorsState.holeRampPassed)return;this._ballBody.applyForce([0,300]);break;case"holeRampSensorSpeed":if(this._sensorsState.holeRampPassed||this._ballBody.velocity[1]<2)return;this._ballBody.applyForce([0,300]);break;case"holeRampSensorSpeedNegative":if(this._sensorsState.holeRampPassed)return;this._ballBody.applyForce([0,-100]);break;case"holeRampSensorEnter":if(!this._sensorsState.launcherPassed||this._sensorsState.holeRampPassed&&this._ballBody.velocity[1]<250)return;this._scene.onSensorCollide(this._colliderName,this._sensorsState),this._ballBody.applyForce([0,100]),this._setCollisionGroupAndMask(["holeRampEnter"],2,1),this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2","holeRampLeave","launcherRampLowspeed","launcherRampHighspeed"],0,0);break;case"holeRampSensorLeave":if(this._sensorsState.holeRampPassed)return;this._scene.onSensorCollide(this._colliderName,this._sensorsState),this._sensorsState.holeRampPassed=!0,R.delayedCall(.5,()=>{this._setCollisionGroupAndMask(["holeRampLeave"],2,1),this._setCollisionGroupAndMask(["holeRampEnter"],0,0)});break;case"holeRampSensorEnd":this._setCollisionGroupAndMask(["holeRampEnter","lipsRamp","lipsRamp2"],2,1),this._sensorsState.holeRampPassed||this._scene.onSensorCollide(this._colliderName,this._sensorsState),this._sensorsState.holeRampPassed&&(this._scene.onSensorCollide(this._colliderName,this._sensorsState),this._sensorsState.holeRampPassed=!1,this._setCollisionGroupAndMask(["holeRampLeave"],0,0));break;case"lipsRampSensorEnter":if(this._sensorsState.lipsRampPassed)return;this._sensorsState.lipsRampPassed=!0,this._scene.onSensorCollide(this._colliderName,this._sensorsState),ai.playSound("bonus-lips"),this._ballBody.applyForce([1500,1500]),this._setCollisionGroupAndMask(["holeRampEnter","holeRampLeave","launcherRampLowspeed","launcherRampHighspeed"],0,0),this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2"],2,1);break;case"lipsRampSensorEnter2":if(this._sensorsState.lipsRampPassed)return;this._sensorsState.lipsRampPassed=!0,this._scene.onSensorCollide(this._colliderName,this._sensorsState),ai.playSound("bonus-lips"),this._ballBody.applyForce([500,800]),this._setCollisionGroupAndMask(["holeRampEnter","holeRampLeave","launcherRampLowspeed","launcherRampHighspeed"],0,0),this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2"],2,1);break;case"lipsRampSensorLeave":case"lipsRampSensorLeave2":if(!this._sensorsState.lipsRampPassed)return;this._scene.onSensorCollide(this._colliderName,this._sensorsState),this._sensorsState.lipsRampPassed=!1,this._setCollisionGroupAndMask(["lipsRamp","lipsRamp2"],2,1);break;case"slingshotSensorRight":if(this._sensorsState.rightSlingshotPassed)return;this._sensorsState.rightSlingshotPassed=!0,this._applyDelayedForce(2500,.35),ai.playSound("second-chance",{delay:.35}),R.delayedCall(.65,()=>{this._setCollisionGroupAndMask(["slingshotRight"],2,1)});break;case"slingshotSensorLeft":if(this._sensorsState.leftSlingshotPassed)return;this._sensorsState.leftSlingshotPassed=!0,this._applyDelayedForce(2500,.35),ai.playSound("second-chance",{delay:.35}),R.delayedCall(.65,()=>{this._setCollisionGroupAndMask(["slingshotLeft"],2,1)});break;case"loseSensor":if(this._sensorsState.losePassed)return;this._sensorsState.losePassed=!0,this._setCollisionGroupAndMask(["holeRampEnter","holeRampLeave","lipsRamp","lipsRamp2","launcherRampHighspeed","slingshotLeft","slingshotRight"],0,0),this._setCollisionGroupAndMask(["launcherRampLowspeed"],2,1),this.ballLose();break}})}_setCollisionGroupAndMask(e,t,i){e&&e.forEach(s=>{this._colliderGroupObjects[s]&&(this._colliderGroupObjects[s].length>0?this._colliderGroupObjects[s].forEach(a=>{a.shapes[0].collisionGroup=t,a.shapes[0].collisionMask=i}):(this._colliderGroupObjects[s].shapes[0].collisionGroup=t,this._colliderGroupObjects[s].shapes[0].collisionMask=i))})}_clampVelocity(e,t){const i=e.velocity[0],s=e.velocity[1],a=Math.sqrt(i*i+s*s);if(a>t){const n=t/a;e.velocity[0]*=n,e.velocity[1]*=n}}_checkBallPosition(){this._ballBody.position[1]<Ie.ballBody.loseBallThreshold&&(this._sensorsState.losePassed=!0,this._scene.onSensorCollide(this._colliderName),this._setCollisionGroupAndMask(["holeRampEnter","holeRampLeave","lipsRamp","lipsRamp2","launcherRampHighspeed","slingshotLeft","slingshotRight"],0,0),this._setCollisionGroupAndMask(["launcherRampLowspeed"],2,1),this.ballLose())}_applyDelayedForce(e,t){R.delayedCall(t,()=>{this._ballBody.applyForce([0,e])})}_bindAll(){}update({time:e,deltaTime:t,frame:i}){const s=Ie.world.fixedTimeStep,a=Ie.world.maxSubSteps,n=Math.min(t/1e3,.1);this._world.step(s,n,a)}resize(e){}_createDebugFolder(){return this._debug?this._debug.addFolder({title:"Physics"}):void 0}}class bu extends we(){init(e={}){this._debug=e.debugFolder||this.$debugger,this._scene=e.scene,this._physicsWorld=e.physicsWorld,this._debugObjects=[],this._colors={sensor:65280,flipper:16711935,slingshot:255,bumper:16776960},this._physicsWorld.bodies.forEach(t=>{this._createDebugObject(t)}),this._bindAll(),this._debugFolder=this._createDebugFolder()}get world(){return this._world}get ballBody(){return this._ballBody}hide(){this._debugObjects.forEach(({debugObject:e})=>{e.visible=!1})}show(){this._debugObjects.forEach(({debugObject:e})=>{e.visible=!0})}destroy(){this._debugObjects.forEach(({debugObject:e})=>{this._scene.remove(e),e.geometry.dispose(),e.material.dispose()})}_createDebugLine(e,t,i=16711680){const s=new Ya({color:i}),a=[e,t],n=new as().setFromPoints(a),r=new Pt(n,s);return r.rotation.x=-Math.PI,r}_createDebugLinesFromPoints(e){const t=[];for(let i=0;i<e.length-1;i++){const s=e[i],a=e[i+1],n=this._createDebugLine(s,a);t.push(n)}return t}_createDebugRectangle(e,t,i=65280){const s=new $e(e,.1,t),a=new It({color:i,wireframe:!0}),n=new U(s,a);return n.rotation.x=-Math.PI,n}_createDebugCircle(e,t=255){const i=new $r(e,32),s=new It({color:t,wireframe:!0}),a=new U(i,s);return a.rotation.x=-Math.PI/2,a}_createDebugCustomShape(e,t=16776960){const i=new el;i.moveTo(e[0][0],e[0][1]);for(let A=1;A<e.length;A++)i.lineTo(e[A][0],e[A][1]);i.lineTo(e[0][0],e[0][1]);const s=new tl(i),a=new It({color:t,wireframe:!0}),n=new U(s,a);n.rotation.x=Math.PI/2;const r=[],l=new Ks(.02,16,16),h=new It({color:16711680});e.forEach(A=>{const d=new U(l,h);d.position.set(A[0],0,A[1]),r.push(d)});const c=new il;return c.add(n),r.forEach(A=>c.add(A)),c}_createDebugObject(e){const t=e.shapes[0];let i;if(t instanceof en)console.log(t.body.revoluteConstraint),i=this._createDebugRectangle(t.width,t.height);else if(t instanceof ir){const s=new O(-t.length/2,0,0),a=new O(t.length/2,0,0);i=this._createDebugLine(s,a)}else if(t instanceof hs)i=this._createDebugCircle(t.radius);else if(t instanceof Kt){const s=t.vertices.map(a=>[a[0],a[1]]);i=this._createDebugCustomShape(s,this._colors[t.body.customData.colliderType])}if(i)return i.position.set(e.position[0],0,e.position[1]),i.rotation.y=e.angle,this._scene.add(i),this._debugObjects.push({body:e,debugObject:i}),i}_bindAll(){}onUpdate({time:e,deltaTime:t,frame:i}){this._debugObjects.forEach(({body:s,debugObject:a})=>{a.position.set(s.position[0],0,s.position[1]),s.customData&&s.customData.colliderType==="flipper"?a.rotation.y=-s.angle:a.rotation.y=s.angle})}onWindowResize(e){}_createDebugFolder(){return this._debug?this._debug.addFolder({title:"Physics"}):void 0}}class Bu{constructor(e={}){this._eventDispatcher=e.eventDispatcher,this._isDevelopment=e.isDevelopment,this._isDebug=e.isDebug,this._bindAll(),this._domElement=e.domElement,this._inputs=this._setupInputs(),this._dragManager=this._createDragManager(),this._keyState={},this._setupEventListeners()}destroy(){this._removeEventListeners()}get inputs(){return this._inputs}_createDragManager(){return new Js({el:this._domElement,preventDefault:!0})}_setupInputs(){return{launch:!1,left:!1,right:!1}}_setupEventListeners(){window.addEventListener("keydown",this._keyDownHandler),window.addEventListener("keyup",this._keyUpHandler),this._isDevelopment&&!this._isDebug&&(this._dragManager.addEventListener("touchdown",this._handleMouseDown),this._dragManager.addEventListener("touchup",this._handleMouseUp)),this._dragManager.addEventListener("touchdown",this._handleTouchStart),this._dragManager.addEventListener("touchup",this._handleTouchEnd)}_removeEventListeners(){window.removeEventListener("keydown",this._keyDownHandler),window.removeEventListener("keyup",this._keyUpHandler),this._isDevelopment&&!this._isDebug&&(this._dragManager.removeEventListener("touchdown",this._handleMouseDown),this._dragManager.removeEventListener("touchup",this._handleMouseUp)),this._dragManager.removeEventListener("touchdown",this._handleTouchStart),this._dragManager.removeEventListener("touchup",this._handleTouchEnd)}_bindAll(){this._keyDownHandler=this._keyDownHandler.bind(this),this._keyUpHandler=this._keyUpHandler.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleMouseDown=this._handleMouseDown.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this)}_keyDownHandler(e){switch(this._keyState[e.keyCode]=!0,this._keyState[87]&&this._keyState[81]&&(this._inputs.launch=!0),this._keyState[37]&&this._keyState[39]&&(this._inputs.launch=!0),e.keyCode){case 32:case 38:case 40:case 83:this._inputs.launch=!0;break;case 37:case 65:case 81:this._inputs.left=!0;break;case 39:case 68:case 87:case 90:this._inputs.right=!0;break}this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("keydown",this._inputs)}_keyUpHandler(e){switch(this._keyState[e.keyCode]=!1,(e.keyCode===87||e.keyCode===81)&&(this._inputs.launch=!1),(e.keyCode===37||e.keyCode===39)&&(this._inputs.launch=!1),e.keyCode){case 32:case 38:case 40:case 83:this._inputs.launch=!1;break;case 37:case 65:case 81:this._inputs.left=!1;break;case 39:case 68:case 87:case 90:this._inputs.right=!1;break}this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("keyup",this._inputs)}_handleTouchStart(e){const t=window.innerWidth;if(e.touches){for(let i=0;i<e.touches.length;i++){const a=e.touches[i].clientX;a<t/2&&(this._inputs.left=!0),a>t/2&&(this._inputs.right=!0),(this._inputs.right||this._inputs.left)&&(this._inputs.launch=!0)}this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("touchstart",this._inputs)}}_handleTouchEnd(e){const t=window.innerWidth;let i=!1,s=!1;if(e.touches){for(let a=0;a<e.touches.length;a++){const r=e.touches[a].clientX;r<t/2&&(i=!0),r>t/2&&(s=!0)}this._inputs.left=i,this._inputs.right=s,(!s||!i)&&(this._inputs.launch=!1),this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("touchend",this._inputs)}}_handleMouseUp(e){const t=window.innerWidth,i=e.position.x;i<t/2&&(this._inputs.left=!1),i>t/2&&(this._inputs.right=!1),(!this._inputs.right||!this._inputs.left)&&(this._inputs.launch=!1),this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("touchend",this._inputs)}_handleMouseDown(e){const t=window.innerWidth,i=e.position.x;i<t/2&&(this._inputs.left=!0),i>t/2&&(this._inputs.right=!0),(this._inputs.right||this._inputs.left)&&(this._inputs.launch=!0),this._inputs.originalEvent=e,this._eventDispatcher.dispatchEvent("touchstart",this._inputs)}}class Su{constructor(e={}){this._eventDispatcher=e.eventDispatcher,this._isMachine=e.isMachine,this._lastUpdateTime=null,this._totalTime=this._isMachine?60:0,this._updatedTime=this._totalTime}get time(){return this._updatedTime}startTimer(){this._lastUpdateTime=Date.now()}pauseTimer(){this._isPaused=!0}playTimer(){this._isPaused=!1}update(){if(!this._isMachine&&!this._isPaused&&this._lastUpdateTime){const e=Date.now(),t=(e-this._lastUpdateTime)/1e3;this._lastUpdateTime=e,this._updatedTime+=t}if(!(this._isPaused||!this._isMachine)&&this._updatedTime>0&&this._lastUpdateTime){const e=Date.now(),t=(e-this._lastUpdateTime)/1e3;this._lastUpdateTime=e,this._updatedTime-=t,this._updatedTime<0&&(this._updatedTime=0,this._eventDispatcher.dispatchEvent("timer:ended"))}}resetTimer(){this._updatedTime=this._totalTime,this._lastUpdateTime=null}}class wu{constructor(e={}){this._objectsCollisions={"bumper-bottom":0,"bumper-left":0,"bumper-right":0,"stool-high":0,"stool-mid":0,"stool-low":0,"beauty-hub":0,"slingshot-left":0,"slingshot-right":0,slingshotEnterLeft:0,slingshotEnterRight:0,"lipstick-lot-01":0,"lipstick-lot-02":0,"lipstick-lot-03":0,"lipstick-lot-04":0,"lipstick-lot-05":0,holeRampSensorEnter:0,holeRampSensorSpeed:0,holeRampSensorSpeedNegative:0,holeRampSensorSpeed2:0,holeRampSensorLeave:0,lipsRampSensorEnter:0,lipsRampSensorEnter2:0,lipsRampSensor1:0,lipsRampSensor2:0,lipsRampSensor3:0,lipsRampSensor4:0,lipsRampSensor5:0},this._flippersToggles={left:0,right:0},this._missionsCompleted={lipsRamp:0,holeRamp:0,"lipstick-lot":0}}get gameData(){return{objectsCollisions:this._objectsCollisions,flippersToggles:this._flippersToggles,missionsCompleted:this._missionsCompleted}}onObjectCollide(e){this._objectsCollisions[e]!==void 0&&this._objectsCollisions[e]++}onFlipperToggle(e){e==="left"&&this._flippersToggles.left++,e==="right"&&this._flippersToggles.right++}onMissionComplete(e){this._missionsCompleted[e]++}resetDatas(){for(const e in this._objectsCollisions)this._objectsCollisions[e]=0;for(const e in this._flippersToggles)this._flippersToggles[e]=0;for(const e in this._missionsCompleted)this._missionsCompleted[e]=0}}class Mu extends we(){init(e={}){this._eventDispatcher=e.eventDispatcher,this._playfieldData=e.playfieldData,this._settings=e.settings,this._scene=e.scene,this._debugFolder=e.debugFolder,this._components=e.components,this._cameraManager=e.cameraManager,this._tutorialStore=Cl(),this._gameStatus={isFirstStart:!1,canStart:!0,prepared:!1,paused:!1,gameOver:!1,debug:!1,startLaunch:!1,isLaunched:!1,canLaunch:!0,isPlaying:!1,isTimerEnded:!1,ballCanLose:!0,remainingLives:3},this._smoothedDeltaTime=0,this._flipperSounds={leftUp:!1,rightUp:!1},this._inputManager=this._createInputManager(),this._pointsManager=this._createPointsManager(),this._physicsManager=this._createPhysicsManager(),this._timerManager=this._createTimerManager(),this._gameDataManager=this._createGameDataManager(),this._settings.debugPhysics&&(this._physicsDebugManager=this._createPhysicsDebugManager()),this._bindAll(),this._setupEventListeners()}get gameStatus(){return this._gameStatus}set gameStatus(e){this._gameStatus=e}get pointsManager(){return this._pointsManager}get physicsManager(){return this._physicsManager}get physicsDebugManager(){return this._physicsDebugManager}get gameDataManager(){return this._gameDataManager}get score(){return this._pointsManager.score}get remainingLives(){return this._gameStatus.remainingLives}get lastScore(){return this._pointsManager.lastScore}get gameTime(){return this._timerManager.time}firstCreatePhysicsDebug(){this._physicsDebugManager=this._createPhysicsDebugManager()}pause(){this._gameStatus.paused=!0}resume(){this._gameStatus.paused=!1}reset(){this._resetHandler()}gameOver(){this._gameOverHandler()}ballLose(){this._ballLoseHandler()}recalculateScore(){let e=0;for(const t in this._pointsManager.colliders)e+=this._pointsManager.colliders[t].points*this._gameDataManager.gameData.objectsCollisions[t];for(const t in this._pointsManager.missions)e+=this._pointsManager.missions[t].points*this._gameDataManager.gameData.missionsCompleted[t];return e}preLaunch(){this._gameStatus.gameOver||!this.$context.isMachine&&this._tutorialStore.step!==1||(this.$soundManager.playSound("pinball-shake",{loop:{start:4e3,end:6e3}}),!this._gameStatus.isFirstStart&&this.$context.isMachine&&(this._gameStatus.isFirstStart=!0,this.$soundManager.playSound("loop-main",{volume:.5,delay:2,loop:{start:1e3,end:33e3},lowpass:!0}),this.$soundManager.enableFilter()),this._gameStatus.prepared=!0,this.$nuxtApp.callHook("game:prepare"),this._gameStatus.startLaunch=!0,this.$nuxtApp.callHook("game:startLaunch"),this._scene.preLaunch())}startGame(){this._gameStatus.gameOver||(this._scene.startGame(this._gameStatus.remainingLives),this._gameStatus.startLaunch=!1,this._gameStatus.canLaunch=!1,this.$soundManager.stopSound("pinball-shake"),this.$soundManager.playSound("ball-launch"),R.delayedCall(.1,()=>{this._physicsManager.launchBall(),this._timerManager.playTimer()}),this._gameStatus.isLaunched=!0,this._gameStatus.isPlaying=!0,this._timerManager.startTimer(),this._animateTextStickers(),this.$nuxtApp.callHook("game:start"))}startGameDebug(){this._gameStatus.startLaunch=!1,this._gameStatus.prepared=!0,this._gameStatus.isLaunched=!0,this._gameStatus.isPlaying=!0,this._timerManager.startTimer()}onCollideObject(e){switch(e.stickerName&&!e.missionActive&&this._components.stickers.animateStickerOn(e.stickerName,e.stickerAnimation),e.objectName&&!e.missionActive&&this._components.flipper.animateColliderObject(e.objectName,e.objectAnimation),(e.colliderType==="bumper"||e.colliderType==="bumper-hub"||e.colliderType==="slingshot"||e.colliderName&&e.colliderName.includes("lipstick-lot"))&&this._scene.onObjectCollide(),this._gameDataManager.onObjectCollide(e.colliderName),e.colliderName){case"bumper-right":this.$soundManager.playSound("bumper-hit-01",{frequencyOffset:150});break;case"bumper-left":this.$soundManager.playSound("bumper-hit-01",{frequencyOffset:75});break;case"bumper-bottom":this.$soundManager.playSound("bumper-hit-01",{frequencyOffset:0});break;case"beauty-hub":this.$soundManager.playSound("slingshot-hit-01",{frequencyOffset:100});break;case"stool-low":this.$soundManager.playSound("seat-hit-01",{frequencyOffset:0});break;case"stool-mid":this.$soundManager.playSound("seat-hit-01",{frequencyOffset:100});break;case"stool-high":this.$soundManager.playSound("seat-hit-01",{frequencyOffset:200});break;case"slingshot-left":this.$soundManager.playSound("slingshot-hit-01",{frequencyOffset:100});break;case"slingshot-right":this.$soundManager.playSound("slingshot-hit-01");break;case"lipstick-lot-01":case"lipstick-lot-02":case"lipstick-lot-03":case"lipstick-lot-04":case"lipstick-lot-05":this.$soundManager.playSound("target-hit-01",{frequencyOffset:Math.random()*400});break}this._animateTextStickers(),this._pointsManager.onCollide(e)}destroy(){this._removeEventListeners(),this._inputManager.destroy(),this._physicsManager.destroy(),this._settings.debugPhysics&&this._physicsDebugManager.destroy()}_bindAll(){this._keyDownHandler=this._keyDownHandler.bind(this),this._keyUpHandler=this._keyUpHandler.bind(this),this._missionCompleteHandler=this._missionCompleteHandler.bind(this),this._resetMissionObjectHandler=this._resetMissionObjectHandler.bind(this),this._timerEndHandler=this._timerEndHandler.bind(this),this._gameOverHandler=this._gameOverHandler.bind(this),this._ballLoseHandler=this._ballLoseHandler.bind(this)}_setupEventListeners(){this._eventDispatcher.addEventListener("keydown",this._keyDownHandler),this._eventDispatcher.addEventListener("keyup",this._keyUpHandler),this._eventDispatcher.addEventListener("touchstart",this._keyDownHandler),this._eventDispatcher.addEventListener("touchend",this._keyUpHandler),this._eventDispatcher.addEventListener("game:over",this._gameOverHandler),this._eventDispatcher.addEventListener("ball:lose",this._ballLoseHandler),this._eventDispatcher.addEventListener("timer:ended",this._timerEndHandler),this._eventDispatcher.addEventListener("mission:complete",this._missionCompleteHandler),this._eventDispatcher.addEventListener("mission:resetObject",this._resetMissionObjectHandler)}_removeEventListeners(){this._eventDispatcher.removeEventListener("keydown",this._keyDownHandler),this._eventDispatcher.removeEventListener("keyup",this._keyUpHandler),this._eventDispatcher.removeEventListener("touchstart",this._keyDownHandler),this._eventDispatcher.removeEventListener("touchend",this._keyUpHandler),this._eventDispatcher.removeEventListener("game:over",this._gameOverHandler),this._eventDispatcher.removeEventListener("ball:lose",this._ballLoseHandler),this._eventDispatcher.removeEventListener("timer:ended",this._timerEndHandler),this._eventDispatcher.removeEventListener("mission:complete",this._missionCompleteHandler),this._eventDispatcher.removeEventListener("mission:resetObject",this._resetMissionObjectHandler)}_createInputManager(){return new Bu({eventDispatcher:this._eventDispatcher,isDevelopment:this.$context.isDevelopment,isDebug:this.$context.isDebug,domElement:this.$renderer.domElement})}_createPhysicsManager(){return new xu({eventDispatcher:this._eventDispatcher,debugFolder:this._debugFolder,scene:this._scene,playfieldData:this._playfieldData,settings:this._settings,gameManager:this})}_createPhysicsDebugManager(){return new bu({debugFolder:this._debugFolder,scene:this._scene,physicsWorld:this._physicsManager.world,settings:this._settings})}_createPointsManager(){return new AA({eventDispatcher:this._eventDispatcher,debugFolder:this._debugFolder,scene:this._scene,playfieldData:this._playfieldData,settings:this._settings})}_createTimerManager(){return new Su({eventDispatcher:this._eventDispatcher,isMachine:this.$context.isMachine})}_createGameDataManager(){return new wu({})}_animateTextStickers(){this._pointsManager.score>this._pointsManager.pointsStep[this._pointsManager.currentPointsStep]&&this._pointsManager.currentPointsStep===0&&(this._pointsManager.currentPointsStep=1,this._components.stickers.animateStickerOn("sticker-ultra-matte","blink")),this._pointsManager.score>this._pointsManager.pointsStep[this._pointsManager.currentPointsStep]&&this._pointsManager.currentPointsStep===1&&(this._pointsManager.currentPointsStep=2,this._components.stickers.animateStickerOn("sticker-ultra-pigmented","blink")),this._pointsManager.score>this._pointsManager.pointsStep[this._pointsManager.currentPointsStep]&&this._pointsManager.currentPointsStep===2&&(this._pointsManager.currentPointsStep=3,this._components.stickers.animateStickerOn("sticker-ultra-vegan","blink"))}update({time:e,deltaTime:t,frame:i}){this._gameStatus.paused||(this._smoothedDeltaTime=t,this._physicsManager.update({time:e,deltaTime:t,frame:i}),!this._gameStatus.prepared&&this._inputManager.inputs.launch&&this._gameStatus.canStart&&this._gameStatus.canLaunch&&!this._gameStatus.gameOver&&this.preLaunch(),this._gameStatus.startLaunch&&this._gameStatus.canLaunch&&!this._gameStatus.gameOver&&(this._physicsManager.updateLaunchSpeed(),this._scene.startLaunch(t)),this._timerManager.update())}_keyDownHandler(e){this._gameStatus.isTimerEnded||this._gameStatus.gameOver||(!this._gameStatus.isPlaying&&!this.$context.isMachine&&!this.$context.isDebug&&!this._tutorialStore.isCompleted&&(e.left&&this._tutorialStore.step===0&&(this._physicsManager.keyDown("left",this._smoothedDeltaTime),this.$nuxtApp.callHook("tutorial:left:start",e),this.$soundManager.playSound("flipper-left"),this._gameStatus.canLaunch=!1),e.right&&this._tutorialStore.step===0&&(this._physicsManager.keyDown("right",this._smoothedDeltaTime),this.$nuxtApp.callHook("tutorial:right:start",e),this.$soundManager.playSound("flipper-right"),this._gameStatus.canLaunch=!1),e.launch&&this._tutorialStore.step===1&&this.$nuxtApp.callHook("tutorial:launch:start",e)),e.left&&this._gameStatus.isPlaying&&(this._physicsManager.keyDown("left",this._smoothedDeltaTime),this._flipperSounds.leftUp||(this._flipperSounds.leftUp=!0,this.$soundManager.playSound("flipper-left"))),e.right&&this._gameStatus.isPlaying&&(this._physicsManager.keyDown("right",this._smoothedDeltaTime),this._flipperSounds.rightUp||(this._flipperSounds.rightUp=!0,this.$soundManager.playSound("flipper-right"))),this._tutorialStore.step===1||this.$context.isDebug?e.launch&&this._gameStatus.isLaunched&&!this._gameStatus.isPlaying&&this._physicsManager.sensorsState.isBallOnLauncher&&(this._gameStatus.startLaunch||(this.$soundManager.playSound("pinball-shake",{loop:{start:4e3,end:6e3}}),this.$nuxtApp.callHook("game:startLaunch"),this._gameStatus.startLaunch=!0)):e.launch&&this._gameStatus.isLaunched&&!this._gameStatus.isPlaying&&this._physicsManager.sensorsState.isBallOnLauncher&&!this._gameStatus.startLaunch&&this._gameStatus.canLaunch&&(this.$soundManager.playSound("pinball-shake",{loop:{start:4e3,end:6e3}}),this.$nuxtApp.callHook("game:startLaunch"),this._gameStatus.startLaunch=!0))}_keyUpHandler(e){this._gameStatus.gameOver||(!this._gameStatus.isPlaying&&!this._tutorialStore.isCompleted&&!this.$context.isDebug&&(e.left||(this._physicsManager.keyUp("left"),this.$nuxtApp.callHook("tutorial:left:end",e)),e.right||(this._physicsManager.keyUp("right"),this.$nuxtApp.callHook("tutorial:right:end",e)),!e.launch&&this._tutorialStore.step===1&&this._gameStatus.canLaunch&&this.$nuxtApp.callHook("tutorial:launch:end",e)),e.left||(this._gameDataManager.onFlipperToggle("left"),this._flipperSounds.leftUp=!1,this._physicsManager.keyUp("left")),e.right||(this._gameDataManager.onFlipperToggle("right"),this._flipperSounds.rightUp=!1,this._physicsManager.keyUp("right")),!e.launch&&this._gameStatus.startLaunch&&this._gameStatus.canLaunch&&this.startGame())}_gameOverHandler(){const e=this._pointsManager.score,t=this._gameDataManager.gameData,i=Math.round(this._timerManager.time);this.$nuxtApp.callHook("game:over",e,i,t),this.$soundManager.playSound("game-over"),this.$context.isMachine&&(this._gameStatus.canStart=!1,this._gameStatus.prepared=!1,this._gameStatus.isLaunched=!1,this._gameStatus.gameOver=!1,this._gameStatus.isPlaying=!1,this._gameStatus.startLaunch=!1,this._gameStatus.isTimerEnded=!1,this._gameStatus.remainingLives=3,this._components.stickers.resetStickersState(),this._components.flipper.resetColliderObjectsState(),this._pointsManager.resetScore(),this._timerManager.resetTimer(),R.delayedCall(3,()=>{this._gameStatus.canStart=!0,this._gameDataManager.resetDatas()}))}_resetHandler(){this._gameStatus.canStart=!1,this._gameStatus.prepared=!1,this._gameStatus.isLaunched=!1,this._gameStatus.gameOver=!1,this._gameStatus.isPlaying=!1,this._gameStatus.startLaunch=!1,this._gameStatus.isTimerEnded=!1,this._gameStatus.paused=!1,this._gameStatus.remainingLives=3,this._physicsManager.ballReset(),this._components.flipper.resetColliderObjectsState(),this._scene.resetScene(),this._pointsManager.resetScore(),this._timerManager.resetTimer(),this._gameStatus.canStart=!0,this._gameDataManager.resetDatas(),this.$nuxtApp.callHook("game:reset")}_ballLoseHandler(){this._gameStatus.ballCanLose&&(this._gameStatus.ballCanLose=!1,this.$nuxtApp.callHook("ball:lose"),this._gameStatus.remainingLives-=1,this._gameStatus.remainingLives===0?(this._gameStatus.gameOver=!0,this._scene.lightsOff(),this._scene.gameOver(),this.gameOver()):this.$soundManager.playSound("ball-new",{delay:.35}),this.$context.isMachine||(this._gameStatus.canLaunch=!1),this.$soundManager.playSound("ball-lost"),this._timerManager.pauseTimer(),this._gameStatus.isPlaying=!1,this._gameStatus.startLaunch=!1,this._components.stickers.resetStickersState(),this._components.flipper.resetColliderObjectsState(),this._pointsManager.resetMissions(),R.delayedCall(1,()=>{this._components.stickers.animateLivesStickers(this._gameStatus.remainingLives),this._gameStatus.ballCanLose=!0}),R.delayedCall(1.5,()=>{!this._gameStatus.isPlaying&&!this._gameStatus.startLaunch&&this.$nuxtApp.callHook("ui:showTutorial")}))}_timerEndHandler(){this._gameStatus.isTimerEnded=!0,this._gameStatus.remainingLives=1,this._scene.lightsOff(),this._gameStatus.isPlaying||this.ballLose()}_missionCompleteHandler(e){switch(this.$soundManager.playSound("score-02"),this._gameDataManager.onMissionComplete(e),e){case"lipstick-lot":this.$nuxtApp.callHook("score:circles"),ai.playSound("bonus-lips");break;case"holeRamp":this.$nuxtApp.callHook("score:stars"),ai.playSound("bonus-hole");break;case"lipsRamp":this.$nuxtApp.callHook("score:stars"),ai.playSound("bonus-lips");break}}_resetMissionObjectHandler(e){this._scene.resetMissionObject(e)}}const Qu=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;void main(){vec4 pos=projectionMatrix*modelViewMatrix*vec4(position,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Du=`#define GLSLIFY 1
varying vec2 vUv;uniform float uOpacity;uniform float uAlphaThreshold;uniform float uAlphaWidth;uniform float uBorderWidth;uniform vec3 uColor;uniform sampler2D uAlphaMap;void main(){vec2 center=vUv-vec2(0.5);float dist=step(length(center),0.5);float dist2=step(length(center),0.5-uBorderWidth);float alpha=dist-dist2;gl_FragColor=vec4(uColor,alpha*uOpacity);}`,Ke={file:"./webgl/components/ComponentCirclePlane/settings.js",scale:{x:1,y:1,z:1},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},material:{uniforms:{uAlphaThreshold:{value:.5},uAlphaWidth:{value:.1},uOpacity:{value:0},uColor:{value:"#ffffff"},uBorderWidth:{value:.1}}}};class lo extends we(Ut){init(e={}){this._debug=e.debugFolder,this.settings=Ke,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$profiler.addObject(this._mesh,"circlePlane"),this.debugFolder=this._createDebugFolder()}get mesh(){return this._mesh}get material(){return this._material}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){return new Ft(1,1,1)}_createMaterial(){return new je({vertexShader:Qu,fragmentShader:Du,uniforms:{uAlphaThreshold:{value:Ke.material.uniforms.uAlphaThreshold.value},uAlphaWidth:{value:Ke.material.uniforms.uAlphaWidth.value},uBorderWidth:{value:Ke.material.uniforms.uBorderWidth.value},uOpacity:{value:Ke.material.uniforms.uOpacity.value},uColor:{value:new _e(Ke.material.uniforms.uColor.value)}},transparent:!0,depthWrite:!1})}_createMesh(){const e=new U(this._geometry,this._material);return this.add(e),e}_createInstancedMiniLights(){const s={min:.05,max:.2},a=new Ft(1,1),n=new It({color:new _e(16711935),side:2}),r=new InstancedMesh(a,n,50*3),l=new Object3D;let h=0;for(let c=0;c<3;c++){const A=1.5+c*.2;for(let d=0;d<50;d++){const m=d/50*Math.PI,p=Math.cos(m)*A,f=Math.sin(m)*A;l.position.set(p,f,0),l.lookAt(new Vector3(0,0,0));const _=Math.random()*(s.max-s.min)+s.min;l.scale.set(_,_,1),l.updateMatrix(),r.setMatrixAt(h++,l.matrix)}}return r.instanceMatrix.needsUpdate=!0,this.add(r),console.log(r),r}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"CirclePlane"});return e.addBinding(Ke.material.uniforms.uAlphaThreshold,"value",{label:"Alpha Threshold"}).on("change",()=>this._updateSettings()),e.addBinding(Ke.material.uniforms.uAlphaWidth,"value",{label:"Alpha Width"}).on("change",()=>this._updateSettings()),e.addBinding(Ke.material.uniforms.uBorderWidth,"value",{label:"Border Width"}).on("change",()=>this._updateSettings()),e.addBinding(Ke.material.uniforms.uOpacity,"value",{label:"Opacity"}).on("change",()=>this._updateSettings()),e.addBinding(Ke.material.uniforms.uColor,"value",{label:"Color"}).on("change",()=>this._updateSettings()),this.$debugger.registerFile(Ke,Ke.file),e}_updateSettings(){this._material.uniforms.uAlphaThreshold.value=Ke.material.uniforms.uAlphaThreshold.value,this._material.uniforms.uAlphaWidth.value=Ke.material.uniforms.uAlphaWidth.value,this._material.uniforms.uBorderWidth.value=Ke.material.uniforms.uBorderWidth.value,this._material.uniforms.uOpacity.value=Ke.material.uniforms.uOpacity.value,this._material.uniforms.uColor.value=new _e(Ke.material.uniforms.uColor.value)}}const Pu=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;void main(){vec4 pos=projectionMatrix*modelViewMatrix*vec4(position,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Lu=`#define GLSLIFY 1
varying vec2 vUv;uniform float uOpacity;uniform float uAlphaThreshold;uniform float uAlphaWidth;uniform vec3 uColor;uniform sampler2D uAlphaMap;void main(){float alpha=texture2D(uAlphaMap,vUv).r;alpha=smoothstep(uAlphaThreshold-uAlphaWidth,uAlphaThreshold+uAlphaWidth,alpha);gl_FragColor=vec4(uColor,alpha*uOpacity);}`,pt={file:"./webgl/components/ComponentStarsPlane/settings.js",scale:{x:0,y:0,z:0},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},material:{uniforms:{uAlphaThreshold:{value:.5},uAlphaWidth:{value:.1},uOpacity:{value:1},uColor:{value:"#ffffff"}}}};class Ls extends we(Ut){init(e={}){this._debug=e.debugFolder,this._color=e.color,this._layer=e.layer,this._border=e.border,this._isCenterOffset=e.isCenterOffset?e.isCenterOffset:!0,this.settings=pt,this._layer&&(this.position.z=this._layer*.01),this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$profiler.addObject(this._mesh,"StarsPlane"),this.debugFolder=this._createDebugFolder()}get mesh(){return this._mesh}get color(){return this._color}get isCenterOffset(){return this._isCenterOffset}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}animate(){const e=R.timeline({repeat:-1,yoyo:!0});return e.to(this._mesh.rotation,{ease:"power3.inOut",z:6,duration:2},0),e}_createGeometry(){return new Ft(1,1,1)}_createMaterial(){return new je({vertexShader:Pu,fragmentShader:Lu,uniforms:{uAlphaMap:{value:$.get(this._border?"star-alpha-border":"star-alpha")},uAlphaThreshold:{value:pt.material.uniforms.uAlphaThreshold.value},uAlphaWidth:{value:pt.material.uniforms.uAlphaWidth.value},uOpacity:{value:pt.material.uniforms.uOpacity.value},uColor:{value:new _e(this._color?this._color:pt.material.uniforms.uColor.value)}},transparent:!0})}_createMesh(){const e=new U(this._geometry,this._material);return this.add(e),e}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"CirclePlane"});return e.addBinding(pt.material.uniforms.uAlphaThreshold,"value",{label:"Alpha Threshold"}).on("change",()=>this._updateSettings()),e.addBinding(pt.material.uniforms.uAlphaWidth,"value",{label:"Alpha Width"}).on("change",()=>this._updateSettings()),e.addBinding(pt.material.uniforms.uOpacity,"value",{label:"Opacity"}).on("change",()=>this._updateSettings()),e.addBinding(pt.material.uniforms.uColor,"value",{label:"Color"}).on("change",()=>this._updateSettings()),e}_updateSettings(){this._material.uniforms.uAlphaThreshold.value=pt.material.uniforms.uAlphaThreshold.value,this._material.uniforms.uAlphaWidth.value=pt.material.uniforms.uAlphaWidth.value,this._material.uniforms.uOpacity.value=pt.material.uniforms.uOpacity.value,this._material.uniforms.uColor.value=new _e(pt.material.uniforms.uColor.value)}}var Va={exports:{}};const Ru=sl(al);(function(o,e){(function(t,i){i(e,Ru)})(nl,function(t,i){function s(b,B){var S=Object.keys(b);if(Object.getOwnPropertySymbols){var Q=Object.getOwnPropertySymbols(b);B&&(Q=Q.filter(function(F){return Object.getOwnPropertyDescriptor(b,F).enumerable})),S.push.apply(S,Q)}return S}function a(b){for(var B=1;B<arguments.length;B++){var S=arguments[B]!=null?arguments[B]:{};B%2?s(Object(S),!0).forEach(function(Q){h(b,Q,S[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(S)):s(Object(S)).forEach(function(Q){Object.defineProperty(b,Q,Object.getOwnPropertyDescriptor(S,Q))})}return b}function n(b,B){if(!(b instanceof B))throw new TypeError("Cannot call a class as a function")}function r(b,B){for(var S=0;S<B.length;S++){var Q=B[S];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(b,f(Q.key),Q)}}function l(b,B,S){return B&&r(b.prototype,B),Object.defineProperty(b,"prototype",{writable:!1}),b}function h(b,B,S){return(B=f(B))in b?Object.defineProperty(b,B,{value:S,enumerable:!0,configurable:!0,writable:!0}):b[B]=S,b}function c(b,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(B&&B.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),B&&d(b,B)}function A(b){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(B){return B.__proto__||Object.getPrototypeOf(B)},A(b)}function d(b,B){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,Q){return S.__proto__=Q,S},d(b,B)}function m(b,B){if(B&&(typeof B=="object"||typeof B=="function"))return B;if(B!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(S){if(S===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S}(b)}function p(b){var B=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var S,Q=A(b);if(B){var F=A(this).constructor;S=Reflect.construct(Q,arguments,F)}else S=Q.apply(this,arguments);return m(this,S)}}function f(b){var B=function(S,Q){if(typeof S!="object"||S===null)return S;var F=S[Symbol.toPrimitive];if(F!==void 0){var X=F.call(S,Q||"default");if(typeof X!="object")return X;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Q==="string"?String:Number)(S)}(b,"string");return typeof B=="symbol"?B:String(B)}var _={exports:{}};(function(b){var B=/\n/,S=`
`,Q=/\s/;function F(te,Z,Ae,ue){var Be=te.indexOf(Z,Ae);return Be===-1||Be>ue?ue:Be}function X(te){return Q.test(te)}function ce(te,Z,Ae,ue){return{start:Z,end:Z+Math.min(ue,Ae-Z)}}b.exports=function(te,Z){return b.exports.lines(te,Z).map(function(Ae){return te.substring(Ae.start,Ae.end)}).join(`
`)},b.exports.lines=function(te,Z){if((Z=Z||{}).width===0&&Z.mode!=="nowrap")return[];te=te||"";var Ae=typeof Z.width=="number"?Z.width:Number.MAX_VALUE,ue=Math.max(0,Z.start||0),Be=typeof Z.end=="number"?Z.end:te.length,De=Z.mode,ge=Z.measure||ce;return De==="pre"?function(oe,xe,me,Pe,de){for(var Xe=[],We=me,ae=me;ae<Pe&&ae<xe.length;ae++){var Qe=xe.charAt(ae),z=B.test(Qe);if(z||ae===Pe-1){var ye=oe(xe,We,z?ae:ae+1,de);Xe.push(ye),We=ae+1}}return Xe}(ge,te,ue,Be,Ae):function(oe,xe,me,Pe,de,Xe){var We=[],ae=de;for(Xe==="nowrap"&&(ae=Number.MAX_VALUE);me<Pe&&me<xe.length;){for(var Qe=F(xe,S,me,Pe);me<Qe&&X(xe.charAt(me));)me++;var z=oe(xe,me,Qe,ae),ye=me+(z.end-z.start),Te=ye+S.length;if(ye<Qe){for(;ye>me&&!X(xe.charAt(ye));)ye--;if(ye===me)Te>me+S.length&&Te--,ye=Te;else for(Te=ye;ye>me&&X(xe.charAt(ye-S.length));)ye--}if(ye>=me){var Ve=oe(xe,me,ye,ae);We.push(Ve)}me=Te}return We}(ge,te,ue,Be,Ae,De)}})(_);var E=_.exports,x=["x","e","a","o","n","s","r","c","u","m","v","w","z"],y=["m","w"],C=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],u=9,I=32,w=function(){function b(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};n(this,b),this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(B)}return l(b,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"descender",get:function(){return this._descender}},{key:"ascender",get:function(){return this._ascender}},{key:"xHeight",get:function(){return this._xHeight}},{key:"baseline",get:function(){return this._baseline}},{key:"capHeight",get:function(){return this._capHeight}},{key:"lineHeight",get:function(){return this._lineHeight}},{key:"linesTotal",get:function(){return this._linesTotal}},{key:"lettersTotal",get:function(){return this._lettersTotal}},{key:"wordsTotal",get:function(){return this._wordsTotal}},{key:"update",value:function(B){var S=this;if(B=Object.assign({measure:this._measure},B),this._options=B,this._options.tabSize=j(this._options.tabSize,4),!B.font)throw new Error("must provide a valid bitmap font");var Q=this.glyphs,F=B.text||"",X=B.font;this._setupSpaceGlyphs(X);var ce=E.lines(F,B),te=B.width||0,Z=F.split(" ").filter(function(ae){return ae!==`
`}).length,Ae=F.split("").filter(function(ae){return ae!==`
`&&ae!==" "}).length;Q.length=0;var ue=ce.reduce(function(ae,Qe){return Math.max(ae,Qe.width,te)},0),Be=0,De=0,ge=j(B.lineHeight,X.common.lineHeight),oe=X.common.base,xe=ge-oe,me=B.letterSpacing||0,Pe=ge*ce.length-xe,de=function(ae){return ae==="center"?1:ae==="right"?2:0}(this._options.align);De-=Pe,this._width=ue,this._height=Pe,this._descender=ge-oe,this._baseline=oe,this._xHeight=function(ae){for(var Qe=0;Qe<x.length;Qe++){var z=x[Qe].charCodeAt(0),ye=J(ae.chars,z);if(ye>=0)return ae.chars[ye].height}return 0}(X),this._capHeight=function(ae){for(var Qe=0;Qe<C.length;Qe++){var z=C[Qe].charCodeAt(0),ye=J(ae.chars,z);if(ye>=0)return ae.chars[ye].height}return 0}(X),this._lineHeight=ge,this._ascender=ge-xe-this._xHeight;var Xe=0,We=0;ce.forEach(function(ae,Qe){for(var z,ye=ae.start,Te=ae.end,Ve=ae.width,Qt=F.slice(ye,Te).split(" ").filter(function(Ze){return Ze!==""}).length,Bt=F.slice(ye,Te).split(" ").join("").length,Ot=0,ia=0,g=ye;g<Te;g++){var H=F.charCodeAt(g),re=S.getGlyph(X,H);if(re){z&&(Be+=k(X,z.id,re.id));var Le=Be;de===1?Le+=(ue-Ve)/2:de===2&&(Le+=ue-Ve),Q.push({position:[Le,De],data:re,index:g,linesTotal:ce.length,lineIndex:Qe,lineLettersTotal:Bt,lineLetterIndex:Ot,lineWordsTotal:Qt,lineWordIndex:ia,wordsTotal:Z,wordIndex:Xe,lettersTotal:Ae,letterIndex:We}),re.id===I&&z.id!==I&&(ia++,Xe++),re.id!==I&&(Ot++,We++),Be+=re.xadvance+me,z=re}}De+=ge,Be=0}),this._lettersTotal=Ae,this._wordsTotal=Z,this._linesTotal=ce.length}},{key:"getGlyph",value:function(B,S){var Q=L(B,S);return Q||(S===u?this._fallbackTabGlyph:S===I?this._fallbackSpaceGlyph:null)}},{key:"computeMetrics",value:function(B,S,Q,F){var X,ce,te=this._options.letterSpacing||0,Z=this._options.font,Ae=0,ue=0,Be=0;if(!Z.chars||Z.chars.length===0)return{start:S,end:S,width:0};Q=Math.min(B.length,Q);for(var De=S;De<Q;De++){var ge=B.charCodeAt(De);if(X=this.getGlyph(Z,ge)){X.char=B[De],X.xoffset;var oe=(Ae+=ce?k(Z,ce.id,X.id):0)+X.xadvance+te,xe=Ae+X.width;if(xe>=F||oe>=F)break;Ae=oe,ue=xe,ce=X}Be++}return ce&&(ue+=ce.xoffset),{start:S,end:S+Be,width:ue}}},{key:"_setupSpaceGlyphs",value:function(B){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,B.chars&&B.chars.length!==0){var S=L(B,I)||function(X){for(var ce=0;ce<y.length;ce++){var te=y[ce].charCodeAt(0),Z=J(X.chars,te);if(Z>=0)return X.chars[Z]}return 0}(B)||B.chars[0],Q=this._options.tabSize*S.xadvance;this._fallbackSpaceGlyph=S;var F=Object.assign({},S);this._fallbackTabGlyph=Object.assign(F,{x:0,y:0,xadvance:Q,id:u,xoffset:0,yoffset:0,width:0,height:0})}}}]),b}();function L(b,B){if(!b.chars||b.chars.length===0)return null;var S=J(b.chars,B);return S>=0?b.chars[S]:null}function k(b,B,S){if(!b.kernings||b.kernings.length===0)return 0;for(var Q=b.kernings,F=0;F<Q.length;F++){var X=Q[F];if(X.first===B&&X.second===S)return X.amount}return 0}function J(b,B,S){for(var Q=S=S||0;Q<b.length;Q++)if(b[Q].id===B)return Q;return-1}function j(b,B){return typeof b=="number"?b:typeof B=="number"?B:0}var q={min:[0,0],max:[0,0]};function pe(b){var B=b.length/2;q.min[0]=b[0],q.min[1]=b[1],q.max[0]=b[0],q.max[1]=b[1];for(var S=0;S<B;S++){var Q=b[2*S+0],F=b[2*S+1];q.min[0]=Math.min(Q,q.min[0]),q.min[1]=Math.min(F,q.min[1]),q.max[0]=Math.max(Q,q.max[0]),q.max[1]=Math.max(F,q.max[1])}}var ve={computeBox:function(b,B){return pe(b),B.min.set(q.min[0],q.min[1],0),B.max.set(q.max[0],q.max[1],0),B},computeSphere:function(b,B){pe(b);var S=q.min[0],Q=q.min[1],F=q.max[0]-S,X=q.max[1]-Q,ce=Math.sqrt(F*F+X*X);B.center.set(S+F/2,Q+X/2,0),B.radius=ce/2}},ee={pages:function(b){var B=new Float32Array(4*b.length*1),S=0;return b.forEach(function(Q){var F=Q.data.page||0;B[S++]=F,B[S++]=F,B[S++]=F,B[S++]=F}),B},attributes:function(b,B,S,Q,F){var X=new Float32Array(4*b.length*2),ce=new Float32Array(4*b.length*2),te=new Float32Array(4*b.length*2),Z=new Float32Array(4*b.length*2),Ae=new Float32Array(4*b.length*2),ue=new Float32Array(4*b.length*2),Be=0,De=0,ge=0,oe=0,xe=0,me=0;return b.forEach(function(Pe){var de=Pe.data,Xe=de.x+de.width,We=de.y+de.height,ae=de.x/B,Qe=de.y/S,z=Xe/B,ye=We/S;Q&&(Qe=(S-de.y)/S,ye=(S-We)/S),X[Be++]=ae,X[Be++]=Qe,X[Be++]=ae,X[Be++]=ye,X[Be++]=z,X[Be++]=ye,X[Be++]=z,X[Be++]=Qe,ce[oe++]=Pe.position[0]/F.width,ce[oe++]=(Pe.position[1]+F.height)/F.height,ce[oe++]=Pe.position[0]/F.width,ce[oe++]=(Pe.position[1]+F.height+de.height)/F.height,ce[oe++]=(Pe.position[0]+de.width)/F.width,ce[oe++]=(Pe.position[1]+F.height+de.height)/F.height,ce[oe++]=(Pe.position[0]+de.width)/F.width,ce[oe++]=(Pe.position[1]+F.height)/F.height,te[xe++]=0,te[xe++]=1,te[xe++]=0,te[xe++]=0,te[xe++]=1,te[xe++]=0,te[xe++]=1,te[xe++]=1,Z[me++]=de.width,Z[me++]=de.height,Z[me++]=de.width,Z[me++]=de.height,Z[me++]=de.width,Z[me++]=de.height,Z[me++]=de.width,Z[me++]=de.height;var Te=Pe.position[0]+de.xoffset,Ve=Pe.position[1]+de.yoffset,Qt=de.width,Bt=de.height;Ae[De++]=Te,Ae[De++]=Ve,Ae[De++]=Te,Ae[De++]=Ve+Bt,Ae[De++]=Te+Qt,Ae[De++]=Ve+Bt,Ae[De++]=Te+Qt,Ae[De++]=Ve,ue[ge++]=Te+Qt/2,ue[ge++]=Ve+Bt/2,ue[ge++]=Te+Qt/2,ue[ge++]=Ve+Bt/2,ue[ge++]=Te+Qt/2,ue[ge++]=Ve+Bt/2,ue[ge++]=Te+Qt/2,ue[ge++]=Ve+Bt/2}),{uvs:X,layoutUvs:ce,positions:Ae,centers:ue,glyphUvs:te,glyphResolution:Z}},infos:function(b,B){for(var S=new Float32Array(4*b.length),Q=new Float32Array(4*b.length),F=new Float32Array(4*b.length),X=new Float32Array(4*b.length),ce=new Float32Array(4*b.length),te=new Float32Array(4*b.length),Z=new Float32Array(4*b.length),Ae=new Float32Array(4*b.length),ue=new Float32Array(4*b.length),Be=new Float32Array(4*b.length),De=0,ge=0,oe=0,xe=0,me=0,Pe=0,de=0,Xe=0,We=0,ae=0,Qe=0;Qe<b.length;Qe++){var z=b[Qe];S[De++]=z.linesTotal,S[De++]=z.linesTotal,S[De++]=z.linesTotal,S[De++]=z.linesTotal,Q[ge++]=z.lineIndex,Q[ge++]=z.lineIndex,Q[ge++]=z.lineIndex,Q[ge++]=z.lineIndex,F[oe++]=z.lineLettersTotal,F[oe++]=z.lineLettersTotal,F[oe++]=z.lineLettersTotal,F[oe++]=z.lineLettersTotal,X[xe++]=z.lineLetterIndex,X[xe++]=z.lineLetterIndex,X[xe++]=z.lineLetterIndex,X[xe++]=z.lineLetterIndex,ce[me++]=z.lineWordsTotal,ce[me++]=z.lineWordsTotal,ce[me++]=z.lineWordsTotal,ce[me++]=z.lineWordsTotal,te[Pe++]=z.lineWordIndex,te[Pe++]=z.lineWordIndex,te[Pe++]=z.lineWordIndex,te[Pe++]=z.lineWordIndex,Z[de++]=z.wordsTotal,Z[de++]=z.wordsTotal,Z[de++]=z.wordsTotal,Z[de++]=z.wordsTotal,Ae[Xe++]=z.wordIndex,Ae[Xe++]=z.wordIndex,Ae[Xe++]=z.wordIndex,Ae[Xe++]=z.wordIndex,ue[We++]=z.lettersTotal,ue[We++]=z.lettersTotal,ue[We++]=z.lettersTotal,ue[We++]=z.lettersTotal,Be[ae++]=z.letterIndex,Be[ae++]=z.letterIndex,Be[ae++]=z.letterIndex,Be[ae++]=z.letterIndex}return{linesTotal:S,lineIndex:Q,lineLettersTotal:F,lineLetterIndex:X,lineWordsTotal:ce,lineWordIndex:te,wordsTotal:Z,wordIndex:Ae,lettersTotal:ue,letterIndex:Be}}},Me=Object.prototype.toString;function P(b){return!!b.constructor&&typeof b.constructor.isBuffer=="function"&&b.constructor.isBuffer(b)}var V=function(b){switch(b){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}},G=function(b){return b.BYTES_PER_ELEMENT&&Me.call(b.buffer)==="[object ArrayBuffer]"||Array.isArray(b)},Ue=function(b){return b!=null&&(P(b)||function(B){return typeof B.readFloatLE=="function"&&typeof B.slice=="function"&&P(B.slice(0,0))}(b)||!!b._isBuffer)},qe=[0,2,3],Ye=[2,1,3],Ce=function(b){c(S,b);var B=p(S);function S(Q){var F;return n(this,S),typeof Q=="string"&&(Q={text:Q}),(F=B.call(this))._options=Object.assign({},Q),F._layout=null,F._visibleGlyphs=[],F.update(F._options),F}return l(S,[{key:"layout",get:function(){return this._layout}},{key:"visibleGlyphs",get:function(){return this._visibleGlyphs}},{key:"update",value:function(Q){if(Q=this._validateOptions(Q)){this._layout=function(ge){return new w(ge)}(Q);var F=Q.flipY!==!1,X=Q.font,ce=X.common.scaleW,te=X.common.scaleH,Z=this._layout.glyphs.filter(function(ge){var oe=ge.data;return oe.width*oe.height>0});this._visibleGlyphs=Z;var Ae=ee.attributes(Z,ce,te,F,this._layout),ue=ee.infos(Z,this._layout),Be=function(ge,oe){ge&&(G(ge)||Ue(ge))||(oe=ge||{},ge=null);for(var xe=typeof(oe=typeof oe=="number"?{count:oe}:oe||{}).type=="string"?oe.type:"uint16",me=typeof oe.count=="number"?oe.count:1,Pe=oe.start||0,de=oe.clockwise!==!1?qe:Ye,Xe=de[0],We=de[1],ae=de[2],Qe=6*me,z=ge||new(V(xe))(Qe),ye=0,Te=0;ye<Qe;ye+=6,Te+=4){var Ve=ye+Pe;z[Ve+0]=Te+0,z[Ve+1]=Te+1,z[Ve+2]=Te+2,z[Ve+3]=Te+Xe,z[Ve+4]=Te+We,z[Ve+5]=Te+ae}return z}([],{clockwise:!0,type:"uint16",count:Z.length});if(this.setIndex(Be),this.setAttribute("position",new i.BufferAttribute(Ae.positions,2)),this.setAttribute("center",new i.BufferAttribute(Ae.centers,2)),this.setAttribute("uv",new i.BufferAttribute(Ae.uvs,2)),this.setAttribute("layoutUv",new i.BufferAttribute(Ae.layoutUvs,2)),this.setAttribute("glyphUv",new i.BufferAttribute(Ae.glyphUvs,2)),this.setAttribute("glyphResolution",new i.BufferAttribute(Ae.glyphResolution,2)),this.setAttribute("lineIndex",new i.BufferAttribute(ue.lineIndex,1)),this.setAttribute("lineLettersTotal",new i.BufferAttribute(ue.lineLettersTotal,1)),this.setAttribute("lineLetterIndex",new i.BufferAttribute(ue.lineLetterIndex,1)),this.setAttribute("lineWordsTotal",new i.BufferAttribute(ue.lineWordsTotal,1)),this.setAttribute("lineWordIndex",new i.BufferAttribute(ue.lineWordIndex,1)),this.setAttribute("wordIndex",new i.BufferAttribute(ue.wordIndex,1)),this.setAttribute("letterIndex",new i.BufferAttribute(ue.letterIndex,1)),!Q.multipage&&"page"in this.attributes)this.deleteAttribute("page");else if(Q.multipage){var De=ee.pages(Z);this.setAttribute("page",new i.BufferAttribute(De,1))}}}},{key:"computeBoundingSphere",value:function(){this.boundingSphere===null&&(this.boundingSphere=new i.Sphere);var Q=this.attributes.position.array,F=this.attributes.position.itemSize;if(!Q||!F||Q.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);ve.computeSphere(Q,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}},{key:"computeBoundingBox",value:function(){this.boundingBox===null&&(this.boundingBox=new i.Box3);var Q=this.boundingBox,F=this.attributes.position.array,X=this.attributes.position.itemSize;if(F&&X&&!(F.length<2))return ve.computeBox(F,Q);Q.makeEmpty()}},{key:"_validateOptions",value:function(Q){if(typeof Q=="string"&&(Q={text:Q}),!(Q=Object.assign({},this._options,Q)).font)throw new TypeError("must specify a { font } in options");return Q}}]),S}(i.BufferGeometry),Ge={common:{uOpacity:{value:1},uColor:{value:{r:255,g:255,b:255}},uMap:{value:null}},rendering:{uThreshold:{value:.05},uAlphaTest:{value:.01}},strokes:{uStrokeColor:{value:{r:255,g:0,b:0}},uStrokeOutsetWidth:{value:0},uStrokeInsetWidth:{value:.3}}},rt={side:i.FrontSide,transparent:!0,defines:{IS_SMALL:!1},extensions:{derivatives:!0},uniforms:a(a(a({},Ge.common),Ge.rendering),Ge.strokes),vertexShader:`#define GLSLIFY 1
attribute vec2 layoutUv;attribute float lineIndex;attribute float lineLettersTotal;attribute float lineLetterIndex;attribute float lineWordsTotal;attribute float lineWordIndex;attribute float wordIndex;attribute float letterIndex;varying vec2 vUv;varying vec2 vLayoutUv;varying vec3 vViewPosition;varying vec3 vNormal;varying float vLineIndex;varying float vLineLettersTotal;varying float vLineLetterIndex;varying float vLineWordsTotal;varying float vLineWordIndex;varying float vWordIndex;varying float vLetterIndex;void main(){vec4 mvPosition=vec4(position,1.0);mvPosition=modelViewMatrix*mvPosition;gl_Position=projectionMatrix*mvPosition;vUv=uv;vLayoutUv=layoutUv;vViewPosition=-mvPosition.xyz;vNormal=normal;vLineIndex=lineIndex;vLineLettersTotal=lineLettersTotal;vLineLetterIndex=lineLetterIndex;vLineWordsTotal=lineWordsTotal;vLineWordIndex=lineWordIndex;vWordIndex=wordIndex;vLetterIndex=letterIndex;}`,fragmentShader:`#define GLSLIFY 1
varying vec2 vUv;uniform float uOpacity;uniform float uThreshold;uniform float uAlphaTest;uniform vec3 uColor;uniform sampler2D uMap;uniform vec3 uStrokeColor;uniform float uStrokeOutsetWidth;uniform float uStrokeInsetWidth;float median(float r,float g,float b){return max(min(r,g),min(max(r,g),b));}void main(){vec3 s=texture2D(uMap,vUv).rgb;float sigDist=median(s.r,s.g,s.b)-0.5;float afwidth=1.4142135623730951/2.0;
#ifdef IS_SMALL
float alpha=smoothstep(uThreshold-afwidth,uThreshold+afwidth,sigDist);
#else
float alpha=clamp(sigDist/fwidth(sigDist)+0.5,0.0,1.0);
#endif
float sigDistOutset=sigDist+uStrokeOutsetWidth*0.5;float sigDistInset=sigDist-uStrokeInsetWidth*0.5;
#ifdef IS_SMALL
float outset=smoothstep(uThreshold-afwidth,uThreshold+afwidth,sigDistOutset);float inset=1.0-smoothstep(uThreshold-afwidth,uThreshold+afwidth,sigDistInset);
#else
float outset=clamp(sigDistOutset/fwidth(sigDistOutset)+0.5,0.0,1.0);float inset=1.0-clamp(sigDistInset/fwidth(sigDistInset)+0.5,0.0,1.0);
#endif
float border=outset*inset;if(alpha<uAlphaTest)discard;vec4 filledFragColor=vec4(uColor,uOpacity*alpha);gl_FragColor=filledFragColor;}`},ri=function(b){c(S,b);var B=p(S);function S(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return n(this,S),Q=Object.assign(JSON.parse(JSON.stringify(rt)),Q),B.call(this,Q)}return l(S)}(i.ShaderMaterial);t.MSDFTextGeometry=Ce,t.MSDFTextMaterial=ri,t.uniforms=Ge,Object.defineProperty(t,"__esModule",{value:!0})})})(Va,Va.exports);var co=Va.exports;const Fa={file:"./webgl/components/ComponentText/settings.js",scale:{x:1,y:1,z:1},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},material:{uniforms:{uAlphaThreshold:{value:.5},uAlphaWidth:{value:.1},uOpacity:{value:1},uColor:{value:"#ffffff"}}}};class Tu extends we(Ut){init(e={}){this._debug=e.debugFolder,this._content=e.content,this._font=e.font,this._size=e.size||.005,this.settings=Fa,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$profiler.addObject(this._mesh,`ComponentText '${this._content}'`),this.debugFolder=this._createDebugFolder()}get mesh(){return this._mesh}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){const e=$.get(`${this._font}-fnt`);return new co.MSDFTextGeometry({text:this._content,font:e})}_createMaterial(){const e=$.get(`${this._font}-atlas`),t=new co.MSDFTextMaterial;return t.uniforms.uMap.value=e,t}_createMesh(){const e=new U(this._geometry,this._material);return e.rotation.x=Math.PI,e.scale.set(this._size,this._size,this._size),this.add(e),e.position.x=-e.geometry.layout.width/2*this._size,e.position.y=-e.geometry.layout.height/2*this._size,e}onWindowResize(e){}update({time:e,deltaTime:t,frame:i}){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:`ComponentText '${this._content}'`});return this.$debugger.registerFile(Fa,Fa.file),e}_updateSettings(){}}class sr extends we(){init(e={}){this._width=e.width||2048,this._height=e.height||2048,this._debugFolder=e.debugFolder,this._renderTarget=this._createRenderTarget(this._width,this._height),this._scene=this._createScene(),this._camera=this._createCamera(),this._components=this._createComponents(),this._addEventListeners()}destroy(){this._renderTarget.dispose(),this._scene.destroy(),this._camera.destroy();for(const e in this._components)typeof this._components[e].destroy=="function"&&this._components[e].destroy()}get texture(){return this._renderTarget.texture}get renderTarget(){return this._renderTarget}get scene(){return this._scene}get dotsColor(){return this._dotsColor}set dotsColor(e){this._dotsColor=e;for(const t in this._components)this._components[t]._material&&!this._components[t].color&&(this._components[t]._material.uniforms.uColor.value=e)}get centerOffset(){return this._centerOffset}set centerOffset(e){this._centerOffset=e;for(const t in this._components)this._components[t].isCenterOffset&&this._components[t].position.set(this._centerOffset.x,this._centerOffset.y,0)}get circlesBorderWidth(){return this._cirblesBorderWidth}set circlesBorderWidth(e){this._cirblesBorderWidth=e;for(const t in this._components)this._components[t]._material&&this._components[t]._material.uniforms.uBorderWidth&&(this._components[t]._material.uniforms.uBorderWidth.value=e)}playCirclesAnimation(){this._isAnimationPlaying=!0,this._circlesTl=new R.timeline({paused:!0,onComplete:()=>{R.set([this._components.circlePlane.mesh.scale,this._components.circlePlane1.mesh.scale],{x:0,y:0}),this._isAnimationPlaying=!1,this.$nuxtApp.callHook("score:animationDone")}}),this._circlesTl.fromTo(this._components.circlePlane.material.uniforms.uOpacity,{value:0},{value:1,duration:.01}),this._circlesTl.fromTo(this._components.circlePlane.mesh.scale,{x:.1,y:.1},{x:2.3,y:2.3,duration:1.2},0),this._circlesTl.to(this._components.circlePlane.material.uniforms.uOpacity,{value:0,duration:.2},.7),this._circlesTl.fromTo(this._components.circlePlane1.material.uniforms.uOpacity,{value:0},{value:1,duration:.01},.4),this._circlesTl.fromTo(this._components.circlePlane1.mesh.scale,{x:.1,y:.1},{x:2.3,y:2.3,duration:1.2},.4),this._circlesTl.to(this._components.circlePlane1.material.uniforms.uOpacity,{value:0,duration:.2},1),this._circlesTl.add(()=>{this.$nuxtApp.callHook("score:display")},.8),this._circlesTl.timeScale(1.3),this._circlesTl.play()}playStarsAnimation(){this._isAnimationPlaying=!0,this._starsTl=new R.timeline({paused:!0,onComplete:()=>{R.set(this._components.starsPlane.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane1.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane2.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane3.scale,{x:0,y:0,z:0}),this._isAnimationPlaying=!1,this.$nuxtApp.callHook("score:animationDone")}}),this._starsTl.fromTo(this._components.starsPlane.scale,{x:0,y:0,z:0},{x:9,y:9,z:9,duration:2.6,ease:"linear"}),this._starsTl.fromTo(this._components.starsPlane1.scale,{x:0,y:0,z:0},{x:9,y:9,z:9,duration:2.6,ease:"linear"},.4),this._starsTl.fromTo(this._components.starsPlane2.scale,{x:0,y:0,z:0},{x:9,y:9,z:9,duration:2.6,ease:"linear"},.9),this._starsTl.fromTo(this._components.starsPlane3.scale,{x:0,y:0,z:0},{x:9,y:9,z:9,duration:2.6,ease:"linear"},1.2),this._starsTl.add(()=>{this.$nuxtApp.callHook("score:display")},1.8),this._starsTl.timeScale(1.3),this._starsTl.play()}playBallAnimation(){const e=new R.timeline({paused:!0});e.fromTo(this._components.ball.rotation,{z:0},{z:-Math.PI*4,duration:1.3,ease:"none"}),e.fromTo(this._components.ball.position,{x:-1.2},{x:1.5,duration:1.8,ease:"power1.out"},0),e.timeScale(1.3),e.play()}playLostBallAnimation(){this._isAnimationPlaying=!0,this._lostBallTl=new R.timeline({paused:!0,onComplete:()=>{for(let t=0;t<this._lifeBallsArray.length;t++)this._components[`ball${t+1}`].position.set(-1.2-.4*(2-t+1),this._ballY,0);this._isAnimationPlaying=!1,this.$nuxtApp.callHook("score:animationDone")}});const e=this._ballsLeft;this._lifeBallsArray.forEach((t,i)=>{const s=2-i;this._lostBallTl.fromTo(t.rotation,{z:0},{z:-Math.PI*6,duration:.8,ease:"power3.out"},s*.05),this._lostBallTl.to(t.position,{x:"+=2",duration:.8,ease:"power3.out"},s*.05)}),this._lostBallTl.fromTo(this._lifeBallsArray[e].material,{opacity:1},{opacity:.3,duration:.2,ease:"steps(1)",repeat:2,yoyo:!0}),this._lostBallTl.to(this._lifeBallsArray[e].position,{y:-.6,x:"-=0.1",duration:.5,ease:"power3.in"},"-=0.3"),this._lostBallTl.fromTo(this._lifeBallsArray[e].rotation,{z:0},{z:Math.PI*2,duration:.4,ease:"Power2.in"},"<"),this._lostBallTl.to(this._lifeBallsArray[e].material,{opacity:0,duration:.01}),this._lifeBallsArray.forEach((t,i)=>{if(i===e)return;const s=2-i;this._lostBallTl.fromTo(t.rotation,{z:0},{z:-Math.PI*3,duration:1.1,ease:"power3.out"},1.6+s*.05),this._lostBallTl.to(t.position,{x:"+=1.4",duration:1.1,ease:"power3.out"},"<")}),this._lostBallTl.add(()=>{this.$nuxtApp.callHook("score:display")},1.9),this._lostBallTl.timeScale(1),this._lostBallTl.play()}stopAnimations(){this._circlesTl&&this._circlesTl.kill(),this._starsTl&&this._starsTl.kill(),R.set([this._components.circlePlane.mesh.scale,this._components.circlePlane1.mesh.scale],{x:0,y:0}),R.set(this._components.starsPlane.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane1.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane2.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane3.scale,{x:0,y:0,z:0})}resetAnimations(){for(let e=0;e<this._lifeBallsArray.length;e++)this._components[`ball${e+1}`].material.opacity=1;R.set([this._components.circlePlane.mesh.scale,this._components.circlePlane1.mesh.scale],{x:0,y:0}),R.set(this._components.starsPlane.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane1.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane2.scale,{x:0,y:0,z:0}),R.set(this._components.starsPlane3.scale,{x:0,y:0,z:0})}_createRenderTarget(e,t){const i=new dt(e,t,{minFilter:Mi,magFilter:Mi,format:vi,type:ct,colorSpace:po,depthBuffer:!1,stencilBuffer:!1,samples:4});return i.texture.generateMipmaps=!1,i}_createScene(e=[]){const t=new rs;return t.background=new _e(0),t}_createCamera(){const e=new fo(-1,1,1,-1,0,1);return e.position.z=1,e}_createComponents(){const e={};e.circlePlane=new lo({debugFolder:this._debug,isCenterOffset:!1}),this._scene.add(e.circlePlane),e.circlePlane1=new lo({debugFolder:this._debug,isCenterOffset:!1}),this._scene.add(e.circlePlane1),e.starsPlane=new Ls({debugFolder:this._debug,layer:0,color:"#ffffff"}),this._scene.add(e.starsPlane),e.starsPlane1=new Ls({debugFolder:this._debug,layer:1,border:!0}),this._scene.add(e.starsPlane1),e.starsPlane2=new Ls({debugFolder:this._debug,layer:2,color:"#580e1c"}),this._scene.add(e.starsPlane2),e.starsPlane3=new Ls({debugFolder:this._debug,layer:3,border:!0}),this._scene.add(e.starsPlane3);const t=new Ft(1,1),i=new It({map:$.get("ball-texture"),transparent:!0});this._ballY=.22,e.ball=new U(t,i),e.ball.position.set(-1.2,this._ballY,0),e.ball.scale.set(.29,.29,.29),this._scene.add(e.ball),this._lifeBallsArray=[];for(let s=0;s<3;s++)e[`ball${s+1}`]=new U(t,i.clone()),e[`ball${s+1}`].position.set(-1.2-.4*(2-s+1),this._ballY,0),e[`ball${s+1}`].scale.set(.29,.29,.29),this._scene.add(e[`ball${s+1}`]),this._lifeBallsArray.push(e[`ball${s+1}`]);return e}_addEventListeners(){this.$nuxtApp.hook("game:start",()=>{this._isAnimationPlaying||this.playBallAnimation()}),this.$nuxtApp.hook("game:over",()=>{this.stopAnimations(),this.resetAnimations()}),this.$nuxtApp.hook("ball:lose",()=>{this._ballsLeft=this.$root.getRemainingLives(),!(this._ballsLeft>2)&&(this.stopAnimations(),this.playLostBallAnimation())}),this.$nuxtApp.hook("score:circles",()=>{this._isAnimationPlaying||(this.stopAnimations(),this.playCirclesAnimation())}),this.$nuxtApp.hook("score:stars",()=>{this._isAnimationPlaying||(this.stopAnimations(),this.playStarsAnimation())})}resize(e,t){this._width=e,this._height=t,this._renderTarget.setSize(e,t)}render(e,t,i){if(!this._scene)return;const s=e.getRenderTarget();e.setRenderTarget(this._renderTarget),e.render(this._scene,this._camera),e.setRenderTarget(s)}_createDebugFolder(){this._debugFolder&&this._debugFolder.addFolder({title:"DotVisualsRenderer"})}}const Bi={file:"./webgl/components/ComponentBall/settings.js",position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},ballMaterial:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1.4},specularIntensity:{value:1},shininess:{value:50,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},matcap:{map:{value:"matcap-metal",type:"texture"},intensity:{value:1},offset:{value:{x:0,y:0}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.1},noiseChannel:{value:{x:1,y:1,z:0}}},normal:{map:{value:"perlin-combined",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:0,y:.99}}},customShader:{shadersName:"ball",additionalUniforms:{uHeightMap:{value:null,debug:!1},uHeightPlaneResolution:{value:{x:20.5,y:10}},uBallPos:{value:{x:-2.27,y:-4.35}},uBallRot:{value:{x:134.87318021303034,y:0}},uOffset:{value:{x:0,y:0}},uActiveHeightMapChannel:{value:2}}},pointLights:!0},ballShadowMaterial:{customShader:{transparent:!0,blending:1,depthTest:{value:!0},depthWrite:{value:!1},shadersName:"ballShadow",additionalUniforms:{uHeightMap:{value:null,debug:!1},uHeightPlaneResolution:{value:{x:20.5,y:10}},uBallPos:{value:{x:-2.27,y:-4.35}},uOffset:{value:{x:0,y:0}},uActiveHeightMapChannel:{value:2}}}}},Nu=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;void main(){vec4 pos=projectionMatrix*modelViewMatrix*vec4(position,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,Fu=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_FragColor=vec4(1.0,0.0,0.0,1.0);}`,Uu=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;uniform sampler2D uHeightMap;uniform vec2 uHeightPlaneResolution;uniform vec2 uBallPos;uniform vec2 uOffset;uniform float uActiveHeightMapChannel;void main(){vec4 pos=vec4(position,1.0);vec2 heightUv=vec2(((uBallPos.x+(uHeightPlaneResolution.x/2.))/uHeightPlaneResolution.x),((uBallPos.y+(uHeightPlaneResolution.y/2.))/uHeightPlaneResolution.y)+uOffset.y);vec3 s=texture2D(uHeightMap,heightUv).rgb;float activeChannel=0.0;if(uActiveHeightMapChannel==0.0){activeChannel=s.r;}if(uActiveHeightMapChannel==1.0){activeChannel=s.g;}if(uActiveHeightMapChannel==2.0){activeChannel=s.b;}float cosAngle=cos(1.57);float sinAngle=sin(1.57);mat4 rotationMatrix=mat4(1.0,0.0,0.0,0.0,0.0,cosAngle,-sinAngle,0.0,0.0,sinAngle,cosAngle,0.0,0.0,0.0,0.0,1.0);pos=rotationMatrix*pos;pos.y+=activeChannel*3.5;gl_Position=projectionMatrix*modelViewMatrix*pos;vUv=uv;vPosition=gl_Position;}`,Ou=`#define GLSLIFY 1
varying vec2 vUv;void main(){float strength=1.0-(0.2/(distance(vUv,vec2(0.5))));float alpha=pow(0.1/(distance(vUv,vec2(0.5))),10.);gl_FragColor=vec4(vec3(strength),alpha);}`,ku=`#define GLSLIFY 1
attribute vec4 aPosition;varying vec2 vUv;varying vec4 vPosition;uniform float uTime;uniform float uScaleBase;uniform float uScaleFactor;uniform float uScaleSpeed;void main(){vec3 transformed=vec3(position);transformed*=uScaleBase+abs(sin(uTime*uScaleSpeed+aPosition.z*10.0))*uScaleFactor;transformed.xy+=aPosition.xy;transformed.z+=0.01;vec4 pos=projectionMatrix*modelViewMatrix*vec4(transformed,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(transformed,1.0);;}`,Gu=`#define GLSLIFY 1
varying vec2 vUv;uniform vec3 uColor;void main(){float gradient=distance(vec2(0.5),vUv)+0.6;float circle=1.0-smoothstep(0.1,0.55,distance(vec2(0.5),vUv));gl_FragColor.rgb=mix(vec3(2.0),uColor,gradient);gl_FragColor.a=circle;}`,Ao={sample:{vertexShader:Nu,fragmentShader:Fu},stickers:{vertexShader:ko,fragmentShader:Go},ballShadow:{vertexShader:Uu,fragmentShader:Ou},miniLights:{vertexShader:ku,fragmentShader:Gu}};class sn extends je{constructor(e){const t=e.settings,i=t.customShader?Ao[t.customShader.shadersName]:Ao.sample;t.customShader&&t.customShader.shadersName;const s={};e.settings.customShader&&e.settings.customShader.additionalUniforms&&Object.keys(e.settings.customShader.additionalUniforms).forEach(n=>{e.settings.customShader.additionalUniforms[n].type==="texture"?s[n]={value:$.get(e.settings.customShader.additionalUniforms[n].value)}:e.settings.customShader.additionalUniforms[n].type==="color"?s[n]={value:new _e(e.settings.customShader.additionalUniforms[n].value)}:e.settings.customShader.additionalUniforms[n].type==="vector2"?s[n]={value:new T(e.settings.customShader.additionalUniforms[n].value.x,e.settings.customShader.additionalUniforms[n].value.y)}:e.settings.customShader.additionalUniforms[n].type==="vector3"?s[n]={value:new O(e.settings.customShader.additionalUniforms[n].value.x,e.settings.customShader.additionalUniforms[n].value.y,e.settings.customShader.additionalUniforms[n].value.z)}:s[n]={value:e.settings.customShader.additionalUniforms[n].value}});const a={...s};super({uniforms:a,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:e.settings.customShader.side||ja,blending:e.settings.customShader.blending||1,transparent:e.settings.customShader.transparent||!1,depthTest:e.settings.customShader.depthTest?e.settings.customShader.depthTest.value:!0,depthWrite:e.settings.customShader.depthWrite?e.settings.customShader.depthWrite.value:!0,name:t.customShader?t.customShader.shadersName:"CSShaderMaterial"})}}class Hu extends we(Ut){init(e){this._debug=e.debugFolder,this.settings=Bi,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this._ballShadowMesh=this._createBallShadowMesh(),this.debugFolder=this._createDebugFolder()}get mesh(){return this._mesh}get shadowMesh(){return this._ballShadowMesh}setActiveHeightMapChannel(e){this._material.uniforms.uActiveHeightMapChannel.value=e,this._ballShadowMesh.material.uniforms.uActiveHeightMapChannel.value=e}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){return new Ks(.115,32,32)}_createMaterial(){const e=new Pi({settings:Bi.ballMaterial});return e.uniforms.uHeightMap.value=$.get("heightmap"),e}_createMesh(){const e=new U(this._geometry,this._material);return e.name="ball",this.$profiler.add(e,"Ball"),this.add(e),e}_createBallShadowGeometry(){return new Ft(1,1,1)}_createBallShadowMaterial(){const e=new sn({settings:Bi.ballShadowMaterial}),t=$.get("heightmap");return t.minFilter=Mi,e.uniforms.uHeightMap.value=t,e}_createBallShadowMesh(){const e=this._createBallShadowGeometry(),t=this._createBallShadowMaterial(),i=new U(e,t);return i.position.y=-.1,this.add(i),i}update({time:e,deltaTime:t,frame:i,ballBody:s}){this._mesh.position.x=s.position[0],this._mesh.position.z=s.position[1],this._ballShadowMesh.position.x=s.position[0],this._ballShadowMesh.position.z=s.position[1];const a=s.velocity[0],n=s.velocity[1],r=.115,l=n/r,h=a/r;this._material.uniforms.uBallRot.value.x-=l*.02*(t/16),this._material.uniforms.uBallRot.value.y=h*.2*(t/16),this._material.uniforms.uBallPos.value.x=this._mesh.position.x,this._material.uniforms.uBallPos.value.y=this._mesh.position.z,this._ballShadowMesh.material.uniforms.uBallPos.value.x=this._mesh.position.x,this._ballShadowMesh.material.uniforms.uBallPos.value.y=this._mesh.position.z}onWindowResize(e){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Ball",expanded:!1});return yi(e,Bi.ballMaterial,this._material),this.$debugger.registerFile(Bi,Bi.file),e}_settingsChangeHandler(e){}}const Wt={file:"./webgl/components/ComponentFlipper/settings.js",baseMaterial:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:0},shininess:{value:50,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},ao:{map:{value:"floor-ao",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:2}}},materials:{base:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},useVertexColors:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:.09999999999999998},shininess:{value:24,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}}},blackWhite:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.58},useVertexAO:{value:!0},useVertexColors:{value:!0},aoVertexIntensity:{value:.86}},lighting:{ambientIntensity:{value:.76},diffuseIntensity:{value:1.69},specularIntensity:{value:.059999999999999866},shininess:{value:200,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},customShader:{shadersName:"blackWhite",additionalUniforms:{}}},shades:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:.38999999999999996},saturation:{value:1},brightness:{value:2},useVertexAO:{value:!0},aoVertexIntensity:{value:1.6600000000000001}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:1},shininess:{value:15,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"shades-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}}},ground:{options:{fog:{value:!0},wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:0},shininess:{value:50,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"ground-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},ao:{map:{value:"ground-shadow-combined",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:.8}},customShader:{shadersName:"ground",additionalUniforms:{uColorTex:{value:"shades-alb",type:"texture"},uBordersColor:{value:"#ca0707",type:"color"},uLightIntensity:{value:1}}},pointLights:!0},lips:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.05},useVertexAO:{value:!0},aoVertexIntensity:{value:1.0399999999999998}},lighting:{ambientIntensity:{value:5.87},diffuseIntensity:{value:.21},specularIntensity:{value:.56},shininess:{value:41,params:{step:1,min:0,max:200}},ambientColor:{value:"#ff0000"},diffuseColor:{value:"#ff7f7f"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}}},text:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:1},shininess:{value:17,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"stickers-ground-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},normal:{map:{value:"stickers-ground-nrm",type:"texture"},scale:{value:{x:4,y:4}},repeat:{value:{x:1,y:1}}},alpha:{map:{value:"stickers-ground-alpha",type:"texture"},width:{value:.42999999999999994},threshold:{value:.6399999999999999}}},lipstick:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:.78},diffuseIntensity:{value:.6299999999999999},specularIntensity:{value:.36},shininess:{value:39,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"lipstick-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},normal:{map:{value:"lipstick-nrm",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:1.9299999999999997,y:0}},intensity:{value:1}}},lipstickBumper:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:2.09},useVertexAO:{value:!0},aoVertexIntensity:{value:.39999999999999997}},lighting:{ambientIntensity:{value:.53},diffuseIntensity:{value:.65},specularIntensity:{value:1.25},shininess:{value:15,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"lipstick-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},normal:{map:{value:"lipstick-nrm",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:0,y:0}},intensity:{value:1}},alpha:{map:{value:"lipstick-alpha",type:"texture"},width:{value:0},threshold:{value:0}},customShader:{shadersName:"lipstick",additionalUniforms:{uColorTex:{value:"shades-alb",type:"texture"}}},pointLights:!0},lipstickLot:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.78},useVertexAO:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:4.5},diffuseIntensity:{value:.59},specularIntensity:{value:1.6999999999999997},shininess:{value:15,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#7c7c7c"}},albedo:{map:{value:"lipstick-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:.97}},alpha:{map:{value:"lipstick-alpha",type:"texture"},width:{value:0},threshold:{value:0}},normal:{map:{value:"lipstick-nrm",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:0,y:0}},intensity:{value:1}},customShader:{shadersName:"lipstick",additionalUniforms:{uColorTex:{value:"shades-alb",type:"texture"}}},pointLights:!0},launcherStick:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.5},useVertexAO:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:2},specularIntensity:{value:1},shininess:{value:39,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"lipstick-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},normal:{map:{value:"lipstick-nrm",type:"texture"},scale:{value:{x:1,y:1}},repeat:{value:{x:1,y:1}}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:.4,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:0}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.3},noiseChannel:{value:{x:0,y:0,z:0}}},customShader:{shadersName:"launcherStick",additionalUniforms:{uBendAmount:{value:0}}}},metalMatcap:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1.4000000000000001},useVertexAO:{value:!0},aoVertexIntensity:{value:1.08},side:2},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:1},specularIntensity:{value:4},shininess:{value:9.999999999999996},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},matcap:{map:{value:"matcap-metal",type:"texture"},intensity:{value:1.5,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:.01}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.3},noiseChannel:{value:{x:0,y:0,z:0}}},pointLights:!0},blanket:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1.0000000000000002},saturation:{value:1},brightness:{value:1.02},useVertexAO:{value:!0},aoVertexIntensity:{value:1.1}},lighting:{ambientIntensity:{value:1.5399999999999998},diffuseIntensity:{value:2},specularIntensity:{value:.29999999999999966},shininess:{value:.9999999999999979},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:1.3000000000000003,params:{step:.1,min:-10,max:10}},offset:{value:{x:-.25,y:-.29000000000000004}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.09999999999999998},noiseChannel:{value:{x:.2,y:.2,z:0}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:.17,y:1.21}},intensity:{value:.9999999999999997}},lights:["light_01"],pointLights:!0},stool:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:.16999999999999998},diffuseIntensity:{value:.5800000000000001},specularIntensity:{value:1},shininess:{value:100},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:1.0999999999999999,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:0}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1,y:1}},noiseIntensity:{value:.3},noiseChannel:{value:{x:0,y:0,z:0}}},customShader:{shadersName:"stool",additionalUniforms:{}},lights:["light_01","light_02"],pointLights:!0},cible:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},useVertexColors:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:.7},diffuseIntensity:{value:.5800000000000001},specularIntensity:{value:10},shininess:{value:100},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}}},tube:{options:{wireframe:{value:!1},opacity:{value:.79},contrast:{value:1.07},saturation:{value:1.1},brightness:{value:1.01},useVertexAO:{value:!0},aoVertexIntensity:{value:1},side:2},lighting:{ambientIntensity:{value:1.87},diffuseIntensity:{value:1},specularIntensity:{value:1.9999999999999998},shininess:{value:50},ambientColor:{value:"#00bdff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffa6f6"},emissiveColor:{value:"#000000"}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:1.0999999999999999,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:.04}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1.08,y:1}},noiseIntensity:{value:.07999999999999999},noiseChannel:{value:{x:-.07,y:.23,z:.02}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:0,y:0}},intensity:{value:1}}},neons:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:2},useVertexAO:{value:!0},aoVertexIntensity:{value:1},side:2},lighting:{ambientIntensity:{value:-20816681711721685e-32},diffuseIntensity:{value:12129186544029835e-30},specularIntensity:{value:10.000000000000004},shininess:{value:4.999999999999998},ambientColor:{value:"#eb0000"},diffuseColor:{value:"#ff729c"},specularColor:{value:"#ff5252"},emissiveColor:{value:"#ffffff"}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:1.0999999999999999,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:.04}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1.08,y:1}},noiseIntensity:{value:.07999999999999999},noiseChannel:{value:{x:-.07,y:.23,z:.02}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:0,y:0}},intensity:{value:1}}},launcherRessort:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!0},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:.999999999999999},diffuseIntensity:{value:50},specularIntensity:{value:60},shininess:{value:9.999999999999998},ambientColor:{value:"#ff4100"},diffuseColor:{value:"#ff2000"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#ffffff"}},matcap:{map:{value:"matcap-sample",type:"texture"},intensity:{value:1.0999999999999999,params:{step:.1,min:-10,max:10}},offset:{value:{x:0,y:.04}},noise:{value:"perlin-combined",type:"texture"},noiseRepeat:{value:{x:1.08,y:1}},noiseIntensity:{value:.07999999999999999},noiseChannel:{value:{x:-.07,y:.23,z:.02}}},env:{map:{value:"env-sample",type:"texture"},rotation:{value:{x:0,y:0}},intensity:{value:1}}}},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}};class zu extends we(Ut){init(e){this._debug=e.debugFolder,this._materials={},this.settings=Wt,this._createMaterials(),this._mesh=this._createMesh(),this.debugFolder=this._createDebugFolder()}get topFlipper(){return this._mesh.getObjectByName("flipper-top-empty")}get leftFlipper(){return this._mesh.getObjectByName("flipper-left-empty")}get rightFlipper(){return this._mesh.getObjectByName("flipper-right-empty")}get mirror(){return this._mesh.getObjectByName("mirror-metal-matcap")}initFlipperLights(){this._materials.ground.uniforms.uLightIntensity.value=Wt.materials.ground.customShader.additionalUniforms.uLightIntensity.value}increaseFlipperLights(){R.to(this._materials.ground.uniforms.uLightIntensity,{duration:1,value:1,ease:"power3.inOut"})}reduceFlipperLights(){R.to(this._materials.ground.uniforms.uLightIntensity,{duration:1,value:.2,ease:"power3.inOut"})}animateLauncher(e){this._materials.launcherStick.uniforms.uBendAmount.value=Ct(this._materials.launcherStick.uniforms.uBendAmount.value+5e-4*e,0,1)}resetLauncher(){R.to(this._materials.launcherStick.uniforms.uBendAmount,{duration:.2,value:0,ease:"bounce.out"})}animateColliderObject(e,t,i){const s=this._mesh.getObjectByName(e);switch(t){case"rotateX":this._rotateAnimation(s,"x");break;case"rotateY":this._rotateAnimation(s,"y");break;case"scale":this._scaleAnimation(s);break;case"fall":this._fallAnimation(s,i);break;case"jump":this._jumpAnimation(s);break;case"push":this._pushAnimation(s);break;case"up":this._upAnimation(s);break}}resetColliderObjectsState(){this._mesh.traverse(e=>{e.isMesh&&(R.to(e.position,{duration:.4,x:e.userData.position.x,y:e.userData.position.y,z:e.userData.position.z,ease:"power3.inOut"}),e.rotation.set(e.userData.rotation.x,e.userData.rotation.y,e.userData.rotation.z),e.scale.set(e.userData.scale.x,e.userData.scale.y,e.userData.scale.z))})}destroy(){super.destroy();for(const e in this._materials)this._materials[e].dispose();this._materials=null}_createMaterials(){for(const e in Wt.materials)Wt.materials[e].type==="shader"?this._createShaderMaterial(e):this._createPhongMaterial(e)}_createPhongMaterial(e){const t=new Pi({settings:Wt.materials[e]});return this._materials[e]=t,t}_createShaderMaterial(e){const t=new sn({settings:Wt.materials[e]});return this._materials[e]=t,t}_createMesh(){const e=$.get("model-flipper").scene;return this.$profiler.addObject(e,"Model Flipper"),e.rotation.y=Math.PI,e.updateMatrixWorld(!0),e.traverse(t=>{t.isMesh&&(t.userData={position:{x:t.position.x,y:t.position.y,z:t.position.z},rotation:{x:t.rotation.x,y:t.rotation.y,z:t.rotation.z},scale:{x:t.scale.x,y:t.scale.y,z:t.scale.z}},t.name.includes("lipstick")&&(t.material=this._materials.lipstick),t.name==="lipstick-lot"&&(t.material=this._materials.lipstickLot,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("giant-lips")&&(t.material=this._materials.lips,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("text")&&(t.material=this._materials.text,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("cible")&&(t.material=this._materials.cible),t.name.includes("shades")&&(t.material=this._materials.shades,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("metal-matcap")&&(t.material=this._materials.metalMatcap),t.name.includes("tube")&&(t.material=this._materials.tube,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("neon")&&(t.material=this._materials.neons,t.userData.bloom=!0,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("launcher-ressort")&&(t.material=this._materials.launcherRessort,t.userData.bloom=!0,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("stool")&&(t.material=this._materials.stool),t.name==="launcher-stick"&&(t.material=this._materials.launcherStick),t.name.includes("lipstick-bumper")&&(t.material=this._materials.lipstickBumper),t.name.includes("blanket")&&(t.material=this._materials.blanket),t.name==="ramp"&&(t.material=this._materials.ramp,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name==="ground"&&(t.material=this._materials.ground,t.matrixAutoUpdate=!1,t.updateMatrix()),t.name.includes("black-white")&&(t.material=this._materials.blackWhite),t.name==="disc-score-light"&&(t.material=this._materials.neons,t.userData.bloom=!0,t.visible=!1))}),this.add(e),e}_rotateAnimation(e,t){const i=R.timeline({});switch(t){case"x":i.to(e.rotation,{duration:.9,x:e.rotation.x+Math.PI*4,ease:"power3.inOut"},0);break;case"y":i.to(e.rotation,{duration:.4,y:e.rotation.y+Math.PI*4,ease:"power3.inOut"},0);break}i.to(e.scale,{duration:.1,x:1.25,z:1.25,ease:"power3.inOut"},0),i.to(e.scale,{duration:.1,x:1,z:1,ease:"power3.inOut"},.2)}_scaleAnimation(e){const t=R.timeline({});t.to(e.scale,{duration:.1,x:1.3,z:1.3,ease:"power3.inOut"},0),t.to(e.scale,{duration:.1,x:1,z:1,ease:"power3.inOut"},.1)}_fallAnimation(e,t){R.timeline().to(e.position,{duration:.4,y:t?e.userData.position.y:e.position.y-4,ease:"power3.inOut"})}_upAnimation(e){R.timeline({}).to(e.position,{duration:.1,y:0,ease:"power3.inOut"},1)}_jumpAnimation(e){this._jumpTimeline=R.timeline({}),this._jumpTimeline.to(e.position,{duration:.3,y:.6,ease:"power3.inOut"},0),this._jumpTimeline.to(e.position,{duration:.3,y:0,ease:"bounce.out"},.4)}_pushAnimation(e){const t=R.timeline({});t.to(e.position,{duration:.1,z:e.position.z+.2,ease:"power3.inOut"},0),t.to(e.position,{duration:.1,z:e.position.z-.2,ease:"power3.inOut"},.35),t.to(e.position,{duration:.5,z:e.position.z,ease:"power3.inOut"},.45)}onUpdate({time:e,deltaTime:t,frame:i}){}onWindowResize(e){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Flipper",expanded:!1});this._debug.addButton({title:"Animate Object"}).on("click",()=>{this.animateColliderObject("beauty-hub-empty","scale"),this.animateColliderObject("lipstick-bumper-right","jump")});for(const t in this._materials){const i=e.addFolder({title:t,expanded:!1});yi(i,Wt.materials[t],this._materials[t])}return this.$debugger.registerFile(Wt,Wt.file),e}_settingsChangeHandler(e){}}const pi={file:"./webgl/components/ComponentStickers/settings.js",materials:{stickers:{options:{wireframe:{value:!1},opacity:{value:1},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!1},aoVertexIntensity:{value:1}},lighting:{ambientIntensity:{value:1.7},diffuseIntensity:{value:1},specularIntensity:{value:.47},shininess:{value:37,params:{step:1,min:0,max:200}},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#ffffff"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},albedo:{map:{value:"stickers-ground-alb",type:"texture"},repeat:{value:{x:1,y:1}},intensity:{value:1}},normal:{map:{value:"stickers-ground-nrm",type:"texture"},scale:{value:{x:4,y:4}},repeat:{value:{x:1,y:1}}},alpha:{map:{value:"stickers-ground-alpha",type:"texture"},width:{value:.27999999999999997},threshold:{value:.6}},customShader:{shadersName:"stickers",additionalUniforms:{uAlbedoMap:{value:"stickers-ground-alb",type:"texture"},uAlphaMap:{value:"stickers-ground-alpha",type:"texture"},uEmissiveMap:{value:"stickers-ground-emi",type:"texture"},uShadowMap:{value:"stickers-ground-shadow",type:"texture"},uDataTexture:{value:null},uNbItems:{value:0},uLightIntensity:{value:2}}}}},position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}};class qu extends we(Ut){init(e){this._debug=e.debugFolder,this._materials={},this.settings=pi,this._stickersGeometries=[],this._stickersDictionnary={},this._createMaterials(),this._mesh=this._createMesh(),this._stickersState=this._createDataTexture(),this._mergedStickersGeometry=this._createMergedStickersGeometry(),this.debugFolder=this._createDebugFolder()}animateStickerOn(e,t){switch(t){case"blink":this._blinkAnimation(e,!1);break;case"blinkAndOff":this._blinkAnimation(e,!0);break}}animateStickerOff(e){this._stickersState.image.data[this._stickersDictionnary[e]]=0,this._stickersState.needsUpdate=!0}initStickersLights(){this._materials.stickers.uniforms.uLightIntensity.value=.1}reduceStickersLights(){R.to(this._materials.stickers.uniforms.uLightIntensity,{duration:2,value:0,ease:"bounce.out"})}increaseStickersLights(){this._blinkAllStickers(10),R.to(this._materials.stickers.uniforms.uLightIntensity,{duration:1,value:2,ease:"power3.inOut"})}animateLivesStickers(e){for(let t=1;t<=e;t++){const i=`sticker-score-${t}`;this.animateStickerOn(i,"blink")}}resetStickersState(){this._blinkAllStickers()}destroy(){super.destroy();for(const e in this._materials)this._materials[e].dispose()}_createMaterials(){for(const e in pi.materials)pi.materials[e].customShader?this._createShaderMaterial(e):this._createPhongMaterial(e)}_createShaderMaterial(e){const t=new Pi({settings:pi.materials[e]});return this._materials[e]=t,t}_createDataTexture(){const e=this._stickersGeometries.length,t=new Uint8Array(e);t.fill(0);const i=new uo(t,e,1,Si);return i.needsUpdate=!0,i}_createMergedStickersGeometry(){if(this._stickersGeometries.length>0){const e=ol(this._stickersGeometries,!0),t=new U(e,this._materials.stickers);this.add(t),this._materials.stickers.uniforms.uDataTexture.value=this._stickersState,this._materials.stickers.uniforms.uNbItems.value=this._stickersGeometries.length}}_createMesh(){const e=$.get("model-flipper").scene;this.$profiler.addObject(e,"Model Flipper"),e.updateMatrixWorld(!0);let t=0;return e.traverse(i=>{if(i.isMesh&&i.name.includes("sticker")){const s=i.geometry.clone(),a=i.matrixWorld.clone();s.applyMatrix4(a),t++,this._stickersDictionnary[i.name]=t;const n=new Float32Array(s.attributes.position.count);n.fill(t),s.setAttribute("geometryId",new rl(n,1)),this._stickersGeometries.push(s),i.visible=!1}}),e}_blinkAnimation(e,t=!1){const i={value:this._stickersState.image.data[this._stickersDictionnary[e]]};R.timeline({repeat:4,repeatDelay:.1,onComplete:()=>{t&&this.animateStickerOff(e)}}).to(i,{duration:.1,value:0,onUpdate:()=>{this._stickersState.image.data[this._stickersDictionnary[e]]=i.value,this._stickersState.needsUpdate=!0}}).to(i,{duration:.1,value:255,onUpdate:()=>{this._stickersState.image.data[this._stickersDictionnary[e]]=i.value,this._stickersState.needsUpdate=!0}})}_blinkAllStickers(e=10){const i=this._stickersState.image.data.length,s=R.timeline({onComplete:()=>{this._stickersState.image.data.fill(0),this._stickersState.needsUpdate=!0}});for(let a=0;a<e;a++)s.to(this._stickersState.image.data,{duration:.2,onStart:()=>{for(let n=0;n<i;n++){const r=Math.random()>.5?255:0;this._stickersState.image.data[n]=r}this._stickersState.needsUpdate=!0}});return s.to(this._stickersState.image.data,{duration:0,onStart:()=>{this._stickersState.image.data.fill(0),this._stickersState.needsUpdate=!0}}),s}onUpdate({time:e,deltaTime:t,frame:i}){}onWindowResize(e){}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"Stickers",expanded:!0});return yi(e,pi.materials.stickers,this._materials.stickers),e.addButton({title:"Blink Animation"}).on("click",()=>{this._blinkAnimation("sticker-arrows-launcher-ramp")}),e.addButton({title:"Blink All Animation"}).on("click",()=>{this._blinkAllStickers()}),this.$debugger.registerFile(pi,pi.file),e}_settingsChangeHandler(e){}}const ne={file:"./webgl/components/ComponentScorePlane/settings.js",scale:{x:.93,y:.93,z:.9},position:{x:.04430979609126176,y:.43,z:4.05},rotation:{x:-2.5808569013664995,y:0,z:3.118492104154829},uiPositionPlane:{scale:{x:.56,y:.29000000000000004,z:1},position:{x:3469446951953614e-33,y:.55,z:3469446951953614e-33},visible:!1},dotsColor:"#ff34a0",backgroundColor:"#580e1c",circlesBorderWidth:.08,visualsCenterOffset:{x:0,y:.3},material:{options:{wireframe:{value:!1},opacity:{value:.9},contrast:{value:1},saturation:{value:1},brightness:{value:1},useVertexAO:{value:!0},aoVertexIntensity:{value:1},shadows:{value:!1}},lighting:{ambientIntensity:{value:1},diffuseIntensity:{value:2.27},specularIntensity:{value:1},shininess:{value:3},ambientColor:{value:"#ffffff"},diffuseColor:{value:"#dd0000"},specularColor:{value:"#ffffff"},emissiveColor:{value:"#000000"}},customShader:{shadersName:"score",additionalUniforms:{uDotResolution:{value:{x:55,y:55}},uDotSize:{value:.44},uBackgroundColor:{value:"#580e1c",type:"color"}}}},miniLightsMaterial:{options:{wireframe:!1},lighting:{flemme:!0},customShader:{shadersName:"miniLights",transparent:!0,additionalUniforms:{uColor:{value:"#ff2189",type:"color"},uScaleBase:{value:.04},uScaleFactor:{value:.07},uScaleSpeed:{value:1},uTime:{value:0,debug:!1}}}}};class ar extends we(Ut){init(e={}){this._debug=e.debugFolder,this._dotVisualsRenderer=e.dotVisualsRenderer,this._dotVisualsRenderTarget=this._dotVisualsRenderer.renderTarget,this._dotVisualsScene=this._dotVisualsRenderer.scene,this._cameraManager=e.cameraManager,this.settings=ne,this._dotVisualsScene.background=new _e(ne.backgroundColor),this._dotVisualsRenderer.dotsColor=new _e(ne.dotsColor),this._dotVisualsRenderer.centerOffset=ne.visualsCenterOffset,this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this._uiPositionPlane=this._createUiPositionPlane(),this._centerVector=new O,this._centerLeftVector=new O,this._centerBottomVector=new O,this._centerTopVector=new O,this._timeSpeed={value:1},this._instancedMiniLights=this._createInstancedMiniLights(),this.$profiler.addObject(this._mesh,"scorePlane"),this.debugFolder=this._createDebugFolder(),this._addEventListeners()}get mesh(){return this._mesh}get screenPositionData(){const e=this._uiPositionPlane.geometry.parameters.width/2*ne.uiPositionPlane.scale.x*ne.scale.x,t=this._uiPositionPlane.geometry.parameters.height/2*ne.uiPositionPlane.scale.y*ne.scale.y;this._centerVector.x=this.position.x+ne.uiPositionPlane.position.x,this._centerVector.y=this.position.y+ne.uiPositionPlane.position.y,this._centerVector.z=this.position.z+ne.uiPositionPlane.position.z,this._centerLeftVector.copy(this._centerVector),this._centerLeftVector.x+=e,this._centerLeftVector.project(this._cameraManager.camera),this._centerBottomVector.copy(this._centerVector),this._centerBottomVector.y+=t,this._centerBottomVector.project(this._cameraManager.camera),this._centerVector.project(this._cameraManager.camera);const i=(this._centerLeftVector.x*.5+.5)*Je.innerWidth,s=(this._centerBottomVector.y*-.5+.5)*Je.innerHeight,a={x:(this._centerVector.x*.5+.5)*Je.innerWidth,y:(this._centerVector.y*-.5+.5)*Je.innerHeight},n=a.x+a.x-i,r=a.y+a.y-s,l=Math.abs(n-i);let h=Math.abs(r-s);const c=h*.17;return h+=c,a.y-=c/2,{center:a,width:l,height:h}}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose()}_createGeometry(){return new Ft(3,3,1)}_createMaterial(){const e=new Pi({settings:ne.material});return e.uniforms.uScoreMap={value:this._dotVisualsRenderTarget.texture},e}_createMesh(){const e=new U(this._geometry,this._material);return this.add(e),e}_createUiPositionPlane(){const e=new Ft(3,3,1),t=new It({color:16711680,depthWrite:!1,depthTest:!1,transparent:!0,opacity:.5}),i=new U(e,t);return i.visible=ne.uiPositionPlane.visible,i.scale.set(ne.uiPositionPlane.scale.x,ne.uiPositionPlane.scale.y,ne.uiPositionPlane.scale.z),i.position.set(ne.uiPositionPlane.position.x,ne.uiPositionPlane.position.y,ne.uiPositionPlane.position.z),this.add(i),i}_createInstancedMiniLights(){const e=new Ft(1,1),t=new ll().copy(e);this._miniLightsMaterial=new sn({settings:ne.miniLightsMaterial});const i=1.05,s=[19,20,21],a=3,n=.22;t.instanceCount=s[0]+s[1]+s[2];const r=[];for(let c=0;c<a;c++){const A=i+c*n;for(let d=0;d<s[c];d++){const m=d/s[c]*Math.PI+.45;let p=Math.cos(m)*A,f=Math.sin(m)*A;c===1&&(d===7||d===8||d===9)&&(p=1e3,f=1e3);const _=Math.random();r.push(p,f,_,c+1)}}const l=new Float32Array(r);t.setAttribute("aPosition",new cl(l,4,!1));const h=new U(t,this._miniLightsMaterial);return h.userData.bloom=!0,this.add(h),h}onWindowResize(e){}_addEventListeners(){this.$nuxtApp.hook("game:startLaunch",this._startLaunchHandler.bind(this)),this.$nuxtApp.hook("game:start",this._startHandler.bind(this))}_startLaunchHandler(){var e;this._isLaunching=!0,(e=this._launchTimeline)==null||e.kill(),this._launchTimeline=new R.timeline,this._launchTimeline.to(this._miniLightsMaterial.uniforms.uScaleBase,{value:ne.miniLightsMaterial.customShader.additionalUniforms.uScaleBase.value+.04,duration:3,ease:"Power2.in"},.2),this._launchTimeline.to(this._miniLightsMaterial.uniforms.uScaleFactor,{value:ne.miniLightsMaterial.customShader.additionalUniforms.uScaleFactor.value+.04,duration:3,ease:"Power2.in"},.2),this._launchTimeline.to(this._timeSpeed,{value:5,duration:3,ease:"Power2.in"},.2)}_startHandler(){var e;this._isLaunching=!1,(e=this._launchTimeline)==null||e.kill(),this._launchTimeline=new R.timeline,this._launchTimeline.to(this._miniLightsMaterial.uniforms.uScaleBase,{value:ne.miniLightsMaterial.customShader.additionalUniforms.uScaleBase.value,duration:.5,ease:"Power3.out"},0),this._launchTimeline.to(this._miniLightsMaterial.uniforms.uScaleFactor,{value:ne.miniLightsMaterial.customShader.additionalUniforms.uScaleFactor.value,duration:.5,ease:"Power3.out"},0),this._launchTimeline.to(this._timeSpeed,{value:1,duration:1,ease:"Power3.out"},0)}update({time:e,deltaTime:t,frame:i}){this._miniLightsMaterial.uniforms.uTime.value+=t*.002*this._timeSpeed.value}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:"ScorePlane"});e.addBinding(ne,"dotsColor",{label:"Dots Color",type:"color"}).on("change",()=>{this._dotVisualsRenderer.dotsColor=new _e(ne.dotsColor)}),e.addBinding(ne,"backgroundColor",{label:"Background Color",type:"color"}).on("change",()=>{this._dotVisualsScene.background=new _e(ne.backgroundColor)}),e.addBinding(ne,"circlesBorderWidth",{label:"Circles Border Width"}).on("change",()=>{this._dotVisualsRenderer.circlesBorderWidth=ne.circlesBorderWidth}),e.addBinding(ne,"visualsCenterOffset",{label:"Visuals Center Offset"}).on("change",()=>{this._dotVisualsRenderer.centerOffset=ne.visualsCenterOffset}),e.addBinding(ne.uiPositionPlane,"visible",{label:"UI Plane Visible"}).on("change",()=>{this._uiPositionPlane.visible=ne.uiPositionPlane.visible}),e.addBinding(ne.uiPositionPlane,"scale",{step:.01,label:"UI Plane Scale"}).on("change",()=>{this._uiPositionPlane.scale.set(ne.uiPositionPlane.scale.x,ne.uiPositionPlane.scale.y,ne.uiPositionPlane.scale.z)}),e.addBinding(ne.uiPositionPlane,"position",{step:.01,label:"UI Plane position"}).on("change",()=>{this._uiPositionPlane.position.set(ne.uiPositionPlane.position.x,ne.uiPositionPlane.position.y,ne.uiPositionPlane.position.z)});const t=e.addFolder({title:"Material"});yi(t,ne.material,this._material);const i=e.addFolder({title:"Mini Lights Material"});return yi(i,ne.miniLightsMaterial,this._miniLightsMaterial),this.$debugger.registerFile(ne,ne.file),e}}function Vu(o,e,t,i,s,a){let n,r,l,h;const c=t.length,A=t[0].length;if(e<1)throw new Error("degree must be at least 1 (linear)");if(e>c-1)throw new Error("degree must be less than or equal to point count - 1");if(!s)for(s=[],n=0;n<c;n++)s[n]=1;if(i){if(i.length!==c+e+1)throw new Error("bad knot vector length")}else for(i=[],n=0;n<c+e+1;n++)i[n]=n;const d=[e,i.length-1-e],m=i[d[0]],p=i[d[1]];if(o=o*(p-m)+m,o<m||o>p)throw new Error("out of bounds");for(l=d[0];l<d[1]&&!(o>=i[l]&&o<=i[l+1]);l++);const f=[];for(n=0;n<c;n++){for(f[n]=[],r=0;r<A;r++)f[n][r]=t[n][r]*s[n];f[n][A]=s[n]}let _;for(h=1;h<=e+1;h++)for(n=l;n>l-e-1+h;n--)for(_=(o-i[n])/(i[n+e+1-h]-i[n]),r=0;r<A+1;r++)f[n][r]=(1-_)*f[n-1][r]+_*f[n][r];for(a=a||[],n=0;n<A;n++)a[n]=f[l][n]/f[l][A];return a}const Wi={interpolate:Vu},Yi={file:"./src/script/webgl/components/ComponentControlPoint/settings.js",scale:.1};class Wu extends we(Ci){init(e){this._debugFolder=e.debugFolder,this._position=e.position,this._cameraManager=e.cameraManager,this._color=e.color,this._bindAll(),this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this._control=this._createControl(),this._debugFolder=this._createDebugFolder(),this._dragManager=new Js({el:window}),this._setupEventListeners(),this._disableControl()}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose(),this._removeEventListeners()}get x(){return this._mesh.position.x}get y(){return this._mesh.position.y}get z(){return this._mesh.position.z}get control(){return this._control}_createControl(){if(!this.$context.isDebug)return;console.warn("Creating ComponentControlPoint Transform Controls, this drops CPU matrix performance");const e=new Uo(this._cameraManager.camera,this.$renderer.domElement);return e.setSize(.4),e.attach(this._mesh),this.add(e),e}_enableControl(){this._control&&(this._control.visible=!0,this._control.enabled=!0)}_disableControl(){this._control&&(this._control.visible=!1,this._control.enabled=!1)}_createGeometry(){return new Ks(1,32,16)}_createMaterial(){return new It({color:new _e(this._color),transparent:!1,opacity:1})}_createMesh(){const e=new U(this._geometry,this._material);return e.position.set(this._position.x,this._position.y,this._position.z),this.add(e),e}update({time:e,deltaTime:t,frame:i}){}onWindowResize(e){this._resize()}_resize(){this._mesh.scale.set(Yi.scale,Yi.scale,Yi.scale)}_bindAll(){this._draggingChangedHandler=this._draggingChangedHandler.bind(this),this._mousemoveHandler=this._mousemoveHandler.bind(this),this._tapHandler=this._tapHandler.bind(this)}_setupEventListeners(){this._control&&(this._control.addEventListener("dragging-changed",this._draggingChangedHandler),window.addEventListener("mousemove",this._mousemoveHandler),this._dragManager.addEventListener("tap",this._tapHandler))}_removeEventListeners(){this._control&&(this._control.removeEventListener("dragging-changed",this._draggingChangedHandler),window.removeEventListener("mousemove",this._mousemoveHandler),this._dragManager.destroy())}_draggingChangedHandler(e){const t=this._cameraManager.getCamera("Orbit");t.enabled=!e.value}_mousemoveHandler(e){if(!this.$context.isDebug)return;const t={x:e.clientX/window.innerWidth*2-1,y:-(e.clientY/window.innerHeight)*2+1},i=this._control.getRaycaster(),s=i.intersectObjects([this._mesh],!1);i.setFromCamera(t,this._cameraManager.camera),s.length===0?this._mesh.material.opacity=.5:this._mesh.material.opacity=1}_tapHandler({position:e}){if(!this.$context.isDebug)return;const t={x:e.x/window.innerWidth*2-1,y:-(e.y/window.innerHeight)*2+1},i=this._control.getRaycaster(),s=i.intersectObjects([this._mesh],!1);i.setFromCamera(t,this._cameraManager.camera),s.length===0?this._disableControl():this._enableControl()}_createDebugFolder(){if(!this._debugFolder)return;const e=this._debugFolder.addFolder({title:"Control Point"});return this.$debugger.registerFile(Yi,Yi.file),e}}class Yu extends we(Ci){init(e){this._debug=e.debugFolder,this._isDebug=e.debug,this._cameraManager=e.cameraManager,this._settings=e.settings,this._name=e.name,this._normal=new O,this._tangent=new O,this._biNormal=new O(0,0,1),this._fixedControlPoints=this._setFixedControlPoints(),this.$context.isDebug&&this._isDebug?(this._controlPoints=this._createControlPoints(),this._points=this._createDebugPoints()):this._points=this._createPoints(),this._geometry=this._createGeometry(),this._material=this._createMaterial(),this._mesh=this._createMesh(),this.$context.isDebug&&this._isDebug&&(this._mesh.visible=!0,this._controlPoints.forEach(t=>{t.visible=!0})),this._debugFolder=this._createDebugFolder(),this._updateGeometry()}get settings(){return this._settings}destroy(){super.destroy(),this._geometry.dispose(),this._material.dispose(),this.$context.isDebug&&this._isDebug&&this._controlPoints.forEach(e=>{e.destroy()})}_createGeometry(){const e=new as;return e.setFromPoints(this._points),e}_createMaterial(){return new Ya({color:this._settings.debugColor?this._settings.debugColor:16711680})}_createMesh(){const e=new Pt(this._geometry,this._material);return e.castShadow=!0,e.visible=!1,!this.$context.isDebug&&this._isDebug&&(e.matrixAutoUpdate=!1,e.updateMatrix()),this.add(e),e}_setFixedControlPoints(){return this._settings.controlPoints.map(t=>[t.x,t.y,t.z])}_createPoints(){const e=[];for(let i=0;i<this._settings.segments;i++){const s=i/this._settings.segments,a=Wi.interpolate(s,2,this._fixedControlPoints);e.push({x:a[0],y:a[1],z:a[2]})}return e}_createDebugPoints(){const e=[];for(let i=0;i<this._settings.segments;i++){const s=i/this._settings.segments,a=Wi.interpolate(s,2,this._fixedControlPoints);e.push({x:a[0],y:a[1],z:a[2]})}return e}_getSpline(e){const s=Wi.interpolate(un.clamp(e-.01,0,1),2,this._fixedControlPoints),a=Wi.interpolate(e,2,this._fixedControlPoints),n=Wi.interpolate(un.clamp(e+.01,0,1),2,this._fixedControlPoints),r={x:a[0],y:a[1],z:a[2]},l={x:n[0],y:n[1],z:n[2]},h={x:s[0],y:s[1],z:s[2]};return this._tangent.set(l.x-h.x,l.y-h.y,l.z-h.z),this._normal.crossVectors(this._tangent,this._biNormal),this._normal.normalize(),{position:{x:r.x,y:r.y,z:r.z},normal:this._normal,tangent:this._tangent}}_createControlPoints(){var t;const e=[];for(let i=0;i<this._settings.controlPoints.length;i++){const s=this._settings.controlPoints[i];this._settings.controlPoints[i].t=i/(this._settings.controlPoints.length-1);const a=new Wu({cameraManager:this._cameraManager,debugFolder:this._debugFolder,position:s,color:this._settings.debugColor?this._settings.debugColor:255});(t=a.control)==null||t.addEventListener("change",()=>{this._controlPointChangedHandler(a)}),a.visible=!1,e.push(a),this.add(a)}return e}_updateGeometry(){this._points=this._createPoints(),this._geometry.setFromPoints(this._points)}_controlPointChangedHandler(e){const t=this._controlPoints.indexOf(e);this._settings.controlPoints[t].x=e.x,this._settings.controlPoints[t].y=e.y,this._settings.controlPoints[t].z=e.z,this._fixedControlPoints=this._setFixedControlPoints(),this._updateGeometry()}_createDebugFolder(){if(!this._debug)return;const e=this._debug.addFolder({title:this._name});return e.addBinding(this._settings,"duration",{step:.01}),e.addBinding(this._settings,"segments",{step:1}).on("change",this._settingsChangedHandler.bind(this)),this.$debugger.registerFile(this._settings,this._settings.file),e}_settingsChangedHandler(){}}class ju extends we(hl){init(e,t,i,s,a={}){this._baseDistance=i,this._baseIntensity=t,this._name=a.name||"Light",this._settings=a.settings||null,this.influence=a.influence!==void 0?a.influence:1,this.addEventListener("added",this._start)}get helper(){return this._helper}get influence(){return this._influence}set influence(e){this._influence=e,this.intensity=this._baseIntensity*this._influence,this.distance=this._baseDistance*this._influence}createDebugFolder(e,t){if(!e)return;if(!this._transformControlsPosition){console.error("Cosmic Point Light: The light needs to be added to the scene before creating the debug folder");return}const i=e.addFolder({title:this._name});i.addBinding(t,"color").on("change",()=>{this.color.setStyle(t.color)}),t.influence&&i.addBinding(t,"influence",{min:0,max:1,step:.01}).on("change",()=>{this.influence=t.influence}),t.intensity&&i.addBinding(t,"intensity",{min:0,step:.01}).on("change",()=>{this._baseIntensity=t.intensity,this.intensity=this._baseIntensity*this._influence}),t.distance&&i.addBinding(t,"distance",{min:0,step:.01}).on("change",()=>{this._baseDistance=t.distance,this.distance=this._baseDistance*this._influence}),t.decay&&i.addBinding(t,"decay",{min:0,step:.01}).on("change",()=>{this.decay=t.decay}),i.addBinding(this._helper,"visible",{label:"Helper visible"});const s=i.addTab({pages:[{title:"Global"}]});t&&this._transformControlsPosition.bindSettings(t),this._transformControlsPosition.createDebugFolder(s.pages[0])}_start(){this._helper=this._createHelper(),this._transformControlsPosition=this._createTransformControlsPosition(),this._settings&&this._transformControlsPosition.bindSettings(this._settings)}_createHelper(){const e=new Al(this,1);return e.visible=!1,this.parent.add(e),e}_createTransformControlsPosition(){return new Hs(this)}onUpdate(){var e;(e=this._helper)==null||e.update()}}const Xu=.94;class Ku{constructor(){this._smoothingFactor=Xu,this._smoothDeltaTime=0,this._setupEventListeners()}get value(){return this._smoothDeltaTime}_update(e){this._smoothDeltaTime=this._smoothingFactor*this._smoothDeltaTime+(1-this._smoothingFactor)*e}_setupEventListeners(){R.ticker.add(this._tickHandler.bind(this))}_tickHandler(e,t,i){this._update(t)}destroy(){R.ticker.remove(this._tickHandler)}}const Ju=new Ku,nr=[{name:"collider-arrow-bottom-left",vertices:[[1.6813411712646484,-1.7765194177627563],[1.9059011936187744,-1.776869773864746],[1.9059011936187744,-1.6001394987106323],[1.6813411712646484,-1.6001394987106323]],customData:{colliderType:"sensor",colliderName:"arrow-bottom-left",stickerName:"sticker-arrow-bottom-left",stickerAnimation:"blink"}},{name:"collider-arrow-bottom-right",vertices:[[-1.902176856994629,-1.7765194177627563],[-1.677616834640503,-1.776869773864746],[-1.677616834640503,-1.6001394987106323],[-1.902176856994629,-1.6001394987106323]],customData:{colliderType:"sensor",colliderName:"arrow-bottom-right",stickerName:"sticker-arrow-bottom-right",stickerAnimation:"blink"}},{name:"collider-beauty-hub",vertices:[[-.3013087809085846,1.526181697845459],[-.17195270955562592,1.3968255519866943],[.004750996828079224,1.349478006362915],[.18145470321178436,1.3968255519866943],[.31081077456474304,1.526181697845459],[.3581584095954895,1.702885389328003],[.31081077456474304,1.8795890808105469],[.18145470321178436,2.0089452266693115],[.004750996828079224,2.056292772293091],[-.17195270955562592,2.0089452266693115],[-.3013087809085846,1.8795890808105469],[-.34865641593933105,1.702885389328003]],customData:{colliderType:"bumper-hub",colliderName:"beauty-hub",colliderPoints:5e3,objectName:"beauty-hub-empty",objectAnimation:"scale"}},{name:"collider-blanket",type:"NURBS",points:[{x:-1.2755749225616455,y:2.129321575164795},{x:-1.3441325426101685,y:1.75537109375},{x:-1.3129699230194092,y:1.287933349609375},{x:-1.1820873022079468,y:.9513778686523438},{x:-1.0075770616531372,y:.7083101868629456},{x:-.7894392609596252,y:.8890528082847595},{x:-.8064818382263184,y:1.1428765058517456},{x:-.8465036153793335,y:1.4488451480865479},{x:-.9180090427398682,y:1.6839790344238281},{x:-.9342093467712402,y:1.9515058994293213},{x:-.8002653121948242,y:2.1636879444122314},{x:-.6524950265884399,y:2.4252495765686035},{x:-.30853259563446045,y:2.4553704261779785},{x:-.4190630614757538,y:3.0393741130828857},{x:-.8979741334915161,y:2.7709572315216064},{x:-1.262037754058838,y:2.133082151412964}],customData:{colliderGroup:2,colliderMask:1}},{name:"collider-blanket",type:"NURBS",points:[{x:1.3093432188034058,y:2.162738561630249},{x:1.3779009580612183,y:1.788788080215454},{x:1.346738338470459,y:1.3213499784469604},{x:1.2158557176589966,y:.9847946166992188},{x:1.0413455963134766,y:.7417268753051758},{x:.6384540796279907,y:.9317524433135986},{x:.806402862071991,y:1.1527045965194702},{x:.8230199217796326,y:1.4330840110778809},{x:.977256178855896,y:1.6949503421783447},{x:.86753249168396,y:1.9220695495605469},{x:.8644145131111145,y:2.2086968421936035},{x:.6515436172485352,y:2.3680343627929688},{x:.35163769125938416,y:2.4327516555786133},{x:.24651005864143372,y:3.064544677734375},{x:1.0000089406967163,y:2.8468680381774902},{x:1.3103450536727905,y:2.165898561477661}],customData:{colliderGroup:2,colliderMask:1}},{name:"collider-border-left-bottom",vertices:[[.3600570559501648,-6.146907806396484],[1.6514413356781006,-6.122528076171875],[1.6215673685073853,-3.318659782409668],[.34151285886764526,-3.934666633605957]],customData:{}},{name:"collider-border-left-mid",vertices:[[1.9271240234375,-5.710858345031738],[3.428734302520752,-5.309009552001953],[3.441519021987915,-.7948843836784363],[1.9133422374725342,-.6386983394622803]],customData:{}},{name:"collider-border-left-mid.001",vertices:[[2.3973896503448486,.7655904293060303],[1.9001543521881104,-.9035170078277588],[3.428734302520752,-.737652063369751],[3.441519021987915,3.7854440212249756],[2.425952672958374,2.947307825088501]],customData:{}},{name:"collider-border-right-bottom",vertices:[[-1.6509199142456055,-6.102224826812744],[-.36865776777267456,-6.122528076171875],[-.35433971881866455,-3.9278159141540527],[-1.6452360153198242,-3.290764808654785]],customData:{}},{name:"collider-border-right-mid",type:"NURBS",points:[{x:-1.951776385307312,y:-5.66066312789917},{x:-1.9517765045166016,y:2.7901082038879395}],customData:{colliderGroup:2,colliderMask:1}},{name:"collider-bumper-bottom",vertices:[[-.2888922095298767,-1.1315670013427734],[-.24998575448989868,-1.2767678499221802],[.0015094578266143799,-1.4647694826126099],[.25300467014312744,-1.2767678499221802],[.29191112518310547,-1.1315670013427734],[.25300467014312744,-.9863661527633667],[.14671029150485992,-.880071759223938],[.0015094578266143799,-.84116530418396],[-.14369137585163116,-.880071759223938],[-.24998575448989868,-.9863661527633667]],customData:{colliderType:"bumper",colliderName:"bumper-bottom",colliderPoints:2500,objectName:"bumper-bottom-black-white",objectAnimation:"scale"}},{name:"collider-bumper-left",vertices:[[.3197281062602997,-.3662518262863159],[.426022469997406,-.47254619002342224],[.5712233185768127,-.5114526748657227],[.7164241671562195,-.47254619002342224],[.8227185010910034,-.3662518262863159],[.8616249561309814,-.22105097770690918],[.8227185010910034,-.07585014402866364],[.7164241671562195,.030444234609603882],[.5712233185768127,.06935068964958191],[.426022469997406,.030444234609603882],[.3197281062602997,-.07585014402866364],[.28082165122032166,-.22105097770690918]],customData:{colliderType:"bumper",colliderName:"bumper-left",colliderPoints:2500,objectName:"bumper-left-black-white",objectAnimation:"scale"}},{name:"collider-bumper-right",vertices:[[-.7639068365097046,-.36107754707336426],[-.6576124429702759,-.4673719108104706],[-.5124115943908691,-.506278395652771],[-.3672107458114624,-.4673719108104706],[-.2609163820743561,-.36107754707336426],[-.22200992703437805,-.21587669849395752],[-.2609163820743561,-.07067586481571198],[-.3672107458114624,.03561851382255554],[-.5124115943908691,.07452496886253357],[-.6576124429702759,.03561851382255554],[-.7639068365097046,-.07067586481571198],[-.8028132915496826,-.21587669849395752]],customData:{colliderType:"bumper",colliderName:"bumper-right",colliderPoints:2500,objectName:"bumper-right-black-white",objectAnimation:"scale"}},{name:"collider-bumper-right.001",vertices:[[-.8122420310974121,-.21587669849395752],[-.772072434425354,-.365791916847229],[-.6623268127441406,-.47553750872612],[-.5124115943908691,-.5157071352005005],[-.36249637603759766,-.47553750872612],[-.25275078415870667,-.365791916847229],[-.21258112788200378,-.21587669849395752],[-.25275078415870667,-.06596146523952484],[-.36249637603759766,.043784111738204956],[-.5124115943908691,.08395376801490784],[-.6623268127441406,.043784111738204956],[-.772072434425354,-.06596146523952484]],customData:{colliderType:"sensor",objectName:"lipstick-bumper-right",objectAnimation:"jump"}},{name:"collider-bumper-right.002",vertices:[[.32335811853408813,-.36771851778030396],[.4285748600959778,-.4729352593421936],[.5723036527633667,-.5114473104476929],[.7160324454307556,-.4729352593421936],[.8212491869926453,-.36771851778030396],[.8597612380981445,-.22398972511291504],[.8212491869926453,-.08026094734668732],[.7160324454307556,.024955809116363525],[.5723036527633667,.0634678304195404],[.4285748600959778,.024955809116363525],[.32335811853408813,-.08026094734668732],[.28484609723091125,-.22398972511291504]],customData:{colliderType:"sensor",objectName:"lipstick-bumper-left",objectAnimation:"jump"}},{name:"collider-bumper-right.003",vertices:[[-.292567640542984,-1.1357975006103516],[-.25363484025001526,-1.2810966968536377],[-.1472684144973755,-1.387463092803955],[-.0019691884517669678,-1.4263958930969238],[.14333003759384155,-1.387463092803955],[.24969646334648132,-1.2810966968536377],[.2886292636394501,-1.1357975006103516],[.24969646334648132,-.9904983043670654],[.14333003759384155,-.8841318488121033],[-.0019691884517669678,-.8451990485191345],[-.1472684144973755,-.8841318488121033],[-.25363484025001526,-.9904983043670654]],customData:{colliderType:"sensor",objectName:"lipstick-bumper-bottom",objectAnimation:"jump"}},{name:"collider-hole-enter",type:"NURBS",points:[{x:1.973010778427124,y:1.3103218078613281},{x:1.9468233585357666,y:2.263730525970459},{x:1.9830607175827026,y:2.7363228797912598},{x:2.1679725646972656,y:2.9569942951202393},{x:2.485257863998413,y:3.1535816192626953},{x:2.72314453125,y:3.292816638946533},{x:3.0391335487365723,y:3.5090041160583496},{x:3.293488025665283,y:3.800713300704956},{x:3.336602210998535,y:4.01185417175293},{x:3.3153867721557617,y:4.342169761657715},{x:3.2132883071899414,y:4.625467300415039},{x:3.058194637298584,y:4.834834575653076},{x:2.795353651046753,y:4.950618743896484},{x:2.4662790298461914,y:4.9539361000061035},{x:2.1728601455688477,y:4.877799034118652},{x:1.8841159343719482,y:4.679973602294922},{x:1.7450608015060425,y:4.357665538787842},{x:1.8013750314712524,y:4.111617088317871},{x:1.9146071672439575,y:3.9297871589660645},{x:1.9280707836151123,y:3.7678260803222656},{x:1.8737823963165283,y:3.6533045768737793},{x:1.7130298614501953,y:3.6353015899658203},{x:1.6245242357254028,y:3.749060869216919},{x:1.7188115119934082,y:3.6756699085235596},{x:1.8760167360305786,y:3.671816825866699},{x:1.9205504655838013,y:3.775780200958252},{x:1.8978277444839478,y:3.923239231109619},{x:1.774687647819519,y:4.083256721496582},{x:1.61494779586792,y:4.116230010986328},{x:1.4941248893737793,y:4.102786064147949},{x:1.3559553623199463,y:4.004580020904541},{x:1.3266396522521973,y:3.776358127593994},{x:1.409859299659729,y:3.5995349884033203},{x:1.6088377237319946,y:3.3992674350738525},{x:1.9693573713302612,y:3.4044628143310547},{x:2.1921708583831787,y:3.619377851486206},{x:2.212470769882202,y:3.9585349559783936},{x:2.014052152633667,y:4.293478012084961},{x:2.0657966136932373,y:4.471362113952637},{x:2.2397148609161377,y:4.613851070404053},{x:2.4438915252685547,y:4.671393394470215},{x:2.6769425868988037,y:4.670232772827148},{x:2.860940933227539,y:4.579645156860352},{x:2.9542429447174072,y:4.384880542755127},{x:3.0188887119293213,y:4.179721355438232},{x:3.003490924835205,y:3.9364867210388184},{x:2.913015842437744,y:3.7833080291748047},{x:2.7528951168060303,y:3.654332160949707},{x:2.567368507385254,y:3.525226593017578},{x:2.3444695472717285,y:3.3994674682617188},{x:2.1914703845977783,y:3.2949142456054688},{x:1.975359559059143,y:3.1544978618621826},{x:1.7830605506896973,y:3.001304864883423},{x:1.6082273721694946,y:2.673617362976074},{x:1.5286253690719604,y:2.3439979553222656},{x:1.292322039604187,y:1.3011473417282104}],customData:{colliderName:"holeRampEnter",colliderGroup:2,colliderMask:1}},{name:"collider-hole-leave",type:"NURBS",points:[{x:1.3527958393096924,y:1.4010162353515625},{x:1.5320959091186523,y:3.4505245685577393},{x:1.526133418083191,y:3.7402050495147705},{x:1.5114747285842896,y:4.001787185668945},{x:1.8949599266052246,y:4.005849838256836},{x:2.011979818344116,y:3.8930208683013916},{x:1.9936232566833496,y:3.2351038455963135},{x:1.9190499782562256,y:1.657958984375},{x:1.7853039503097534,y:.4429442882537842}],customData:{colliderName:"holeRampLeave",colliderGroup:0,colliderMask:0}},{name:"collider-hole-sensor--enter",vertices:[[1.425024390220642,1.8856112957000732],[1.8594310283660889,1.7951416969299316],[1.8818074464797974,1.9433062076568604],[1.4474008083343506,2.033775806427002]],customData:{colliderType:"sensor",colliderName:"holeRampSensorEnter",colliderPoints:250,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0,stickerName:"sticker-arrows-hole-ramp",stickerAnimation:"blink"}},{name:"collider-hole-sensor--speed",vertices:[[2.3919169902801514,2.9203267097473145],[2.4975500106811523,3.036424160003662],[2.1716158390045166,3.367797374725342],[2.0659828186035156,3.251699686050415]],customData:{colliderType:"sensor",colliderName:"holeRampSensorSpeed",colliderPoints:250,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0}},{name:"collider-hole-sensor--speed.001",vertices:[[1.8018110990524292,4.359683036804199],[2.0722475051879883,4.309207439422607],[2.0842068195343018,4.401336669921875],[1.8137704133987427,4.451812267303467]],customData:{colliderType:"sensor",colliderName:"holeRampSensorSpeedNegative",colliderPoints:250,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0}},{name:"collider-hole-sensor--speed.002",vertices:[[1.4971990585327148,3.5644102096557617],[1.5401585102081299,3.5187079906463623],[1.6823205947875977,3.6382462978363037],[1.639361023902893,3.683948516845703]],customData:{colliderType:"sensor",colliderName:"holeRampSensorSpeed2",colliderPoints:250,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0}},{name:"collider-hole-sensor-end",vertices:[[1.8079389333724976,.7447848320007324],[1.8360170125961304,.8521553874015808],[1.2037051916122437,1.0011844635009766],[1.1756271123886108,.893813967704773]],customData:{colliderType:"sensor",colliderName:"holeRampSensorEnd",colliderPoints:0,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0}},{name:"collider-hole-sensor-leave",vertices:[[1.6653289794921875,3.6747491359710693],[1.8885478973388672,3.6759445667266846],[1.8870930671691895,3.8952929973602295],[1.6638741493225098,3.8940975666046143]],customData:{colliderType:"sensor",colliderName:"holeRampSensorLeave",colliderPoints:250,missionActive:!1,missionName:"holeRamp",missionPoints:5e3,restartMissionOnComplete:!0}},{name:"collider-launcher-highspeed",type:"NURBS",points:[{x:1.3560495376586914,y:1.6573026180267334},{x:1.4643006324768066,y:3.179189920425415},{x:1.221728801727295,y:3.542701482772827},{x:.801295280456543,y:3.7061407566070557},{x:.34423112869262695,y:3.826845407485962},{x:-.2161715030670166,y:3.820470094680786},{x:-.9231176376342773,y:3.6980974674224854},{x:-1.485550045967102,y:3.5409491062164307},{x:-1.8588676452636719,y:3.2006261348724365},{x:-2.032304525375366,y:2.631963014602661},{x:-2.5835344791412354,y:2.6916444301605225},{x:-2.339813709259033,y:3.487837076187134},{x:-1.8106191158294678,y:3.972219228744507},{x:-.8866338729858398,y:4.209050178527832},{x:-.33029651641845703,y:4.324708938598633},{x:.24988174438476562,y:4.321163177490234},{x:.929457426071167,y:4.20965576171875},{x:1.5806255340576172,y:4.017831802368164},{x:1.8437104225158691,y:3.876141309738159},{x:1.9995107650756836,y:3.507962465286255},{x:2.008814811706543,y:2.950378179550171},{x:1.9548254013061523,y:1.6906406879425049},{x:1.9728960990905762,y:1.438417673110962}],customData:{colliderName:"launcherRampHighspeed",colliderGroup:0,colliderMask:0}},{name:"collider-launcher-lowspeed",type:"NURBS",points:[{x:-.3773348331451416,y:2.7040932178497314},{x:-.40976810455322266,y:3.1938364505767822},{x:-.5053181648254395,y:3.393773317337036},{x:-.6621551513671875,y:3.504406690597534},{x:-1.1546826362609863,y:3.6383707523345947},{x:-1.5809136629104614,y:3.5409491062164307},{x:-1.8588676452636719,y:3.2006261348724365},{x:-2.032304525375366,y:2.631963014602661},{x:-1.998659610748291,y:-4.238097190856934},{x:-2.1363961696624756,y:-4.326513290405273},{x:-2.2052643299102783,y:-4.5498809814453125},{x:-2.274132490158081,y:-4.5498809814453125},{x:-2.343000888824463,y:-4.5498809814453125},{x:-2.4118690490722656,y:-4.321859836578369},{x:-2.54960560798645,y:-4.235770225524902},{x:-2.5636303424835205,y:-.7539699077606201},{x:-2.5835344791412354,y:2.6916444301605225},{x:-2.339813709259033,y:3.487837076187134},{x:-1.8106191158294678,y:3.972219228744507},{x:-1.0485355854034424,y:4.140322685241699},{x:-.3612072467803955,y:3.9074652194976807},{x:.11322307586669922,y:3.362053632736206},{x:.34502696990966797,y:2.757916212081909}],customData:{colliderName:"launcherRampLowspeed",colliderGroup:2,colliderMask:1}},{name:"collider-launcher-sensor",vertices:[[-.30631256103515625,2.754070997238159],[.150885671377182,2.754070997238159],[.150885671377182,3.0415847301483154],[-.30631256103515625,3.0415847301483154]],customData:{colliderType:"sensor",colliderName:"launcherSensor",stickerName:"sticker-arrows-launcher-ramp",stickerAnimation:"blink"}},{name:"collider-launcher-sensor-fast",vertices:[[1.1292845010757446,.5886009335517883],[1.6784471273422241,.4464494287967682],[1.7291196584701538,.6422085165977478],[1.1799570322036743,.7843600511550903]],customData:{colliderType:"sensor",colliderName:"launcherSensorHighspeedLeave"}},{name:"collider-lips-exterior",type:"NURBS",points:[{x:1.899786353111267,y:-.7813802361488342},{x:1.781075119972229,y:-.6406853795051575},{x:1.9301879405975342,y:-.33235442638397217},{x:2.2168962955474854,y:.26242345571517944},{x:2.3992178440093994,y:.9607808589935303},{x:2.3998289108276367,y:1.5736088752746582},{x:2.276979446411133,y:2.1507468223571777},{x:2.0092058181762695,y:2.6765170097351074},{x:1.4721752405166626,y:3.1894173622131348},{x:.8584476113319397,y:3.48598575592041},{x:.2327214479446411,y:3.6110057830810547},{x:-.4864180088043213,y:3.572181463241577},{x:-.9466999769210815,y:3.3831894397735596},{x:-1.3389207124710083,y:3.1052162647247314},{x:-1.6371957063674927,y:2.7172813415527344},{x:-1.8115257024765015,y:2.3294315338134766},{x:-1.8860207796096802,y:1.7672924995422363},{x:-1.781185507774353,y:1.0604357719421387},{x:-1.3902941942214966,y:.2508542835712433}],customData:{colliderName:"lipsRamp2",colliderGroup:3,colliderMask:2}},{name:"collider-lips-interior",type:"NURBS",points:[{x:1.3598192930221558,y:-.43209362030029297},{x:1.5362155437469482,y:-.021346569061279297},{x:1.5894700288772583,y:.22955656051635742},{x:1.6754947900772095,y:.27593994140625},{x:1.844815731048584,y:.4771597385406494},{x:1.9850965738296509,y:1.0706124305725098},{x:1.9819797277450562,y:1.6004047393798828},{x:1.8801337480545044,y:2.064377784729004},{x:1.6762566566467285,y:2.47851824760437},{x:1.231041431427002,y:2.9145987033843994},{x:.9404104351997375,y:3.082712173461914},{x:.6497794985771179,y:3.1749556064605713},{x:.4248262345790863,y:3.2327239513397217},{x:.1998729705810547,y:3.267731189727783},{x:-.11633741855621338,y:3.2798337936401367},{x:-.4325476288795471,y:3.2464141845703125},{x:-.6323997974395752,y:3.1960997581481934},{x:-.832252025604248,y:3.107849597930908},{x:-.9930217266082764,y:2.9951183795928955},{x:-1.1537916660308838,y:2.852039098739624},{x:-1.3829551935195923,y:2.5340523719787598},{x:-1.4948722124099731,y:2.212512731552124},{x:-1.560601830482483,y:1.8234673738479614},{x:-1.5121886730194092,y:1.4346463680267334},{x:-1.0614948272705078,y:.5666117668151855}],customData:{colliderName:"lipsRamp",colliderGroup:3,colliderMask:2}},{name:"collider-lips-sensor-enter-left",vertices:[[1.8388983011245728,-.4069473445415497],[1.8961931467056274,-.3030034601688385],[1.5982626676559448,-.11654578149318695],[1.5409678220748901,-.22048965096473694]],customData:{colliderType:"sensor",colliderName:"lipsRampSensorEnter",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left",stickerAnimation:"blink"}},{name:"collider-lips-sensor-enter-left.001",vertices:[[1.9893604516983032,.6839179992675781],[2.2247469425201416,.635977029800415],[2.2540218830108643,.7797155976295471],[2.0186357498168945,.8276565074920654]],customData:{colliderType:"sensor",colliderName:"lipsRampSensor1",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left"}},{name:"collider-lips-sensor-enter-left.002",vertices:[[1.6299772262573242,2.5558245182037354],[1.7340511083602905,2.452449321746826],[1.9033383131027222,2.622880697250366],[1.7992643117904663,2.7262558937072754]],customData:{colliderType:"sensor",colliderName:"lipsRampSensor2",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left"}},{name:"collider-lips-sensor-enter-left.003",vertices:[[.12701357901096344,3.269636869430542],[.27355799078941345,3.2631142139434814],[.28423917293548584,3.5030953884124756],[.13769474625587463,3.509618043899536]],customData:{colliderType:"sensor",colliderName:"lipsRampSensor3",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left"}},{name:"collider-lips-sensor-enter-left.004",vertices:[[-1.2128427028656006,2.7900564670562744],[-1.1191781759262085,2.902949333190918],[-1.3040515184402466,3.0563342571258545],[-1.3977159261703491,2.943441390991211]],customData:{colliderType:"sensor",colliderName:"lipsRampSensor4",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left"}},{name:"collider-lips-sensor-enter-left.005",vertices:[[-1.7919433116912842,1.588314175605774],[-1.5563244819641113,1.635099172592163],[-1.5848937034606934,1.7789796590805054],[-1.8205125331878662,1.7321946620941162]],customData:{colliderType:"sensor",colliderName:"lipsRampSensor5",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-left"}},{name:"collider-lips-sensor-enter-left.006",vertices:[[-.4161173403263092,-.005556166172027588],[.41611725091934204,-.005556171759963036],[.4161173403263092,.005556168034672737],[-.41611725091934204,.005556173622608185]],customData:{colliderType:"rotateSensor",colliderName:"mirror"}},{name:"collider-lips-sensor-enter-right",vertices:[[-1.4532511234283447,.5702912211418152],[-1.4051835536956787,.48246344923973083],[-1.1498711109161377,.6001068353652954],[-1.1979385614395142,.6879346370697021]],customData:{colliderType:"sensor",colliderName:"lipsRampSensorEnter2",colliderPoints:2e3,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0,stickerName:"sticker-lips-ramp-right",stickerAnimation:"blink"}},{name:"collider-lips-sensor-leave-left",vertices:[[1.7203266620635986,-.5941988825798035],[1.7749781608581543,-.4985805153846741],[1.501230001449585,-.3213045299053192],[1.4465786218643188,-.4169228971004486]],customData:{colliderType:"sensor",colliderName:"lipsRampSensorLeave",colliderPoints:0,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0}},{name:"collider-lips-sensor-leave-right",vertices:[[-1.3817023038864136,.4262792468070984],[-1.334133267402649,.3377484083175659],[-1.0835247039794922,.448624849319458],[-1.1310937404632568,.5371556878089905]],customData:{colliderType:"sensor",colliderName:"lipsRampSensorLeave2",colliderPoints:0,missionActive:!1,missionName:"lipsRamp",missionPoints:5e4,restartMissionOnComplete:!0}},{name:"collider-lipstick-lot",vertices:[[-1.9932602643966675,-1.0485702753067017],[-1.6325188875198364,-.7742531895637512],[-1.3288030624389648,.18557846546173096],[-1.7587934732437134,.32163864374160767]],customData:{}},{name:"collider-lipstick-lot-sensor-02",vertices:[[-1.4750185012817383,-.13146352767944336],[-1.4093266725540161,-.15154756605625153],[-1.3820477724075317,-.06630928069353104],[-1.4506499767303467,-.045953795313835144]],customData:{colliderType:"sensor",colliderName:"lipstick-lot-04",colliderPoints:2e3,missionActive:!1,missionName:"lipstick-lot",missionPoints:1e4,restartMissionOnComplete:!0,stickerName:"sticker-lipstick-lot-04",stickerAnimation:"blink",objectName:"cible-04",objectAnimation:"fall"}},{name:"collider-lipstick-lot-sensor-01",vertices:[[-1.4130752086639404,.07096684724092484],[-1.3467425107955933,.04750906676054001],[-1.315057635307312,.1335250437259674],[-1.3843564987182617,.15738935768604279]],customData:{colliderType:"sensor",colliderName:"lipstick-lot-05",colliderPoints:2e3,missionActive:!1,missionName:"lipstick-lot",missionPoints:1e4,restartMissionOnComplete:!0,stickerName:"sticker-lipstick-lot-05",stickerAnimation:"blink",objectName:"cible-05",objectAnimation:"fall"}},{name:"collider-lipstick-lot-sensor-03",vertices:[[-1.5513584613800049,-.34866032004356384],[-1.4799513816833496,-.37391260266304016],[-1.4458425045013428,-.2813164293766022],[-1.5204427242279053,-.25562652945518494]],customData:{colliderType:"sensor",colliderName:"lipstick-lot-03",colliderPoints:2e3,missionActive:!1,missionName:"lipstick-lot",missionPoints:1e4,restartMissionOnComplete:!0,stickerName:"sticker-lipstick-lot-03",stickerAnimation:"blink",objectName:"cible-03",objectAnimation:"fall"}},{name:"collider-lipstick-lot-sensor-04",vertices:[[-1.6229413747787476,-.5512705445289612],[-1.5455788373947144,-.5786288380622864],[-1.5086252689361572,-.47831010818481445],[-1.5894473791122437,-.45047762989997864]],customData:{colliderType:"sensor",colliderName:"lipstick-lot-02",colliderPoints:2e3,missionActive:!1,missionName:"lipstick-lot",missionPoints:1e4,restartMissionOnComplete:!0,stickerName:"sticker-lipstick-lot-02",stickerAnimation:"blink",objectName:"cible-02",objectAnimation:"fall"}},{name:"collider-lipstick-lot-sensor-05",vertices:[[-1.682542324066162,-.7444531917572021],[-1.604740023612976,-.7719670534133911],[-1.5675764083862305,-.671078085899353],[-1.648857831954956,-.6430873870849609]],customData:{colliderType:"sensor",colliderName:"lipstick-lot-01",colliderPoints:2e3,missionActive:!1,missionName:"lipstick-lot",missionPoints:1e4,restartMissionOnComplete:!0,stickerName:"sticker-lipstick-lot-01",stickerAnimation:"blink",objectName:"cible-01",objectAnimation:"fall"}},{name:"collider-lose",vertices:[[-.4133642911911011,-5.43949031829834],[.36204177141189575,-5.441744327545166],[.3660079538822174,-5.179835796356201],[-.4093981087207794,-5.177581787109375]],customData:{colliderType:"sensor",colliderName:"loseSensor"}},{name:"collider-sensor-highspeed",vertices:[[-2.448822498321533,2.910191535949707],[-2.0436010360717773,2.7889256477355957],[-1.9944210052490234,2.9532651901245117],[-2.3996424674987793,3.074531078338623]],customData:{colliderType:"sensor",colliderName:"launcherSensorHighspeed"}},{name:"collider-slingshot",type:"NURBS",points:[{x:-1.6345726251602173,y:-3.2947449684143066},{x:-1.6545584201812744,y:-3.5980632305145264},{x:-1.6518027782440186,y:-3.901381731033325},{x:-1.6873884201049805,y:-4.028552055358887},{x:-1.7925065755844116,y:-4.064899444580078},{x:-1.8947640657424927,y:-4.015560150146484},{x:-1.9336391687393188,y:-3.899212598800659},{x:-1.9433599710464478,y:-3.1253113746643066}],customData:{colliderName:"slingshot",colliderGroup:2,colliderMask:1}},{name:"collider-slingshot-bumper-left",vertices:[[.8936321139335632,-2.2401163578033447],[.9041134715080261,-2.291839838027954],[1.1933249235153198,-2.0111899375915527],[1.1627435684204102,-1.6649279594421387],[1.1149054765701294,-1.7028510570526123],[.936805009841919,-1.932293176651001]],customData:{colliderType:"slingshot",colliderName:"slingshot-left",colliderPoints:4e3,stickerName:"sticker-star-slingshot-left",stickerAnimation:"blink",objectName:"slingshot-left",objectAnimation:"scale"}},{name:"collider-slingshot-bumper-right",vertices:[[-1.1678884029388428,-2.077225685119629],[-.9070978164672852,-2.2992310523986816],[-.8997167348861694,-2.2395389080047607],[-.951706051826477,-1.9548468589782715],[-1.1156684160232544,-1.7093453407287598],[-1.1587766408920288,-1.6802698373794556]],customData:{colliderType:"slingshot",colliderName:"slingshot-right",colliderPoints:4e3,stickerName:"sticker-star-slingshot-right",stickerAnimation:"blink",objectName:"slingshot-right",objectAnimation:"scale"}},{name:"collider-slingshot-door-left",vertices:[[1.6170417070388794,-3.3100597858428955],[1.6556679010391235,-3.376908779144287],[1.9444023370742798,-3.2101070880889893],[1.9057761430740356,-3.1432580947875977]],customData:{colliderName:"slingshotLeft",colliderGroup:3,colliderMask:2}},{name:"collider-slingshot-door-right",vertices:[[-1.660782814025879,-3.368075370788574],[-1.62220299243927,-3.3011996746063232],[-1.911024570465088,-3.134549140930176],[-1.9496043920516968,-3.2014248371124268]],customData:{colliderName:"slingshotRight",colliderGroup:3,colliderMask:2}},{name:"collider-slingshot-left",vertices:[[.8748710751533508,-2.3603034019470215],[.8936936855316162,-2.418275833129883],[.9702674150466919,-2.4367878437042236],[1.121779203414917,-2.356071949005127],[1.2452771663665771,-2.283656358718872],[1.2813663482666016,-2.253718614578247],[1.3008549213409424,-2.2030298709869385],[1.3217545747756958,-1.6619237661361694],[1.3093900680541992,-1.6153149604797363],[1.2761497497558594,-1.5861529111862183],[1.2346975803375244,-1.5798965692520142],[1.1960973739624023,-1.5932155847549438]],customData:{}},{name:"collider-slingshot-left-launch",vertices:[[1.664334774017334,-4.187050819396973],[1.8941800594329834,-4.187050819396973],[1.896136999130249,-3.903118133544922],[1.6622252464294434,-3.903118133544922]],customData:{}},{name:"collider-slingshot-left.001",vertices:[[1.976866602897644,-.7229524254798889],[2.1088178157806396,-.7781895399093628],[2.154390573501587,-.7890599370002747],[2.206587553024292,-.7741951942443848],[1.8253730535507202,-.5281001329421997],[1.790337085723877,-.5779681205749512],[1.8214778900146484,-.6503048539161682]],customData:{}},{name:"collider-slingshot-right",vertices:[[-1.2908629179000854,-2.21830415725708],[-1.2690973281860352,-2.2680578231811523],[-1.2316884994506836,-2.2963292598724365],[-1.1050357818603516,-2.3630738258361816],[-.9500218629837036,-2.436840772628784],[-.9046485424041748,-2.43613600730896],[-.8774633407592773,-2.36205792427063],[-1.1991603374481201,-1.6063023805618286],[-1.2528811693191528,-1.595703363418579],[-1.2821017503738403,-1.6096121072769165],[-1.3096510171890259,-1.6400538682937622],[-1.3190356492996216,-1.6741039752960205]],customData:{}},{name:"collider-slingshot-right-launch",vertices:[[-1.9078826904296875,-4.187050819396973],[-1.678037405014038,-4.187050819396973],[-1.6760804653167725,-3.903118133544922],[-1.9099922180175781,-3.903118133544922]],customData:{}},{name:"collider-slingshot-sensor-left.001",vertices:[[1.6769299507141113,-3.4366555213928223],[1.8824071884155273,-3.4381966590881348],[1.8834582567214966,-3.259101629257202],[1.6779810190200806,-3.2575602531433105]],customData:{colliderType:"sensor",colliderName:"slingshotLeaveLeft",objectName:"door-blanket-left",objectAnimation:"up"}},{name:"collider-slingshot-sensor-left.002",vertices:[[1.6769299507141113,-4.054318428039551],[1.8824071884155273,-4.0558600425720215],[1.8834582567214966,-3.8767647743225098],[1.6779810190200806,-3.875223398208618]],customData:{colliderType:"sensor",colliderName:"slingshotSensorLeft",objectName:"skillshot-blanket-left",objectAnimation:"push"}},{name:"collider-slingshot-sensor-right-leave",vertices:[[-1.8888475894927979,-3.4366555213928223],[-1.6833703517913818,-3.4381966590881348],[-1.6823192834854126,-3.259101629257202],[-1.8877965211868286,-3.2575602531433105]],customData:{colliderType:"sensor",colliderName:"slingshotLeaveRight",objectName:"door-blanket-right",objectAnimation:"up"}},{name:"collider-slingshot-sensor-right",vertices:[[-1.8888475894927979,-2.087808847427368],[-1.6833703517913818,-2.0893499851226807],[-1.6823192834854126,-1.910254955291748],[-1.8877965211868286,-1.908713698387146]],customData:{colliderType:"sensor",colliderName:"slingshotEnterRight",objectName:"door-blanket-right",objectAnimation:"up"}},{name:"collider-slingshot-sensor-left",vertices:[[1.6946197748184204,-2.0646510124206543],[1.9000970125198364,-2.066192388534546],[1.9011480808258057,-1.8870971202850342],[1.6956708431243896,-1.8855559825897217]],customData:{colliderType:"sensor",colliderName:"slingshotEnterLeft",objectName:"door-blanket-left",objectAnimation:"up"}},{name:"collider-slingshot-sensor-right.001",vertices:[[-1.8933340311050415,-4.05175256729126],[-1.6878567934036255,-4.0532941818237305],[-1.6868057250976562,-3.8741989135742188],[-1.8922829627990723,-3.872657537460327]],customData:{colliderType:"sensor",colliderName:"slingshotSensorRight",objectName:"skillshot-blanket-right",objectAnimation:"push"}},{name:"collider-slingshot.001",type:"NURBS",points:[{x:1.6274943351745605,y:-3.2947449684143066},{x:1.6466211080551147,y:-3.901381731033325},{x:1.6822067499160767,y:-4.028552055358887},{x:1.7873249053955078,y:-4.064899444580078},{x:1.8895823955535889,y:-4.015560150146484},{x:1.928457498550415,y:-3.899212598800659},{x:1.9256768226623535,y:-3.1253113746643066}],customData:{colliderName:"slingshot",colliderGroup:2,colliderMask:1}},{name:"collider-stool-01",vertices:[[.6803803443908691,1.1329083442687988],[.7114309668540955,1.0753616094589233],[.7670949101448059,1.0410500764846802],[.8324571251869202,1.0391672849655151],[.8900038003921509,1.0702179670333862],[.9243153929710388,1.1258819103240967],[.9261981248855591,1.191244125366211],[.8951475024223328,1.2487908601760864],[.8394835591316223,1.2831023931503296],[.7741213440895081,1.2849851846694946],[.7165746688842773,1.2539345026016235],[.6822630763053894,1.198270559310913]],customData:{colliderType:"bumper-hub",colliderName:"stool-low",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-left-03",stickerAnimation:"blinkAndOff",objectName:"stool-01",objectAnimation:"rotateY"}},{name:"collider-stool-02",vertices:[[.8502183556556702,1.622823715209961],[.8964555859565735,1.5765864849090576],[.9596168398857117,1.5596624612808228],[1.022778034210205,1.5765864849090576],[1.0690152645111084,1.622823715209961],[1.0859392881393433,1.6859849691390991],[1.0690152645111084,1.7491462230682373],[1.022778034210205,1.7953834533691406],[.9596168398857117,1.8123074769973755],[.8964555859565735,1.7953834533691406],[.8502183556556702,1.7491462230682373],[.8332943916320801,1.6859849691390991]],customData:{colliderType:"bumper-hub",colliderName:"stool-mid",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-left-02",stickerAnimation:"blinkAndOff",objectName:"stool-02",objectAnimation:"rotateY"}},{name:"collider-stool-03",vertices:[[.7107910513877869,2.121382474899292],[.7570282816886902,2.0751452445983887],[.8201895356178284,2.0582211017608643],[.8833507895469666,2.0751452445983887],[.9295880198478699,2.121382474899292],[.94651198387146,2.1845436096191406],[.9295880198478699,2.2477047443389893],[.8833507895469666,2.2939419746398926],[.8201895356178284,2.310866117477417],[.7570282816886902,2.2939419746398926],[.7107910513877869,2.2477047443389893],[.6938670873641968,2.1845436096191406]],customData:{colliderType:"bumper-hub",colliderName:"stool-high",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-left-01",stickerAnimation:"blinkAndOff",objectName:"stool-03",objectAnimation:"rotateY"}},{name:"collider-stool-04",vertices:[[-.92549729347229,1.1302026510238647],[-.8951594233512878,1.0722769498825073],[-.8399233222007751,1.037280797958374],[-.7745893001556396,1.0345913171768188],[-.716663658618927,1.0649292469024658],[-.6816675662994385,1.1201653480529785],[-.6789780855178833,1.1854993104934692],[-.7093159556388855,1.2434250116348267],[-.7645520567893982,1.27842116355896],[-.8298860788345337,1.2811106443405151],[-.8878117203712463,1.2507727146148682],[-.9228078126907349,1.1955366134643555]],customData:{colliderType:"bumper-hub",colliderName:"stool-low",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-right-03",stickerAnimation:"blinkAndOff",objectName:"stool-04",objectAnimation:"rotateY"}},{name:"collider-stool-05",vertices:[[-1.0510634183883667,1.6185986995697021],[-1.0048261880874634,1.5723614692687988],[-.94166499376297,1.555437445640564],[-.8785037398338318,1.5723614692687988],[-.8322665095329285,1.6185986995697021],[-.8153425455093384,1.6817599534988403],[-.8322665095329285,1.7449212074279785],[-.8785037398338318,1.7911584377288818],[-.94166499376297,1.8080824613571167],[-1.0048261880874634,1.7911584377288818],[-1.0510634183883667,1.7449212074279785],[-1.0679874420166016,1.6817599534988403]],customData:{colliderType:"bumper-hub",colliderName:"stool-mid",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-right-02",stickerAnimation:"blinkAndOff",objectName:"stool-05",objectAnimation:"rotateY"}},{name:"collider-stool-06",vertices:[[-.9200863242149353,2.121382474899292],[-.873849093914032,2.0751452445983887],[-.8106878399848938,2.0582211017608643],[-.7475265860557556,2.0751452445983887],[-.7012893557548523,2.121382474899292],[-.6843653917312622,2.1845436096191406],[-.7012893557548523,2.2477047443389893],[-.7475265860557556,2.2939419746398926],[-.8106878399848938,2.310866117477417],[-.873849093914032,2.2939419746398926],[-.9200863242149353,2.2477047443389893],[-.9370102882385254,2.1845436096191406]],customData:{colliderType:"bumper-hub",colliderName:"stool-high",colliderPoints:2500,stickerName:"sticker-stars-beauty-hub-right-01",stickerAnimation:"blinkAndOff",objectName:"stool-06",objectAnimation:"rotateY"}},{name:"collider-wall-left.001",vertices:[[1.5927388668060303,-2.472665786743164],[1.653111457824707,-2.4371323585510254],[1.653111457824707,-1.427990436553955],[1.5888218879699707,-1.427990436553955]],customData:{}},{name:"collider-wall-right.001",vertices:[[-.8976226449012756,-3.177278757095337],[-.779571533203125,-2.963740348815918],[-1.658017635345459,-2.4425089359283447],[-1.659673810005188,-2.7479212284088135]],customData:{}},{name:"collider-wall-save-left",vertices:[[1.6018455028533936,-1.3009319305419922],[1.657297134399414,-1.3009512424468994],[1.6582459211349487,-1.1497687101364136],[1.6025837659835815,-1.1508780717849731]],customData:{}},{name:"collider-wall-save-right",vertices:[[-1.6594419479370117,-1.3009319305419922],[-1.6039903163909912,-1.3009512424468994],[-1.6030415296554565,-1.1497687101364136],[-1.6587036848068237,-1.1508780717849731]],customData:{}},{name:"collider-wall-left",vertices:[[.7823074460029602,-2.9665868282318115],[.8351925611495972,-3.071932792663574],[.8880776166915894,-3.177278757095337],[1.6501284837722778,-2.7479212284088135],[1.6484724283218384,-2.4425089359283447]],customData:{}},{name:"collider-wall-right",vertices:[[-1.662656545639038,-2.4371323585510254],[-1.6022839546203613,-2.472665786743164],[-1.5983669757843018,-1.427990436553955],[-1.662656545639038,-1.427990436553955]],customData:{}},{name:"collider_left",vertices:[[-.06251386553049088,-.6402146220207214],[-.04122566431760788,-.6688546538352966],[-.001678764121606946,-.678544819355011],[.03456242009997368,-.66794753074646],[.05480850487947464,-.6297770738601685],[.08119843155145645,.02399134263396263],[.041322335600852966,.07668021321296692],[-.015332190319895744,.08574075996875763],[-.06848885118961334,.05529070273041725],[-.08642515540122986,.0018798969686031342]],customData:{colliderType:"flipper",colliderName:"leftFlipper",colliderGroup:2,colliderMask:1}},{name:"collider_left-top",vertices:[[-.049926649779081345,-.47296568751335144],[-.033693827688694,-.4948849380016327],[-.003479794366285205,-.50234454870224],[.024234825745224953,-.4942934811115265],[.03976094350218773,-.4651457369327545],[.06081068888306618,.03451671451330185],[.030402854084968567,.07484225928783417],[-.0128879863768816,.08184371888637543],[-.05355841666460037,.058641158044338226],[-.06733957678079605,.017841551452875137]],customData:{colliderType:"flipper",colliderName:"topFlipper",colliderGroup:2,colliderMask:1}},{name:"collider_right",vertices:[[-.06251386553049088,-.6434647440910339],[-.04122566431760788,-.6721047759056091],[-.001678764121606946,-.6817949414253235],[.03456242009997368,-.6711976528167725],[.05480850487947464,-.633027195930481],[.08119843155145645,.020741209387779236],[.041322335600852966,.07343008369207382],[-.015332190319895744,.08249063044786453],[-.06848885118961334,.052040569484233856],[-.08642515540122986,-.0013702362775802612]],customData:{colliderType:"flipper",colliderName:"rightFlipper",colliderGroup:2,colliderMask:1}}],Zu={shapes:nr},$u=Object.freeze(Object.defineProperty({__proto__:null,default:Zu,shapes:nr},Symbol.toStringTag,{value:"Module"})),ed=`#define GLSLIFY 1
varying vec2 vUv;varying vec4 vPosition;void main(){vec4 pos=projectionMatrix*modelViewMatrix*vec4(position,1.0);pos.xyz/=pos.w;vUv=uv;vPosition=pos;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}`,td=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D uDebugTexture;uniform float uScale;uniform sampler2D tDiffuse;void main(){vec2 scale=vec2(2.0/uScale,2.0/uScale);vec2 offset=vec2(0.0,-(2.0-uScale)/uScale);vec2 scaledUv=vUv*scale+offset;vec4 finalColor=texture2D(tDiffuse,vUv);if(vUv.x<=0.5*uScale&&vUv.y>=1.0-0.5*uScale){finalColor=texture2D(uDebugTexture,scaledUv);}gl_FragColor=vec4(finalColor.rgb,1.0);}`;class id extends $s{constructor(e={}){const{scene:t,debugCamera:i,activeCamera:s}=e;super({uniforms:{tDiffuse:{value:null},uDebugTexture:{value:null},uScale:{value:.75}},vertexShader:ed,fragmentShader:td}),this._scene=t,this._debugCamera=i,this._activeCamera=s,this._renderTarget=this._createRenderTarget(),this.uniforms.uDebugTexture.value=this._renderTarget.texture}get scene(){return this._scene}set scene(e){this._scene=e}get debugCamera(){return this._debugCamera}set debugCamera(e){this._debugCamera=e}get activeCamera(){return this._activeCamera}set activeCamera(e){this._activeCamera=e}get scale(){return this._scale}set scale(e){this._scale=e,this.uniforms.uScale.value=this._scale}dispose(){}render(e,t,i,s){e.autoClear=!0,e.setRenderTarget(this._renderTarget),e.render(this._scene,this._debugCamera),super.render(e,t,i,s)}_createRenderTarget(){const e=new dt(Je.innerWidth,Je.innerHeight,{type:bt,alpha:!0});return e.generateMipmaps=!1,e}}class sd extends we(_o){init(e,t,i){this.camera=e,this._debugCamera=e,this._scene=t,this._activeCamera=i,this._debugCameraPass=this._createDebugCameraPass()}_createDebugCameraPass(){const e=new id({scene:this._scene,debugCamera:this._debugCamera,activeCamera:this._activeCamera});return this.$postProcessing.composer.addPass(e),this.$postProcessing.passes.activeCamera=e,e}show(){this.visible=!0,this.$postProcessing.composer.addPass(this._debugCameraPass)}hide(){this.visible=!1,this.$postProcessing.composer.removePass(this._debugCameraPass)}render(){this.$postProcessing.passes.debugCamera.scene=this._scene,this.$postProcessing.passes.debugCamera.debugCamera=this._debugCamera,this.$postProcessing.passes.debugCamera.activeCamera=this._activeCamera}}class Wa extends we(rs){init(e={}){this._bindAll(),this._config=this.$context.isMachine?Un:Ca,this._loadingProgress=0,this._cameraPaths={},this._cinematicCameras=this._createCinematicCameras(),this._cameraManager=this._createCameraManager(),this._cameraPaths=this._createCameraPaths(this._cameraManager),this._setupCameras(),Se.showCameraHelper&&(this._cameraDebugHelper=this._createDebugCameraHelper()),this._lights=this._createLights(),this._resourceManager=this._createResourceManager(),this._dragManager=this._createDragManager(),this._setupEventListeners(),this._debugFolder=this._createDebugFolder()}get resourceManager(){return this._resourceManager}load(){}precompile(){const e=[];e[0]=new Promise(r=>{this.$renderer.compile(this,this.camera),r()});const t=Ca.resources.filter(r=>r.type==="texture"),i=[...t],s=[],a=4,n=1;for(let r=0;r<t.length;r+=a)s.push(i.slice(r,r+a));for(let r=0;r<s.length;r++){const l=new Promise(h=>{ls(()=>{for(let c=0;c<s[r].length;c++){const A=$.get(s[r][c].name);A&&this.$renderer.initTexture(A)}h()},r*n)});e.push(l)}return Promise.all(e)}start(){this._dotVisualsRenderer=new sr({width:1024,height:1024,debugFolder:this._debugFolder}),this._components=this._createComponents(),this._gameManager=this._createGameManager();const e=new _e(Se.backgroundColor);this.background=e}gameOver(){R.delayedCall(4.5,()=>{this.lightsOn()}),this.$soundManager.enableFilter(),this._cameraManager.getCamera("CameraFlipperMain").allowFollowBall=!1,R.delayedCall(1.5,()=>{this.playCinematicCameras()})}resetScene(){this._cameraManager.getCamera("CameraFlipperMain").allowFollowBall=!1}ballLose(){this._components.ball.setActiveHeightMapChannel(2);const e=si.current==="large"||si.current==="extra-large"?this._cameraPaths.launcherDesktop:this._cameraPaths.launcherMobile;this.$context.isMachine?this._cameraManager.getCamera("CameraFlipperMachine").shakeOnLose():(this._gameManager.gameStatus.remainingLives>0&&(this._cameraManager.getCamera("CameraFlipperMain").shakeOnLose(),this._cameraManager.getCamera("CameraFlipperMain").allowFollowBall=!1,this._cameraManager.getCamera("CameraFlipperMain").resetLookAtStates(e,1),this._cameraManager.getCamera("CameraFlipperMain").playLoseToStartPos(e,1,this._gameManager.gameStatus)),this._gameManager.gameStatus.remainingLives===0&&this._cameraManager.getCamera("CameraFlipperMain").shakeOnLoseFinal())}startLaunch(e){this._components.flipper.animateLauncher(e),this.$soundManager.disableFilter(),this._cameraManager.getCamera("CameraFlipperMain").allowFollowBall=!0,this.$context.isMachine?this._cameraManager.getCamera("CameraFlipperMachine").zoomIn():this._cameraManager.getCamera("CameraFlipperMain").zoomIn()}startGame(e){this.$context.isMachine?this._cameraManager.getCamera("CameraFlipperMachine").zoomOut():this._cameraManager.getCamera("CameraFlipperMain").zoomOut(),this._components.stickers.animateLivesStickers(e),this._components.flipper.resetLauncher()}preLaunch(){var e;this.lightsOn(),this.$context.isMachine&&(this._cameraManager.setCamera("CameraFlipperMachine"),(e=this._cinematicCamerasTimeline)==null||e.kill())}resetMissionObject(e){this._components.flipper.animateColliderObject(e.element.objectName,e.element.objectAnimation,!0),this._components.stickers.animateStickerOn(e.element.stickerName,"blinkAndOff")}lightsOn(){for(const e in Se.lights)R.to(this._lights[e],{intensity:Se.lights[e].intensity,duration:.2,repeat:5,yoyo:!0,onComplete:()=>{R.to(this._lights[e],{intensity:Se.lights[e].intensity,duration:2,ease:"power3.out"})}});for(const e in Se.pointLights)R.to(this._lights[e],{intensity:Se.pointLights[e].intensity,duration:.2,repeat:5,yoyo:!0,onComplete:()=>{R.to(this._lights[e],{intensity:Se.pointLights[e].intensity,duration:2,ease:"power3.out"})}});this._components.flipper.increaseFlipperLights(),this._components.stickers.increaseStickersLights(),this.$postProcessing.increaseBloomIntensity()}lightsOff(){for(const e in this._lights)R.to(this._lights[e],{intensity:0,duration:.2,repeat:5,yoyo:!0,delay:.4,onComplete:()=>{R.to(this._lights[e],{intensity:0,duration:2,ease:"power3.out"})}});this._components.flipper.reduceFlipperLights(),this._components.stickers.reduceStickersLights()}playCinematicCameras(){for(let e=0;e<this._cinematicCameras.length;e++)this._cameraManager.getCamera(this._cinematicCameras[e].name).playCameraSplinePath(this._cameraPaths[this._cinematicCameras[e].spline]);this.$context.isDebug||(this._cinematicCamerasTimeline=R.timeline({repeat:-1,delay:0}),this._cinematicCamerasTimeline.to({},{duration:4.5,onComplete:()=>{this._cinematicCamerasIndex=yl(this._cinematicCamerasIndex+1,this._cinematicCameras.length),this._cameraManager.setCamera(this._cinematicCameras[this._cinematicCamerasIndex].name)}}))}goToFlippers(){var e;this.$soundManager.playSound("loop-main",{volume:.5,delay:0,loop:{start:1e3,end:33e3},lowpass:!0}),this.$soundManager.enableFilter(),(e=this._cinematicCamerasTimeline)==null||e.kill()}onObjectCollide(){this._lights.light_06.influence=1}onSensorCollide(e,t){switch(e){case"holeRampSensorEnter":case"holeRampSensorSpeed":this._components.ball.setActiveHeightMapChannel(0);break;case"lipsRampSensorEnter":case"lipsRampSensorEnter2":this._components.ball.setActiveHeightMapChannel(1);break;case"holeRampSensorLeave":R.delayedCall(.35,()=>{this._components.ball.setActiveHeightMapChannel(2)});break}}destroy(){super.destroy(),this._destroyComponents(),this._removeEventListeners(),this._gameManager.destroy()}get config(){return this._config}get camera(){return this._cameraManager.camera}get cameraManager(){return this._cameraManager}get gameManager(){return this._gameManager}get components(){return this._components}get cameraPaths(){return this._cameraPaths}_createCameraManager(){const e=[];for(let i=0;i<this._cinematicCameras.length;i++)e.push(this._cinematicCameras[i].name);return new ea({types:["CameraFlipperMain","CameraFlipperMachine","Orbit",...e],debugFolder:this._debugFolder,id:"PhysicsScene"})}_createCinematicCameras(){return this._cinematicCamerasIndex=0,[{name:"CameraIntro",spline:"intro"},{name:"CameraTubeFlipper",spline:"tubeFlipper"},{name:"CameraBeautyHub",spline:"beautyHub"},{name:"CameraLips",spline:"lips"}]}_setupCameras(){this.$context.isMachine&&!this.$context.isDebug?(this._cameraManager.setCamera("CameraIntro"),this._cameraManager.getCamera("CameraIntro").playCameraSplinePath(this._cameraPaths.intro),this.playCinematicCameras()):!this.$context.isDebug&&!this.$context.isMachine&&(this._cameraManager.setCamera("CameraIntro"),this._cameraManager.getCamera("CameraIntro").playCameraSplinePath(this._cameraPaths.intro))}_createDebugCameraHelper(){const e=new sd(this._cameraManager.getCamera("CameraFlipperMain"),this,this._cameraManager.camera);return this.add(e),e}_createResourceManager(){const e=new Zs,t=this.$context.isMachine?Un:Ca;return e.add(t.resources),e.load(),e}_createGameManager(){return new Mu({eventDispatcher:this.$eventDispatcher,debugFolder:this._debugFolder,scene:this,playfieldData:$u,settings:Se,components:this._components,cameraManager:this._cameraManager})}_createDragManager(){return new Js({el:this.$renderer.domElement,preventDefault:!0})}_createLights(){this._selectiveLightsArray=[],this._nonSelectiveLightsArray=[];const e={};for(const t in Se.lights){const i=Se.lights[t],s=new Ka(i.color,i.intensity,{name:t});s.position.set(i.position.x,i.position.y,i.position.z),s.target.position.set(i.target.position.x,i.target.position.y,i.target.position.z),e[t]=s,this.add(s);const a=Se.lights[t].selective,n={key:t,value:a?1:0};this._selectiveLightsArray.push(n),this._nonSelectiveLightsArray.push(a?0:1)}Mt.lights.selectiveDirLights={value:this._selectiveLightsArray},Mt.lights.nonSelectiveDirLights={value:this._nonSelectiveLightsArray};for(const t in Se.pointLights){const i=Se.pointLights[t],s=new ju(i.color,i.intensity,i.distance,i.decay,{name:t,influence:i.influence,settings:i});s.position.set(i.position.x,i.position.y,i.position.z),e[t]=s,this.add(s)}return e}_bindAll(){this._loadCompleteHandler=this._loadCompleteHandler.bind(this),this._loadProgressHandler=this._loadProgressHandler.bind(this)}_createComponents(){return{ball:this._createComponentBall(),flipper:this._createComponentFlipper(),stickers:this._createComponentStickers(),scorePlane:this._createComponentScorePlane()}}_createCameraPaths(e){const t={};for(const i in Se.cameraPaths)if(Object.prototype.hasOwnProperty.call(Se.cameraPaths,i)){const s=Se.cameraPaths[i];t[i]={pos:this._createComponentSpline(s.pos,`${i}SplinePos`,e,s.debug),lookAt:this._createComponentSpline(s.lookAt,`${i}SplineLookAt`,e,s.debug)}}return t}_createComponentBall(){const e=new Hu({debugFolder:this._debugFolder});return this.add(e),e}_createComponentFlipper(){const e=new zu({debugFolder:this._debugFolder});return this.add(e),e}_createComponentStickers(){const e=new qu({debugFolder:this._debugFolder});return this.add(e),e}_createComponentScorePlane(){const e=new ar({debugFolder:this._debugFolder,dotVisualsRenderer:this._dotVisualsRenderer,cameraManager:this._cameraManager});this.add(e);const t=e.mesh.onBeforeRender;return e.mesh.onBeforeRender=(...i)=>{t==null||t.apply(e.mesh,i),this._dotVisualsRenderer.render(this.$renderer,this._cameraManager.camera,0)},e}_createComponentSpline(e,t,i,s=!1){const a=new Yu({debugFolder:this._debugFolder,cameraManager:i,debug:s,settings:e,name:t,color:e.debugColor});return this.add(a),a}_destroyComponents(){if(this._components)for(const e in this._components)typeof this._components[e].destroy=="function"&&this._components[e].destroy()}onUpdate({time:e,frame:t}){if(this._gameManager&&this._gameManager.gameStatus.paused||!this._components)return;const i=Ju.value;this._components.scorePlane.update({time:e,deltaTime:i,frame:t}),this._components.ball.update({time:e,deltaTime:i,frame:t,ballBody:this._gameManager.physicsManager.ballBody}),this._lights.light_06.position.x=Rt(this._lights.light_06.position.x,this._components.ball.mesh.position.x,.35*i/16),this._lights.light_06.position.z=Rt(this._lights.light_06.position.z,this._components.ball.mesh.position.z,.35*i/16),this._lights.light_06.influence=Rt(this._lights.light_06.influence,0,.07*i/16),this.$context.isMachine||this._cameraManager.getCamera("CameraFlipperMain").followBall(this._components.ball.mesh.position,i),this._components.flipper&&(this._components.flipper.mirror.rotation.x=-this._gameManager.physicsManager.mirror.angle,this._components.flipper.topFlipper.rotation.y=-this._gameManager.physicsManager.topFlipper.angle,this._components.flipper.leftFlipper.rotation.y=-this._gameManager.physicsManager.leftFlipper.angle,this._components.flipper.rightFlipper.rotation.y=-this._gameManager.physicsManager.rightFlipper.angle,this._gameManager.update({time:e,deltaTime:i,frame:t}))}onWindowResize(e){}_setupEventListeners(){this._resourceManager.addEventListener("complete",this._loadCompleteHandler),this._resourceManager.addEventListener("progress",this._loadProgressHandler)}_removeEventListeners(){this._resourceManager.removeEventListener("complete",this._loadCompleteHandler)}_loadCompleteHandler(){this.$context.isMachine&&this.precompile().then(()=>{this.start()})}_loadProgressHandler(e){}_createDebugFolder(){if(!this.$debugger)return;const e=this.$debugger.addFolder({title:`Scene ${this._config.name}`});for(const i in Se.lights)this._lights[i].createDebugFolder(e,Se.lights[i]);for(const i in Se.pointLights)this._lights[i].createDebugFolder(e,Se.pointLights[i]);e.addBinding(Se,"backgroundColor").on("change",()=>{this.background=new _e(Se.backgroundColor)}),e.addBinding(Se,"showCameraHelper").on("change",()=>{Se.showCameraHelper?this._cameraDebugHelper.show():this._cameraDebugHelper.hide()}),e.addBinding(Se,"debugPhysics").on("change",()=>{Se.debugPhysics&&!this._gameManager.physicsDebugManager?this._gameManager.firstCreatePhysicsDebug():Se.debugPhysics&&this._gameManager.physicsDebugManager?this._gameManager.physicsDebugManager.show():this._gameManager.physicsDebugManager.hide()}),e.addButton({title:"Reset Game"}).on("click",()=>{this._gameManager.reset(),this.goToFlippers(),this._cameraManager.setCamera("CameraFlipperMain"),this._cameraManager.getCamera("CameraFlipperMain").setCameraToSplinePos(this._cameraPaths.flippersMobile,0),this._cameraManager.getCamera("CameraFlipperMain").playCameraSplinePath(this._cameraPaths.flippersMobile)}),e.addButton({title:"Play Intro Cam Animation"}).on("click",()=>{this._cameraManager.getCamera("CameraIntro").playCameraSplinePath(this._cameraPaths.intro)}),e.addButton({title:"Play Launcher Cam Animation"}).on("click",()=>{this._cameraManager.getCamera("CameraFlipperMain").playCameraSplinePath(this._cameraPaths.launcherDesktop)}),e.addButton({title:"Set Cam To Spline Pos"}).on("click",()=>{this._cameraManager.getCamera("CameraFlipperMain").setCameraToSplinePos(this._cameraPaths.launcherMobile,0)}),e.addButton({title:"Download Lightmap"}).on("click",()=>{this._depthTexDownloader.setupMesh(),this._depthTexDownloader.download()}),e.addButton({title:"Reset Ball"}).on("click",()=>{this._gameManager.physicsManager.reset()}),e.addButton({title:"Launch Ball Debug"}).on("click",()=>{this._gameManager.physicsManager.launchBallDebug(),this._gameManager.startGameDebug()}),e.addButton({title:"Event Start"}).on("click",()=>{this.$nuxtApp.callHook("game:start")}),e.addButton({title:"Event Game Over"}).on("click",()=>{this._gameManager._gameOverHandler()}),e.addButton({title:"Event Ball Lose"}).on("click",()=>{this.$nuxtApp.callHook("ball:lose")}),e.addButton({title:"Event Score Circles"}).on("click",()=>{this.$nuxtApp.callHook("score:circles")}),e.addButton({title:"Event Score Stars"}).on("click",()=>{this.$nuxtApp.callHook("score:stars")});const t=e.addFolder({title:"Teleport to Position"});for(const i in Se.debugPositions)t.addButton({title:i}).on("click",()=>{this._gameManager.physicsManager.setDebugPosition(Se.debugPositions[i].position,Se.debugPositions[i].ramps)});return this.$debugger.registerFile(Se,Se.file),e}}Object.assign(Wa.prototype,cA);const Ua={name:"Scene Dot Visuals",resources:[{name:"model-sample",type:"gltf",path:"./webgl/models/model-sample.glb"},{name:"matcap-sample",type:"texture",path:"./webgl/textures/matcaps/matcap-sample.jpg"},{name:"perlin-combined",type:"texture",path:"./webgl/textures/noises/perlin-combined.jpg",options:{wrapS:N,wrapT:N}},{name:"albedo-sample",type:"texture",path:"./webgl/textures/sample/albedo-sample.jpg",options:{wrapS:N,wrapT:N,colorSpace:ot}},{name:"star-alpha",type:"texture",path:"./webgl/textures/dot-visuals/star-full.png"},{name:"star-alpha-border",type:"texture",path:"./webgl/textures/dot-visuals/star-border.png"},{name:"ao-sample",type:"texture",path:"./webgl/textures/sample/ao-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"roughness-sample",type:"texture",path:"./webgl/textures/sample/roughness-sample.jpg",options:{wrapS:N,wrapT:N}},{name:"normal-sample",type:"texture",path:"./webgl/textures/sample/normal-sample.jpg",options:{wrapS:N,wrapT:N}}]},gi={file:"./webgl/scenes/SceneDotVisuals/settings.js",shadows:{enabled:!0,showHelper:!1,color:"#000000",intensity:.9,near:0,far:30,mapSize:{x:1024,y:1024},bias:-1e-4,radius:4,blurSamples:4,frustumSize:5},lights:{light_shadows:{target:{position:{x:-1.6,y:2,z:.5},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}},position:{x:-10.600000000000001,y:9.5,z:5},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},intensity:4.6499999999999995,color:"#ffffff"}}},ad={};class or extends we(rs){init(e={}){this._bindAll(),this._config=Ua,this._resourceManager=this._createResourceManager(),this._cameraManager=this._createCameraManager(),this._lights=this._createLights(),this._debugFolder=this._createDebugFolder(),this._setupEventListeners()}destroy(){super.destroy(),this._destroyComponents(),this._removeEventListeners()}get config(){return this._config}get cameraManager(){return this._cameraManager}get camera(){return this._cameraManager.camera}precompile(){const e=[];e[0]=new Promise(r=>{r()});const t=Ua.resources.filter(r=>r.type==="texture"),i=[...t],s=[],a=4,n=1;for(let r=0;r<t.length;r+=a)s.push(i.slice(r,r+a));for(let r=0;r<s.length;r++){const l=new Promise(h=>{ls(()=>{for(let c=0;c<s[r].length;c++){const A=$.get(s[r][c].name);A&&this.$renderer.initTexture(A)}h()},r*n)});e.push(l)}return Promise.all(e)}_start(){this._dotVisualsRenderer=new sr({width:1024,height:1024,debugFolder:this._debugFolder}),this._components=this._createComponents()}_createCameraManager(){return new ea({types:["Orbit","Default"],debugFolder:this._debugFolder,id:"Scene Dot Visuals"})}_createResourceManager(){const e=new Zs;return e.add(Ua.resources),e.load(),e}_createLights(){const e={};for(const t in gi.lights){const i=gi.lights[t],s=new Ka(i.color,i.intensity,{name:t,settings:i});e[t]=s,this.add(s)}return e}_createShadowMap(){if(!gi.shadows||!gi.shadows.enabled)return;const e=new qo({light:this._lights.light_shadows,settings:gi.shadows,scene:this,debugFolder:this._debugFolder});return this.$renderer.shadowMap.enabled=!0,this.$renderer.shadowMap.autoUpdate=!0,this.$renderer.shadowMap.type=Co,e}_bindAll(){this._loadCompleteHandler=this._loadCompleteHandler.bind(this)}_createComponents(){return{scorePlane:this._createComponentScorePlane()}}_createComponentScorePlane(){const e=new ar({debugFolder:this._debugFolder,dotVisualsRenderer:this._dotVisualsRenderer});this.add(e);const t=e._mesh.onBeforeRender;return e._mesh.onBeforeRender=(...i)=>{t==null||t.apply(e._mesh,i),this._dotVisualsRenderer.render(this.$renderer,this._cameraManager.camera,0)},e}_createComponentText(){const e=new Tu({content:"GOOOO",font:"anton",debugFolder:this._debugFolder});return this.add(e),e}_createComponentModel(){const e=new Ho({debugFolder:this._debugFolder});return this.add(e),e}_createComponentReflector(){const e=new zo({debugFolder:this._debugFolder,camera:this._cameraManager.camera,scene:this});return this.add(e),e}_destroyComponents(){if(this._components)for(const e in this._components)typeof this._components[e].destroy=="function"&&this._components[e].destroy()}onUpdate({time:e,deltaTime:t,frame:i}){for(const s in this._components)typeof this._components[s].update=="function"&&this._components[s].update({time:e,deltaTime:t,frame:i})}onWindowResize(e){}_setupEventListeners(){this._resourceManager.addEventListener("complete",this._loadCompleteHandler)}_removeEventListeners(){this._resourceManager.removeEventListener("complete",this._loadCompleteHandler)}_loadCompleteHandler(){this._start()}_createDebugFolder(){if(!this.$debugger)return;const e=this.$debugger.addFolder({title:`${this._config.name}`});return this.$debugger.registerFile(gi,gi.file),e}}Object.assign(or.prototype,ad);const Rs={Main:Wa,Flipper:Wa,Sample:Oo,Materials:Vo,DotVisuals:or},nd={load(){return this.scene.load()},precompile(){return this.scene.precompile()},startScene(){return this.scene.start()},pause(){this.scene.gameManager.pause()},resume(){this.scene.gameManager.resume()},reset(){this.scene.gameManager.reset()},getScore(){var o;return(o=this.scene.gameManager)==null?void 0:o.score},getRemainingLives(){var o;return(o=this.scene.gameManager)==null?void 0:o.remainingLives},getLastScore(){var o;return(o=this.scene.gameManager)==null?void 0:o.lastScore},recalculateScore(){this.scene.gameManager.recalculateScore()},getGameTime(){var o;return(o=this.scene.gameManager)==null?void 0:o.gameTime},getScorePlanePositionData(){var o;return(o=this.scene.components)==null?void 0:o.scorePlane.screenPositionData},getGameManager(){return this.scene.gameManager},getResourceManager(){return this.scene.resourceManager},playCinematicCameras(){this.scene.playCinematicCameras(),this.scene.preLaunch()},goToFlippers(){this.scene.goToFlippers();const o=si.current==="large"||si.current==="extra-large"?this.scene.cameraPaths.flippersDesktop:this.scene.cameraPaths.flippersMobile;this.scene.cameraManager.setCamera("CameraFlipperMain"),this.scene.cameraManager.getCamera("CameraFlipperMain").setCameraToSplinePos(o,0),this.scene.cameraManager.getCamera("CameraFlipperMain").playCameraSplinePath(o)},goToLauncher(){const o=si.current==="large"||si.current==="extra-large"?this.scene.cameraPaths.launcherDesktop:this.scene.cameraPaths.launcherMobileTutorial;this.scene.cameraManager.getCamera("CameraFlipperMain").setCameraToSplinePos(o,0),this.scene.cameraManager.getCamera("CameraFlipperMain").playCameraSplinePath(o,0,this.scene.gameManager.gameStatus)}};class rr{constructor(e={}){this._canvas=e.canvas,this._debugger=e.debugger,this._nuxtApp=e.nuxtApp,this._contextStore=yo(),this._isProduction=e.isProduction,this._isDebug=e.isDebug,this._isDevelopment=e.isDevelopment,this._autoCreateStats=this._isDevelopment,this._eventDispatcher=new ul,this._renderer=this._createRenderer(),this._postprocessing=this._createPostprocessing(),this._profiler=this._createProfiler(),_i.setGUI(this._debugger),this._registerKTXLoader(),this._registerBidelloGlobals(),this._createShaderChunks(),this._stats=this._createStats(),this._bindAll(),this._setupEventListeners(),Je.triggerResize(),this._setupDebugger()}start(){this._scene=this._createScene()}destroy(){$.resources.filter(e=>e.type==="texture").forEach(e=>{$.get(e.name).dispose()}),this._scene.destroy(),this._renderer.renderLists.dispose(),this._renderer.dispose(),this._removeEventListeners(),this._postprocessing.destroy(),this._stats&&this._removeStats()}get scene(){return this._scene}_createRenderer(){return new dl({canvas:this._canvas,powerPreference:"high-performance",antialias:!1,transparent:!1})}_createPostprocessing(){return new cc({renderer:this._renderer,debugger:this._debugger,nuxtApp:this._nuxtApp,context:this._contextStore})}_createProfiler(){const e=this._renderer.getContext(),t=e.getExtension("EXT_disjoint_timer_query_webgl2"),i=new Gl(e,t,this._renderer);return i.addDebuggerButton(this._debugger),i}_createScene(){const t=new URLSearchParams(location.search).get("scene");return Rs[t]?new Rs[t]:new Rs.Main}_createShaderChunks(){St.phong_pars_fragment=Ac,St.phong_fragment=hc,St.matcap_pars_fragment=uc,St.matcap_fragment=dc,St.env_pars=pc,St.env_fragment=gc,St.env_vertex=fc,St.shadows_fragment_pars=mc,St.shadows_fragment=vc,St.shadows_vertex_pars=_c,St.shadows_vertex=Cc}_createStats(){return this._isProduction||!this._autoCreateStats?void 0:new El(this._renderer)}_removeStats(){this._stats&&(document.body.removeChild(this._stats.domContainer),this._stats.destroy(),this._stats=null)}_registerKTXLoader(){$.registerLoader(Nl,"ktx2",{transcoderPath:"./libs/basis/",renderer:this._renderer}),$.registerLoader(Fl,"audio")}_registerBidelloGlobals(){et.registerGlobal("root",this),et.registerGlobal("nuxtApp",this._nuxtApp),et.registerGlobal("renderer",this._renderer),et.registerGlobal("canvas",this._canvas),et.registerGlobal("debugger",this._debugger),et.registerGlobal("profiler",this._profiler),et.registerGlobal("eventDispatcher",this._eventDispatcher),et.registerGlobal("context",this._contextStore),et.registerGlobal("postProcessing",this._postprocessing),et.registerGlobal("soundManager",ai)}_resize(e){this._resizeRenderer(e),this._triggerBidelloResize(e)}_resizeRenderer(e){const t=_i.isReady?Math.min(e.dpr,_i.globalProfile.maxDpr):e.dpr;this._renderer.setPixelRatio(t),this._renderer.setSize(e.innerWidth,e.innerHeight,!0)}_triggerBidelloResize(e){et.trigger({name:"windowResize",fireAtStart:!0},e)}_tick({time:e,deltaTime:t,frame:i}){var s,a;(s=this._stats)==null||s.begin(),this._update({time:e,deltaTime:t,frame:i}),this._render({time:e,deltaTime:t,frame:i}),(a=this._stats)==null||a.end()}_update({time:e,deltaTime:t,frame:i}){this._triggerBidelloUpdate({time:e,deltaTime:t,frame:i}),this._postprocessing&&this._postprocessing.update({time:e,deltaTime:t,frame:i})}_triggerBidelloUpdate({time:e,deltaTime:t,frame:i}){et.trigger({name:"update",fireAtStart:!1},{time:e,deltaTime:t,frame:i})}_render(){this._scene&&this._postprocessing.render(this._scene,this._scene.camera)}_bindAll(){this._tickHandler=this._tickHandler.bind(this),this._resizeHandler=this._resizeHandler.bind(this)}_setupEventListeners(){Je.addEventListener("resize",this._resizeHandler),R.ticker.add(this._tickHandler),_i.ready().then(()=>{this._resizeHandler(Je.dimensions)})}_removeEventListeners(){Je.removeEventListener("resize",this._resizeHandler),R.ticker.remove(this._tickHandler)}_tickHandler(e,t,i){this._tick({time:e,deltaTime:t,frame:i})}_resizeHandler(e){this._resize(e)}_setupDebugger(){if(!this._debugger)return;const e=this._debugger.addFolder({title:"Debug scenes",expanded:!1});for(const t in Rs){const i=e.addButton({title:`${t}`}).on("click",()=>{window.location.href=`/debug?scene=${t}`}),a=new URLSearchParams(location.search).get("scene")||"Main",n=location.pathname.includes("/debug"),r=a===t;i.disabled=r&&n}}}Object.assign(rr.prototype,nd);const od={__name:"index",setup(o){let e=null,t;const i=yo(),{provide:s}=aa(),{$webgl:a}=aa(),n=gl();function r(){dn&&!i.isProduction&&(t=new dn({title:"WebGL Debugger",position:"top-right"}))}function l(){e=new rr({canvas:n.value,debugger:t,isProduction:i.isProduction,isDebug:i.isDebug,isDevelopment:i.isDevelopment,nuxtApp:aa()}),e.start()}function h(){r(),l()}return fl(h),ml(()=>{t==null||t.destroy(),e==null||e.destroy()}),a||s("webgl",{getWebglApp:()=>e}),(c,A)=>(vl(),_l("canvas",{ref_key:"canvas",ref:n,class:"the-webgl-background"},null,512))}},ud=pl(od,[["__scopeId","data-v-70146f20"]]);export{ud as _};
